import{_ as Q,X as T,d6 as B,r as D,o as r,d as m,w as a,f as t,B as c,h as W,i as U,T as x,k as l,t as f,c$ as A,j as v,G as h,d0 as P,e as b,m as I,l as N,O,n as g,F as C,s as E,R as k,S as s,Q as _,ax as H,M as w,y as G}from"./index.129a5639.js";import{e as j}from"./emitirNFe.35117289.js";import{D as L}from"./DocumentosFiscais.765df2e1.js";import{M as X}from"./ModalHistoricoStatus.29ca6929.js";const J={visibilidade:{botao:{editar:!1,remover:!1,visualizar:!1}}},K={components:{Avatar:T,Envelope:B,ModalHistoricoStatus:X,DocumentosFiscais:L},computed:{podeMigrarFatura(){return!~["Finalizada","Aguardando Pagamento"].indexOf(this.fatura.status)&&!~["Cancelado","N\xE3o Aprovado","Or\xE7amento"].indexOf(this.documento.status)}},data(){return{contato:{},documento:{},documentosItem:[],fatura:{},faturasAbertas:[],visibilidade:{},detalhesVisivel:!1,configImpressaoOrcamento:[],configImpressaoEnvelope:[],sistemaPai:""}},methods:{async duplicarVenda(){try{await new Promise((i,e)=>{this.$q.dialog({message:"Duplicar este pedido?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(()=>{i()}).onCancel(()=>{e()})})}catch{return}try{const i=await $db.venda.duplicarVenda(this.id);this.$refs.modalEnvelope.mostrar({idEnvelope:i}),this.$q.notify({type:"positive",message:"Pedido duplicado"})}catch(i){let e="N\xE3o foi poss\xEDvel realizar a opera\xE7\xE3o";/^GError:.+/.test(i.message)&&(e=i.message.slice(7)),this.$q.notify({type:"negative",message:e}),console.error(i)}},irParaAtendimentoFatura(i){this.$router.push({name:"AtendimentoFatura",params:{id:i}})},async migrarFatura({documento:i,idFatura:e}){try{await new Promise((n,p)=>{this.$q.dialog({message:"Esta a\xE7\xE3o ir\xE1 migrar este envelope para outra fatura.",noRefocus:!0,preventClose:!0,title:"Tem certeza?",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(()=>{n()}).onCancel(()=>{p()})})}catch{return}try{let n;if(e&&(n=await $db.hibrido.le({table:"documento",id:e})),!n){const p=await $db.envelope.obterDadosContatoResponsavel(i.idContatoResponsavel);n=$db.fatura.criar({...i,idContato:p.idContato,idContatoEndereco:p.idContatoEndereco,numeroDocumentoContato:p.numeroDocumentoContato,descricaoContato:p.descricaoContato,descricaoContatoEndereco:p.descricaoContatoEndereco,telefoneContato:p.telefoneContato}),await $db.fatura.grava({fatura:n})}await $db.documento.grava({atual:{id:i.id,idFatura:n.id},original:i}),localStorage.setItem("idFatura",n.id),this.$emit("executar","atualizar"),this.irParaAtendimentoFatura(i.idContatoResponsavel)}catch(n){let p="Erro ao migrar para fatura.";/^GError:.+/.test(n.message)&&(p=n.message.slice(7)),$q.notify({type:"negative",message:p}),console.error(n);return}},alternarDetalhes(){this.detalhesVisivel=!this.detalhesVisivel},async carregarContatos({ids:i}){const e={};for(const n of i)e[n]||(e[n]=await $db.hibrido.le({table:"contato",id:n}));this.contato=e},async configurarVisibilidade({documento:i,faturasAbertas:e}){const n=$utils.clonar(J.visibilidade);e.some(p=>p.id===i.idFatura)&&(n.botao.remover=await $db.permissao.objeto("Diretiva_Vendas_RemoverVendaFatura")),!~["Cancelado","N\xE3o Aprovado"].indexOf(i.status)&&!i.idFatura&&(n.botao.editar=!0),n.botao.editar||(n.botao.visualizar=!0),this.visibilidade=n},async carregarFaturasAbertas({documento:i}){let e=[];return i.idContatoResponsavel&&i.idEmpresa&&(e=await $db.hibrido.lista({table:"documento",where:{idContato:i.idContatoResponsavel,idEmpresa:i.idEmpresa,tipo:"Fatura",status:"Aberta"}}),e=e.sort((n,p)=>!n.numero||n.numero<p.numero?-1:1)),e},async mostrar({documento:i}){await this.$refs.modalEnvelope.mostrar({idEnvelope:i.id})},async atualizar(){this.sistemaPai=$utils.sistemaPai();const i=await $db.hibrido.le({table:"documento",id:this.id}),e=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:this.id}}),n=await this.carregarFaturasAbertas({documento:i});i.idFatura&&(this.fatura=await $db.hibrido.le({table:"documento",id:i.idFatura})),await this.carregarContatos({ids:[i.idContato,i.idContatoVendedor,i.idContatoResponsavel]}),await this.configurarVisibilidade({documento:i,faturasAbertas:n}),await this.configuraImpressaoEnvelope({documento:i}),await this.configuraImpressaoOrcamento({documento:i}),await this.configuraImpressosWhatsapp({documento:i}),this.faturasAbertas=n,this.documentosItem=e.filter(p=>p.idItem),this.documento=i},async configuraImpressaoEnvelope({documento:i}){const e=await $db.configuracoes.porNome("impressao.envelope",i.idEmpresa);this.configImpressaoEnvelope=[...e.length?e.map(n=>({texto:"Imprimir Envelope",...n})):[{valor:"envelope",texto:"Imprimir Envelope"},{valor:"envelopeMini",texto:"Imprimir Envelope Mini"}]]},async configuraImpressaoOrcamento({documento:i}){const e=await $db.configuracoes.porNome("impressao.venda",i.idEmpresa),n=[{valor:"invoice",texto:"Or\xE7amento/Venda (Invoice)"}];this.sistemaPai==="optisoul"&&n.push({valor:"orcamento",texto:"Or\xE7amento (Antigo)"},{valor:"termoGarantia",texto:"Termo de Garantia"}),this.configImpressaoOrcamento=[...e.length?e.map(p=>({texto:"Imprimir Or\xE7amento",...p})):n]},async configuraImpressosWhatsapp({documento:i}){const e=await $db.configuracoes.le({prefixoNome:"venda.whatsapp.enviar.",idEmpresa:i.idEmpresa});this.configImpressosWhatsapp=e.map(n=>({...n,idVenda:i.id}))},async dialogEnviar(i){var e,n;try{const p=await $db.hibrido.le({table:"documento",id:i.idVenda});$utils.verificarErro(!(p!=null&&p.id),"Erro ao obter dados");const o=await $db.contato.leCompleto(p.idContato),y=(((e=o==null?void 0:o.telefone)==null?void 0:e.find(q=>q.tipoTelefone==="WhatsApp"))||((n=o==null?void 0:o.telefone)==null?void 0:n.find(q=>q.tipoTelefone==="Principal"))||(o==null?void 0:o.telefone[0])||{}).telefone.trim()||"";$q.dialog({title:"Enviar impresso pelo Whatsapp?",preventClose:!0,prompt:{label:"Enviar para este n\xFAmero:",model:y||"",hint:"Ou adicione um novo n\xFAmero, ex: 19988776655",isValid:q=>q.length>0,type:"text"},cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(async q=>{var S;p.telefoneContato=q.replace(/\D/g,"");const z=await $db.venda.enviaImpressaoPdfwhatsapp({documento:p,nomeImpresso:i.nome.replace("venda.whatsapp.enviar.",""),mensagem:(S=i.texto)!=null?S:`Voc\xEA est\xE1 recebendo o ${i.valor} da empresa ${p.descricaoEmpresa} (${p.numeroDocumentoEmpresa}).`})})}catch{$q.notifyError("Erro ao enviar.",erro)}},copiarUid(){const i=this.$refs.uid;i.type="text";try{i.select(),document.execCommand("copy"),this.$q.notify({message:"UID copiado para a \xE1rea de transfer\xEAncia.",type:"info"})}catch{this.$q.notify("Erro ao copiar.")}i.type="hidden",window.getSelection().removeAllRanges()},descricaoEnvelope(i){if(i.itens)return i.itens.map(n=>n.descricaoItem).filter(Boolean).join(" | ");let e="";for(const n of this.dados.itensEnvelopes)n.idDocumentoAdicional===i.id&&n.descricaoItem.trim()&&(e+=n.descricaoItem.trim()+" | ");return e.slice(0,-3)},executar(i){switch(i){case"atualizar":this.atualizar();break;case"cancelar":case"finalizar":case"reprovar":this.$emit("executar","atualizar");break;case"retornarOrcamento":this.$emit("executar",i);break}},async remover({documento:i}){this.$q.dialog({message:"Esta a\xE7\xE3o ir\xE1 remover este envelope da fatura",title:"Tem certeza?",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{await $db.venda.checarConflitoStatus({id:i.id,status:i.status})}catch(e){return $q.notifyError(e.message),!1}await $db.documento.grava({atual:{id:i.id,idFatura:""},original:i}),this.$emit("executar","remover")})}},mixins:[j],props:{id:{required:!0,type:String}},async mounted(){await this.atualizar()}},Y={class:"col-12 col-md-6 q-pl-none"},Z={class:"q-item-section"},$={class:"col-6 col-md hideonmobile"},ee={class:"text-left q-my-none"},te={class:"col-4 col-md hideonmobile"},oe={class:"text-left q-my-none"},ae={class:"col-4 col-md hideonmobile"},ie={class:"text-left q-my-none"},re={class:"col-6 col-md hideonmobile"},ne={class:"text-right text-h5 text-positive text-weight-bold q-my-none"},le={class:"text-right text-weight-normal text-tertiary text-body2 q-my-none"},se={class:"col-12 hideondesktop"},de={class:"text-left q-my-none"},ue={class:"col-12 col-md-6"},me={class:"col-12 col-md-6 full-height items-end hideonmobile"},ce={class:"col-6"},fe={class:"text-left q-my-none"},pe={class:"text-left q-my-none"},ve={class:"col-6"},be={class:"text-right text-weight-normal text-tertiary text-body2 q-my-none"},ye={class:"text-right text-h5 text-positive text-weight-bold q-my-none"},ke={class:"col-12 full-height items-end"},he={class:"col-12 col-md-6"},ge={class:"text-subtitle1 text-weight-bold q-ma-none items-center"},Ce={class:"q-ma-none"},_e={key:0},we={class:"col-6 col-md-4"},xe={class:"q-ma-none"},qe={class:"col-6 col-md-2 text-right"},Ee={class:"q-ma-none"};function Fe(i,e,n,p,o,y){const q=D("avatar"),z=D("row"),S=D("DocumentosFiscais"),R=D("Envelope"),M=D("ModalHistoricoStatus");return o.documento.id?(r(),m(G,{key:0,id:"VendaCard",class:"extratoItem bg-white q-pa-sm no-shadow"},{default:a(()=>[t(z,{class:"items-center justify-between q-mx-none q-px-none q-mb-sm"},{default:a(()=>{var u;return[c("div",Y,[t(W,{class:"q-pa-none"},{default:a(()=>{var d;return[t(q,{imagem:(d=o.contato[o.documento.idContato])==null?void 0:d.imagem,rotulo:o.documento.descricaoContato,tamanho:"40",style:{float:"left"}},null,8,["imagem","rotulo"]),t(U,null,{default:a(()=>{var F;return[c("div",Z,[t(x,null,{default:a(()=>{var V;return[l(f((V=o.contato[o.documento.idContato])==null?void 0:V.apelido),1)]}),_:1}),o.documento.idContatoResponsavel!==o.documento.idContato&&((F=o.contato[o.documento.idContatoResponsavel])==null?void 0:F.nome)?(r(),m(x,{key:0,caption:""},{default:a(()=>{var V;return[l(f((V=o.contato[o.documento.idContatoResponsavel])==null?void 0:V.nome),1)]}),_:1})):(r(),m(x,{key:1,caption:""},{default:a(()=>{var V;return[l(f((V=o.contato[o.documento.idContato])==null?void 0:V.nome),1)]}),_:1}))])]}),_:1}),t(A,{rounded:"",color:"tertiary",small:""},{default:a(()=>[l(f(o.documento.status),1)]),_:1}),t(A,{class:"q-ml-sm",color:"positive",escuro:"",onClick:y.copiarUid},{default:a(()=>[l(" #"+f(parseInt(o.documento.numero)||(o.documento.id||"").slice(-6))+" ",1),t(v,{class:"q-ml-sm",name:"mdi-glasses"}),h(c("input",{type:"hidden","onUpdate:modelValue":e[0]||(e[0]=F=>o.documento.id=F),ref:"uid"},null,512),[[P,o.documento.id]])]),_:1},8,["onClick"])]}),_:1})]),c("div",$,[c("p",ee,[o.contato[o.documento.idContatoVendedor]?(r(),m(v,{key:0,name:"mdi-account-tie"})):b("",!0),l(" "+f((u=o.contato[o.documento.idContatoVendedor])==null?void 0:u.apelido)+" ",1),t(I,null,{default:a(()=>e[18]||(e[18]=[l(" Vendedor(a) ")])),_:1})])]),c("div",te,[c("p",oe,[o.documento.dataHoraEmissao?(r(),m(v,{key:0,name:"mdi-calendar-today "})):b("",!0),l(" "+f(i.$filters.data(o.documento.dataHoraEmissao))+" ",1),t(I,null,{default:a(()=>e[19]||(e[19]=[l(" Emiss\xE3o ")])),_:1})])]),c("div",ae,[c("p",ie,[o.documento.dataHoraFinalizado?(r(),m(v,{key:0,name:"mdi-calendar-check"})):b("",!0),l(" "+f(i.$filters.data(o.documento.dataHoraFinalizado))+" ",1),o.documento.dataHoraFinalizado?(r(),m(I,{key:1},{default:a(()=>e[20]||(e[20]=[l(" Finalizado ")])),_:1})):b("",!0)])]),c("div",re,[c("p",ne,f(i.$filters.numero(o.documento.totalDocumento,2)),1),c("p",le,f(i.$filters.numero(o.documento.subTotal,2)),1)])]}),_:1}),t(N,{class:"hideondesktop q-mb-sm"}),t(z,{class:"q-mx-none q-px-none items-center"},{default:a(()=>{var u;return[c("div",se,[c("p",de,[o.contato[o.documento.idContatoVendedor]?(r(),m(v,{key:0,name:"mdi-account-tie"})):b("",!0),l(" "+f((u=o.contato[o.documento.idContatoVendedor])==null?void 0:u.apelido)+" ",1),t(I,null,{default:a(()=>e[21]||(e[21]=[l(" Vendedor(a) ")])),_:1})])]),c("div",ue,[t(O,{class:"no-border text-tertiary"},{default:a(()=>[(r(!0),g(C,null,E(o.documentosItem,d=>(r(),m(k,{key:d.id,class:"q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:a(()=>[t(s,{avatar:"",class:"mw80"},{default:a(()=>[t(x,null,{default:a(()=>[l(f(d.quantidade)+"x",1)]),_:2},1024)]),_:2},1024),t(s,null,{default:a(()=>[t(x,null,{default:a(()=>[l(f(d.descricaoItem),1)]),_:2},1024)]),_:2},1024),t(s,{side:"",top:""},{default:a(()=>[t(x,null,{default:a(()=>[l(f(i.$filters.numero(d.total,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),c("div",me,[t(N,{class:"hideondesktop q-mb-sm q-mt-xs"}),t(_,{rounded:"",dense:"",flat:"",icon:"more_vert",color:"tertiary",class:"no-shadow q-mx-xs",size:"md",style:{float:"right"}},{default:a(()=>[t(H,null,{default:a(()=>[h((r(),m(O,{link:"",separator:""},{default:a(()=>[i.$utils.mapearStatus(o.documento).permiteNota?(r(),g(C,{key:0},[h((r(),m(k,{clickable:"",onClick:e[1]||(e[1]=d=>i.emitirNFeV2({idVenda:o.documento.id},1,"Venda"))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"account_balance"})]),_:1}),t(s,null,{default:a(()=>e[22]||(e[22]=[l("NFe de Sa\xEDda/Venda")])),_:1})]),_:1})),[[w]]),h((r(),m(k,{clickable:"",onClick:e[2]||(e[2]=d=>i.emitirNFeV2({idVenda:o.documento.id},0,"Devolu\xE7\xE3o"))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"account_balance"})]),_:1}),t(s,null,{default:a(()=>e[23]||(e[23]=[l("NFe de Entrada/Devolu\xE7\xE3o")])),_:1})]),_:1})),[[w]]),h((r(),m(k,{clickable:"",onClick:e[3]||(e[3]=d=>i.emitirNFeV2({idVenda:o.documento.id},1,"Remessa"))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"account_balance"})]),_:1}),t(s,null,{default:a(()=>e[24]||(e[24]=[l("NFe de Remessa")])),_:1})]),_:1})),[[w]])],64)):b("",!0),y.podeMigrarFatura?(r(),g(C,{key:1},[(r(!0),g(C,null,E(o.faturasAbertas.filter(d=>d.id!==o.documento.idFatura),d=>h((r(),m(k,{clickable:"",key:d.id,onClick:F=>y.migrarFatura({documento:o.documento,idFatura:d.id})},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"mdi-folder-move"})]),_:1}),t(s,null,{default:a(()=>[l(f("Migrar para fatura #"+(d.numero||d.id.slice(-6))),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[w]])),128)),h((r(),m(k,{clickable:"",onClick:e[4]||(e[4]=d=>y.migrarFatura({documento:o.documento}))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"mdi-folder-move"})]),_:1}),t(s,null,{default:a(()=>e[25]||(e[25]=[l("Migrar para nova fatura")])),_:1})]),_:1})),[[w]])],64)):b("",!0),t(k,{clickable:"",onClick:e[5]||(e[5]=d=>i.$refs.modalHistoricoStatus.mostrar({idDocumento:o.documento.id}))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"history"})]),_:1}),t(s,null,{default:a(()=>e[26]||(e[26]=[l("Hist\xF3rico do Status")])),_:1})]),_:1}),t(k,{clickable:"",onClick:y.duplicarVenda},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"mdi-content-duplicate"})]),_:1}),t(s,null,{default:a(()=>e[27]||(e[27]=[l("Duplicar Pedido")])),_:1})]),_:1},8,["onClick"]),(r(!0),g(C,null,E(i.configImpressosWhatsapp.filter(d=>d.valor),d=>(r(),m(k,{clickable:"",key:d.valor,onClick:F=>y.dialogEnviar(d)},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"mdi-whatsapp"})]),_:1}),t(s,null,{default:a(()=>[l(f(d.valor),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})),[[w]])]),_:1})]),_:1}),o.visibilidade.botao.remover?(r(),m(_,{key:0,rounded:"",dense:"",flat:"",icon:"clear",color:"tertiary",class:"no-shadow q-mx-xs",size:"md",onClick:e[6]||(e[6]=d=>y.remover({documento:o.documento})),style:{float:"right"}})):b("",!0),o.visibilidade.botao.editar?(r(),m(_,{key:1,rounded:"",dense:"",flat:"",icon:"edit",color:"primary",class:"no-shadow q-mx-xs",size:"md",onClick:e[7]||(e[7]=d=>y.mostrar({documento:o.documento})),style:{float:"right"}})):b("",!0),o.visibilidade.botao.visualizar?(r(),m(_,{key:2,rounded:"",dense:"",flat:"",icon:"remove_red_eye",color:"primary",class:"no-shadow q-mx-xs",size:"md",onClick:e[8]||(e[8]=d=>y.mostrar({documento:o.documento})),style:{float:"right"}})):b("",!0),t(_,{rounded:"",dense:"",flat:"",icon:"print",color:"primary",class:"no-shadow q-mx-xs",size:"md",style:{float:"right"}},{default:a(()=>[t(H,null,{default:a(()=>[t(O,{link:"",separator:""},{default:a(()=>[(r(!0),g(C,null,E(o.configImpressaoOrcamento.filter(d=>d.valor),d=>(r(),m(k,{clickable:"",key:d.valor,onClick:F=>i.$imprimir(d.valor,{id:o.documento.id,Oculto:"0"})},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"print"})]),_:1}),t(s,null,{default:a(()=>[t(x,null,{default:a(()=>[l(f(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),o.sistemaPai==="optisoul"?(r(!0),g(C,{key:0},E(o.configImpressaoEnvelope,d=>(r(),m(k,{clickable:"",key:d.valor,onClick:F=>i.$imprimir(d.valor,o.documento.id)},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"print"})]),_:1}),t(s,null,{default:a(()=>[t(x,null,{default:a(()=>[l(f(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):b("",!0)]),_:1})]),_:1})]),_:1}),t(_,{rounded:"",dense:"",flat:"",icon:o.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down",size:"md",class:"no-shadow q-mx-xs",color:"tertiary",style:{float:"right"},onClick:y.alternarDetalhes},null,8,["icon","onClick"])])]}),_:1}),t(N,{class:"hideondesktop q-mb-sm q-mt-xs"}),t(z,{class:"q-mx-none q-px-none hideondesktop"},{default:a(()=>[c("div",ce,[c("p",fe,[o.documento.dataHoraEmissao?(r(),m(v,{key:0,name:"mdi-calendar-today"})):b("",!0),l(" "+f(i.$filters.data(o.documento.dataHoraEmissao))+" ",1),t(I,null,{default:a(()=>e[28]||(e[28]=[l(" Emiss\xE3o ")])),_:1})]),c("p",pe,[o.documento.dataHoraFinalizado?(r(),m(v,{key:0,name:"mdi-calendar-check"})):b("",!0),l(" "+f(i.$filters.data(o.documento.dataHoraFinalizado))+" ",1),o.documento.dataHoraFinalizado?(r(),m(I,{key:1},{default:a(()=>e[29]||(e[29]=[l(" Finalizado ")])),_:1})):b("",!0)])]),c("div",ve,[c("p",be,f(i.$filters.numero(o.documento.subTotal,2)),1),c("p",ye,f(i.$filters.numero(o.documento.totalDocumento,2)),1)]),c("div",ke,[t(N,{class:"hideondesktop q-mb-sm q-mt-xs"}),t(_,{rounded:"",dense:"",flat:"",icon:"more_vert",color:"tertiary",class:"no-shadow q-mx-xs",size:"md",style:{float:"right"}},{default:a(()=>[t(H,null,{default:a(()=>[h((r(),m(O,{link:"",separator:""},{default:a(()=>[i.$utils.mapearStatus(o.documento).permiteNota?(r(),g(C,{key:0},[h((r(),m(k,{clickable:"",onClick:e[9]||(e[9]=u=>i.emitirNFeV2({idVenda:o.documento.id},1,"Venda"))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"account_balance"})]),_:1}),t(s,null,{default:a(()=>e[30]||(e[30]=[l("NFe de Sa\xEDda/Venda")])),_:1})]),_:1})),[[w]]),h((r(),m(k,{clickable:"",onClick:e[10]||(e[10]=u=>i.emitirNFeV2({idVenda:o.documento.id},0,"Devolu\xE7\xE3o"))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"account_balance"})]),_:1}),t(s,null,{default:a(()=>e[31]||(e[31]=[l("NFe de Entrada/Devolu\xE7\xE3o")])),_:1})]),_:1})),[[w]]),h((r(),m(k,{clickable:"",onClick:e[11]||(e[11]=u=>i.emitirNFeV2({idVenda:o.documento.id},1,"Remessa"))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"account_balance"})]),_:1}),t(s,null,{default:a(()=>e[32]||(e[32]=[l("NFe de Remessa")])),_:1})]),_:1})),[[w]])],64)):b("",!0),y.podeMigrarFatura?(r(),g(C,{key:1},[(r(!0),g(C,null,E(o.faturasAbertas.filter(u=>u.id!==o.documento.idFatura),u=>h((r(),m(k,{key:u.id,onClick:d=>y.migrarFatura({documento:o.documento,idFatura:u.id})},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"mdi-folder-move"})]),_:1}),t(s,null,{default:a(()=>[l(f("Migrar para fatura #"+(u.numero||u.id.slice(-6))),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[w]])),128)),h((r(),m(k,{onClick:e[12]||(e[12]=u=>y.migrarFatura({documento:o.documento}))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"mdi-folder-move"})]),_:1}),t(s,null,{default:a(()=>e[33]||(e[33]=[l("Migrar para nova fatura")])),_:1})]),_:1})),[[w]])],64)):b("",!0),t(k,{clickable:"",onClick:e[13]||(e[13]=u=>i.$refs.modalHistoricoStatus.mostrar({idDocumento:o.documento.id}))},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"history"})]),_:1}),t(s,null,{default:a(()=>e[34]||(e[34]=[l("Hist\xF3rico do Status")])),_:1})]),_:1}),t(k,{clickable:"",onClick:y.duplicarVenda},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"mdi-content-duplicate"})]),_:1}),t(s,null,{default:a(()=>e[35]||(e[35]=[l("Duplicar Pedido")])),_:1})]),_:1},8,["onClick"]),(r(!0),g(C,null,E(i.configImpressosWhatsapp.filter(u=>u.valor),u=>(r(),m(k,{clickable:"",key:u.valor,onClick:d=>y.dialogEnviar(u)},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"mdi-whatsapp"})]),_:1}),t(s,null,{default:a(()=>[l(f(u.valor),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})),[[w]])]),_:1})]),_:1}),o.visibilidade.botao.remover?(r(),m(_,{key:0,rounded:"",dense:"",flat:"",icon:"clear",color:"tertiary",class:"no-shadow q-mx-xs",size:"md",onClick:e[14]||(e[14]=u=>y.remover({documento:o.documento})),style:{float:"right"}})):b("",!0),o.visibilidade.botao.editar?(r(),m(_,{key:1,rounded:"",dense:"",flat:"",icon:"edit",color:"primary",class:"no-shadow q-mx-xs",size:"md",onClick:e[15]||(e[15]=u=>y.mostrar({documento:o.documento})),style:{float:"right"}})):b("",!0),o.visibilidade.botao.visualizar?(r(),m(_,{key:2,rounded:"",dense:"",flat:"",icon:"remove_red_eye",color:"primary",class:"no-shadow q-mx-xs",size:"md",onClick:e[16]||(e[16]=u=>y.mostrar({documento:o.documento})),style:{float:"right"}})):b("",!0),t(_,{rounded:"",dense:"",flat:"",icon:"print",color:"primary",class:"no-shadow q-mx-xs",size:"md",style:{float:"right"}},{default:a(()=>[t(H,null,{default:a(()=>[t(O,{link:"",separator:""},{default:a(()=>[(r(!0),g(C,null,E(o.configImpressaoOrcamento.filter(u=>u.valor),u=>(r(),m(k,{clickable:"",key:u.valor,onClick:d=>i.$imprimir(u.valor,{id:o.documento.id,Oculto:"0"})},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"print"})]),_:1}),t(s,null,{default:a(()=>[t(x,null,{default:a(()=>[l(f(u.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),o.sistemaPai==="optisoul"?(r(!0),g(C,{key:0},E(o.configImpressaoEnvelope,u=>(r(),m(k,{clickable:"",key:u.valor,onClick:d=>i.$imprimir(u.valor,o.documento.id)},{default:a(()=>[t(s,{avatar:""},{default:a(()=>[t(v,{name:"print"})]),_:1}),t(s,null,{default:a(()=>[t(x,null,{default:a(()=>[l(f(u.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):b("",!0)]),_:1})]),_:1})]),_:1}),t(_,{rounded:"",dense:"",flat:"",icon:o.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down",size:"md",class:"no-shadow q-mx-xs",color:"tertiary",style:{float:"right"},onClick:y.alternarDetalhes},null,8,["icon","onClick"])])]),_:1}),o.detalhesVisivel?(r(),m(N,{key:0,class:"hideondesktop q-my-sm"})):b("",!0),o.detalhesVisivel?(r(),m(z,{key:1,class:"items-start q-mx-none q-px-none q-mt-md"},{default:a(()=>[c("div",he,[c("p",ge,[t(v,{name:"business"}),l(" "+f(o.documento.descricaoEmpresa),1)]),c("div",Ce,[o.fatura.id?(r(),g("div",_e,[e[36]||(e[36]=l(" Fatura ")),t(A,{color:"positive",escuro:"",onClick:y.copiarUid},{default:a(()=>[l(" #"+f(parseInt(o.fatura.numero)||(o.fatura.id||"").slice(-6))+" ",1),t(v,{class:"q-ml-sm",name:"mdi-glasses"}),h(c("input",{type:"hidden","onUpdate:modelValue":e[17]||(e[17]=u=>o.fatura.id=u),ref:"uid"},null,512),[[P,o.fatura.id]])]),_:1},8,["onClick"]),t(A,{class:"q-ml-sm",rounded:"",color:"tertiary",small:""},{default:a(()=>[l(f(o.fatura.status),1)]),_:1})])):b("",!0),c("div",null,f(o.documento.observacao),1),c("div",null,f(o.documento.observacaoInterna),1),c("div",null,f(o.documento.motivoCancelamento),1),c("div",null,f(o.documento.observacaoCancelamento),1)]),t(S,{idVenda:o.documento.id},null,8,["idVenda"])]),c("div",we,[e[37]||(e[37]=c("p",{class:"text-subtitle1 text-weight-bold q-ma-none"}," Faturamento ",-1)),c("div",xe,f(o.documento.observacaoFaturamento),1)]),c("div",qe,[e[38]||(e[38]=c("p",{class:"text-subtitle1 text-weight-bold q-ma-none"}," Desconto ",-1)),c("p",Ee,f(i.$filters.numero(o.documento.totalDesconto,2)),1)])]),_:1})):b("",!0),t(R,{ref:"modalEnvelope"},null,512),t(M,{ref:"modalHistoricoStatus"},null,512)]),_:1})):b("",!0)}var Ne=Q(K,[["render",Fe]]);export{Ne as E};
