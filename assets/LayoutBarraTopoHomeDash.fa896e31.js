import{_ as j,c3 as I,c4 as M,c5 as z,aE as l,c6 as P,c7 as L,c8 as H,c9 as V,aF as D,aG as J,ca as G,bq as Z,p as _,o as u,d as v,f as a,w as e,B as T,D as q,x as E,l as k,bm as $,az as O,C as g,i as p,N as C,P as c,R as t,j as d,e as n,L as y,S as h,t as f,k as A,F as R,r as K,a4 as W,E as X,A as N,b0 as U,G as Y}from"./index.e0611938.js";import{P as aa}from"./Plataforma15.0d9dd1ba.js";import{_ as ea}from"./b15-white.58ad6516.js";import{_ as ta}from"./optidados-white.e4237b1d.js";const oa={components:{UsuarioAlterarSenha:I,VendaModal:M,PromptBuscaOnline:z},computed:{config(){return l.configuracoes.valores},statusBanco(){return o=>{const r="";return!r||r==="100"?"":`${this.$filters.numero(r,2)}%`}}},data(){return{dbContato:l.contato,dbUsuario:l.usuario,sistemaPai:"",clienteSistema:{sistema:""},clienteSistemaBaixados:[],bancos:[],campos:{},dialogAlterarSenha:!1,permissoes:{},sincronismoStatus:P.status}},methods:{abrirValidCertificadora(){window.open("https://api.whatsapp.com/send?phone=5516988096765&text=Ol%20sou%20cliente%20B-15%20e%20quero%20adquirir%20ou%20renovar%20meu%20certificado%20digital","_blank")},abrirEntidadeOnline(o){let r="AtendimentoContato";~this.$route.name.indexOf("Atendimento")&&(r=this.$route.name),this.$router.push({name:r,params:{id:o.id}})},abrirPromptBuscaOnline(){this.$refs.promptBuscaOnline.mostrar()},adicionarContato(){$utils.emitter.emit("adicionarContato")},adicionarOrcamento(){this.$refs.vendaModal.mostrar()},irParaAtendimento(){const o=localStorage.getItem("contatoSelecionado");this.$router.push({name:"Atendimento",params:{id:o||"0"}})},abrirZap(){this.sistemaPai==="optisoul"&&window.open("https://api.whatsapp.com/send?phone=5519986085252&text=Preciso%20de%20uma%20ajuda","_blank"),this.sistemaPai!=="optisoul"&&window.open("https://api.whatsapp.com/send?phone=551621116161&text=Preciso%20de%20uma%20ajuda","_blank")},async sincronizar(){L.log("BarraTopo","sincronizar()"),P.descarregarErp(),P.descarregarPlataforma()},onClickAlterarSenha(){this.dialogAlterarSenha=!0},alternarMenu(){$db.app.menuVisivel.value=!$db.app.menuVisivel.value},desconectar(){l.usuario.desconecta(),window.location.reload()},imprimir:H,async mostrarTabelas(){let o=await V.getDatabaseNames();o.splice(o.indexOf("plataforma"),1);const r={};for(const m of o){const x=(await D(m).tables).sort((s,i)=>s.name.localeCompare(i.name));for(const s of x){const i=await s.count();r.hasOwnProperty(s.name)||(r[s.name]={}),r[s.name][m]=i}}return console.table(r),r},async restaurar(){if(await J.sincronismoFila.count()>0){this.$q.notifyError("N\xE3o pode restaurar! H\xE1 dados no dispositivo que n\xE3o foram sincronizados.");return}for(const o of this.bancos)if(await D(o.bancoDeDados).sincronismoFila.count()>0){this.$q.notifyError(`N\xE3o pode restaurar! H\xE1 dados do banco '${o.bancoDeDados}' no dispositivo que n\xE3o foram sincronizados.`);return}try{await new Promise((o,r)=>{this.$q.dialog({title:"Tem certeza?",message:"Esta opera\xE7\xE3o vai apagar todos os dados de seu dispositivo! Para confirmar digite a palavra 'RESTAURAR'.",prompt:{model:"",isValid:m=>m.toUpperCase()==="RESTAURAR",type:"text",class:"bg-light"},cancel:{label:"CANCELAR",push:!0,color:"tertiary",flat:!0},ok:{label:"RESTAURAR",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(m=>{o()}).onCancel(()=>{r()})})}catch{return}this.$q.loading.show({message:"Restaurando"});try{const o=await V.getDatabaseNames();for(const m of o)await D(m,"delete");const r=localStorage.getItem("dispositivoCliente");localStorage.clear(),r&&localStorage.setItem("dispositivoCliente",r),window.location.reload()}catch(o){this.$q.notifyError("Erro na opera\xE7\xE3o de restaurar",o)}finally{this.$q.loading.hide()}},async selecionaBancoDados(o){this.clienteSistema=o||{},l.cache.set("reload","1"),l.cache.set("bancoDeDados",o.bancoDeDados||""),l.cache.setJson("clienteSistema",o),this.$router.push({name:"Home"})}},props:{restricao:Boolean},async mounted(){this.clienteSistemaBaixados=JSON.parse(localStorage.getItem("clienteSistemaBaixados")),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema"))||{},this.bancos=await G.sincronismo.le(),this.sistemaPai=Z(),this.permissoes={atendimento:await l.permissao.objeto("atendimento"),admCustom:await l.permissao.objeto("admcustom"),admEnvelopes:await l.permissao.objeto("admenvelopes"),admOS:await l.permissao.objeto("admos"),funilVendas:await l.permissao.objeto("crmfunil"),item:await l.permissao.objeto("item"),importarReceita:await l.permissao.objeto("importarReceita"),caixa:await l.permissao.objeto("caixa"),cockpit:await l.permissao.objeto("cockpit"),nfe:await l.permissao.objeto("nfe")}}},sa={class:"BarraTopo"},na={style:{height:"30px"}},ra=E("img",{src:ea,alt:"B15",style:{height:"30px"},class:"q-mr-md"},null,-1),ia={key:0,src:ta,alt:"Optidados",style:{height:"30px"},class:"q-mr-md"},la={class:"q-pa-none q-my-none items-center justify-center full-height column"};function ca(o,r,m,x,s,i){const w=_("avatar"),S=_("row"),B=_("usuario-alterar-senha"),Q=_("PromptBuscaOnline"),F=_("VendaModal");return u(),v("div",sa,[a(N,{unelevated:""},{default:e(()=>[a(T,{class:"bg-gradiente text-primary q-px-sm"},{default:e(()=>[a(q,{onClick:i.alternarMenu,icon:"menu",flat:"",round:"",dense:"",color:"white",class:"q-mr-sm"},null,8,["onClick"]),E("div",na,[ra,s.sistemaPai==="optisoul"?(u(),v("img",ia)):k("",!0)]),a($),a(q,{onClick:i.abrirPromptBuscaOnline,icon:"search",flat:"",round:"",dense:"",color:"white"},null,8,["onClick"]),a(q,{icon:"add",flat:"",dense:"",color:"white"},{default:e(()=>[a(O,null,{default:e(()=>[g((u(),p(C,{link:"","no-border":"",separator:""},{default:e(()=>[a(c,{onClick:i.adicionarContato,clickable:""},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"person",size:"sm"})]),_:1}),a(t,null,{default:e(()=>[n("Contato")]),_:1})]),_:1},8,["onClick"]),a(c,{onClick:i.adicionarOrcamento,clickable:""},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"add_shopping_cart",size:"sm"})]),_:1}),a(t,null,{default:e(()=>[n("Or\xE7amento/Venda")]),_:1})]),_:1},8,["onClick"])]),_:1})),[[y]])]),_:1})]),_:1})]),_:1}),a(T,{class:"bg-gradiente text-white q-py-sm"},{default:e(()=>[a(S,{class:"items-center q-mx-none q-px-none q-py-xs"},{default:e(()=>[E("div",la,[a(w,{imagem:s.dbUsuario.logado.img,rotulo:s.dbUsuario.logado.nome,tamanho:"40",onClick:i.sincronizar},null,8,["imagem","rotulo","onClick"]),a(O,{class:"BarraTopo-usuarioPopover q-py-sm"},{default:e(()=>[a(C,{"no-border":""},{default:e(()=>[a(c,null,{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(w,{imagem:s.dbUsuario.logado.img,rotulo:s.dbUsuario.logado.nome,tamanho:"38"},null,8,["imagem","rotulo"])]),_:1}),a(t,{class:"q-pl-sm"},{default:e(()=>[a(h,null,{default:e(()=>[n(f(s.dbUsuario.logado.nome),1)]),_:1}),a(h,{caption:""},{default:e(()=>[n(f(s.dbUsuario.logado.cpf),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(C,{class:"q-ma-md bordered",dense:""},{default:e(()=>[a(c,{dense:"",class:"text-tertiary",clickable:""},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"storage"})]),_:1}),a(t,null,{default:e(()=>[a(h,null,{default:e(()=>[n(f(s.clienteSistema.bancoDeDados),1)]),_:1}),a(h,{caption:"",class:"text-caption"},{default:e(()=>[n(f(s.clienteSistema.sistema),1)]),_:1})]),_:1}),a(t,{side:""},{default:e(()=>[n(f(i.statusBanco(s.clienteSistema.bancoDeDados)),1)]),_:1}),a(A,null,{default:e(()=>[n("Base")]),_:1}),a(O,null,{default:e(()=>[a(C,{link:""},{default:e(()=>[(u(!0),v(R,null,K(s.clienteSistemaBaixados,b=>(u(),v(R,{key:b.idClienteSistema},[g((u(),p(c,{clickable:"",class:"text-tertiary q-py-xs",onClick:fa=>i.selecionaBancoDados(b),dense:""},{default:e(()=>[a(t,null,{default:e(()=>[a(h,null,{default:e(()=>[n(f(b.bancoDeDados),1)]),_:2},1024),a(h,{caption:"",class:"text-caption"},{default:e(()=>[n(f(b.sistema),1)]),_:2},1024)]),_:2},1024),a(t,{side:""},{default:e(()=>[n(f(i.statusBanco(b.bancoDeDados)),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[y]]),a(W)],64))),128)),g((u(),p(c,{to:{name:"AutenticacaoBancos",params:{operacao:"selecionar"}},class:"text-tertiary",clickable:"",dense:""},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"settings"})]),_:1}),a(t,null,{default:e(()=>[a(h,null,{default:e(()=>[n("Selecionar bases")]),_:1})]),_:1})]),_:1})),[[y]])]),_:1})]),_:1})]),_:1}),a(c,{onClick:i.mostrarTabelas,dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"data_usage"})]),_:1}),a(t,null,{default:e(()=>[n("0 gb")]),_:1}),a(A,null,{default:e(()=>[n("Espa\xE7o")]),_:1})]),_:1},8,["onClick"]),a(c,{to:{name:"PainelSincronismo"},dense:"",class:"text-tertiary",clickable:""},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"swap_calls"})]),_:1}),a(t,null,{default:e(()=>[n(f("Fila enviar: "+String(s.sincronismoStatus.tamanhoFila)),1)]),_:1}),a(A,null,{default:e(()=>[n("Fila de sincrinismo para enviar")]),_:1})]),_:1})]),_:1}),g((u(),p(C,null,{default:e(()=>[a(c,{onClick:i.abrirZap,clickable:"",dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"contact_support"})]),_:1}),a(t,null,{default:e(()=>[n("Ajuda")]),_:1})]),_:1},8,["onClick"]),a(c,{onClick:i.abrirValidCertificadora,clickable:"",dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"add_moderator"})]),_:1}),a(t,null,{default:e(()=>[n("Certificado Digital")]),_:1})]),_:1},8,["onClick"]),m.restricao?k("",!0):(u(),p(c,{key:0,to:{name:"Configuracoes"},clickable:"",dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"settings"})]),_:1}),a(t,null,{default:e(()=>[n("Configura\xE7\xF5es")]),_:1})]),_:1})),a(c,{onClick:i.restaurar,clickable:"",dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"warning"})]),_:1}),a(t,null,{default:e(()=>[n("Restaurar e sair")]),_:1})]),_:1},8,["onClick"]),a(c,{onClick:i.onClickAlterarSenha,clickable:"",dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"mdi-lock-open-outline"})]),_:1}),a(t,null,{default:e(()=>[n("Alterar senha")]),_:1})]),_:1},8,["onClick"]),!!s.dbUsuario.logado.administrador&&[1,2].includes(s.dbUsuario.logado.grupoInterno)?(u(),p(c,{key:1,to:{name:"CriarBanco"},clickable:"",dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"mdi-database-plus"})]),_:1}),a(t,null,{default:e(()=>[n("Criar banco")]),_:1})]),_:1})):k("",!0),s.sistemaPai==="b15"?(u(),p(c,{key:2,to:{name:"FaturaB15"},clickable:"",dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"attach_money"})]),_:1}),a(t,null,{default:e(()=>[n("Fatura B-15")]),_:1})]),_:1})):k("",!0),s.sistemaPai==="optisoul"?(u(),p(c,{key:3,to:{name:"FaturaB15Optidados"},clickable:"",dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"attach_money"})]),_:1}),a(t,null,{default:e(()=>[n("Fatura B-15 Optidados")]),_:1})]),_:1})):k("",!0),a(c,{onClick:i.desconectar,clickable:"",dense:"",class:"text-tertiary"},{default:e(()=>[a(t,{avatar:""},{default:e(()=>[a(d,{name:"exit_to_app"})]),_:1}),a(t,null,{default:e(()=>[n("Sair")]),_:1})]),_:1},8,["onClick"])]),_:1})),[[y]])]),_:1})]),a(X,null,{default:e(()=>[n(f(s.dbUsuario.logado.nome),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(B,{modelValue:s.dialogAlterarSenha,"onUpdate:modelValue":r[0]||(r[0]=b=>s.dialogAlterarSenha=b)},null,8,["modelValue"]),a(Q,{ref:"promptBuscaOnline",onSelecionar:i.abrirEntidadeOnline},null,8,["onSelecionar"]),a(F,{ref:"vendaModal"},null,512)])}var da=j(oa,[["render",ca]]);const ua={components:{Plataforma15:aa,BarraTopo:da},data(){return{rota:"",start:!1}},methods:{async menu_click(o){this.$refs.Plataforma15.menu_click(o)}},mounted(){this.$route.name==="Plataforma15"&&!this.$route.redirectedFrom&&this.$refs.Plataforma15.menu_click(JSON.parse(JSON.stringify(this.$route.params)))}};function ma(o,r,m,x,s,i){const w=_("barra-topo"),S=_("Plataforma15"),B=_("router-view");return u(),v(R,null,[a(N,null,{default:e(()=>[a(w,{onMenuClick:i.menu_click},null,8,["onMenuClick"])]),_:1}),a(Y,null,{default:e(()=>[g(a(S,{ref:"Plataforma15"},null,512),[[U,o.$route.name==="Plataforma15"]]),g(a(B,null,null,512),[[U,o.$route.name!=="Plataforma15"]])]),_:1})],64)}var ga=j(ua,[["render",ma]]);export{ga as default};
