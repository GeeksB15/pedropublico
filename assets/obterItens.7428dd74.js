import{bB as n,bE as R,bL as L,aC as _,bz as oo,bj as g,bK as h,aD as x,bO as E,bM as J,bF as ao}from"./index.129a5639.js";import{c as O}from"./compactarValidarNFe.c3faa32e.js";import{c as to}from"./codigosANP.a6c1a264.js";var lo={calculaTotais(o,a,e,s=!0){var c,u,t,S,p,l,m,C,f,v,I,T,P,F,b,D;this.metadados=e;const i={vBC:0,vBCST:0,vICMS:0,vICMSDeson:0,vFCPUFDest:null,vICMSUFDest:null,vICMSUFRemet:null,vFCP:0,vST:0,vICMSST:null,vICMSSTRet:null,vFCPST:0,vFCPSTRet:0,vProd:0,vFrete:0,vSeg:0,vDesc:0,vII:0,vIPI:0,vIPIDevol:0,vPIS:0,vCOFINS:0,vOutro:0,vNF:0,noXml_vTribFed:0,noXml_vTribEst:0,noXml_vTribMun:0,vTotTrib:0};for(const N in o.det){const r=o.det[N],d=r.imposto.escolhas.valor_escolha,U=r.imposto.escolhas[d].ICMS.escolhas.valor_escolha,B=r.imposto.escolhas[d].ICMS.escolhas[U];if(this.calculaVCredICMSSN(B,r),s&&(this.distribuiDadosICMS(r,o),this.distribuiDadosPIS(r),this.distribuiDadosCOFINS(r),this.distribuiDadosIPI(r)),a.automatico.dados_trib&&(r.prod.qTrib=r.prod.qCom,r.prod.uTrib=r.prod.uCom,r.prod.vUnTrib=r.prod.vUnCom,r.prod.cEANTrib=r.prod.cEAN),a.automatico.totais){const A=n(r.prod.qCom,4),Y=n(r.prod.vUnCom,4),Q=n(r.prod.qTrib,4),y=n(r.prod.vUnTrib,4),W=n(A*Y,2),H=n(r.prod.vFrete,2),w=n(r.prod.vSeg,2),G=n(r.prod.vOutro,2),$=n(r.prod.vDesc,2),K=a.automatico.incluiDespesasNaBC===!1?0:G,q=n(Q*y+w+K-$,2);if(r.prod.vProd=n(W,2),r.prod.indTot==="1"&&(i.vProd+=W),i.vIPIDevol+=((u=(c=r.impostoDevol)==null?void 0:c.IPI)==null?void 0:u.vIPIDevol)||0,i.vFrete+=H,i.vSeg+=w,i.vOutro+=G,i.vDesc+=$,this.calculaICMS_ISSQN_IPI_II(r,o,a,i,q,A),this.calculaPIS_COFINS("PIS",r,a,i,q,A,o),this.calculaPIS_COFINS("COFINS",r,a,i,q,A,o),this.calculaIBPT(r,a,i),(S=(t=r.imposto)==null?void 0:t.ICMSUFDest)!=null&&S.visivel){const Z=(m=(l=(p=r.impostoDevol)==null?void 0:p.IPI)==null?void 0:l.vIPIDevol)!=null?m:0,j=(C=r.imposto.noXml_vIPI)!=null?C:0,V=n(Q*y+w+H+K-$+Z+j,2),z=r.imposto.ICMSUFDest.pICMSUFDest,k=r.imposto.ICMSUFDest.pICMSInter;r.imposto.ICMSUFDest.vBCUFDest=V,z&&k&&z>k&&(r.imposto.ICMSUFDest.vICMSUFDest=n(V*((z-k)/100),2))}}this.resumeDadosICMS(r),(v=(f=r.imposto)==null?void 0:f.ICMSUFDest)!=null&&v.visivel&&(i.vICMSUFDest||(i.vICMSUFDest=0),i.vFCPUFDest||(i.vFCPUFDest=0),i.vICMSUFDest+=(P=(T=(I=r.imposto)==null?void 0:I.ICMSUFDest)==null?void 0:T.vICMSUFDest)!=null?P:0,i.vFCPUFDest+=(D=(b=(F=r.imposto)==null?void 0:F.ICMSUFDest)==null?void 0:b.vFCPUFDest)!=null?D:0)}if(a.automatico.totais){const N=o.total.ICMSTot;if(a.calculaTotais){i.vST=i.vICMSST+i.vST,i.vNF=i.vProd+i.vFrete+i.vSeg+i.vOutro+i.vST+i.vFCPST+i.vIPI+i.vIPIDevol-i.vDesc;for(const r in i)i[r]!=null&&(N[r]=n(i[r],2))}if(o.pag.detPag.length){if(o.pag.detPag.length===1){const r=o.pag.detPag[0];r.tPag==="90"?r.vPag=0:r.vPag=n(i.vNF)}}else{const r=O.executa(R.infNFe.pag.detPag.lista,{});r.tPag="99",r.xPag="",r.vPag=n(i.vNF),o.pag.detPag.push(r)}}},calculaIBPT(o,a,e){const s=Number(o.prod.vProd)-Number(o.prod.vDesc);o.imposto.noXml_vTribFed=["1","6","7"].includes(o.imposto.noXml_orig)?n(Number(o.imposto.noXml_pTribImp)*s/100):n(Number(o.imposto.noXml_pTribFed)*s/100),e.noXml_vTribFed=n(e.noXml_vTribFed+o.imposto.noXml_vTribFed,2),o.imposto.noXml_vTribEst=n(Number(o.imposto.noXml_pTribEst)*s/100),e.noXml_vTribEst=n(e.noXml_vTribEst+o.imposto.noXml_vTribEst),o.imposto.noXml_vTribMun=n(Number(o.imposto.noXml_pTribMun)*s/100),e.noXml_vTribMun=n(e.noXml_vTribMun+o.imposto.noXml_vTribMun),o.imposto.vTotTrib=n(o.imposto.noXml_vTribFed+o.imposto.noXml_vTribEst+o.imposto.noXml_vTribMun),e.vTotTrib=n(e.vTotTrib+o.imposto.vTotTrib)},distribuiDadosICMS(o,a){const e=o.imposto.noXml_CSOSN||"",s=o.imposto.noXml_CST||"",i=o.imposto.escolhas.opcao1.ICMS.escolhas;if(e||s){o.imposto.escolhas.valor_escolha="opcao1";const u=this.metadados.infNFe.det.lista.imposto.escolhas.opcao1.ICMS.escolhas;for(const t in i)t==="valor_escolha"||t==="ICMSPart"||t==="ICMSST"||t.endsWith("_erro")||(a.emit.CRT==="3"?"CST"in i[t]&&u[t].CST._enumeration.find(l=>l.valor===s)&&(i.valor_escolha=t,i[t].CST=s):"CSOSN"in i[t]&&u[t].CSOSN._enumeration.find(l=>l.valor===e)&&(i.valor_escolha=t,i[t].CSOSN=e))}const c=i[i.valor_escolha];c&&o.imposto.escolhas.valor_escolha==="opcao1"&&(o.imposto.noXml_orig&&this.atualizaCampoRecursivo(c,"orig",o.imposto.noXml_orig),o.imposto.noXml_pICMS&&!["201","202"].includes(e)&&(this.atualizaCampoRecursivo(c,"pICMS",o.imposto.noXml_pICMS),o.imposto.noXml_pICMS=0),o.imposto.noXml_pRedBC&&(this.atualizaCampoRecursivo(c,"pRedBC",o.imposto.noXml_pRedBC),o.imposto.noXml_pRedBC=0),o.imposto.noXml_pFCP&&!["201","202"].includes(e)&&(this.atualizaCampoRecursivo(c,"pFCP",o.imposto.noXml_pFCP),o.imposto.noXml_pFCP=0))},resumeDadosICMS(o){const a=o.imposto.escolhas;if(a.valor_escolha==="opcao1"||!a.valor_escolha){a.valor_escolha="opcao1";const e=a.opcao1.ICMS.escolhas,s=e.valor_escolha,i=e[s];i&&("CST"in i?o.imposto.noXml_CST=i.CST:"CSOSN"in i&&(o.imposto.noXml_CSOSN=i.CSOSN),o.imposto.noXml_orig=this.buscaRecursivo(i,"orig"))}},distribuiDadosPIS(o){const a=o.imposto.noXml_CSTPis||"";if(a){const e=this.metadados.infNFe.det.lista.imposto.PIS.escolhas,s=o.imposto.PIS.escolhas;for(const c in s)c==="valor_escolha"||c.endsWith("_erro")||"CST"in s[c]&&e[c].CST._enumeration.find(S=>S.valor===a)&&(s.valor_escolha=c,s[c].CST=a);const i=s[s.valor_escolha];!!i&&!!o.imposto.noXml_pPIS&&this.atualizaCampoRecursivo(i,"pPIS",o.imposto.noXml_pPIS)}},distribuiDadosCOFINS(o){const a=o.imposto.noXml_CSTCofins||"";if(a){const e=this.metadados.infNFe.det.lista.imposto.COFINS.escolhas,s=o.imposto.COFINS.escolhas;for(const c in s)c==="valor_escolha"||c.endsWith("_erro")||"CST"in s[c]&&e[c].CST._enumeration.find(S=>S.valor===a)&&(s.valor_escolha=c,s[c].CST=a);const i=s[s.valor_escolha];!!i&&!!o.imposto.noXml_pCOFINS&&this.atualizaCampoRecursivo(i,"pCOFINS",o.imposto.noXml_pCOFINS)}},distribuiDadosIPI(o){const a=o.imposto.noXml_CSTIpi||"";if(a){o.imposto.escolhas.valor_escolha="opcao1";const e=o.imposto.escolhas.opcao1.IPI;e.visivel=!0,e.cEnq=o.imposto.noXml_cEnqIpi,this.metadados.infNFe.det.lista.imposto.escolhas.opcao1.IPI.escolhas.IPITrib.CST._enumeration.find(c=>c.valor===a)?(e.escolhas.valor_escolha="IPITrib",e.escolhas.IPITrib.CST=a,e.escolhas.IPITrib.escolhas.valor_escolha="opcao1",e.escolhas.IPITrib.escolhas.opcao1.pIPI=e.escolhas.IPITrib.escolhas.opcao1.pIPI||o.imposto.noXml_pIPI||0):(e.escolhas.valor_escolha="IPINT",e.escolhas.IPINT.CST=a)}},calculaPIS_COFINS(o,a,e,s,i,c,u){let t=null;switch(a.imposto[o].escolhas.valor_escolha){case o+"Aliq":t=a.imposto[o].escolhas[o+"Aliq"],this.calculaImpostoPercentagem(o,t,"vBC","p"+o,t,"v"+o,s,e,i,a,u);break;case o+"Qtde":t=a.imposto[o].escolhas[o+"Qtde"],this.calculaImpostoQuantidade(o,t,"qBCProd","vAliqProd",t,"v"+o,s,e,c);break;case o+"NT":break;case o+"Outr":t=a.imposto[o].escolhas[o+"Outr"],t.escolhas.valor_escolha==="opcao1"?this.calculaImpostoPercentagem(o,t.escolhas.opcao1,"vBC","p"+o,t,"v"+o,s,e,i,a,u):t.escolhas.valor_escolha==="opcao2"&&this.calculaImpostoQuantidade(o,t.escolhas.opcao2,"qBCProd","vAliqProd",t,"v"+o,s,e,c);break}a.imposto[o+"ST"].visivel&&(t=a.imposto[o+"ST"],t.escolhas.valor_escolha==="opcao1"?this.calculaImpostoPercentagem(o,t.escolhas.opcao1,"vBC","p"+o,t,"v"+o,s,e,i):t.escolhas.valor_escolha==="opcao2"&&this.calculaImpostoQuantidade(o,t.escolhas.opcao2,"qBCProd","vAliqProd",t,"v"+o,s,e,c))},calculaICMS_ISSQN_IPI_II(o,a,e,s,i,c){switch(o.imposto.escolhas.valor_escolha){case"opcao1":this.calculaIPI(o.imposto.escolhas.opcao1.IPI,e,s,i,c,o,a),this.calculaICMS(o,a,e,s,i),this.calculaII(o.imposto.escolhas.opcao1.II,e,s,i);break;case"opcao2":this.calculaISSQN(o.imposto.escolhas.opcao2.ISSQN,e,s,i),this.calculaIPI(o.imposto.escolhas.opcao2.IPI,e,s,i,c,o,a);break}},calculaIPI(o,a,e,s,i,c,u){let t=null;if(o.visivel)switch(o.escolhas.valor_escolha){case"IPITrib":t=o.escolhas.IPITrib,t.escolhas.valor_escolha==="opcao1"?this.calculaImpostoPercentagem("IPI",t.escolhas.opcao1,"vBC","pIPI",t,"vIPI",e,a,s,c,u):t.escolhas.valor_escolha==="opcao2"&&this.calculaImpostoQuantidade("IPI",t.escolhas.opcao2,"qUnid","vUnid",t,"vIPI",e,a,i);break;case"IPINT":t=o.escolhas.IPINT;break}},calculaII(o,a,e,s){o.visivel&&(e.vII+=Number(o.vII))},calculaISSQN(o,a,e,s){this.calculaImpostoPercentagem("ISSQN",o,"vBC","vAliq",o,"vISSQN",e,a,s)},calculaICMS(o,a,e,s,i){const c=o.imposto.escolhas.opcao1.ICMS,u=o.imposto;let t=null;switch(c.escolhas.valor_escolha){case"ICMS00":t=c.escolhas.ICMS00,e.automatico.calculaBC&&(t.modBC="3"),this.calculaImpostoPercentagem("ICMS",t,"vBC","pICMS",t,"vICMS",s,e,i,o,a),t.opcional.visivel&&this.calculaImpostoPercentagem("FCP",t.opcional,"vBCFCP","pFCP",t.opcional,"vFCP",s,e,i,o,a);break;case"ICMS10":t=c.escolhas.ICMS10,e.automatico.calculaBC&&(t.modBC="3"),this.calculaImpostoPercentagem("ICMS",t,"vBC","pICMS",t,"vICMS",s,e,i,o,a),t.opcional.visivel&&this.calculaImpostoPercentagem("FCP",t.opcional,"vBCFCP","pFCP",t.opcional,"vFCP",s,e,i,o,a),t.opcional2.visivel&&this.calculaImpostoFCPST("FCPST",t.opcional2,"vBCFCPST","pFCPST",t.opcional2,"vFCPST",s,e,Number(t.vBCST)||0,Number(t.opcional.vFCP)||0,o),this.calculaImpostoST("ICMSST",t,"vBCST","pICMSST","pMVAST","vICMS",t,"vICMSST",s,e,i,o,a);break;case"ICMS20":t=c.escolhas.ICMS20,this.calculaImpostoPercentagemComReducaoBc("ICMS","vBC","pICMS","pRedBC","vICMS",t,s,e,i,o,a),t.opcional.visivel&&this.calculaImpostoPercentagem("FCP",t.opcional,"vBCFCP","pFCP",t.opcional,"vFCP",s,e,i,o,a);break;case"ICMS30":t=c.escolhas.ICMS30,t.opcional.visivel&&this.calculaImpostoFCPST("FCPST",t.opcional,"vBCFCPST","pFCPST",t.opcional,"vFCPST",s,e,Number(t.vBCST)||0,Number(t.opcional.vFCP)||0,o),this.calculaImpostoST("ICMSST",t,"vBCST","pICMSST","pMVAST","vICMS",t,"vICMSST",s,e,i,o,a);break;case"ICMS40":t=c.escolhas.ICMS40;break;case"ICMS51":t=c.escolhas.ICMS51,this.calculaImpostoPercentagemComReducaoBc("ICMS","vBC","pICMS","pRedBC","vICMS",t,s,e,i,o,a),t.opcional.visivel&&this.calculaImpostoPercentagem("FCP",t.opcional,"vBCFCP","pFCP",t.opcional,"vFCP",s,e,i,o,a);break;case"ICMS60":t=c.escolhas.ICMS60,t.opcional.visivel&&this.calculaImpostoPercentagem("ICMSSTRet",t.opcional,"vBCSTRet","pST",t.opcional,"vICMSSTRet",s,e,i,o,a),t.opcional2.visivel&&this.calculaImpostoPercentagem("FCPSTRet",t.opcional2,"vBCFCPSTRet","pFCPSTRet",t.opcional2,"vFCPSTRet",s,e,i,o,a);break;case"ICMS70":t=c.escolhas.ICMS70,this.calculaImpostoPercentagemComReducaoBc("ICMS","vBC","pICMS","pRedBC","vICMS",t,s,e,i,o,a),t.opcional.visivel&&this.calculaImpostoPercentagem("FCP",t.opcional,"vBCFCP","pFCP",t.opcional,"vFCP",s,e,i,o,a),t.opcional2.visivel&&this.calculaImpostoFCPST("FCPST",t.opcional2,"vBCFCPST","pFCPST",t.opcional2,"vFCPST",s,e,Number(t.vBCST)||0,Number(t.opcional.vFCP)||0,o),this.calculaImpostoST("ICMSST",t,"vBCST","pICMSST","pMVAST","vICMS",t,"vICMSST",s,e,i,o,a);break;case"ICMS90":t=c.escolhas.ICMS90;let S=0;t.opcional.visivel&&(this.calculaImpostoPercentagemComReducaoBc("ICMS","vBC","pICMS","pRedBC","vICMS",t.opcional,s,e,i,o,a),t.opcional.opcional.visivel&&(this.calculaImpostoPercentagem("FCP",t.opcional.opcional,"vBCFCP","pFCP",t.opcional.opcional,"vFCP",s,e,i,o,a),S=Number(t.opcional.opcional.vFCP)||0)),t.opcional2.visivel&&(t.opcional2.vICMS=t.opcional.vICMS,t.opcional2.opcional.visivel&&this.calculaImpostoFCPST("FCPST",t.opcional2.opcional,"vBCFCPST","pFCPST",t.opcional2.opcional,"vFCPST",s,e,Number(t.opcional2.vBCST)||0,S,o),this.calculaImpostoST("ICMSST",t.opcional2,"vBCST","pICMSST","pMVAST","vICMS",t.opcional2,"vICMSST",s,e,i,o,a));break;case"ICMSPart":t=c.escolhas.ICMSPart;break;case"ICMSST":t=c.escolhas.ICMSST;break;case"ICMSSN101":t=c.escolhas.ICMSSN101,this.calculaImpostoST_CSOSN_101_102(t,u,s,o,a,e,i);break;case"ICMSSN102":t=c.escolhas.ICMSSN102;break;case"ICMSSN201":t=c.escolhas.ICMSSN201,this.calculaImpostoST_CSOSN_201_202(t,u,s,o,a,e,i);break;case"ICMSSN202":t=c.escolhas.ICMSSN202,this.calculaImpostoST_CSOSN_201_202(t,u,s,o,a,e,i);break;case"ICMSSN500":t=c.escolhas.ICMSSN500,t.opcional.visivel&&this.calculaImpostoPercentagem("ICMSSTRet",t.opcional,"vBCSTRet","pST",t.opcional,"vICMSSTRet",s,e,i,o,a),t.opcional2.visivel&&this.calculaImpostoPercentagem("FCPSTRet",t.opcional2,"vBCFCPSTRet","pFCPSTRet",t.opcional2,"vFCPSTRet",s,e,i,o,a);break;case"ICMSSN900":t=c.escolhas.ICMSSN900,t.opcional.visivel&&this.calculaImpostoPercentagemComReducaoBc("ICMS","vBC","pICMS","pRedBC","vICMS",t.opcional,s,e,i,o,a),t.opcional2.visivel&&(t.opcional2.vICMS=t.opcional.vICMS,t.opcional2.opcional.visivel&&this.calculaImpostoFCPST("FCPST",t.opcional2.opcional,"vBCFCPST","pFCPST",t.opcional2.opcional,"vFCPST",s,e,Number(t.opcional2.vBCST)||0,Number(t.opcional2.vFCP)||0,o),this.calculaImpostoST("ICMSST",t.opcional2,"vBCST","pICMSST","pMVAST","vICMS",t.opcional2,"vICMSST",s,e,i,o,a));break}},calculaImpostoPercentagem(o,a,e,s,i,c,u,t,S,p,l){if(e in a||console.error("totalEImpostos: Campo "+e+" n\xE3o consta em objetoImposto "),s in a||console.error("totalEImpostos: Campo "+s+" n\xE3o consta em objetoImposto "),c in i||console.error("totalEImpostos: Campo "+c+" n\xE3o consta em objetoImposto "),c in u||console.error("totalEImpostos: Campo "+c+" n\xE3o consta em total"),o==="ICMSSTRet"&&p.imposto.noXml_ICMSSTRet){i.pST=p.imposto.noXml_ICMSSTRet.pST,i.vBCSTRet=p.imposto.noXml_ICMSSTRet.vBCSTRet,i.vICMSSTRet=p.imposto.noXml_ICMSSTRet.vICMSSTRet,i.vICMSSubstituto=p.imposto.noXml_ICMSSTRet.vICMSSubstituto,p.infAdProd=`Base ICMS ST Ret: ${$filters.numero(i.vBCSTRet,2)} / `,p.infAdProd+=`Al\xEDquota ICMS ST Ret: ${$filters.numero(i.pST,2)} / `,p.infAdProd+=`Valor ICMS ST Ret: ${$filters.numero(i.vICMSSTRet,2)} / `,p.infAdProd+=`Valor ICMS Pr\xF3prio (Substituto): ${$filters.numero(i.vICMSSubstituto,2)}`;return}if(~["PIS","COFINS"].indexOf(o)&&(S-=p.imposto.noXml_vICMS),o==="ICMS"&&l.ide.indFinal==="1"&&(S+=p.imposto.noXml_vIPI),o==="ICMS"){const m=l.transp.modFrete==="0",C=p.prod.vFrete;S=S+(m?C:0)}if(S===0||!t.automatico.calculaBC?S=Number(a[e]):S=this.atualizaBC(a,e,t,S),t.calculaTotais){const m=this.atualizaAliquota(a,s,t),C=this.atualizaValorImposto(i,c,S*m/100);u[c]+=C,o==="IPI"&&(p.imposto.noXml_vIPI=C),(o==="ICMS"||o==="ICMSST")&&(e in u||console.error("totalEImpostos: Campo "+e+" n\xE3o consta em total"),u[e]+=S),o==="ICMS"&&(p.imposto.noXml_vICMS=C)}},calculaImpostoST(o,a,e,s,i,c,u,t,S,p,l,m,C){var T,P,F,b;e in a||console.error("totalEImpostos: Campo "+e+" n\xE3o consta em objetoImposto "),s in a||console.error("totalEImpostos: Campo "+s+" n\xE3o consta em objetoImposto "),i in a||console.error("totalEImpostos: Campo "+i+" n\xE3o consta em objetoImposto "),t in u||console.error("totalEImpostos: Campo "+t+" n\xE3o consta em objetoImposto "),t in S||console.error("totalEImpostos: Campo "+t+" n\xE3o consta em total");const f=Number(a[i])||0,v=Number(a[c])||0,I=Number(a[s])||0;if(l===0||!p.automatico.calculaBC)l=Number(a[e])||0;else{const D=C.transp.modFrete==="0",N=C.transp.modFrete==="1",r=m.prod.vFrete,d=C.ide.indFinal==="1";let U=0;Number((T=m==null?void 0:m.imposto)==null?void 0:T.noXml_orig)===1&&Number((P=m==null?void 0:m.imposto)==null?void 0:P.noXml_CST)===10&&(U=(b=(F=m==null?void 0:m.imposto)==null?void 0:F.noXml_vIPI)!=null?b:0);const B=n(l+U+(D||!d&&N?r:0))*(1+f/100);l=this.atualizaBC(a,e,p,B)}p.calculaTotais&&(u[t]=n(l*I/100-v,2),t==="vICMSST"&&(u[t]+=m.imposto.noXml_vFCPST||0),S[t]+=u[t],(o==="ICMS"||o==="ICMSST")&&(e in S||console.error("totalEImpostos: Campo "+e+" n\xE3o consta em total"),S[e]+=l))},calculaVCredICMSSN(o,a){const e=o!=null?o:{};"pCredSN"in e&&"vCredICMSSN"in e&&(o.vCredICMSSN=$utils.arredondar(o.pCredSN/100*Number(a.prod.vProd),2))},calculaImpostoST_CSOSN_101_102(o,a,e,s,i,c,u){!c.automatico.calculaBC||(o.pCredSN=$utils.arredondar(Number(c==null?void 0:c.aliquotaSimples),2),this.calculaVCredICMSSN(o,s))},calculaImpostoST_CSOSN_201_202(o,a,e,s,i,c,u){let t,S,p;if(u===0||!c.automatico.calculaBC)u=Number(a.noXml_vBC)||0,S=Number(a.noXml_vBCFCP)||0,t=Number(o.vBCST)||0,p=Number(o.opcional.vBCFCPST)||0;else{S=u;const l=i.transp.modFrete==="0",m=i.transp.modFrete==="1",C=s.prod.vFrete,f=i.ide.indFinal==="1",v=Number(o.pMVAST)||0;t=n((u+(l||!f&&m?C:0))*(1+v/100)),p=t,a.noXml_vBC=u,a.noXml_vBCFCP=S,o.vBCST=t,o.opcional.vBCFCPST=p}if(c.calculaTotais){const l=Number(a.noXml_pICMS)||0,m=Number(a.noXml_pFCP)||0,C=Number(o.pICMSST)||0,f=Number(o.opcional.pFCPST)||0,v=n(u*l/100,2),I=n(S*m/100,2),T=n(t*C/100-v,2),P=n(p*f/100-I,2);a.noXml_vICMS=v,a.noXml_vFCP=I,o.vICMSST=T,o.opcional.vFCPST=P,a.noXml_vFCPST=P,e.vICMSST+=T,e.vFCPST+=P,e.vBCST+=t}},calculaImpostoFCPST(o,a,e,s,i,c,u,t,S,p,l){e in a||console.error("totalEImpostos: Campo "+e+" n\xE3o consta em objetoImposto "),s in a||console.error("totalEImpostos: Campo "+s+" n\xE3o consta em objetoImposto "),c in i||console.error("totalEImpostos: Campo "+c+" n\xE3o consta em objetoImposto "),c in u||console.error("totalEImpostos: Campo "+c+" n\xE3o consta em total");const m=Number(a[s])||0;S===0||!t.automatico.calculaBC?S=Number(a[e]):S=this.atualizaBC(a,e,t,S),t.calculaTotais&&(i[c]=n(S*m/100-p,2),u[c]+=i[c],c==="vFCPST"&&(l.imposto.noXml_vFCPST=i[c]))},calculaImpostoPercentagemComReducaoBc(o,a,e,s,i,c,u,t,S,p,l){a in c||console.error("totalEImpostos: Campo "+a+" n\xE3o consta em objetoImposto "),e in c||console.error("totalEImpostos: Campo "+e+" n\xE3o consta em objetoImposto "),s in c||console.error("totalEImpostos: Campo "+s+" n\xE3o consta em objetoImposto "),i in c||console.error("totalEImpostos: Campo "+i+" n\xE3o consta em objetoImposto "),i in u||console.error("totalEImpostos: Campo "+i+" n\xE3o consta em total");const m=Number(c[e]),C=Number(c[s]);if(S===0||!t.automatico.calculaBC?S=Number(c[a]):(!!C&&!!m&&(S=n(S-S*(C/100),2)),c[a]=S),t.calculaTotais){const f=n(S*m/100,2);c[i]=f,u[i]+=f,(o==="ICMS"||o==="ICMSST")&&(a in u||console.error("totalEImpostos: Campo "+a+" n\xE3o consta em total"),u[a]+=S)}},calculaImpostoQuantidade(o,a,e,s,i,c,u,t,S){e in a||console.log("Campo "+e+" n\xE3o consta em objetoImposto "),s in a||console.log("Campo "+s+" n\xE3o consta em objetoImposto "),c in i||console.log("Campo "+c+" n\xE3o consta em objetoImposto "),c in u||console.log("Campo "+c+" n\xE3o consta em total");const p=this.atualizaBCquantidade(a,e,S,t),l=this.atualizaAliquotaQuantidade(a,s,t),m=this.atualizaValorImposto(i,c,p*l);u[c]+=m},atualizaBC(o,a,e,s){return e.automatico.calculaBC?o[a]=n(s,2):s=Number(o[a]),s},atualizaAliquota(o,a,e){let s=0;return s=Number(o[a]),s},atualizaValorImposto(o,a,e){return o[a]=n(e,2),n(e,2)},atualizaBCquantidade(o,a,e,s){let i=0;return s.automatico.calculaBC?(i=e,o[a]=n(i,4)):i=Number(o[a]),i},atualizaAliquotaQuantidade(o,a,e){let s=0;return s=Number(o[a]),s},atualizaCampoRecursivo(o,a,e){a in o&&(o[a]=e);for(const s in o){const i=o[s];!!i&&i.constructor===Object&&this.atualizaCampoRecursivo(i,a,e)}},atualizaCampoVisivelRecursivo(o,a,e){a in o&&"visivel"in o&&(o.visivel=e);for(const s in o){const i=o[s];!!i&&i.constructor===Object&&this.atualizaCampoVisivelRecursivo(i,a,e)}},buscaRecursivo(o,a){if(a in o)return o[a];for(const e in o){const s=o[e];if(!!s&&s.constructor===Object){const i=this.buscaRecursivo(s,a);if(i)return i}}return 0}};async function io(o){var i;const{idItem:a}=o!=null?o:{};let e,s;if(!!a)return e=await $erp().item.get(a),s=JSON.parse((i=e==null?void 0:e.json)!=null?i:null),s==null?void 0:s.icmsSTRet}function M(o,a,e){e in o&&(o[e]=a[e]);for(const s in o){const i=o[s];!!i&&i.constructor===Object&&M(i,a,e)}}function X(o,a,e){e in o&&"visivel"in o&&(o.visivel=!!a[e+"Visivel"]);for(const s in o){const i=o[s];!!i&&i.constructor===Object&&X(i,a,e)}}async function ro({infNFe:o,det:a,descricaoProduto:e,item:s,documentoItem:i,cfop:c,empresa:u,destinatario:t,outrosNFe:S},p){var P,F;o.ide.idDest=o.emit.enderEmit.UF===o.dest.enderDest.UF||!o.emit.enderEmit.UF||!o.dest.enderDest.UF||o.ide.mod==="65"?"1":o.dest.enderDest.UF==="EX"?"3":"2";let l=s.ncm||"";l=l.length===8?l:L(l);const m={emitente:{regime:o.emit.CRT,uf:o.emit.enderEmit.UF,tributacaoSetor:u.tributacaoSetor,tributacao:u.tributacao},destinatario:{regime:t.regime==="SimplesNacional"?"1":t.regime==="Normal"?"3":void 0,uf:o.dest.enderDest.UF,pessoa:{CPF:"PF",CNPJ:"PJ",idEstrangeiro:"Estrangeiro"}[o.dest.enderDest.UF==="EX"?"idEstrangeiro":o.dest.escolhas.valor_escolha]||void 0,tributacaoSetor:t.tributacaoSetor,tributacao:t.tributacao,indicadorIE:o.dest.indIEDest,consumidor:o.ide.indFinal==="0"?"N":o.ide.indFinal==="1"?"S":void 0,destino:o.ide.idDest},ncm:l,idItem:s.id,cfop:String(c||""),cest:s.cest,origemMercadoria:String(s.codigoOrigem||""),produto:s.descricao},C=await _.configuracaoImposto.pesquisa(m,p);if(!C||!C.ordem||!C.saida)return;m.emitente.uf!==m.destinatario.uf&&~["2","9"].indexOf(m.destinatario.indicadorIE)&&(a.imposto.ICMSUFDest.visivel=!0,a.imposto.ICMSUFDest.pFCPUFDest=Number(C.saida.icmsInterestadual.pFCPUFDest||0),a.imposto.ICMSUFDest.pICMSInter=String(Number(C.saida.pICMS).toFixed(2)),a.imposto.ICMSUFDest.pICMSInterPart=Number(C.saida.icmsInterestadual.pICMSInterPart||0),a.imposto.ICMSUFDest.pICMSUFDest=Number(C.saida.icmsInterestadual.pICMSUFDest||0),a.imposto.ICMSUFDest.pRedBCSTInter=Number(C.saida.icmsInterestadual.pRedBCSTInter||0));const f=a.prod,v=a.imposto,I=oo(C.saida);f.CFOP=C.entrada.cfop,v.noXml_orig=C.entrada.origemMercadoria,v.noXml_CST=I.cstCsosn,v.noXml_CSOSN=I.cstCsosn,v.noXml_pICMS=I.pICMS||0,v.noXml_pRedBC=(P=Number(C.saida.icmsInterestadual.pRedBC))!=null?P:0,v.noXml_pFCP=I.pFCP||0,I.pMVAST=I.pMVAST||0,I.pRedBC=(F=Number(C.saida.icmsInterestadual.pRedBC))!=null?F:0,M(v,I,"modBC"),M(v,I,"modBCST"),M(v,I,"pFCP"),M(v,I,"pFCPST"),M(v,I,"pFCPST"),M(v,I,"pFCPSTRet"),M(v,I,"pICMS"),M(v,I,"pICMSEfet"),M(v,I,"pICMSST"),M(v,I,"pMVAST"),M(v,I,"pRedBC"),M(v,I,"pST"),X(v,I,"pFCP"),X(v,I,"pFCPST"),X(v,I,"pFCPSTRet"),X(v,I,"pICMSEfet"),X(v,I,"pST"),v.noXml_ICMSSTRet=await io({idItem:f.noXml_id}),v.noXml_CSTPis=I.pisCst,v.noXml_pPIS=I.pPIS||0,v.noXml_CSTCofins=I.cofinsCst,v.noXml_pCOFINS=I.pCOFINS||0,C.entrada.cest&&(f.opcional.visivel=!0,f.opcional.CEST=L(C.entrada.cest)),S.observacoesNFe||(S.observacoesNFe={});const T=(C.saida.observacaoNFe||"").trim();(s==null?void 0:s.id)&&!S.observacoesNFe[s.id]&&T&&(S.observacoesNFe[s.id]=T),I.ipiVisivel&&(v.noXml_CSTIpi=o.ide.tpNF==="1"?I.ipiCstEntrada:I.ipiCstSaida,v.noXml_pIPI=f.noXml_pIPI||I.pIPI||0,v.noXml_cEnqIpi=I.ipiCEnq||0)}async function no(o,a){const e=(await _.configuracoes.leValorComFiltroEmpresa("nfe.autorizadoDownloadXml",a)).split(" ");for(const s of e){const i=O.executa(R.infNFe.autXML.lista,{},this.tipo),c=L(s);c.length===14?(i.escolhas.valor_escolha="CNPJ",i.escolhas.CNPJ=c,o.autXML.push(i)):c.length===11&&(i.escolhas.valor_escolha="CPF",i.escolhas.CPF=c,o.autXML.push(i))}}async function uo(o,a){o.ide.serie=String(await _.configuracoes.leValorNumericoComFiltroEmpresa(this.serie,a,1)),o.ide.nNF=String(await _.documentoFiscalEletronico.proximoNumero(o.ide.tpAmb,o.emit.escolhas.valor_escolha==="CPF"?o.emit.escolhas.CPF:o.emit.escolhas.CNPJ,o.ide.mod,o.ide.serie,a))}async function So(o,a){g.log("gerarJsonBaseD","obterConfiguracaoImposto"),o.descricaoProduto=`Produto '${o.documentoItem.descricaoItem||""}'`,h(!o.item.ncm,`${o.descricaoProduto} sem cadastro de NCM`);let e;o.outrosNFe.cfop?(e=await x().cfop.where({cfop:Number(o.outrosNFe.cfop)}).first(),h(!e,"CFOP inv\xE1lido")):(h(!o.documentoItem.idCfop,`${o.descricaoProduto} sem CFOP definido`),e=await x().cfop.get(o.documentoItem.idCfop),h(!e,`${o.descricaoProduto} com CFOP inv\xE1lido`)),o.cfop=e.cfop,await this.gerarConfiguracaoImposto(o,a)}async function Co(o){var a,e;if(g.log("gerarJsonBaseD","obterFatura"),o.documentoFatura=await $db.hibrido.le({table:"documento",id:o.idDocumento}),h(!o.documentoFatura,"N\xE3o foi poss\xEDvel carregar a fatura/venda"),o.documentosAdicionais=await $db.hibrido.lista({table:"documento",where:{idDocumentoAdicional:o.idDocumento}}),o.documentosVendas=await $db.hibrido.lista({table:"documento",where:{idFatura:o.idDocumento}}),o.idsDocumentos=[o.idDocumento,...o.documentosAdicionais.map(s=>s.id),...o.documentosVendas.map(s=>s.id)],g.log("gerarJsonBaseD",{documentoFatura:o.documentoFatura,documentosAdicionais:o.documentosAdicionais,documentosVendas:o.documentosVendas}),o.totalDesconto=n((o.documentoFatura.totalDesconto||0)+E(o.documentosVendas,"totalDesconto")),o.documentoFatura.tipo==="Venda")o.totalFrete=n(o.documentoFatura.valorFrete||0),o.tipoFrete=o.documentoFatura.tipoFrete;else{o.totalFrete=n(E(o.documentosVendas,"valorFrete")),o.tipoFrete=(e=(a=o.documentosVendas)==null?void 0:a.find(s=>s.tipoFrete))==null?void 0:e.tipoFrete;for(const s of o.documentosVendas)s.tipo!=="Envelope"&&h(o.tipoFrete!==s.tipoFrete,"Diverg\xEAncia de frete entre as vendas, favor emitir a nota individualmente (por venda)")}o.tipoFrete==="FOB"?o.infNFe.transp.modFrete="1":o.infNFe.transp.modFrete=n(o.totalFrete)===0?"9":o.tipoFrete==="CIF"?"0":o.tipoFrete==="FOB"?"1":"9",o.tipo!=="NFe"&&(o.totalFrete=0),o.infNFe.ide.natOp=o.outrosNFe.operacao?o.outrosNFe.operacao:o.infNFe.ide.finNFe==="4"?"Devolu\xE7\xE3o":"Venda",this.tipo==="NFCe"&&(o.infNFe.infAdic.visivel=!0,o.infNFe.infAdic.infCpl=J(await _.configuracoes.leValorComFiltroEmpresa("cupom.mensagem",o.documentoFatura.idEmpresa,"Obrigado e Volte Sempre!")),await _.configuracoes.leValorNumerico("nfce.offline")===1&&(o.infNFe.ide.tpEmis="9",o.infNFe.ide.opcional.visivel=!0,o.infNFe.ide.opcional.dhCont=ao.formatarDataNFe(new Date),o.infNFe.ide.opcional.xJust="Internet indisponivel")),o.outrosNFe.idDocumento=o.idDocumento}function po(o={}){var e;const a=[];for(const s in((e=o.outrosNFe)==null?void 0:e.observacoesNFe)||{}){const i=o.outrosNFe.observacoesNFe[s];let c=a.find(u=>u.msg===i);c||(c={msg:i},a.push(c))}o.outrosNFe.observacoesNFe="";for(const s of a)o.outrosNFe.observacoesNFe&&(o.outrosNFe.observacoesNFe+=" "),o.outrosNFe.observacoesNFe+=s.msg}function mo(o={}){const a=o.infNFe.total.ICMSTot.vProd-o.infNFe.total.ICMSTot.vDesc;o.outrosNFe.textoValorAproximadosTributos="[Valores aproximados dos tributos: R$ "+$utils.formatarNumero(o.infNFe.total.ICMSTot.vTotTrib,2)+" ("+$utils.formatarNumero(100*o.infNFe.total.ICMSTot.vTotTrib/a,2)+"%)  Federais: R$ "+$utils.formatarNumero(o.infNFe.total.ICMSTot.noXml_vTribFed,2)+" ("+$utils.formatarNumero(100*o.infNFe.total.ICMSTot.noXml_vTribFed/a,2)+"%)  Estaduais: R$ "+$utils.formatarNumero(o.infNFe.total.ICMSTot.noXml_vTribEst,2)+" ("+$utils.formatarNumero(100*o.infNFe.total.ICMSTot.noXml_vTribEst/a,2)+"%)  Municipais: R$ "+$utils.formatarNumero(o.infNFe.total.ICMSTot.noXml_vTribMun,2)+" ("+$utils.formatarNumero(100*o.infNFe.total.ICMSTot.noXml_vTribMun/a,2)+"%) Fonte: IBPT.] "}async function vo(o){var u,t,S;if(g.log("gerarJsonBaseD","obterFormasPagamento"),o.documentosPagamento=await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:o.idDocumento}}),o.documentosPagamento.length===0&&["Venda","Envelope"].includes(o.documentoFatura.tipo)){h(!o.documentoFatura.idFatura,"A venda n\xE3o tem pagamento e n\xE3o pertence a uma fatura");const p=await $db.hibrido.le({table:"documento",id:o.documentoFatura.idFatura});h(!p,"N\xE3o foi poss\xEDvel carregar a fatura da venda"),o.documentosPagamento=await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:p.id}}),o.vendaSemPagamento=!0}h(!o.documentosPagamento.length&&!o.vendaSemPagamento,"N\xE3o h\xE1 pagamentos"),g.log("gerarJsonBaseD","documentosPagamento",o.documentosPagamento);const a=[];for(const p of o.documentosPagamento){const l=await this.obterMeioPagamento(o,p.idFormaPagamento),m=await $erp().formaPagamento.get(p.idFormaPagamento);let C=a.find(f=>f.tPag===l&&f.card.cAut===p.autorizacao);if(C)C.vPag=n(C.vPag+p.valor);else{if(C=O.executa(R.infNFe.pag.detPag.lista,{},this.tipo),C.tPag=l,C.vPag=n(p.valor),["03","04"].includes(l)){let f;m.idContatoOperadoraCartao&&(f=await $erp().contato.get(m.idContatoOperadoraCartao),f&&(f.numeroDocumentoNacional=(u=f.numeroDocumentoNacional)==null?void 0:u.replace(/\D/g,""))),C.card.visivel=!0,C.card.tpIntegra=m.tef?"1":"2",((t=f==null?void 0:f.numeroDocumentoNacional)==null?void 0:t.length)===14&&(C.card.CNPJ=f.numeroDocumentoNacional),C.card.cAut=p.autorizacao}l==="99"&&(C.xPag=$utils.removerCaracteresEspeciais(((S=m==null?void 0:m.descricao)!=null?S:"").trim())),a.push(C)}}h(a.length===0&&!o.vendaSemPagamento,"N\xE3o h\xE1 pagamentos"),o.totalProdutos=n(o.totalProdutos);const e=await $db.hibrido.lista({table:"financeiroTitulo",where:{idFatura:o.idDocumento}}),s=n(E(a,"vPag"));n(E(e,"valorTotal")+o.totalServicos);const i=n(o.totalProdutos+o.totalFrete+o.totalDevolucao-o.totalDesconto-a.reduce((p,l)=>l.tPag==="90"?l.vPag:0,0));for(const p of a)p.tPag!=="99"&&delete p.xPag,p.tPag==="90"&&(p.vPag=0);if(s>0&&s!==i){for(const l of a)l.vPag=n(l.vPag*i/s);const p=n(E(a,"vPag"));for(const l of a)l.tPag!=="90"&&(l.vPag=n(l.vPag+i-p))}const c=n(-o.totalDevolucao);c>0&&o.totalProdutos>0&&a.push({tPag:"99",xPag:"Credito de Devolucao",vPag:c}),o.infNFe.pag.detPag=a}async function Io(o){if(o.totalFrete>0){const a=[];for(const s of o.infNFe.det){const i=s.prod;a.push({id:i.noXml_idDocumentoItem,valor:i.qCom*i.vUnCom-i.vDesc})}const e=$utils.ratear({itens:a,saldo:o.totalFrete});for(const s of o.infNFe.det){const i=s.prod,c=e.find(u=>u.id===i.noXml_idDocumentoItem);i.vFrete=(c==null?void 0:c.parcela)||0}}}async function fo(o,a){var p;g.log("gerarJsonBaseD","obterItens");const e=(await $db.hibrido.lista({table:"documentoItem",whereIn:{idDocumento:o.idsDocumentos}})).sort((l,m)=>String(l.dataHoraEmissao||"").localeCompare(String(m.dataHoraEmissao||""))),s=await $db.hibrido.lista({table:"documento",whereIn:{id:o.idsDocumentos}});h(!e,"N\xE3o foi poss\xEDvel carregar os produtos"),g.log("gerarJsonBaseD","documentosItens",e);const i=await _.configuracoes.leValorNumericoComFiltroEmpresa(this.usadesconto,o.outrosNFe.idContatoEmitente,1),c=await _.configuracoes.leValorNumerico("imposto.versao"),u=[];for(const l of e){let m=n(l.total||0);if(!l.idItem)continue;if(["Servi\xE7o"].includes(l.tipoItem)){o.totalServicos+=m;continue}if(o.infNFe.ide.finNFe==="4"){if(!(m<0)){o.totalDevolucao+=m;continue}}else if(m<0){o.totalDevolucao+=m;continue}const C=n(l.quantidade||1,4);let f=n(l.valorItem||0,4),v=n(l.descontoItem||0,4),I=n((l.descontoTotalRateado||0)+(l.descontoFaturaRateado||0),4);if(g.log("gerarJsonBaseD",{quantidade:C,valorUnitarioItem:f,descontoUnitarioItem:v,descontoRateadoItem:I,valorUnitarioItemComDesconto:f-v-I/C,valorUnitarioItemComDescontoA:n(f-v-I/C,4),totalItem:m,tipoItem:l.tipoItem,idItem:l.idItem,descricaoItem:l.descricaoItem}),["TLOE","TLOD"].includes(l.tipoItem))continue;if(["LOE","LOD"].includes(l.tipoItem)){const r=e.filter(d=>["TLOE","TLOD"].includes(d.tipoItem)&&d.idDocumentoItemPai===l.id);g.log("gerarJsonBaseD","tratamentos",r);for(const d of r)v+=n(d.descontoItem||0,4),I+=n((d.descontoTotalRateado||0)+(d.descontoFaturaRateado||0),4),f=n(f+d.valorItem||0,4),m+=d.total||0}if(n(m)===0)continue;let T=n(v*C+I);i===0&&(f=n(f-v-I/C,4),T=0),o.totalProdutos+=m,o.documentoItem=l,o.item=await x().item.get(l.idItem),h(!o.item,"N\xE3o foi poss\xEDvel carregar o cadastro do produto"),o.det=O.executa(R.infNFe.det.lista,{},this.tipo);const P=o.det.prod;let F=String(o.item.codigoBarras||"").padStart(13,"0");if(F.startsWith("999")&&(F="SEM GTIN"),P.cProd=J(String(o.item.referencia||o.item.codigoItem||"0").trim()),P.cEAN=F,P.xProd=J(l.descricaoItem).substr(0,120).trim(),P.NCM=String(o.item.ncm||""),P.uCom=String(o.item.unidade||"UN").trim(),P.qCom=C||0,P.vUnCom=f||0,P.vDesc=T||0,o.infNFe.ide.finNFe==="4"&&(P.vUnCom=-P.vUnCom,P.vDesc=-P.vDesc),P.noXml_id=l.idItem,P.noXml_idDocumentoItem=l.id,this.tipo==="NFe"){const r=(p=o==null?void 0:o.documentosVendas)==null?void 0:p.find(({id:d})=>d===l.idDocumento);r!=null&&r.numeroOrdemCompra&&(P.xPed=String(r.numeroOrdemCompra),P.nItemPed=String(u.length+1))}if(l.loteEmpresa&&l.dataValidadeLote&&l.dataFabricacaoLote&&P.rastro.push({nLote:l.loteEmpresa,qLote:l.quantidade,dFab:new Date(l.dataFabricacaoLote).toISOString().slice(0,10),dVal:new Date(l.dataValidadeLote).toISOString().slice(0,10)}),o.item.codigoANP){P.escolhas.valor_escolha="comb",P.escolhas.comb.cProdANP=o.item.codigoANP;let r=to.tabelaANP.find(d=>d.value===o.item.codigoANP);r&&(P.escolhas.comb.descANP=r.label),r||(P.escolhas.comb.descANP="C\xF3digo n\xE3o encontrado na tabela da ANP."),o.infNFe.dest.enderDest.UF&&(P.escolhas.comb.UFCons=o.infNFe.dest.enderDest.UF)}const b=Math.abs(l.valorRealTotal),D=Math.abs(l.valorIpi),N=Math.abs(l.percentualIpi);b&&D&&(P.noXml_pIPI=n(N)||n(D/b*100)),o.pesoL=n((o.pesoL||0)+Number(o.item.peso||0)*Number(C||1),3),o.pesoB=n((o.pesoB||0)+Number(o.item.pesoBruto||0)*Number(C||1),3),c===2?await this.obterConfiguracaoImpostoV2(o,a):await this.obterConfiguracaoImposto(o),u.push(o.det)}if(o.infNFe.ide.finNFe==="4")h(u.length===0,"N\xE3o h\xE1 produtos para devolu\xE7\xE3o");else if(h(u.length===0,"N\xE3o h\xE1 produtos vendidos"),o.outrosNFe.operacao!=="Remessa")for(const l of u)await this.obterAliquotasTributosIbpt(o,l);const t=O.executa(R.infNFe.transp.vol.lista,{},this.tipo),S=s.reduce((l,m)=>l+(Number(m.numeroVolumeTransporte)||0),0);t.esp="",S>0&&(t.esp=S===1?"VOLUME":"VOLUMES"),t.qVol=String(S||""),t.pesoL=o.pesoL,t.pesoB=o.pesoB,o.infNFe.transp.vol.push(t),g.log("gerarJsonBaseD","itens",u),o.infNFe.det=u}export{no as a,uo as b,Co as c,po as d,mo as e,vo as f,ro as g,Io as h,fo as i,So as o,lo as t};
