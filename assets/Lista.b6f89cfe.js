import{_ as Q,p as y,o as f,i as C,w as o,f as a,s as $,B as L,E as P,e as d,C as z,D as b,L as F,x as w,z as Y,y as B,bh as ua,bW as J,K as Z,A as W,t as _,b6 as da,G,d as x,F as T,r as D,j as I,b0 as K,b2 as ca,b3 as X,bk as ma,bl as aa,N,P as U,R as k,S as A,az as R,H as fa,l as E,Q as pa,b1 as ha,I as va,a5 as S,bw as ga,k as M,a4 as ba}from"./index.094a6fb0.js";import{L as _a}from"./Lista.bd52a084.js";import{o as Ca}from"./open-url.89def1d2.js";import{Q as ya}from"./QDate.6a3c15ec.js";import{Q as ea}from"./QTime.60e75681.js";import"./QBtnDropdown.26bd157e.js";import"./QBtnGroup.13529f03.js";import"./xlsx.6cceadb4.js";const ka={data(){return{visivel:!1,assunto:""}},methods:{async criar(){try{this.resolve({assunto:this.assunto}),this.visivel=!1}catch(l){$q.notifyError("Ocorreu erro ao adicionar",l)}},onHide(){this.resolve({})},show(){return this.assunto="",this.visivel=!0,this.$nextTick(()=>this.$refs.assunto.focus()),new Promise((l,e)=>{this.resolve=l})}}},Va={class:"layout-padding"},wa={class:"col-12"},qa={class:"q-mt-lg text-right"};function Aa(l,e,u,m,t,r){const c=y("campo"),p=y("row");return f(),C(B,{modelValue:t.visivel,"onUpdate:modelValue":e[1]||(e[1]=i=>t.visivel=i),onHide:e[2]||(e[2]=i=>r.onHide())},{default:o(()=>[a($,{class:"q-dialog-plugin"},{default:o(()=>[a(L,{class:"bg-primary text-white"},{default:o(()=>[a(P,null,{default:o(()=>[d("Criar checklist")]),_:1}),z(a(b,{dense:"",flat:"",icon:"close",round:""},null,512),[[F]])]),_:1}),w("div",Va,[a(Y,{class:"q-pa-md",onSubmit:r.criar},{default:o(()=>[a(p,{class:"items-center q-col-gutter-md"},{default:o(()=>[w("div",wa,[a(c,{modelValue:t.assunto,"onUpdate:modelValue":e[0]||(e[0]=i=>t.assunto=i),modelModifiers:{trim:!0},ref:"assunto",rotulo:"Assunto",autofocus:"",rules:[i=>!!i||"Campo obrigat\xF3rio"]},null,8,["modelValue","rules"])])]),_:1}),w("div",qa,[z(a(b,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[F]]),a(b,{color:"primary",class:"text-white",unelevated:"",label:"Criar",type:"submit"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1},8,["modelValue"])}var xa=Q(ka,[["render",Aa]]);const za={data(){return{visivel:!1,convidado:{}}},methods:{async alterar(){try{this.resolve(this.convidado),this.visivel=!1}catch(l){$q.notifyError("Ocorreu erro ao alterar",l)}},onHide(){this.resolve()},validateEmail(l){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(l).toLowerCase())},show(l){return this.convidado=$utils.clonarV2(l),this.visivel=!0,this.$nextTick(()=>this.$refs.email.focus()),new Promise((e,u)=>{this.resolve=e})}}},Ha={class:"layout-padding"},Ta={class:"col-12"},Fa={class:"q-mt-lg text-right"};function Da(l,e,u,m,t,r){const c=y("campo"),p=y("row");return f(),C(B,{modelValue:t.visivel,"onUpdate:modelValue":e[4]||(e[4]=i=>t.visivel=i),onHide:e[5]||(e[5]=i=>r.onHide())},{default:o(()=>[a($,{class:"q-dialog-plugin"},{default:o(()=>[a(L,{class:"bg-primary text-white"},{default:o(()=>[a(P,null,{default:o(()=>[d("Convidado")]),_:1}),z(a(b,{dense:"",flat:"",icon:"close",round:""},null,512),[[F]])]),_:1}),w("div",Ha,[a(Y,{class:"q-pa-md",onSubmit:r.alterar},{default:o(()=>[a(p,{class:"items-center q-col-gutter-md"},{default:o(()=>[w("div",Ta,[a(c,{modelValue:t.convidado.cpfCnpj,"onUpdate:modelValue":e[0]||(e[0]=i=>t.convidado.cpfCnpj=i),modelModifiers:{trim:!0},rotulo:"CPF/CNPJ","somente-leitura":""},null,8,["modelValue"]),a(c,{modelValue:t.convidado.nome,"onUpdate:modelValue":e[1]||(e[1]=i=>t.convidado.nome=i),modelModifiers:{trim:!0},rotulo:"Nome","somente-leitura":""},null,8,["modelValue"]),a(c,{modelValue:t.convidado.email,"onUpdate:modelValue":e[2]||(e[2]=i=>t.convidado.email=i),modelModifiers:{trim:!0},ref:"email",before:[{icon:"alternate_email"}],rotulo:"E-mail",rules:[i=>r.validateEmail(i)||"email inv\xE1lido"]},null,8,["modelValue","rules"]),a(c,{modelValue:t.convidado.observacoes,"onUpdate:modelValue":e[3]||(e[3]=i=>t.convidado.observacoes=i),modelModifiers:{trim:!0},rotulo:"Observa\xE7\xF5es"},null,8,["modelValue"])])]),_:1}),w("div",Fa,[z(a(b,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[F]]),a(b,{color:"primary",class:"text-white",unelevated:"",label:"Alterar",type:"submit"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1},8,["modelValue"])}var Sa=Q(za,[["render",Da]]);const Ua={data(){return{visivel:!1,anotacao:{}}},methods:{async alterar(){try{this.resolve(this.anotacao),this.visivel=!1}catch(l){$q.notifyError("Ocorreu erro ao alterar",l)}},onHide(){this.resolve()},show(l){return this.anotacao=$utils.clonarV2(l),this.visivel=!0,this.$nextTick(()=>this.$refs.campoFocus.focus()),new Promise((e,u)=>{this.resolve=e})}}},ja={class:"layout-padding"},Oa={class:"col-12"},Ia={class:"col-6"},Ea={class:"col-6"},Na={class:"col-12"},La={class:"q-mt-lg text-right"};function Pa(l,e,u,m,t,r){const c=y("campo"),p=y("row");return f(),C(B,{modelValue:t.visivel,"onUpdate:modelValue":e[3]||(e[3]=i=>t.visivel=i),onHide:e[4]||(e[4]=i=>r.onHide())},{default:o(()=>[a($,{class:"q-dialog-plugin"},{default:o(()=>[a(L,{class:"bg-primary text-white"},{default:o(()=>[a(P,null,{default:o(()=>[d("Anota\xE7\xE3o")]),_:1}),z(a(b,{dense:"",flat:"",icon:"close",round:""},null,512),[[F]])]),_:1}),w("div",ja,[a(Y,{class:"q-pa-md",onSubmit:r.alterar},{default:o(()=>[a(p,{class:"items-center q-col-gutter-md"},{default:o(()=>[w("div",Oa,[a(c,{modelValue:t.anotacao.usuario.nome,"onUpdate:modelValue":e[0]||(e[0]=i=>t.anotacao.usuario.nome=i),rotulo:"Usu\xE1rio","somente-leitura":""},null,8,["modelValue"])]),w("div",Ia,[a(c,{modelValue:t.anotacao.dataHoraCriacao,"onUpdate:modelValue":e[1]||(e[1]=i=>t.anotacao.dataHoraCriacao=i),tipo:"data",rotulo:"Data","somente-leitura":""},null,8,["modelValue"])]),w("div",Ea,[a(c,{modelValue:l.$filters.hora(t.anotacao.dataHoraCriacao,"",5),rotulo:"Hora","somente-leitura":""},null,8,["modelValue"])]),w("div",Na,[a(c,{modelValue:t.anotacao.texto,"onUpdate:modelValue":e[2]||(e[2]=i=>t.anotacao.texto=i),modelModifiers:{trim:!0},ref:"campoFocus",rotulo:"Texto",rules:[i=>!!i||"Campo obrigat\xF3rio"]},null,8,["modelValue","rules"])])]),_:1}),w("div",La,[z(a(b,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[F]]),a(b,{color:"primary",class:"text-white",unelevated:"",label:"Alterar",type:"submit"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1},8,["modelValue"])}var Qa=Q(Ua,[["render",Pa]]);const Ma={data(){return{visivel:!1,apontamento:{}}},methods:{async alterar(){try{$utils.verificarErro(this.apontamento.dataHoraInicio>$utils.dataAtual(),"Data e hora iniciada deve ser no passado"),this.apontamento.dataHoraFim&&(this.apontamento.dataHoraFim=this.apontamento.dataHoraInicio.substr(0,10)+this.apontamento.dataHoraFim.substr(10),$utils.verificarErro(this.apontamento.dataHoraFim<this.apontamento.dataHoraInicio,"Hora finalizada deve ser maior que hora iniciada"),$utils.verificarErro(this.apontamento.dataHoraFim>$utils.dataAtual(),"Data e hora finalizada deve ser no passado")),this.resolve(this.apontamento),this.visivel=!1}catch(l){$q.notifyError("Ocorreu erro ao alterar",l)}},onHide(){this.resolve()},show(l){return this.apontamento=$utils.clonarV2(l),this.visivel=!0,new Promise((e,u)=>{this.resolve=e})}}},Ba={class:"layout-padding"},Ra={class:"q-mt-lg text-right"};function $a(l,e,u,m,t,r){const c=y("campo"),p=y("g-col"),i=y("g-label"),h=y("g-row");return f(),C(B,{modelValue:t.visivel,"onUpdate:modelValue":e[4]||(e[4]=v=>t.visivel=v),onHide:e[5]||(e[5]=v=>r.onHide()),maximized:""},{default:o(()=>[a($,{class:"q-dialog-plugin"},{default:o(()=>[a(L,{class:"bg-primary text-white"},{default:o(()=>[a(P,null,{default:o(()=>[d("Apontamento")]),_:1}),z(a(b,{dense:"",flat:"",icon:"close",round:""},null,512),[[F]])]),_:1}),w("div",Ba,[a(Y,{class:"q-pa-md",onSubmit:r.alterar},{default:o(()=>[a(h,{gutter:" md"},{default:o(()=>[a(p,{col:"12"},{default:o(()=>[a(c,{modelValue:t.apontamento.usuario.nome,"onUpdate:modelValue":e[0]||(e[0]=v=>t.apontamento.usuario.nome=v),rotulo:"Usu\xE1rio","somente-leitura":""},null,8,["modelValue"])]),_:1}),a(p,{col:"12"},{default:o(()=>[a(i,null,{default:o(()=>[d("Iniciado")]),_:1}),a(h,{gutter:" md"},{default:o(()=>[a(p,{col:"shrink"},{default:o(()=>[a(ya,{modelValue:t.apontamento.dataHoraInicio,"onUpdate:modelValue":e[1]||(e[1]=v=>t.apontamento.dataHoraInicio=v),mask:"YYYY-MM-DDTHH:mm:ss.SSSZ",landscape:"",ref:"campoFocus"},null,8,["modelValue"])]),_:1}),a(p,{col:"shrink"},{default:o(()=>[a(ea,{modelValue:t.apontamento.dataHoraInicio,"onUpdate:modelValue":e[2]||(e[2]=v=>t.apontamento.dataHoraInicio=v),mask:"YYYY-MM-DDTHH:mm:ss.SSSZ",landscape:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(p,{col:"12"},{default:o(()=>[a(i,null,{default:o(()=>[d("Finalizado")]),_:1}),a(h,{gutter:" md"},{default:o(()=>[a(p,{col:"shrink"},{default:o(()=>[a(ea,{modelValue:t.apontamento.dataHoraFim,"onUpdate:modelValue":e[3]||(e[3]=v=>t.apontamento.dataHoraFim=v),mask:"YYYY-MM-DDTHH:mm:ss.SSSZ",landscape:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),w("div",Ra,[z(a(b,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[F]]),a(b,{color:"primary",class:"text-white",unelevated:"",label:"Alterar",type:"submit"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1},8,["modelValue"])}var Ya=Q(Ma,[["render",$a]]);const Ja={components:{Arquivo:ua,CheckListCriar:xa,Convidado:Sa,Anotacao:Qa,Apontamento:Ya},data(){return{visivel:!1,showFilters:!0,item:{},imagens:{},arquivosOriginal:[],arquivos:[],arrayTags:[],arrayAnotacoes:[],arrayApontamentos:[],textoAnotacao:"",anotacoesPorDia:[],apontamentoIniciado:null,apontamentosPorDia:[],arrayConvidados:[],arrayChecklist:[],termoBuscaAnotacao:"",usuario:JSON.parse(localStorage.getItem("usuario")),produtos:{},tabsModel:"xtab-1",dadosClientes:[]}},methods:{async atualizar({id:l}){const e=await $db.tarefa.ler({filtro:{id:l}});$utils.verificarErro(!(e!=null&&e.id),"Tarefa n\xE3o encontrada."),this.itemOriginal=$utils.clonarV2(e),this.item={...$db.tarefa.criar(),...e},this.atualizarAnotacoes(e.anotacoes),this.atualizarApontamentos(e.apontamentos),this.arrayConvidados=this.atualizarConvidados(e.convidados),this.arrayTags=this.atualizarTags(e.tags),this.itemOriginal=this.prepararSalvar(),this.atualizarChecklist(),this.carregarImagens(),this.carregarArquivos()},atualizarAnotacoes(l){const e=$utils.converterObjetoParraArray({objetos:l}).sort((i,h)=>h.dataHoraCriacao.localeCompare(i.dataHoraCriacao)),u=$utils.removerAcentos((this.termoBuscaAnotacao||"").toUpperCase()).split(" ").filter(i=>i!=="");let m,t,r,c;const p=[];for(const i of e){if(u.length){const j=$utils.removerAcentos(i.texto.toUpperCase());if(!u.reduce((q,H)=>q&&j.includes(H),!0))continue}const h=i.dataHoraCriacao.substr(0,10),v=i.usuario.cpf;h!==m?(r={usuario:i.usuario,anotacoes:[i]},c={data:h,anotacoes:[r]},p.push(c)):v!==t?(r={usuario:i.usuario,anotacoes:[i]},c.anotacoes.push(r)):r.anotacoes.push(i),m=h,t=v}this.anotacoesPorDia=p,this.arrayAnotacoes=e},atualizarApontamentos(l){const e=$utils.converterObjetoParraArray({objetos:l}).sort((p,i)=>i.dataHoraInicio.localeCompare(p.dataHoraInicio));let u,m,t,r;const c=[];this.apontamentoIniciado=null;for(const p of e){const i=p.dataHoraInicio.substr(0,10),h=p.usuario.cpf;p.arrayTags=this.atualizarTags(p.tags),p.duracao=J.utc(J(p.dataHoraFim||J()).diff(p.dataHoraInicio)).format("HH:mm:ss"),!p.dataHoraFim&&h===this.usuario.numeroDocumentoNacional&&(this.apontamentoIniciado=p),i!==u?(t={usuario:p.usuario,apontamentos:[p]},r={data:i,apontamentos:[t]},c.push(r)):h!==m?(t={usuario:p.usuario,apontamentos:[p]},r.apontamentos.push(t)):t.apontamentos.push(p),u=i,m=h}this.apontamentosPorDia=c,this.arrayApontamentos=e},atualizarConvidados(l){return $utils.converterObjetoParraArray({objetos:l,chave:"cpfCnpj"}).map(e=>({...e,arrayTags:this.atualizarTags(e.tags)}))},atualizarTags(l){return $utils.converterObjetoParraArray({objetos:l,campos:[["texto","label"]]})},async atualizarChecklist(){try{const l=await $db.tarefa.ler({filtro:{pai:{id:this.item.id}}});for(const e of l.data)for(const u in e.apontamentos){const m=e.apontamentos[u];m.dataHoraFim||(e.apontamentoIniciado=m)}this.arrayChecklist=l.data}catch(l){$q.notifyError("N\xE3o foi poss\xEDvel atualizar checklist",l)}},async show(l){try{const{id:e}=l!=null?l:{};$q.loading.show(),e?await this.atualizar({id:e}):this.criarTarefa(),this.termoBuscaAnotacao="",this.visivel=!0}catch(e){$q.notifyError("N\xE3o foi poss\xEDvel obter a informa\xE7\xE3o.",e)}finally{$q.loading.hide()}},async onHide(){this.verificarSeAlterouCampos()&&(await this.descartarConfirma()||(this.visivel=!0)),this.visivel||(this.$router.replace({params:{id:""}}),this.$emit("atualizar"))},criarTarefa(){this.item=$db.tarefa.criar(),this.item.id=$utils.uuid(),this.item.dataHoraCriacao=$utils.dataAtual(),this.item.responsavel={id:this.usuario.idContato||this.usuario.id,cpf:this.usuario.numeroDocumentoNacional,nome:this.usuario.nome},this.itemOriginal=$utils.clonarV2(this.item),this.itemOriginal=this.prepararSalvar(),this.arquivos=[],this.arquivosOriginal=[],this.arrayTags=[],this.arrayAnotacoes=[],this.arrayApontamentos=[],this.anotacoesPorDia=[],this.apontamentosPorDia=[],this.arrayConvidados=[],this.arrayChecklist=[],this.apontamentoIniciado=null},async buscarItem(){var u;const l=await $g.promptItem.show({filtro:{ativo:!0,tipo:"Servi\xE7o"},placeholder:"Selecione o Servi\xE7o"}),e=(u=Object.values(l.itensSelecionados)[0])==null?void 0:u.item;l.acao==="selecionarItens"&&e&&(this.item.item={id:e.id,descricao:e.descricao,prioridade:e.garantiaDescricao},this.imagens[e.id]=e.imagem)},async buscarContato(l){try{const e={cliente:"Cliente",solicitante:"Solicitante",responsavel:"Respons\xE1vel",organizador:"Organizador",convidado:"Convidado"}[l]||"Contato",u=await $g.promptContato.show({filtro:{ativo:!0,numeroDocumentoNacional:!0},placeholder:`Selecione o ${e}`});if(u){const m={cliente:this.carregarCliente,solicitante:this.carregarSolicitante,responsavel:this.carregarResponsavel,organizador:this.carregarOrganizador,convidado:this.carregarConvidado}[l];await m(u),this.imagens[u.numeroDocumentoNacional]=u.imagem}}catch(e){$q.notifyError("N\xE3o foi possivel buscar contato",e)}},async carregarCliente(l){const e=await $db.contatoEndereco.leEnderecoPrincipal(l.id),u=await $db.contatoTelefone.le({idContato:l.id});this.item.cliente={id:l.id,cpfCnpj:l.numeroDocumentoNacional,nome:l.nome,apelido:l.apelido,email:l.email,telefones:$utils.converterArrayParaObjeto({array:u,campos:["tipoTelefone","telefone"]}),tipoEndereco:e.grupo,endereco:(e.logradouro?e.logradouro+" ":"")+(e.numero?e.numero+", ":"")+(e.complemento?e.complemento+", ":"")+(e.bairro?e.bairro+" - ":"")+(e.municipio?e.municipio+"/":"")+(e.uf?e.uf+" ":"")+(e.cep?e.cep:"")}},async carregarSolicitante(l){this.item.solicitante={id:l.id,cpf:l.numeroDocumentoNacional,nome:l.nome}},async carregarResponsavel(l){this.item.responsavel={id:l.id,cpf:l.numeroDocumentoNacional,nome:l.nome}},async carregarOrganizador(l){this.item.organizador={id:l.id,cpf:l.numeroDocumentoNacional,nome:l.nome}},async carregarConvidado(l){$utils.verificarErro(this.arrayConvidados.find(e=>e.cpfCnpj===l.numeroDocumentoNacional),"Contato j\xE1 esta na lista de convidados"),this.arrayConvidados.push({cpfCnpj:l.numeroDocumentoNacional,nome:l.nome,email:l.email,observacoes:"",arrayTags:[]})},async finalizar(){await this.salvarConfirma("Deseja finalizar e salvar a tarefa?")&&(this.item.status="Fechado",this.item.dataHoraFinalizado=$utils.dataAtual(),await this.salvar({visivel:!0}))},async reabrir(){await this.salvarConfirma("Deseja reabrir e salvar a tarefa?")&&(this.item.status="Aberto",await this.salvar({visivel:!0}))},async salvar({visivel:l}){try{$utils.verificarErro(!this.verificarSeAlterouCampos(),"N\xE3o h\xE1 dados alterados"),$utils.verificarErro(!this.item.assunto,"Assunto n\xE3o preenchido"),$utils.verificarErro(!this.item.cliente.id,"Cliente n\xE3o selecionado"),$utils.verificarErro(!this.item.solicitante.id,"Solicitante n\xE3o selecionado"),$utils.verificarErro(!this.item.responsavel.id,"Respons\xE1vel n\xE3o selecionado"),$q.loading.show();const e=this.prepararSalvar();await $db.tarefa.gravar(e),this.itemOriginal=e,await this.salvarArquivos(),$q.notifyPositive("Tarefa salva com sucesso"),l||(this.visivel=!1,this.$router.replace({params:{id:""}}),this.$emit("atualizar"))}catch(e){$q.notifyError("N\xE3o foi possivel salvar.",e)}finally{$q.loading.hide()}},prepararSalvar(){const l=$utils.clonarV2(this.item);return l.tags=this.prepararSalvarTags(this.arrayTags,this.itemOriginal.tags),l.anotacoes=this.prepararSalvarAnotacoes(this.arrayAnotacoes,this.itemOriginal.anotacoes),l.apontamentos=this.prepararSalvarApontamentos($utils.clonarV2(this.arrayApontamentos),this.itemOriginal.apontamentos),l.convidados=this.prepararSalvarConvidados($utils.clonarV2(this.arrayConvidados),this.itemOriginal.convidados),l},verificarSeAlterouCampos(){const l=this.prepararSalvar(),e=$utils.diferencaObjetos(this.itemOriginal,l),u=Object.keys(e).length>0;return u&&console.log("verificarSeAlterouCampos",{dadosAlterados:e,original:this.itemOriginal,novo:l}),u},prepararSalvarAnotacoes(l,e){return $utils.converterArrayParaObjeto({array:l,objetoOriginal:e})},prepararSalvarApontamentos(l,e){var u;for(const m of l)m.tags=this.prepararSalvarTags(m.arrayTags,(u=e[m.id])==null?void 0:u.tags),delete m.arrayTags,delete m.duracao;return $utils.converterArrayParaObjeto({array:l,objetoOriginal:e})},prepararSalvarConvidados(l,e){var u;for(const m of l)m.tags=this.prepararSalvarTags(m.arrayTags,(u=e[m.cpfCnpj])==null?void 0:u.tags),delete m.arrayTags;return $utils.converterArrayParaObjeto({array:l,chave:"cpfCnpj",objetoOriginal:e})},prepararSalvarTags(l,e){return $utils.converterArrayParaObjeto({array:l,campos:[["label","texto"]],objetoOriginal:e})},async adicionarChecklist(){try{const l=await this.$refs.checkListCriar.show();if(!l.assunto)return;const e=this.arrayChecklist.reduce((m,t)=>t.ordem>m?t.ordem:m,0),u={id:$utils.uuid(),pai:{id:this.item.id,assunto:this.item.assunto},ordem:e+1,tipo:"SubTarefa",assunto:l.assunto,dataHoraCriacao:$utils.dataAtual(),status:"Aberto",apontamentoIniciado:null,responsavel:$utils.clonarV2(this.item.responsavel),cliente:$utils.clonarV2(this.item.cliente),organizador:$utils.clonarV2(this.item.organizador),solicitante:$utils.clonarV2(this.item.solicitante),item:$utils.clonarV2(this.item.item),apontamentos:{}};this.arrayChecklist.push(u),$q.loading.show(),await $db.tarefa.gravar(u)}catch(l){$q.notifyError("N\xE3o foi poss\xEDvel adicionar checklist",l)}finally{$q.loading.hide()}},adicionarAnotacao(){const l=$utils.uuid(),e={dataHoraCriacao:$utils.dataAtual(),usuario:{cpf:this.usuario.numeroDocumentoNacional,nome:this.usuario.nome},texto:this.textoAnotacao};this.termoBuscaAnotacao="",this.item.anotacoes[l]=e,this.atualizarAnotacoes(this.item.anotacoes),this.textoAnotacao=""},adicionarApontamento(){const l=$utils.uuid();return{apontamento:{dataHoraInicio:$utils.dataAtual(),dataHoraFim:"",duracao:"",arrayTags:[],tags:{},usuario:{cpf:this.usuario.numeroDocumentoNacional,nome:this.usuario.nome}},id:l}},async editarAnotacao(l){const e=this.item.anotacoes[l],u=await this.$refs.anotacao.show(e);u&&(e.texto=u.texto,this.atualizarAnotacoes(this.item.anotacoes))},async editarApontamento(l){const e=this.item.apontamentos[l],u=await this.$refs.apontamento.show(e);u&&(e.dataHoraInicio=u.dataHoraInicio,e.dataHoraFim=u.dataHoraFim,this.atualizarApontamentos(this.item.apontamentos))},async excluirAnotacao(l){l&&await this.excluirConfirma("Confirma exclus\xE3o de anota\xE7\xE3o?")&&(delete this.item.anotacoes[l],this.atualizarAnotacoes(this.item.anotacoes))},async excluirApontamento(l){l&&await this.excluirConfirma("Confirma exclus\xE3o de apontamento?")&&(delete this.item.apontamentos[l],this.atualizarApontamentos(this.item.apontamentos))},async iniciarContador(){let l=!0;if(this.verificarSeAlterouCampos()&&(l=await this.salvarConfirma("Deseja iniciar apontamento e salvar a tarefa?")),l){const{apontamento:e,id:u}=this.adicionarApontamento();this.item.apontamentos[u]=e,this.apontamentoIniciado=e,this.atualizarApontamentos(this.item.apontamentos),await this.salvar({visivel:!0})}},async pararContador(l){let e=!0;if(this.verificarSeAlterouCampos()&&(e=await this.salvarConfirma("Deseja pausar o apontamento e salvar a tarefa?")),e){const u=this.item.apontamentos[l].dataHoraInicio,m=$utils.dataAtual();m.substr(0,10)===u.substr(0,10)?(this.item.apontamentos[l].dataHoraFim=m,this.atualizarApontamentos(this.item.apontamentos),this.apontamentoIniciado=null):await this.editarApontamento(l),await this.salvar({visivel:!0})}},async finalizarChecklist(l){try{$q.loading.show(),l.status="Fechado",l.dataHoraFinalizado=$utils.dataAtual(),await $db.tarefa.gravar(l)}catch(e){$q.notifyError("N\xE3o foi poss\xEDvel iniciar",e)}finally{$q.loading.hide()}},async iniciarChecklist(l){try{$q.loading.show();const{apontamento:e,id:u}=this.adicionarApontamento();l.apontamentos[u]=e,await $db.tarefa.gravar(l),l.apontamentoIniciado=e}catch(e){$q.notifyError("N\xE3o foi poss\xEDvel iniciar",e)}finally{$q.loading.hide()}},async pararChecklist(l){try{$q.loading.show(),l.apontamentoIniciado.dataHoraFim=$utils.dataAtual(),l.apontamentoIniciado=null,await $db.tarefa.gravar(l)}catch(e){$q.notifyError("N\xE3o foi poss\xEDvel parar",e)}finally{$q.loading.hide()}},async editarConvidado(l){try{const e=this.arrayConvidados[l],u=await this.$refs.convidado.show(e);if(!(u!=null&&u.cpfCnpj))return;this.arrayConvidados[l]=u;const m=await $db.contato.le({numeroDocumentoNacional:u.cpfCnpj}),t=m==null?void 0:m[0];if(!!t&&t.email!==u.email){const r={dadosOriginais:{contato:t},contato:{...t,email:u.email}};await $db.contato.grava(r)}}catch(e){$q.notifyError("N\xE3o foi poss\xEDvel atualizar",e)}},async excluirConvidado(l){l&&await this.excluirConfirma("Confirma exclus\xE3o de convidado?")&&(this.arrayConvidados=this.arrayConvidados.filter(e=>e.cpfCnpj!==l))},async excluirChecklist(l){try{l&&await this.excluirConfirma("Confirma exclus\xE3o de checklist?")&&($q.loading.show(),await $db.tarefa.remover(l),this.arrayChecklist=this.arrayChecklist.filter(e=>e.id!==l))}catch(e){$q.notifyError("N\xE3o foi poss\xEDvel remover checklist",e)}finally{$q.loading.hide()}},async abrirTarefa(l){this.$router.replace({params:{id:l}}),await this.show({id:l})},async carregarArquivos(){try{this.arquivosOriginal=await $db.arquivo.lista({tipoArquivo:"tarefaArquivo",idTabelaMaster:this.item.id}),this.arquivos=$utils.clonarV2(this.arquivosOriginal)}catch(l){$q.notifyError("N\xE3o foi poss\xEDvel atualizar os arquivos",l)}},async carregarImagens(){var l,e,u;try{const m=[this.item.organizador.cpf,this.item.responsavel.cpf,this.item.solicitante.cpf,this.item.cliente.cpfCnpj,...Object.keys(this.item.convidados),...this.arrayAnotacoes.map(r=>{var c;return(c=r==null?void 0:r.usuario)==null?void 0:c.cpf}),...this.arrayApontamentos.map(r=>{var c;return(c=r==null?void 0:r.usuario)==null?void 0:c.cpf})];for(const r of m)if(!!r&&this.imagens[r]===void 0){const c=await $db.contato.le({numeroDocumentoNacional:r});this.imagens[r]=(e=(l=c==null?void 0:c[0])==null?void 0:l.imagem)!=null?e:""}const t=this.item.item.id;if(!!t&&this.imagens[t]===void 0){const r=await $db.item.le({id:t});this.imagens[t]=(u=r==null?void 0:r.imagem)!=null?u:""}}catch(m){$q.notifyError("N\xE3o foi poss\xEDvel atualizar as imagens",m)}},async salvarArquivos(){await $db.arquivo.remove(this.arquivosOriginal.filter(l=>!this.arquivos.find(e=>e.id===l.id)));for(const l of this.arquivos)l.idTabelaMaster=this.item.id,await $db.arquivo.grava({original:this.arquivosOriginal.find(e=>e.id===l.id),atual:l})},excluirConfirma(l){return new Promise((e,u)=>{$q.dialog({cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},title:"Remover",message:l,ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{e(!0)}).onCancel(()=>{e(!1)})})},salvarConfirma(l){return new Promise((e,u)=>{$q.dialog({cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},title:"Salvar",message:l,ok:{label:"Sim",push:!0,class:"bg-positive",textColor:"white",flat:!0}}).onOk(()=>{e(!0)}).onCancel(()=>{e(!1)})})},descartarConfirma(){return new Promise((l,e)=>{$q.dialog({cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},title:"Descartar",message:"Deseja descartar as modifica\xE7\xF5es?",ok:{label:"Descartar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{l(!0)}).onCancel(()=>{l(!1)})})},abrirURL:Ca,async abrirTelefone(l){if(!l.telefone)return;const e=l.tipoTelefone==="WhatsApp"?"https://api.whatsapp.com/send?phone=":"tel:+";this.abrirURL(e+await $utils.formatarTelefone(l))}},mounted(){}},Za={class:"u-container border-top"};function Wa(l,e,u,m,t,r){const c=y("avatar"),p=y("campo"),i=y("g-col"),h=y("g-label"),v=y("g-row"),j=y("badge"),s=y("row"),q=y("BadgeCopiarUid"),H=y("gchips"),ta=y("arquivo"),la=y("CheckListCriar"),ia=y("Convidado"),ra=y("Anotacao"),sa=y("Apontamento"),na=y("modalEditarJson");return f(),C(B,{modelValue:t.visivel,"onUpdate:modelValue":e[25]||(e[25]=n=>t.visivel=n),onHide:r.onHide,maximized:""},{default:o(()=>[a(Z,{view:"hHr lpR fFr",class:"bg-light"},{default:o(()=>[a(W,null,{default:o(()=>[a(L,{class:"q-pa-sm",color:"transparent"},{default:o(()=>[z(a(b,{icon:"arrow_back",round:"",flat:"",dense:""},null,512),[[F]]),a(P,null,{default:o(()=>[d(_(t.item.assunto||"Nova Tarefa"),1)]),_:1}),a(b,{onClick:e[0]||(e[0]=n=>t.showFilters=!t.showFilters),icon:"menu",round:"",flat:"",dense:""})]),_:1})]),_:1}),a(da,{modelValue:t.showFilters,"onUpdate:modelValue":e[5]||(e[5]=n=>t.showFilters=n),bordered:"",side:"left"},{default:o(()=>[a(Z,{view:"hHh lpR lFr"},{default:o(()=>[a(W,{class:"bg-white"},{default:o(()=>[a(L,{class:"text-tertiary"},{default:o(()=>[a(c,{imagem:t.imagens[t.item.cliente.cpfCnpj],rotulo:t.item.cliente.apelido,tamanho:"36"},null,8,["imagem","rotulo"]),a(P,null,{default:o(()=>[a(p,{modelValue:t.item.cliente.nome,"onUpdate:modelValue":e[1]||(e[1]=n=>t.item.cliente.nome=n),rotulo:"Cliente",dense:"","somente-leitura":"",after:[{icon:"edit",handler(){r.buscarContato("cliente")}}],ajuda:t.item.cliente.cpf},null,8,["modelValue","after","ajuda"])]),_:1}),a(b,{onClick:e[2]||(e[2]=n=>t.showFilters=!t.showFilters),icon:"close",round:"",flat:"",dense:""})]),_:1})]),_:1}),a(G,null,{default:o(()=>[a(v,{gutter:"md"},{default:o(()=>[a(i,{col:"12"},{default:o(()=>[(f(!0),x(T,null,D(t.item.cliente.telefones,n=>(f(),C(v,{key:n,onClick:g=>r.abrirTelefone(n.telefone),mg:"sm-b",bordered:"bottom",class:"cursor-pointer"},{default:o(()=>[a(i,{col:"shrink"},{default:o(()=>[a(I,{name:n.tipoTelefone==="WhatsApp"?"mdi-whatsapp":"phone",color:n.tipoTelefone==="WhatsApp"?"green":"tertiary",size:"sm"},null,8,["name","color"])]),_:2},1024),a(i,{col:"xs"},{default:o(()=>[a(h,null,{default:o(()=>[d(_(n.telefone),1)]),_:2},1024),a(h,{text:"caption light"},{default:o(()=>[d(_(n.tipoTelefone),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),z(a(v,{mg:"sm-b",bordered:"bottom",class:"cursor-pointer"},{default:o(()=>[a(i,{col:"shrink"},{default:o(()=>[a(I,{name:"alternate_email",size:"sm"})]),_:1}),a(i,{col:"xs"},{default:o(()=>[a(h,null,{default:o(()=>[d(_(t.item.cliente.email),1)]),_:1}),a(h,{text:"caption light"},{default:o(()=>[d("e-mail")]),_:1})]),_:1})]),_:1},512),[[K,t.item.cliente.email]]),z(a(v,{mg:"sm-b",bordered:"bottom",class:"cursor-pointer"},{default:o(()=>[a(i,{col:"shrink"},{default:o(()=>[a(I,{name:"business",size:"sm"})]),_:1}),a(i,{col:"xs"},{default:o(()=>[a(h,null,{default:o(()=>[d(_(t.item.cliente.endereco),1)]),_:1}),a(h,{text:"caption light"},{default:o(()=>[d(_(t.item.cliente.tipoEndereco),1)]),_:1})]),_:1})]),_:1},512),[[K,t.item.cliente.endereco]]),a(v,null,{default:o(()=>[a(i,{col:"12"},{default:o(()=>[a(ca,{modelValue:t.tabsModel,"onUpdate:modelValue":e[3]||(e[3]=n=>t.tabsModel=n),color:"transparent","text-color":"primary",class:"q-mt-md"},{default:o(()=>[a(X,{name:"xtab-1",label:"Pendentes",class:"q-py-none q-px-lg",default:""}),a(X,{name:"xtab-2",label:"Conclu\xEDdas",class:"q-py-none q-px-lg"})]),_:1},8,["modelValue"]),a(ma,{modelValue:t.tabsModel,"onUpdate:modelValue":e[4]||(e[4]=n=>t.tabsModel=n),class:"q-pa-none",style:{"border-top":"1px solid rgba(255, 255, 255, 0.25)"}},{default:o(()=>[a(aa,{name:"xtab-1",class:"q-pa-none"},{default:o(()=>[a(N,{highlight:"","no-border":"",separator:"",class:"q-pa-none"},{default:o(()=>[(f(!0),x(T,null,D(t.dadosClientes,n=>(f(),C(U,{key:n,onClick:g=>l.abrirItem(n)},{default:o(()=>[a(k,{avatar:""},{default:o(()=>[a(c,{imagem:n.photo,tamanho:"30"},null,8,["imagem"])]),_:2},1024),a(k,null,{default:o(()=>[a(A,null,{default:o(()=>[d(_(n.name),1)]),_:2},1024),a(A,{caption:""},{default:o(()=>[d(_(n.email),1)]),_:2},1024),a(A,{caption:""},{default:o(()=>[d(_(n.tel),1)]),_:2},1024),a(s,{class:"q-col-gutter-x-sm q-mt-xs"},{default:o(()=>[a(j,{class:"q-ml-sm",escuro:"",cor:"positive"},{default:o(()=>[d("Tag")]),_:1}),a(j,{class:"q-ml-sm",escuro:"",cor:"primary"},{default:o(()=>[d("Tag")]),_:1})]),_:1})]),_:2},1024),a(k,{avatar:"",right:""},{default:o(()=>[a(b,{flat:"",dense:"",icon:"more_vert",round:"",size:"md"},{default:o(()=>[a(R,null,{default:o(()=>[z((f(),C(N,{link:"","no-border":"",separator:"",class:"q-pa-none"},{default:o(()=>[a(U,null,{default:o(()=>[a(k,{avatar:""},{default:o(()=>[a(I,{name:"edit"})]),_:1}),a(k,null,{default:o(()=>[a(A,null,{default:o(()=>[d("Editar")]),_:1})]),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),_:1})]),_:1})]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),a(aa,{name:"xtab-2",class:"q-pa-none"},{default:o(()=>[a(N,{highlight:"","no-border":"",separator:"",class:"q-pa-none"},{default:o(()=>[(f(!0),x(T,null,D(t.dadosClientes,n=>(f(),C(U,{key:n,onClick:g=>l.abrirItem(n)},{default:o(()=>[a(k,{avatar:""},{default:o(()=>[a(c,{imagem:n.photo,tamanho:"30"},null,8,["imagem"])]),_:2},1024),a(k,null,{default:o(()=>[a(A,null,{default:o(()=>[d(_(n.name),1)]),_:2},1024),a(A,{caption:""},{default:o(()=>[d(_(n.email),1)]),_:2},1024),a(A,{caption:""},{default:o(()=>[d(_(n.tel),1)]),_:2},1024),a(s,{class:"q-col-gutter-x-sm q-mt-xs"},{default:o(()=>[a(j,{class:"q-ml-sm",escuro:"",cor:"positive"},{default:o(()=>[d("Tag")]),_:1}),a(j,{class:"q-ml-sm",escuro:"",cor:"primary"},{default:o(()=>[d("Tag")]),_:1})]),_:1})]),_:2},1024),a(k,{avatar:"",right:""},{default:o(()=>[a(b,{flat:"",dense:"",icon:"more_vert",round:"",size:"md"},{default:o(()=>[a(R,null,{default:o(()=>[z((f(),C(N,{link:"","no-border":"",separator:"",class:"q-pa-none"},{default:o(()=>[a(U,null,{default:o(()=>[a(k,{avatar:""},{default:o(()=>[a(I,{name:"edit"})]),_:1}),a(k,null,{default:o(()=>[a(A,null,{default:o(()=>[d("Editar")]),_:1})]),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),_:1})]),_:1})]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(G,null,{default:o(()=>[a(fa,null,{default:o(()=>[a(v,{gutter:"md",items:"center"},{default:o(()=>[a(i,{col:"12 sm"},{default:o(()=>[a(p,{modelValue:t.item.assunto,"onUpdate:modelValue":e[6]||(e[6]=n=>t.item.assunto=n),modelModifiers:{trim:!0},rotulo:"Assunto"},null,8,["modelValue"])]),_:1}),a(i,{col:"12 sm-shrink"},{default:o(()=>{var n,g,V,O;return[a(j,{rotulo:t.item.status,cor:t.item.status==="Fechado"?"tertiary":"positive",escuro:"",class:"q-mr-sm"},null,8,["rotulo","cor"]),a(q,{id:(g=(n=t.item)==null?void 0:n.id)!=null?g:"",numero:(O=(V=t.item)==null?void 0:V.numero)!=null?O:"",cor:"tertiary"},null,8,["id","numero"])]}),_:1})]),_:1}),a(v,{gutter:"md"},{default:o(()=>[a(i,{col:"12 md8"},{default:o(()=>[a(v,{gutter:"md",mg:"md-b",bg:"bg-white"},{default:o(()=>{var n;return[a(i,{col:"12"},{default:o(()=>[a(h,{icon:"playlist_add_check sm tertiary left"},{default:o(()=>[d("Detalhe")]),_:1})]),_:1}),a(i,{col:"12"},{default:o(()=>[a(p,{modelValue:t.item.descricao,"onUpdate:modelValue":e[7]||(e[7]=g=>t.item.descricao=g),rotulo:"Descri\xE7\xE3o",tipo:"textoArea",rows:"4",filled:""},null,8,["modelValue"])]),_:1}),(n=t.item.pai)!=null&&n.id?(f(),C(i,{key:0,col:"12"},{default:o(()=>[a(h,{icon:"mdi-account-arrow-left sm",onClick:e[8]||(e[8]=g=>r.abrirTarefa(t.item.pai.id)),class:"cursor-pointer"},{default:o(()=>[d("Tarefa pai: "+_(t.item.pai.assunto),1)]),_:1})]),_:1})):E("",!0),a(i,{col:"12"},{default:o(()=>[a(p,{modelValue:t.item.operacao,"onUpdate:modelValue":e[9]||(e[9]=g=>t.item.operacao=g),rotulo:"opera\xE7\xE3o",tipo:"texto"},null,8,["modelValue"])]),_:1}),a(i,{col:"12 lg6"},{default:o(()=>[a(v,{items:"center"},{default:o(()=>[a(i,{col:"xs-shrink"},{default:o(()=>[a(c,{imagem:t.imagens[t.item.solicitante.cpf],rotulo:t.item.solicitante.nome,tamanho:"36"},null,8,["imagem","rotulo"])]),_:1}),a(i,{col:"xs"},{default:o(()=>[a(p,{modelValue:t.item.solicitante.nome,"onUpdate:modelValue":e[10]||(e[10]=g=>t.item.solicitante.nome=g),rotulo:"Solicitante",dense:"","somente-leitura":"",after:[{icon:"edit",handler(){r.buscarContato("solicitante")}}]},null,8,["modelValue","after"])]),_:1})]),_:1})]),_:1}),a(i,{col:"12 lg6"},{default:o(()=>[a(v,{items:"center"},{default:o(()=>[a(i,{col:"xs-shrink"},{default:o(()=>[a(c,{imagem:t.imagens[t.item.responsavel.cpf],rotulo:t.item.responsavel.nome,tamanho:"36"},null,8,["imagem","rotulo"])]),_:1}),a(i,{col:"xs"},{default:o(()=>[a(p,{modelValue:t.item.responsavel.nome,"onUpdate:modelValue":e[11]||(e[11]=g=>t.item.responsavel.nome=g),rotulo:"Respons\xE1vel",dense:"","somente-leitura":"",after:[{icon:"edit",handler(){r.buscarContato("responsavel")}}]},null,8,["modelValue","after"])]),_:1})]),_:1})]),_:1}),a(i,{col:"12 lg6"},{default:o(()=>[a(v,{items:"center"},{default:o(()=>[a(i,{col:"xs-shrink"},{default:o(()=>[a(c,{imagem:t.imagens[t.item.organizador.cpf],rotulo:t.item.organizador.nome,tamanho:"36"},null,8,["imagem","rotulo"])]),_:1}),a(i,{col:"xs"},{default:o(()=>[a(p,{modelValue:t.item.organizador.nome,"onUpdate:modelValue":e[12]||(e[12]=g=>t.item.organizador.nome=g),rotulo:"Organizador",dense:"","somente-leitura":"",after:[{icon:"edit",handler(){r.buscarContato("organizador")}}]},null,8,["modelValue","after"])]),_:1})]),_:1})]),_:1}),a(i,{col:"12 lg6"},{default:o(()=>[a(v,{items:"center"},{default:o(()=>[a(i,{col:"xs-shrink"},{default:o(()=>[a(c,{imagem:t.imagens[t.item.item.id],rotulo:t.item.item.descricao,tamanho:"36"},null,8,["imagem","rotulo"])]),_:1}),a(i,{col:"xs"},{default:o(()=>[a(p,{modelValue:t.item.item.descricao,"onUpdate:modelValue":e[13]||(e[13]=g=>t.item.item.descricao=g),rotulo:"Servi\xE7o",dense:"","somente-leitura":"",after:[{icon:"edit",handler(){r.buscarItem()}}]},null,8,["modelValue","after"])]),_:1})]),_:1})]),_:1}),a(i,{col:"12 lg6"},{default:o(()=>[a(p,{modelValue:t.item.dataLimite,"onUpdate:modelValue":e[14]||(e[14]=g=>t.item.dataLimite=g),rotulo:"Prazo",tipo:"data"},null,8,["modelValue"])]),_:1}),a(i,{col:"12 lg6"},{default:o(()=>[a(p,{modelValue:t.item.dataHoraFinalizado,"onUpdate:modelValue":e[15]||(e[15]=g=>t.item.dataHoraFinalizado=g),rotulo:"Finalizado",tipo:"data","somente-leitura":""},null,8,["modelValue"])]),_:1}),a(i,{col:"12"},{default:o(()=>[a(H,{modelValue:t.arrayTags,"onUpdate:modelValue":e[16]||(e[16]=g=>t.arrayTags=g),dense:"",before:[{icon:"local_offer",tooltip:"Tags"}]},null,8,["modelValue"])]),_:1})]}),_:1}),a(v,{gutter:"md",mg:"md-b",bg:"bg-white"},{default:o(()=>[a(i,{col:"shrink"},{default:o(()=>[a(h,{icon:"history sm tertiary left"},{default:o(()=>[d("Anota\xE7\xF5es")]),_:1})]),_:1}),a(i,null,{default:o(()=>[a(pa,{modelValue:t.termoBuscaAnotacao,"onUpdate:modelValue":[e[17]||(e[17]=n=>t.termoBuscaAnotacao=n),e[18]||(e[18]=n=>r.atualizarAnotacoes(t.item.anotacoes))],debounce:700,color:"none",dense:"",outlined:"",placeholder:"Filtrar",clearable:""},{prepend:o(()=>[a(I,{name:"mdi-filter"})]),_:1},8,["modelValue"])]),_:1}),a(i,{col:"12"},{default:o(()=>[(f(!0),x(T,null,D(t.anotacoesPorDia,n=>(f(),C(v,{gutter:"md-x",key:n},{default:o(()=>[a(i,{col:"12",bordered:"left"},{default:o(()=>[a(h,{caption:"",icon:"today 17px grey-7 left"},{default:o(()=>[d(_(l.$filters.data(n.data)),1)]),_:2},1024),(f(!0),x(T,null,D(n.anotacoes,g=>(f(),C(v,{key:g,mg:"md-t"},{default:o(()=>[a(i,{col:"xs-shrink"},{default:o(()=>[a(c,{imagem:t.imagens[g.usuario.cpf],tamanho:"36"},null,8,["imagem"])]),_:2},1024),a(i,{col:"xs"},{default:o(()=>[a(v,null,{default:o(()=>[a(i,{col:"12"},{default:o(()=>[a(h,null,{default:o(()=>[d(_(g.usuario.nome),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),(f(!0),x(T,null,D(g.anotacoes,V=>(f(),C(v,{key:V},{default:o(()=>[a(i,{col:"shrink"},{default:o(()=>[a(h,{caption:"",class:"q-mt-xs"},{default:o(()=>[d(_(l.$filters.hora(V.dataHoraCriacao,"",5)),1)]),_:2},1024)]),_:2},1024),a(i,null,{default:o(()=>[a(h,{bordered:"","rounded-borders":"",class:"q-pa-sm"},{default:o(()=>[d(_(V.texto),1)]),_:2},1024)]),_:2},1024),V.usuario.cpf===t.usuario.numeroDocumentoNacional?(f(),x(T,{key:0},[a(i,{col:"shrink"},{default:o(()=>[a(b,{icon:"delete",size:"sm",round:"",flat:"",dense:"",onClick:O=>r.excluirAnotacao(V.id),color:"tertiary"},null,8,["onClick"])]),_:2},1024),a(i,{col:"shrink"},{default:o(()=>[a(b,{icon:"edit",size:"sm",round:"",flat:"",dense:"",onClick:O=>r.editarAnotacao(V.id)},null,8,["onClick"])]),_:2},1024)],64)):E("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),a(v,{gutter:"md",bg:"bg-white"},{default:o(()=>[a(i,{col:"12"},{default:o(()=>[a(h,{icon:"history sm tertiary left"},{default:o(()=>[d("Apontamentos")]),_:1})]),_:1}),a(i,{col:"12"},{default:o(()=>[(f(!0),x(T,null,D(t.apontamentosPorDia,n=>(f(),C(v,{gutter:"md-x",key:n},{default:o(()=>[a(i,{col:"12",bordered:"left"},{default:o(()=>[a(h,{caption:"",icon:"today 17px grey-7 left"},{default:o(()=>[d(_(l.$filters.data(n.data)),1)]),_:2},1024),(f(!0),x(T,null,D(n.apontamentos,g=>(f(),C(v,{key:g,mg:"md-t"},{default:o(()=>[a(i,{col:"xs-shrink"},{default:o(()=>[a(c,{imagem:t.imagens[g.usuario.cpf],tamanho:"36"},null,8,["imagem"])]),_:2},1024),a(i,{col:"xs"},{default:o(()=>[a(v,null,{default:o(()=>[a(i,{col:"12"},{default:o(()=>[a(h,null,{default:o(()=>[d(_(g.usuario.nome),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(v,{mg:"md-t"},{default:o(()=>[a(i,{col:"2"},{default:o(()=>[a(h,null,{default:o(()=>[d("Iniciado")]),_:1})]),_:1}),a(i,{col:"2"},{default:o(()=>[a(h,null,{default:o(()=>[d("Finalizado")]),_:1})]),_:1}),a(i,{col:"2"},{default:o(()=>[a(h,null,{default:o(()=>[d("Dura\xE7\xE3o")]),_:1})]),_:1}),a(i,{col:"4"}),a(i,{col:"2"})]),_:1}),(f(!0),x(T,null,D(g.apontamentos,V=>(f(),C(v,{key:V},{default:o(()=>[a(i,{col:"2"},{default:o(()=>[a(h,null,{default:o(()=>[d(_(l.$filters.hora(V.dataHoraInicio,"",5)),1)]),_:2},1024)]),_:2},1024),!V.dataHoraFim&&V.usuario.cpf===t.usuario.numeroDocumentoNacional?(f(),C(i,{key:0,col:"2"},{default:o(()=>[a(b,{icon:"stop",color:"red",size:"sm",round:"",flat:"",dense:"",onClick:O=>r.pararContador(V.id)},null,8,["onClick"])]),_:2},1024)):(f(),C(i,{key:1,col:"2"},{default:o(()=>[a(h,null,{default:o(()=>[d(_(l.$filters.hora(V.dataHoraFim,"",5)),1)]),_:2},1024)]),_:2},1024)),a(i,{col:"2"},{default:o(()=>[a(h,null,{default:o(()=>[d(_((V.duracao||"").substr(0,5)),1)]),_:2},1024)]),_:2},1024),a(i,{col:"4"},{default:o(()=>[a(H,{modelValue:V.arrayTags,"onUpdate:modelValue":O=>V.arrayTags=O,dense:"",before:[{icon:"local_offer",tooltip:"Tags"}]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),V.usuario.cpf===t.usuario.numeroDocumentoNacional?(f(),x(T,{key:2},[a(i,{col:"1"},{default:o(()=>[a(b,{icon:"delete",size:"sm",round:"",flat:"",dense:"",onClick:O=>r.excluirApontamento(V.id),color:"tertiary"},null,8,["onClick"])]),_:2},1024),a(i,{col:"1"},{default:o(()=>[a(b,{icon:"edit",size:"sm",round:"",flat:"",dense:"",onClick:O=>r.editarApontamento(V.id)},null,8,["onClick"])]),_:2},1024)],64)):(f(),C(i,{key:3,col:"2"}))]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),a(i,{col:"12 md4"},{default:o(()=>[a(v,{gutter:"md",mg:"md-b",bg:"bg-white"},{default:o(()=>[a(i,{col:"12"},{default:o(()=>[a(h,{icon:"mdi-attachment sm tertiary left",bordered:"bottom",class:"q-pb-sm"},{default:o(()=>[d("Arquivos")]),_:1})]),_:1}),a(ta,{resize:{crop:!0,width:1e3,height:1e3},idTabelaMaster:t.item.id,arquivo:t.arquivos,tipoArquivo:"tarefaArquivo"},null,8,["idTabelaMaster","arquivo"])]),_:1}),a(v,{gutter:"md",mg:"md-b",bg:"bg-white"},{default:o(()=>[a(i,{col:"12"},{default:o(()=>[a(h,{icon:"mdi-format-list-checks sm tertiary left",bordered:"bottom",class:"q-pb-sm"},{default:o(()=>[d("Checklist")]),_:1})]),_:1}),a(i,{col:"12"},{default:o(()=>[(f(!0),x(T,null,D(t.arrayChecklist,n=>(f(),C(v,{key:n},{default:o(()=>[a(i,{col:"grow",onClick:g=>r.abrirTarefa(n.id),class:"cursor-pointer"},{default:o(()=>[a(h,null,{default:o(()=>[d(_(n.assunto),1)]),_:2},1024)]),_:2},1032,["onClick"]),a(i,{col:"shrink"},{default:o(()=>[a(b,{icon:"delete",size:"sm",round:"",flat:"",dense:"",onClick:g=>r.excluirChecklist(n.id),color:"tertiary"},null,8,["onClick"])]),_:2},1024),a(i,{col:"shrink"},{default:o(()=>[a(b,{icon:"edit",size:"sm",round:"",flat:"",dense:"",onClick:g=>r.abrirTarefa(n.id)},null,8,["onClick"])]),_:2},1024),a(i,{col:"shrink"},{default:o(()=>[a(ha,{"model-value":!!n.dataHoraFinalizado,"onUpdate:modelValue":g=>r.finalizarChecklist(n)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),a(i,{col:"12",text:"center"},{default:o(()=>[a(b,{onClick:r.adicionarChecklist,icon:"add",size:"sm",label:"Nova Tarefa",outline:"",color:"positive"},null,8,["onClick"])]),_:1})]),_:1}),a(v,{gutter:"md",mg:"md-b",bg:"bg-white"},{default:o(()=>[a(i,{col:"12"},{default:o(()=>[a(h,{icon:"people sm tertiary left",bordered:"bottom",class:"q-pb-sm"},{default:o(()=>[d("Convidados")]),_:1})]),_:1}),a(i,{col:"12"},{default:o(()=>[(f(!0),x(T,null,D(t.arrayConvidados,(n,g)=>(f(),C(v,{key:n},{default:o(()=>[a(i,{col:"shrink"},{default:o(()=>[a(c,{imagem:t.imagens[n.cpfCnpj],tamanho:"36"},null,8,["imagem"])]),_:2},1024),a(i,{col:"grow"},{default:o(()=>[a(h,null,{default:o(()=>[d(_(n.nome),1)]),_:2},1024),a(h,null,{default:o(()=>[d(_(n.email),1)]),_:2},1024),a(h,null,{default:o(()=>[d(_(n.observacoes),1)]),_:2},1024)]),_:2},1024),a(i,{col:"shrink"},{default:o(()=>[a(b,{onClick:V=>r.excluirConvidado(n.cpfCnpj),icon:"delete",size:"sm",dense:"",flat:"",round:"",color:"tertiary"},null,8,["onClick"])]),_:2},1024),a(i,{col:"shrink"},{default:o(()=>[a(b,{onClick:V=>r.editarConvidado(g),icon:"edit",size:"sm",dense:"",flat:"",round:"",color:"tertiary"},null,8,["onClick"])]),_:2},1024),a(i,{col:"12"},{default:o(()=>[a(H,{modelValue:n.arrayTags,"onUpdate:modelValue":V=>n.arrayTags=V,dense:"",before:[{icon:"local_offer",tooltip:"Tags"}]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),a(i,{col:"12",text:"center"},{default:o(()=>[a(b,{onClick:e[19]||(e[19]=n=>r.buscarContato("convidado")),icon:"add",size:"sm",label:"Convidado",outline:"",color:"positive"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(va,{class:"bg-light"},{default:o(()=>[w("div",Za,[a(v,{gutter:"md",items:"center"},{default:o(()=>[a(i,{col:"10 sm11"},{default:o(()=>[a(p,{modelValue:t.textoAnotacao,"onUpdate:modelValue":e[20]||(e[20]=n=>t.textoAnotacao=n),tipo:"textoArea",rows:"2",filled:"",borderless:"",placeholder:"Digite sua anota\xE7\xE3o"},null,8,["modelValue"])]),_:1}),a(i,{col:"2 sm1",text:"center"},{default:o(()=>[a(b,{onClick:r.adicionarAnotacao,icon:"mdi-send","text-color":"primary",color:"transparent",round:"",flat:""},null,8,["onClick"])]),_:1}),a(i,{col:"12 sm6"},{default:o(()=>[t.apontamentoIniciado?(f(),C(b,{key:1,icon:"stop",onClick:e[21]||(e[21]=n=>r.pararContador(t.apontamentoIniciado.id)),class:"float-left",round:"",flat:"",color:"red"})):(f(),C(b,{key:0,icon:"play_arrow",onClick:r.iniciarContador,class:"float-left",round:"",flat:"",color:"green"},null,8,["onClick"])),a(b,{icon:"group_add",round:"",flat:"",color:"tertiary",class:"q-mr-xs",onClick:e[22]||(e[22]=n=>r.buscarContato("convidado"))}),a(b,{icon:"mdi-attachment",round:"",flat:"",color:"tertiary",class:"q-mr-xs"}),a(b,{icon:"mdi-format-list-checks",round:"",flat:"",color:"tertiary",class:"q-mr-xs",onClick:r.adicionarChecklist},null,8,["onClick"])]),_:1}),a(i,{class:"12 sm6",text:"right"},{default:o(()=>[t.item.status==="Aberto"?(f(),C(b,{key:0,onClick:r.finalizar,label:"FINALIZAR",color:"negative",unelevated:""},null,8,["onClick"])):(f(),C(b,{key:1,onClick:r.reabrir,label:"Reabrir",color:"negative",unelevated:""},null,8,["onClick"])),a(b,{onClick:e[23]||(e[23]=n=>r.salvar({visivel:!1})),label:"SALVAR",color:"primary",unelevated:"",class:"q-ml-sm"}),a(b,{class:"q-ml-sm",color:"tertiary",flat:"",icon:"more_vert",round:""},{default:o(()=>[a(R,null,{default:o(()=>[a(N,{link:"",separator:""},{default:o(()=>[z((f(),C(U,{clickable:"",onClick:e[24]||(e[24]=n=>l.$refs.modalEditarJson.modal.visivel=!0)},{default:o(()=>[a(k,{avatar:""},{default:o(()=>[a(I,{name:"code"})]),_:1}),a(k,null,{default:o(()=>[a(A,null,{default:o(()=>[d("Editar json")]),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),a(la,{ref:"checkListCriar"},null,512),a(ia,{ref:"convidado"},null,512),a(ra,{ref:"anotacao"},null,512),a(sa,{ref:"apontamento"},null,512),a(na,{ref:"modalEditarJson"},null,512)]),_:1},8,["modelValue","onHide"])}var Ga=Q(Ja,[["render",Wa],["__scopeId","data-v-056c9689"]]);const oa={id:null,dataHoraCriacao:{de:S.formatDate(S.subtractFromDate(new Date,{months:3})).substr(0,10),ate:null},dataLimite:{de:null,ate:null},dataHoraFinalizado:{de:null,ate:null},assunto:null,descricao:null,status:null,tipo:"Tarefa",solicitante:{},organizador:{},responsavel:{},empresa:{},cliente:{}},Ka={components:{Lista:_a,Ficha:Ga},data(){return{imagens:{},lista:[],listaOriginal:[],mostrar:{barraTopo:!0,toolbarTitulo:!0,icone:"task",titulo:"Tarefas",filtroAvancado:!0,buscar:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:""},tabSelecionada:{valor:"Ativos"},tabs:[{valor:"Ativos",rotulo:"Ativos"},{valor:"Excluidos",rotulo:"Exclu\xEDdos"},{valor:"Todos",rotulo:"Todos"}],opcoesStatus:[],opcoesTipo:[],busca:"",buscaAnterior:"",filtros:$utils.clonarV2(oa),paginacao:{atual:1,maximo:1,total:1,limite:25,ordenacao:["dataHoraCriacao"],direcao:["desc"]}}},methods:{async atualizar(){try{$q.loading.show();const l={...this.filtros,dataHoraCriacao:{de:this.filtros.dataHoraCriacao.de?S.formatDate(this.filtros.dataHoraCriacao.de).substr(0,10):null,ate:this.filtros.dataHoraCriacao.ate?S.formatDate(S.addToDate(this.filtros.dataHoraCriacao.ate,{days:1})).substr(0,10):null},dataLimite:{de:this.filtros.dataLimite.de?S.formatDate(this.filtros.dataLimite.de).substr(0,10):null,ate:this.filtros.dataLimite.ate?S.formatDate(S.addToDate(this.filtros.dataLimite.ate,{days:1})).substr(0,10):null},dataHoraFinalizado:{de:this.filtros.dataHoraFinalizado.de?S.formatDate(this.filtros.dataHoraFinalizado.de).substr(0,10):null,ate:this.filtros.dataHoraFinalizado.ate?S.formatDate(S.addToDate(this.filtros.dataHoraFinalizado.ate,{days:1})).substr(0,10):null},cliente:{cpfCnpj:this.filtros.cliente.numeroDocumentoNacional},organizador:{cpf:this.filtros.organizador.numeroDocumentoNacional},responsavel:{cpf:this.filtros.responsavel.numeroDocumentoNacional},solicitante:{cpf:this.filtros.solicitante.numeroDocumentoNacional},empresa:{cnpj:this.filtros.empresa.numeroDocumentoNacional}},e=await $db.tarefa.ler({filtro:l,limit:this.paginacao.limite,page:this.paginacao.atual,sort:this.paginacao.ordenacao,dir:this.paginacao.direcao});Array.isArray(e.data)?(this.listaOriginal=e.data,this.paginacao.total=e.total,this.paginacao.maximo=e.totalPages):e.id===l.id?(this.listaOriginal=[e],this.paginacao.total=1,this.paginacao.maximo=1):(console.error("Falha ao atualizar tarefas",{resposta:e}),$utils.verificarErro(!0,"Falha ao atualizar tarefas")),this.busca?this.atualizarFiltroTermo():this.lista=$utils.clonarV2(this.listaOriginal),this.opcoesStatus=await $db.tarefa.lerStatus(),this.opcoesTipo=await $db.tarefa.lerTipos(),this.carregarImagens()}catch(l){$q.notifyError("Erro iniciar",l)}finally{$q.loading.hide()}},async atualizarFiltro(){this.busca===this.buscaAnterior?await this.atualizar():this.atualizarFiltroTermo()},atualizarFiltroTermo(){const l=$utils.removerAcentos((this.busca||"").toUpperCase()).split(" ").filter(Boolean);this.lista=this.listaOriginal.filter(e=>{const u=$utils.removerAcentos([e.assunto,e.descricao,...Object.values(e.tags).map(({texto:m})=>m)].filter(Boolean).join(" ")).toUpperCase();return l.reduce((m,t)=>m&&u.includes(t),!0)}),this.buscaAnterior=this.busca},async buscarContato(l){try{const e={cliente:"Cliente",solicitante:"Solicitante",responsavel:"Respons\xE1vel",organizador:"Organizador",convidado:"Convidado"}[l]||"Contato",u=await $g.promptContato.show({filtro:{ativo:!0,numeroDocumentoNacional:!0},placeholder:`Selecione o ${e}`});u&&(this.filtros[l]=u)}catch(e){$q.notifyError("N\xE3o foi possivel buscar contato",e)}},async abrirTarefa(l){this.$router.replace({params:{id:l}}),await this.$refs.ficha.show({id:l})},async carregarImagens(){var l,e;try{const u=this.lista.map(m=>{var t;return(t=m.responsavel)==null?void 0:t.cpf});for(const m of u)if(!!m&&this.imagens[m]===void 0){const t=await $db.contato.le({numeroDocumentoNacional:m});this.imagens[m]=(e=(l=t==null?void 0:t[0])==null?void 0:l.imagem)!=null?e:""}}catch(u){$q.notifyError("N\xE3o foi poss\xEDvel atualizar as imagens",u)}},async criarClick(){await this.$refs.ficha.show()},limparFiltrosClick(){this.filtros=$utils.clonarV2(oa),this.atualizar()}},async mounted(){const{id:l}=this.$route.params;l?await this.abrirTarefa(l):await this.atualizar()}},Xa={class:"mw80 text-center"};function ae(l,e,u,m,t,r){const c=y("campo"),p=y("BadgeCopiarUid"),i=y("avatar"),h=y("badge"),v=y("Lista",!0),j=y("Ficha");return f(),x("div",null,[a(v,{busca:t.busca,"onUpdate:busca":e[22]||(e[22]=s=>t.busca=s),onAtualizar:r.atualizarFiltro,onCriarClick:r.criarClick,onLimparFiltrosClick:r.limparFiltrosClick,lista:t.lista,tabSelecionada:t.tabSelecionada,tabs:t.tabs,paginacao:t.paginacao,mostrar:t.mostrar},{filtroCampos:o(()=>[a(c,{modelValue:t.filtros.id,"onUpdate:modelValue":e[0]||(e[0]=s=>t.filtros.id=s),rotulo:"ID",dense:"",class:"q-mb-xl"},null,8,["modelValue"]),a(c,{modelValue:t.filtros.dataHoraCriacao.de,"onUpdate:modelValue":e[1]||(e[1]=s=>t.filtros.dataHoraCriacao.de=s),tipo:"data",rotulo:"Data Criado",dense:"",class:"q-mb-xs"},null,8,["modelValue"]),a(c,{modelValue:t.filtros.dataHoraCriacao.ate,"onUpdate:modelValue":e[2]||(e[2]=s=>t.filtros.dataHoraCriacao.ate=s),tipo:"data",rotulo:"At\xE9",dense:"",clearable:"",class:"q-mb-xl"},null,8,["modelValue"]),a(c,{modelValue:t.filtros.dataLimite.de,"onUpdate:modelValue":e[3]||(e[3]=s=>t.filtros.dataLimite.de=s),tipo:"data",rotulo:"Data Limite",dense:"",clearable:"",class:"q-mb-xs"},null,8,["modelValue"]),a(c,{modelValue:t.filtros.dataLimite.ate,"onUpdate:modelValue":e[4]||(e[4]=s=>t.filtros.dataLimite.ate=s),tipo:"data",rotulo:"At\xE9",dense:"",clearable:"",class:"q-mb-xl"},null,8,["modelValue"]),a(c,{modelValue:t.filtros.dataHoraFinalizado.de,"onUpdate:modelValue":e[5]||(e[5]=s=>t.filtros.dataHoraFinalizado.de=s),tipo:"data",rotulo:"Data Finalizado",dense:"",clearable:"",class:"q-mb-xs"},null,8,["modelValue"]),a(c,{modelValue:t.filtros.dataHoraFinalizado.ate,"onUpdate:modelValue":e[6]||(e[6]=s=>t.filtros.dataHoraFinalizado.ate=s),tipo:"data",rotulo:"At\xE9",dense:"",clearable:"",class:"q-mb-xl"},null,8,["modelValue"]),a(c,{modelValue:t.filtros.status,"onUpdate:modelValue":e[7]||(e[7]=s=>t.filtros.status=s),opcoes:t.opcoesStatus,tipo:"seletor",rotuloFixo:"Status",filter:"",clearable:"",dense:"",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),a(c,{modelValue:t.filtros.tipo,"onUpdate:modelValue":e[8]||(e[8]=s=>t.filtros.tipo=s),opcoes:t.opcoesTipo,tipo:"seletor",rotuloFixo:"Tipo",filter:"",clearable:"",dense:"",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),a(c,{modelValue:t.filtros.assunto,"onUpdate:modelValue":e[9]||(e[9]=s=>t.filtros.assunto=s),rotulo:"Assunto",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(c,{modelValue:t.filtros.descricao,"onUpdate:modelValue":e[10]||(e[10]=s=>t.filtros.descricao=s),rotulo:"Descri\xE7\xE3o",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),w("div",{onClick:e[12]||(e[12]=s=>r.buscarContato("cliente")),class:"cursor-pointer itemHover q-mb-md"},[a(c,{modelValue:t.filtros.cliente.nome,"onUpdate:modelValue":e[11]||(e[11]=s=>t.filtros.cliente.nome=s),rotulo:"Cliente",dense:"","somente-leitura":"",clearable:"",after:[{icon:"edit",handler(){r.buscarContato("cliente")}}]},null,8,["modelValue","after"])]),w("div",{onClick:e[14]||(e[14]=s=>r.buscarContato("organizador")),class:"cursor-pointer itemHover q-mb-md"},[a(c,{modelValue:t.filtros.organizador.nome,"onUpdate:modelValue":e[13]||(e[13]=s=>t.filtros.organizador.nome=s),rotulo:"Organizador",dense:"","somente-leitura":"",clearable:"",after:[{icon:"edit",handler(){r.buscarContato("organizador")}}]},null,8,["modelValue","after"])]),w("div",{onClick:e[16]||(e[16]=s=>r.buscarContato("solicitante")),class:"cursor-pointer itemHover q-mb-md"},[a(c,{modelValue:t.filtros.solicitante.nome,"onUpdate:modelValue":e[15]||(e[15]=s=>t.filtros.solicitante.nome=s),rotulo:"Solicitante",dense:"","somente-leitura":"",clearable:"",after:[{icon:"edit",handler(){r.buscarContato("solicitante")}}]},null,8,["modelValue","after"])]),w("div",{onClick:e[18]||(e[18]=s=>r.buscarContato("responsavel")),class:"cursor-pointer itemHover q-mb-md"},[a(c,{modelValue:t.filtros.responsavel.nome,"onUpdate:modelValue":e[17]||(e[17]=s=>t.filtros.responsavel.nome=s),rotulo:"Respons\xE1vel",dense:"","somente-leitura":"",clearable:"",after:[{icon:"edit",handler(){r.buscarContato("responsavel")}}]},null,8,["modelValue","after"])]),w("div",{onClick:e[20]||(e[20]=s=>r.buscarContato("empresa")),class:"cursor-pointer itemHover q-mb-xl"},[a(c,{modelValue:t.filtros.empresa.nome,"onUpdate:modelValue":e[19]||(e[19]=s=>t.filtros.empresa.nome=s),rotulo:"Empresa",dense:"","somente-leitura":"",clearable:"",after:[{icon:"edit",handler(){r.buscarContato("empresa")}}]},null,8,["modelValue","after"])]),a(c,{modelValue:t.paginacao.limite,"onUpdate:modelValue":e[21]||(e[21]=s=>t.paginacao.limite=s),min:"1",rotulo:"Quantidade por p\xE1gina",tipo:"quantidade",dense:""},null,8,["modelValue"])]),itemLista:o(()=>[a(N,{bordered:"",class:"bg-white q-mb-xs rounded-borders"},{default:o(()=>[(f(!0),x(T,null,D(t.lista,s=>(f(),x("div",{key:s,class:"itemHover"},[a(U,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:o(()=>[a(k,{class:"hideonmobile col-auto q-pr-sm no-margin"},{default:o(()=>[w("div",Xa,[a(p,{id:s.id,numero:s.id,cor:"positive"},null,8,["id","numero"])])]),_:2},1024),a(k,{class:"col-xs col-sm no-margin"},{default:o(()=>[a(U,{class:"q-pa-none"},{default:o(()=>[a(k,{onClick:q=>r.abrirTarefa(s.id),class:"col-auto items-center cursor-pointer"},{default:o(()=>{var q,H;return[a(i,{imagem:t.imagens[(q=s.responsavel)==null?void 0:q.cpf],rotulo:(H=s.responsavel)==null?void 0:H.nome,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]}),_:2},1032,["onClick"]),a(k,{onClick:q=>r.abrirTarefa(s.id),class:"col cursor-pointer"},{default:o(()=>[a(A,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:o(()=>[d(_(s.assunto),1)]),_:2},1024),s.descricao?(f(),C(A,{key:0,caption:"",lines:"2",class:"text-tertiary ellipsis-2-lines"},{default:o(()=>[d(_(s.descricao),1)]),_:2},1024)):E("",!0),a(k,{class:"hideondesktop q-mt-sm"},{default:o(()=>[w("div",null,[a(p,{id:s.id,numero:s.id,cor:"positive"},null,8,["id","numero"]),s.status?(f(),C(h,{key:0,rotulo:s.status,cor:s.status==="Fechado"?"tertiary":"positive",escuro:"",class:"q-ml-xs"},null,8,["rotulo","cor"])):E("",!0),a(h,{rotulo:s.tipo,cor:"primary",escuro:"",class:"q-ml-xs"},null,8,["rotulo"])])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),a(k,{class:"col-xs col-sm no-margin"},{default:o(()=>[a(U,{class:"q-pa-none"},{default:o(()=>[a(k,{onClick:q=>r.abrirTarefa(s.id),class:"hideonmobile col cursor-pointer"},{default:o(()=>[a(A,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:o(()=>[d(_(l.$filters.data(s.dataHoraCriacao)),1)]),_:2},1024),a(A,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:o(()=>[d(_(l.$filters.data(s.dataLimite)),1)]),_:2},1024),a(A,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:o(()=>[d(_(l.$filters.data(s.dataHoraFinalizado)),1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),a(k,{onClick:q=>r.abrirTarefa(s.id),class:"hideonmobile maxw100 q-pl-sm no-margin cursor-pointer"},{default:o(()=>[s.status?(f(),C(ga,{key:0,color:s.status==="Fechado"?"tertiary":"positive","text-color":"white","multi-line":"",class:"col-auto q-mx-auto q-py-xs"},{default:o(()=>[d(_(s.status)+" ",1),a(M,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[d("Status")]),_:1})]),_:2},1032,["color"])):E("",!0)]),_:2},1032,["onClick"]),a(k,{onClick:q=>r.abrirTarefa(s.id),class:"hideonmobile maxw200 q-pl-sm no-margin cursor-pointer"},{default:o(()=>{var q,H;return[(q=s.solicitante)!=null&&q.nome?(f(),C(A,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:o(()=>[d(_(s.solicitante.nome)+" ",1),a(M,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[d("Solicitante")]),_:1})]),_:2},1024)):E("",!0),(H=s.responsavel)!=null&&H.nome?(f(),C(A,{key:1,caption:"",lines:"1",color:"tertiary",class:"ellipsis"},{default:o(()=>[d(_(s.responsavel.nome)+" ",1),a(M,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[d("Respons\xE1vel")]),_:1})]),_:2},1024)):E("",!0)]}),_:2},1032,["onClick"]),a(k,{onClick:q=>r.abrirTarefa(s.id),class:"hideonmobile maxw200 q-pl-sm no-margin cursor-pointer"},{default:o(()=>{var q,H;return[(q=s.empresa)!=null&&q.razaosocial?(f(),C(A,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:o(()=>[d(_(s.empresa.razaosocial)+" ",1),a(M,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[d("Empresa")]),_:1})]),_:2},1024)):E("",!0),(H=s.cliente)!=null&&H.razaosocial?(f(),C(A,{key:1,caption:"",lines:"1",color:"tertiary",class:"ellipsis"},{default:o(()=>[d(_(s.cliente.razaosocial)+" ",1),a(M,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[d("Cliente")]),_:1})]),_:2},1024)):E("",!0)]}),_:2},1032,["onClick"]),a(k,{class:"col-auto q-pl-sm no-margin"},{default:o(()=>[a(U,{class:"q-pa-none"},{default:o(()=>[a(k,{class:"hideonmobile q-pr-sm no-margin"},{default:o(()=>[a(b,{onClick:q=>r.abrirTarefa(s.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024),a(k,{class:"no-margin"},{default:o(()=>[a(b,{icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:o(()=>[a(R,null,{default:o(()=>[z((f(),C(N,{link:"","no-border":"",separator:""},{default:o(()=>[a(U,{onClick:q=>r.abrirTarefa(s.id),clickable:"",class:"hideondesktop cursor-pointer"},{default:o(()=>[a(k,{avatar:""},{default:o(()=>[a(I,{name:"edit"})]),_:1}),a(k,null,{default:o(()=>[d(" Editar ")]),_:1})]),_:2},1032,["onClick"]),a(U,{onClick:q=>l.duplicarItem(s),clickable:""},{default:o(()=>[a(k,{avatar:""},{default:o(()=>[a(I,{name:"control_point_duplicate"})]),_:1}),a(k,null,{default:o(()=>[d(" Duplicar Produto/Servi\xE7o ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),[[F]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(ba)]))),128))]),_:1})]),_:1},8,["busca","onAtualizar","onCriarClick","onLimparFiltrosClick","lista","tabSelecionada","tabs","paginacao","mostrar"]),a(j,{ref:"ficha",onAtualizar:r.atualizar},null,8,["onAtualizar"])])}var ue=Q(Ka,[["render",ae]]);export{ue as default};
