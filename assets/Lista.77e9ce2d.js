import{_ as N,o as m,i as v,w as t,f as a,s as K,B as L,E as O,e as c,C as q,D as k,L as U,bd as aa,y as j,p as f,M as X,O as ma,K as oa,A as ea,t as b,G as ta,H as pa,z as ia,d as P,F as W,r as Z,x as w,l as A,Q as G,I as la,$ as ra,be as ha,bg as fa,dD as va,dE as ga,bn as Ca,b0 as z,az as Y,P as x,R as p,j as $,N as J,S as D,u as _a,a6 as ya,k as F,dF as ba,bb as wa,Y as ka,Z as Aa,a4 as qa}from"./index.81269774.js";import{L as Da}from"./Lista.de253e62.js";import{Q as Va}from"./QDate.39aed954.js";import{G as Ea}from"./GenericModal.ca874dff.js";import{G as xa}from"./GChipsV2.973449a2.js";import{J as sa}from"./JsonViewer.d67158db.js";import{s as $a}from"./selecaoContaWhatsapp.3fa0b68a.js";import"./xlsx.09c1adc2.js";import"./QBtnDropdown.3309dfee.js";import"./QBtnGroup.d8322823.js";const Fa={data(){return{visivel:!1}},methods:{async anexar(e){const o=await this.toBase64(e[0]);await $utils.geeksApi({ret:{funcao:"D280149A-F8EA-4103-B4AA-656707767F19",idCampanha:this.idCampanha,anexo:o,nomeArquivo:e[0].name}}),this.resolve(!0),this.visivel=!1},onHide(){this.resolve()},async mostrar({idCampanha:e}){return this.idCampanha=e,this.visivel=!0,new Promise((o,l)=>{this.resolve=o})},toBase64(e){return new Promise((o,l)=>{const d=new FileReader;d.readAsDataURL(e),d.onload=()=>o(d.result),d.onerror=i=>l(i)})}}};function Ua(e,o,l,d,i,s){return m(),v(j,{modelValue:i.visivel,"onUpdate:modelValue":o[0]||(o[0]=u=>i.visivel=u),onHide:o[1]||(o[1]=u=>s.onHide())},{default:t(()=>[a(K,null,{default:t(()=>[a(L,null,{default:t(()=>[a(O,null,{default:t(()=>[c("Anexar")]),_:1}),q(a(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1}),a(aa,{"auto-expand":"",color:"none",class:"mobile-only",label:"Foto","hide-upload-btn":"","hide-upload-progress":"","dark-light":"",url:"",ref:"fotoCampo",factory:s.anexar},null,8,["factory"]),a(aa,{"auto-expand":"",color:"none",class:"mobile-hide",extensions:".jpg,.mp3,.mp4",label:"Anexo","hide-upload-btn":"","auto-upload":"","dark-light":"",url:"",ref:"fotoCampo",factory:s.anexar},null,8,["factory"])]),_:1})]),_:1},8,["modelValue"])}var Ba=N(Fa,[["render",Ua]]);const Ha={data(){return{visivel:!1,idContato:"",nome:"",apelido:"",email:"",telefone:""}},methods:{onHide(){this.resolve()},async mostrar({idCampanha:e}){return this.idCampanha=e,this.visivel=!0,new Promise((o,l)=>{this.resolve=o})},async salvarContato(){try{this.$q.loading.show(),(await $utils.geeksApi({ret:{funcao:"B18C0CB3-5EA1-4E1C-8C31-EB354E5E3DB1",idCampanha:this.idCampanha,idContato:this.idContato,nome:this.nome,apelido:this.apelido,telefone:this.telefone,email:this.email}})).data.ret.erro?$q.notifyError("ret.data.ret.erro"):(this.resolve(!0),this.cancelarContato())}finally{this.$q.loading.hide()}},cancelarContato(){this.idContato="",this.nome="",this.apelido="",this.email="",this.telefone="",this.visivel=!1},async abrirModalContato(){const e={ativo:!0},o=await $g.promptContato.show({filtro:e,placeholder:"Selecione"});if(!o)return;let d=(await $db.contato.leCompletoV3(o.id)).telefone.filter(function(i){return i.tipoTelefone.indexOf("WhatsApp")!==-1});this.idContato=o.id,this.nome=o.nome,this.apelido=o.apelido,this.telefone="",d.length!==0&&d[0].telefone&&(this.telefone=d[0].telefone),this.email=""}}};function Sa(e,o,l,d,i,s){const u=f("campo");return m(),v(j,{modelValue:i.visivel,"onUpdate:modelValue":o[3]||(o[3]=g=>i.visivel=g),onHide:o[4]||(o[4]=g=>s.onHide())},{default:t(()=>[a(K,{class:"row"},{default:t(()=>[a(L,{class:"bg-primary text-white row"},{default:t(()=>[a(O,null,{default:t(()=>[c("Contato")]),_:1}),q(a(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1}),a(X,{class:"col-12"},{default:t(()=>[a(u,{modelValue:i.nome,"onUpdate:modelValue":o[0]||(o[0]=g=>i.nome=g),rotulo:"Nome",after:[{icon:"search",handler:s.abrirModalContato}],rules:[g=>!!g||"Campo Obrigat\xF3rio"]},null,8,["modelValue","after","rules"]),a(u,{modelValue:i.apelido,"onUpdate:modelValue":o[1]||(o[1]=g=>i.apelido=g),class:"col-12",tipo:"texto",rotulo:"Apelido",rules:[g=>!!g||""]},null,8,["modelValue","rules"]),a(u,{modelValue:i.telefone,"onUpdate:modelValue":o[2]||(o[2]=g=>i.telefone=g),class:"col-12",tipo:"Telefone",rotulo:"Telefone",mask:"(##) #####-####",rules:[g=>!!g||"Campo Obrigat\xF3rio"]},null,8,["modelValue","rules"])]),_:1}),a(X,{class:"col-12"},{default:t(()=>[a(ma,{align:"right",class:"row"},{default:t(()=>[a(k,{flat:"",class:"bg-primary text-white row",onClick:s.salvarContato},{default:t(()=>[c("Salvar")]),_:1},8,["onClick"]),a(k,{flat:"",onClick:s.cancelarContato},{default:t(()=>[c("Cancelar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var za=N(Ha,[["render",Sa]]);const Pa={components:{GChipsV2:xa},data(){return{show:!1,filtro:[]}},emits:["hide","aplicar"],methods:{async handlerSeletor(e){var d,i;const o=(i=(d=this.props)==null?void 0:d.filtro[e])==null?void 0:i.handler;let l;!o||(l=await o(),l&&this.filtro[e].valor.push(l))},async aplicar(){let e=!1;this.$refs.form.getValidationComponents().forEach(o=>{!o.validate()&&!e&&(e=!0)}),!e&&this.$emit("aplicar",$utils.clonarV2(this.filtro))}},props:{props:Object},watch:{props(){var o,l,d,i;const e=[];for(const s of(l=(o=this.props)==null?void 0:o.filtro)!=null?l:[]){const u={};"campo"in s&&(u.campo=s.campo),"operador"in s&&(u.operador=s.operador),"valor"in s&&(u.valor=s.valor),e.push(u)}this.filtro=e,this.show=(i=(d=this.props)==null?void 0:d.show)!=null?i:!1}}},Ra={class:"col-12"},Ma={key:0,class:"col-4"},Ta={class:"col-8"},La=["onClick"],Oa={class:"col-12"},Na={class:"col-12"},Qa={class:"q-mb-sm"},ja={class:"col-md-6"},Ia={class:"row"},Ga={class:"col-6 col-md-6"},Ja={class:"col-6 col-md-6"},Wa={class:"col-md-6"},Ya={class:"row"},Ka={class:"col-6 col-md-6"},Xa={class:"col-6 col-md-6"},Za={class:"col-12"},ao={class:"q-mb-sm"},oo={class:"col-6 col-sm"},eo={class:"col-6 col-sm"};function to(e,o,l,d,i,s){const u=f("row"),g=f("campo"),C=f("GChipsV2");return m(),v(j,{modelValue:i.show,"onUpdate:modelValue":o[0]||(o[0]=h=>i.show=h),onHide:o[1]||(o[1]=h=>e.$emit("hide"))},{default:t(()=>[a(oa,{container:"",view:"hHh lpR fFf",class:"q-layout-modal bg-white"},{default:t(()=>[a(ea,null,{default:t(()=>[a(L,null,{default:t(()=>[a(O,null,{default:t(()=>[c(b(l.props.titulo),1)]),_:1}),q(a(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1})]),_:1}),a(ta,null,{default:t(()=>[a(pa,null,{default:t(()=>[a(ia,{ref:"form",class:"col q-pa-md"},{default:t(()=>[(m(!0),P(W,null,Z(i.filtro,(h,_)=>(m(),P("div",{key:_},[l.props.filtro[_].tipo==="botao"&&l.props.filtro[_].handler?(m(),v(u,{key:0,class:"q-mb-xl"},{default:t(()=>[w("div",Ra,[a(k,{color:"primary",icon:l.props.filtro[_].icone,label:l.props.filtro[_].titulo,onClick:y=>s.handlerSeletor(_),style:{width:"100%"}},null,8,["icon","label","onClick"])])]),_:2},1024)):A("",!0),l.props.filtro[_].tipo==="seletor"&&l.props.filtro[_].handler?(m(),v(u,{key:1,class:"q-mb-xl"},{default:t(()=>[h.operador?(m(),P("div",Ma,[a(g,{tipo:"seletor","rotulo-fixo":l.props.filtro[_].titulo,options:l.props.filtro[_].operadores,modelValue:h.operador,"onUpdate:modelValue":y=>h.operador=y},null,8,["rotulo-fixo","options","modelValue","onUpdate:modelValue"])])):A("",!0),w("div",Ta,[w("div",{onClick:y=>s.handlerSeletor(_)},[a(C,{modelValue:h.valor,"onUpdate:modelValue":y=>h.valor=y,class:"q-px-none",useInput:!1,placeholder:"Filtre por C\xF3digo, N\xFAmero..."},null,8,["modelValue","onUpdate:modelValue"])],8,La)])]),_:2},1024)):A("",!0),l.props.filtro[_].tipo==="seletor"&&l.props.filtro[_].opcoes?(m(),v(u,{key:2,class:"q-mb-xl"},{default:t(()=>[w("div",Oa,[a(g,{tipo:"seletor","rotulo-fixo":l.props.filtro[_].titulo,options:l.props.filtro[_].opcoes,modelValue:h.valor,"onUpdate:modelValue":y=>h.valor=y,clearable:""},null,8,["rotulo-fixo","options","modelValue","onUpdate:modelValue"])])]),_:2},1024)):A("",!0),l.props.filtro[_].tipo==="periodoDiaMes"?(m(),v(u,{key:3,class:"q-mb-xl"},{default:t(()=>[w("div",Na,[w("strong",Qa,b(l.props.filtro[_].titulo),1),a(u,null,{default:t(()=>{var y,B,R,M,T,n,V,I;return[w("div",ja,[c(" Data Inicial "),w("div",Ia,[w("div",Ga,[a(G,{label:"Dia",modelValue:h.valor.diaInicio,"onUpdate:modelValue":H=>h.valor.diaInicio=H,rules:(B=(y=l.props.filtro[_].rules)==null?void 0:y.diaInicio)!=null?B:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])]),w("div",Ja,[a(G,{label:"M\xEAs",modelValue:h.valor.mesInicio,"onUpdate:modelValue":H=>h.valor.mesInicio=H,rules:(M=(R=l.props.filtro[_].rules)==null?void 0:R.mesInicio)!=null?M:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])])])]),w("div",Wa,[c(" Data Final "),w("div",Ya,[w("div",Ka,[a(G,{label:"Dia",modelValue:h.valor.diaFim,"onUpdate:modelValue":H=>h.valor.diaFim=H,rules:(n=(T=l.props.filtro[_].rules)==null?void 0:T.diaFim)!=null?n:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])]),w("div",Xa,[a(G,{label:"M\xEAs",modelValue:h.valor.mesFim,"onUpdate:modelValue":H=>h.valor.mesFim=H,rules:(I=(V=l.props.filtro[_].rules)==null?void 0:V.mesFim)!=null?I:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])])])])]}),_:2},1024)])]),_:2},1024)):A("",!0),l.props.filtro[_].tipo==="periodoData"?(m(),v(u,{key:4,class:"q-mb-xl"},{default:t(()=>[w("div",Za,[w("strong",ao,b(l.props.filtro[_].titulo),1),a(u,null,{default:t(()=>[w("div",oo,[a(g,{modelValue:h.valor.inicio,"onUpdate:modelValue":y=>h.valor.inicio=y,rotulo:"In\xEDcio",clearable:"",tipo:"data"},null,8,["modelValue","onUpdate:modelValue"])]),w("div",eo,[a(g,{modelValue:h.valor.fim,"onUpdate:modelValue":y=>h.valor.fim=y,rotulo:"Fim",clearable:"",tipo:"data"},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024)])]),_:2},1024)):A("",!0)]))),128))]),_:1},512)]),_:1})]),_:1}),a(la,null,{default:t(()=>[a(L,{class:"bg-light"},{default:t(()=>[a(O,{class:"text-right"},{default:t(()=>[q(a(k,{flat:"",size:"md","no-ripple":"",color:"tertiary",label:"Cancelar",class:"q-mr-sm"},null,512),[[U]]),a(k,{"no-ripple":"",label:"Aplicar",color:"primary",unelevated:"",class:"no-shadow",onClick:s.aplicar},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var io=N(Pa,[["render",to]]);const lo={data(){return{visivel:!1,telefone:"",anexo:[],campanha:{},socket:{conectado:!1,socket:{}}}},emits:["atualizar"],methods:{onHide(){this.resolve({})},testarEnvio(){try{console.log("Envio de teste");const e=this.telefone,o=this.campanha.mensagem,l=localStorage.getItem("bancoDeDados"),d=this.anexo;this.whatsEnvia({funcao:"enviar mensagem",telDestino:e,mensa:o,anexo:d,banco:l}),console.log("Teste de campanha enviado"),this.visivel=!1}catch(e){console.log(e.message)}},whatsEnvia(e){if(this.socket=$g.conexaoWpp,this.socket.conectado)try{this.socket.socket.send(JSON.stringify(e))}catch(o){console.log(o.message)}},show(e,o){return this.visivel=!0,this.telefone="",this.campanha=e,this.anexo=o,new Promise((l,d)=>{this.resolve=l})}}},ro={class:"layout-padding"},so={class:"col-12"},no={class:"q-mt-lg text-right"};function co(e,o,l,d,i,s){const u=f("campo"),g=f("row");return m(),v(j,{modelValue:i.visivel,"onUpdate:modelValue":o[1]||(o[1]=C=>i.visivel=C),onHide:o[2]||(o[2]=C=>s.onHide())},{default:t(()=>[a(K,{class:"q-dialog-plugin"},{default:t(()=>[a(L,{class:"bg-primary text-white"},{default:t(()=>[a(O,null,{default:t(()=>[c("Testar Envio da Campanha")]),_:1}),q(a(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1}),w("div",ro,[a(ia,{class:"q-pa-md",onSubmit:s.testarEnvio},{default:t(()=>[a(g,{class:"items-center q-col-gutter-md"},{default:t(()=>[w("div",so,[a(u,{modelValue:i.telefone,"onUpdate:modelValue":o[0]||(o[0]=C=>i.telefone=C),tipo:"texto",rotulo:"Telefone"},null,8,["modelValue"])])]),_:1}),w("div",no,[q(a(k,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[U]]),a(k,{color:"primary",class:"text-white",unelevated:"",label:"Enviar Teste",type:"submit"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1},8,["modelValue"])}var uo=N(lo,[["render",co]]);const mo={components:{modalAnexo:Ba,modalContato:za,BadgeCopiarUid:ra,SeletorCampoTabela:ha,GenericModal:Ea,PromptGrupoUnico:fa,PromptSegmentoUnico:va,PromptOrigemMarketingUnico:ga,FiltroDinamico:io,JsonViewer:sa,CampanhaTesteEnvio:uo,selecaoContaWhatsapp:$a},data(){const e=new Date(new Date($utils.dataAtual()).toDateString()),l=new Date(e).setDate(1);return{campanha:{id:"",descricao:"Descri\xE7\xE3o",dataHoraCriacao:$utils.dataAtual(),status:"Rascunho",tipo:"",idContato:"",mensagem:"Mensagem",responsavel:"",idEmpresa:""},campanhaOriginal:{},campanhaContato:[],campanhaAnexo:[],contatoGrupo:[],vendedores:[],filtro:{periodo:{aniversario:{from:`${e.getFullYear()}-${e.getMonth()}-${e.getDate()}`,to:`${e.getFullYear()}-${e.getMonth()}-${e.getDate()+1}`},receitaVencida:{from:l,to:""}}},lastFimReceita:null,opcaoAdicionar:"",grupo:"",segmento:"",vendedor:"",visivel:!1,somenteLeitura:!1,modalTitle:"Filtre contatos",filtroDinamico:null,empresa:{},sistemaPai:"",objetoConexoes:{},opcoesTipo:[],contatoCampo:"",opcoesContatos:[]}},emits:["atualizar"],methods:{async atualizar({id:e}){try{this.$q.loading.show();const o=await $utils.geeksApi({ret:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",id:e}});this.campanha=o.data.ret.campanha,this.campanha.conexao||(this.campanha.conexao=this.clienteSistema.bancoDeDados),this.somenteLeitura=o.data.ret.campanha.status!=="Rascunho",this.campanhaOriginal=$utils.clonarV2(this.campanha),await this.$nextTick(),this.atualizarAnexo(o.data.ret.campanhaAnexo),this.atualizarContato(o.data.ret.campanhaContato)}catch(o){$q.notifyError("Ocorreu um erro ao atualizar",o)}finally{this.$q.loading.hide()}},async atualizarAnexo(e){try{await this.$nextTick(),this.campanhaAnexo=e}catch(o){$q.notifyError("Ocorreu um erro ao atualizar anexo",o)}},async atualizarContato(e){try{await this.$nextTick(),this.campanhaContato=e.map(o=>(o.ordenar=this.$utils.removerCaracteresEspeciais(o.nome),o)).sort((o,l)=>o.ordenar>l.ordenar?1:l.ordenar>o.ordenar?-1:0)}catch(o){$q.notifyError("Ocorreu um erro ao atualizar contato",o)}try{await this.$nextTick();const o={};for(const{conexaoEnvio:l}of this.campanhaContato)if(!o[l])if(!l)o[l]="Sem envio";else if(l.startsWith("cpf")){const d=l.substring(3),i=(await $db.contato.le({numeroDocumentoNacional:d}))[0];o[l]=(i==null?void 0:i.nome)+" - CPF"}else if(l.startsWith("cnpj")){const d=l.replace("_","/").substring(4),i=(await $db.hibrido.lista({table:"empresa",whereFilter:{numeroDocumentoNacional:d}}))[0];o[l]=((i==null?void 0:i.sigla)||(i==null?void 0:i.apelido))+" - CNPJ"}else o[l]=l;this.objetoConexoes=o}catch(o){$q.notifyError("Ocorreu um erro ao atualizar conexao de envio",o)}},verificarSeAlterouCampos(){return $utils.diferencaObjetos(this.campanhaOriginal,this.campanha)},async salvar(){let e=this.verificarSeAlterouCampos();Object.keys(e).length!==0&&(e.funcao="65A200F2-9B9F-40E6-BD3A-282B77FC6BFB",e.id=this.campanha.id,await $utils.geeksApi({ret:e}))},async salvar_click(e){try{$q.loading.show(),this.campanha.idContato||(this.campanha.idContato=$db.usuario.logado.id),await this.salvar(),e||(this.$router.replace({params:{id:""}}),this.$emit("atualizar"),this.visivel=!1)}catch(o){$q.notifyError("Ocorreu um erro ao salvar",o)}finally{$q.loading.hide()}},async enviar_click(){if(this.campanhaContato.length===0){this.$q.notifyError("N\xE3o \xE9 permitido enviar campanha sem lista de contatos!");return}try{$q.loading.show(),this.campanha.status="Enviando",this.campanha.dataHoraDisparo=$utils.dataAtual(),this.campanha.log=`${await this.formatDate(new Date($utils.dataAtual()))} - Campanha disparada por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional}) 
${this.campanha.log||""}`,await this.salvar(),this.fechar()}catch(e){$q.notifyError("Ocorreu um erro!",e)}finally{$q.loading.hide()}},async rascunho_click(){try{$q.loading.show(),this.campanha.status="Rascunho",this.campanha.log=`${await this.formatDate(new Date($utils.dataAtual()))} - Campanha retornada para Rascunho por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional}) 
${this.campanha.log||""}`,await this.salvar(),this.fechar()}catch(e){$q.notifyError("Ocorreu um erro!",e)}finally{$q.loading.hide()}},async mostrar(e){await this.atualizar(e),this.visivel=!0},fechar(){this.$router.replace({params:{id:""}}),this.$emit("atualizar"),this.visivel=!1},async anexar_click(){const e=this.campanha.id;await this.$refs.modalAnexo.mostrar({idCampanha:e})&&(await this.salvar(),await this.atualizar({id:e}))},showFiltersModal(e){e==="carteira-aniversariantes"?this.modalTitle="Aniversariantes":e==="carteira-receitas-vencidas"&&(this.modalTitle="Receitas vencidas"),this.opcaoAdicionar=e,this.$refs.filtersModal.show()},async anexoDownload(e){const o=await $utils.geeksApi({item:{funcao:"B546B803-45E8-40B5-9F28-CFCC323AD5FD",id:e.id}});let l=document.createElement("a");l.href=o.data.item.anexo,l.download=o.data.item.nomeArquivo,l.click()},async anexoRemove(e){this.$q.dialog({cancel:{label:"Manter",push:!0,color:"tertiary",flat:!0},title:"Tem certeza?",message:"Ao continuar voc\xEA ir\xE1 perder esse anexo.",ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{if(this.campanhaContato.find(i=>i.status==="Enviado")){this.$q.notifyError("N\xE3o \xE9 permitido remover o anexo de uma campanha que j\xE1 foi enviada!");return}this.$q.loading.show();const o=this.campanha,l=o.id,d=await $utils.geeksApi({ret:{funcao:"BE8B810E-A49A-4B38-84B8-B758AD5064EF",id:e.id}});await this.atualizar({id:l}),this.campanha=o}finally{this.$q.loading.hide()}})},async adicionarContato(){const e=this.campanha.id;await this.$refs.modalContato.mostrar({idCampanha:e})&&(await this.salvar(),await this.atualizar({id:e}))},async adicionarPorGrupo(){let e=this.grupo;try{this.$q.loading.show(),await this.salvar();const o=this.campanha,l=o.id,d=await $utils.geeksApi({ret:{funcao:"ACC16F3A-88EC-43C6-A9B1-82828ED6E593",idCampanha:l,grupo:e,idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:l}),this.campanha=o}finally{this.$q.loading.hide()}},async adicionarPorSegmento(){let e=this.segmento;try{this.$q.loading.show(),await this.salvar();const o=this.campanha,l=o.id,d=await $utils.geeksApi({ret:{funcao:"3127C40C-0DD3-42A3-A37E-8ACACB52B88D",idCampanha:l,segmento:e,idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:l}),this.campanha=o}finally{this.$q.loading.hide()}},async adicionarPorVendedor(e){this.grupo="",this.$forceUpdate();try{this.$q.loading.show(),await this.salvar();const o=this.campanha,l=o.id,d=await $utils.geeksApi({ret:{funcao:"7B03B118-39D4-4BFB-9F64-12A7020F441F",idCampanha:l,idVendedor:e.id,idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:l}),this.campanha=o}finally{this.$q.loading.hide()}},async adicionarPorContato(e){this.grupo="",this.$forceUpdate();try{this.$q.loading.show(),await this.salvar();const o=this.campanha,l=o.id,d=await $utils.geeksApi({ret:{funcao:"61003235-3E37-4E2F-A7B7-A1F25FD12470",idCampanha:l,idContato:e.id}});this.showAddPositiveMsg(),await this.atualizar({id:l}),this.campanha=o}finally{this.$q.loading.hide()}},async adicionarPorDataAniversario(){let e=new Date(this.filtro.periodo.aniversario.from),o=new Date(this.filtro.periodo.aniversario.to);typeof this.filtro.periodo.aniversario=="string"&&(e=new Date(this.filtro.periodo.aniversario),o=new Date(this.filtro.periodo.aniversario));try{this.$q.loading.show(),await this.salvar();const d=this.campanha.id,i=await $utils.geeksApi({ret:{funcao:"E3BDE3F3-6D9A-424A-B4EB-B28E9757A1E5",idCampanha:d,ini:{mes:e.getMonth()+1,dia:e.getDate()},fim:{mes:o.getMonth()+1,dia:o.getDate()},idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:d})}finally{this.$q.loading.hide()}},async adicionarPorDataReceitaVencida(){const e=new Date(this.filtro.periodo.receitaVencida.from),o=new Date(this.filtro.periodo.receitaVencida.to);if(this.lastFimReceita&&this.lastFimReceita===o.toString())return!1;this.lastFimReceita=o.toString();try{this.$q.loading.show(),await this.salvar();const d=this.campanha.id,i=await $utils.geeksApi({ret:{funcao:"BA806BC5-CAF1-4673-AD4C-572B4AF8DB25",idCampanha:d,ini:{ano:e.getFullYear(),mes:e.getMonth()+1,dia:e.getDate()},fim:{ano:o.getFullYear(),mes:o.getMonth()+1,dia:o.getDate()},idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:d})}finally{this.$q.loading.hide()}},showAddPositiveMsg(){$q.notifyPositive("Contatos vinculados com sucesso!")},async contatoRemoveTodos(){this.$q.dialog({cancel:{label:"Voltar",push:!0,color:"tertiary",flat:!0},title:"Limpar?",message:"Ao continuar sua lista de envio ficar\xE1 limpa.",ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{if(this.campanhaContato.find(d=>d.status==="Enviado")){this.$q.notifyError("N\xE3o \xE9 permitido remover um contato para o qual a campanha j\xE1 foi enviada!");return}this.$q.loading.show();const e=this.campanha,o=e.id,l=await $utils.geeksApi({ret:{funcao:"AE0FFC21-984C-46E0-A9E6-6E8A192DC750",id:o}});await this.atualizar({id:o}),this.campanha=e}finally{this.$q.loading.hide()}})},async contatoRemove(e){try{if((e==null?void 0:e.status)!=="Enviado"){this.$q.loading.show();const o=this.campanha,l=o.id,d=await $utils.geeksApi({ret:{funcao:"15D77453-DEE7-4DD1-B34C-3F6C8D2CC687",id:e.id}});await this.atualizar({id:l}),this.campanha=o}e.status==="Enviado"&&this.$q.notifyError("N\xE3o \xE9 permitido remover um contato para o qual a campanha j\xE1 foi enviada!")}finally{this.$q.loading.hide()}},async concluirFiltros(){this.opcaoAdicionar==="contato-grupo"&&this.adicionarPorGrupo(),this.opcaoAdicionar==="carteira-vendedor"&&this.adicionarPorVendedor(),this.opcaoAdicionar==="carteira-aniversariantes"&&this.adicionarPorDataAniversario(),this.opcaoAdicionar==="carteira-receitas-vencidas"&&this.adicionarPorDataReceitaVencida()},async abrirModalMultiplos(){this.opcoesTipo=Ca.map(e=>({label:e.rotulo,value:e.valor})),this.filtroDinamico={show:!0,titulo:"Filtro",filtro:[{titulo:"Empresa",campo:"contatoIdEmpresa",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptContato.show({filtro:{ativo:!0,empresas:!0},placeholder:"Selecione a empresa"});return e?{value:e.id,label:e.apelido||e.nome}:!1}},{titulo:"Grupo",campo:"contatoGrupoDescricao",tipo:"seletor",operador:"and",operadores:[{label:"Cont\xE9m todos",value:"and"},{label:"Cont\xE9m pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptGrupoUnico.show();if(!!e.descricao)return{value:e.descricao,label:e.descricao}}},{titulo:"Carteira do Vendedor",campo:"contatoIdContatoVendedor",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptContato.show({filtro:{ativo:!0,vendedores:!0},placeholder:"Selecione o vendedor"});if(!!e)return{value:e.id,label:e.nome}}},{titulo:"Profiss\xE3o/Segmento",campo:"contatoSegmento",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptSegmentoUnico.show();if(!!e.descricao)return{value:e.descricao,label:e.descricao}}},{titulo:"Origem Marketing",campo:"contatoOrigemMarketing",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptOrigemMarketingUnico.show();if(!!e.descricao)return{value:e.descricao,label:e.descricao}}},{titulo:"Tipo de Produto",campo:"tipoProduto",tipo:"seletor",opcoes:this.opcoesTipo,valor:null},{titulo:"Sexo",campo:"contatoSexo",tipo:"seletor",opcoes:[{label:"Masculino",value:"Masculino"},{label:"Feminino",value:"Feminino"},{label:"Outro",value:"Outro"}],valor:null},{titulo:"Anivers\xE1rio",campo:"contatoDataAbertura",tipo:"periodoDiaMes",valor:{diaInicio:"",mesInicio:"",diaFim:"",mesFim:""}},{titulo:"Data da Venda",campo:"vendaDataHoraFinalizado",tipo:"periodoData",valor:{inicio:null,fim:null}}]},[23,37,40,42,52,53,57,58,63,68].includes(this.clienteSistema.codigoSistema)&&(this.filtroDinamico.filtro.push({titulo:"Data do Envelope",campo:"envelopeDataHoraFinalizado",tipo:"periodoData",valor:{inicio:null,fim:null}}),this.filtroDinamico.filtro.push({titulo:"Receitas Vencidas",campo:"receitaDataHoraFinalizado",tipo:"periodoData",valor:{inicio:null,fim:null}}))},async aplicarFiltroDinamico(e){try{if($q.loading.show(),await this.filtroVazio(e))return $q.notifyError("\xC9 necess\xE1rio pelo menos um filtro para aplic\xE1-lo.");await this.salvar();const o=(await $utils.geeksApi({payload:{funcao:"A8198AC8-69C0-41E2-92AE-109161145256",idCampanha:this.campanha.id,filtro:e}})).data.payload,l=o.filtrosUtilizados,d=o.qtdeContatos;if(l.length>0&&d>0){const i=await this.formatarFiltros(l);this.campanha.log=`${await this.formatDate(new Date($utils.dataAtual()))} - Adicionado os contatos por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional}) utilizando o(s) filtro(s) por:
${i}

${this.campanha.log||""}`,await this.salvar()}if(d===0){$q.notifyError("N\xE3o h\xE1 contatos para o filtro selecionado.");return}this.filtroDinamico=null,this.showAddPositiveMsg(),await this.atualizar({id:this.campanha.id})}catch(o){$q.notify({type:"negative",message:o.message}),console.error(o)}finally{$q.loading.hide()}},async filtroVazio(e){return e.every(o=>Array.isArray(o.valor)?o.valor.length===0:typeof o.valor=="object"&&o.valor!==null?Object.values(o.valor).every(l=>l===""||l===null):o.valor===null||o.valor===void 0)},async criar(){this.campanha={id:$utils.uuid(),descricao:"Descri\xE7\xE3o",dataHoraCriacao:$utils.dataAtual(),status:"Rascunho",tipo:"Whatsapp",mensagem:"Mensagem",idContato:$db.usuario.logado.id,responsavel:$db.usuario.logado.nome,conexao:this.clienteSistema.bancoDeDados,log:`${await this.formatDate(new Date($utils.dataAtual()))} - Campanha criada por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional})`},this.campanhaContato=[],this.campanhaAnexo=[],this.campanhaOriginal={},this.visivel=!0,this.somenteLeitura=!1},uploadClick(){this.$refs.Upload.click()},async abrirArquivo(e){const o=this.$refs.Upload.files;if(FileReader&&o&&o.length){var l=new FileReader;l.onload=()=>{},l.readAsDataURL(o[0]),await this.anexar(o[0])}},toBase64(e){return new Promise((o,l)=>{const d=new FileReader;d.readAsDataURL(e),d.onload=()=>o(d.result),d.onerror=i=>l(i)})},async anexar(e){await this.salvar();const o=await this.toBase64(e);await $utils.geeksApi({ret:{funcao:"D280149A-F8EA-4103-B4AA-656707767F19",idCampanha:this.campanha.id,anexo:o,nomeArquivo:e.name}}),await this.atualizar({id:this.campanha.id})},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)},async testarEnvio_click(){console.log("teste de Envio de Campanha");const e=[];this.campanhaAnexo&&this.campanhaAnexo.forEach(async o=>{const l=await this.buscaAnexo(o.id);e.push(l)}),await $utils.dormir(2e3),await this.$refs.testeEnvio.show(this.campanha,e)},async buscaAnexo(e){try{const o=await $utils.geeksApi({item:{funcao:"B546B803-45E8-40B5-9F28-CFCC323AD5FD",id:e}});return{anexo:o.data.item.anexo,nomeArquivo:o.data.item.nomeArquivo}}catch(o){console.log(o.message)}},async alteraResponsavelEmpresa(e){let o,l,d;e==="responsavel"&&(o={ativo:!0,usuario:!0},l="Selecione o respons\xE1vel",d="o respons\xE1vel"),e==="empresa"&&(o={ativo:!0,empresas:!0},l="Selecione a empresa",d="a empresa"),await $q.dialog({title:"Selecione uma das op\xE7\xF5es abaixo:",options:{type:"radio",model:"alterar",items:[{label:`Alterar ${d}`,value:"alterar",color:"primary"},{label:`Remover ${d}`,value:"remover",color:"negative"}]},cancel:{label:"CANCELAR",push:!0,color:"negative",flat:!0},ok:{label:"CONFIRMAR",push:!0,textColor:"primary",flat:!0}}).onOk(async i=>{if((await $utils.geeksApi({ler:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",id:this.campanha.id}})).data.ler.campanha||await this.salvar_click("rapido"),i==="remover")try{if(e==="responsavel"&&!this.campanha.idContato)return $q.notifyPositive("Nenhum respons\xE1vel vinculado para remover!");if(e==="empresa"&&!this.campanha.idEmpresa)return $q.notifyPositive("Nenhuma empresa vinculada para remover!");const u=await $utils.geeksApi({alterar:{funcao:"7FD8CA64-9FB6-4105-92D0-AC0603E09E3A",idCampanha:this.campanha.id,tipo:e,acao:i}});await this.atualizar({id:this.campanha.id}),$q.notifyPositive(`Removido ${d} com sucesso.`)}catch(u){$q.notifyError(`Ocorreu um erro ao remover ${d} da campanha!`),console.error(u)}if(i==="alterar")try{const u=await $g.promptContato.show({filtro:o,placeholder:l});if(e==="responsavel"&&!u){$q.notifyError("Nenhum respons\xE1vel selecionado!");return}if(e==="empresa"&&!u){$q.notifyError("Nenhuma empresa selecionada!");return}const g=await $utils.geeksApi({alterarConexao:{funcao:"7FD8CA64-9FB6-4105-92D0-AC0603E09E3A",idCampanha:this.campanha.id,tipo:e,acao:i,idContato:u.id,nomeContato:u.nome}});await this.atualizar({id:this.campanha.id}),$q.notifyPositive(`Alterado ${d} com sucesso.`)}catch(u){$q.notifyError(`Ocorreu um erro ao alterar ${d} da campanha!`),console.error(u)}}).onCancel(()=>{})},async formatDate(e){if(!(e instanceof Date))throw new Error('Argumento "data" inv\xE1lido. Voc\xEA deve passar uma inst\xE2ncia de data');const o=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),d=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),u=String(e.getSeconds()).padStart(2,"0");return`${d}/${l}/${o} - ${i}:${s}:${u}`},async whatsAlterarConta(e){this.campanha.conexao=e},async formatarFiltros(e){return e.length>1?e.join(`
`):e[0]},async contatoBuscar(e,o){try{if(e=e.trim(),this.opcoesContatos=[],e.length>1){const l=(await $db.contato.ler({filtros:{termoBusca:e,ativo:!0}})).data;this.opcoesContatos=l.map(d=>({data:d,label:`${d.apelido} | ${d.nome}`,stamp:"#0000000",sublabel:d.nome,value:d.nome}))}o()}catch{o(),this.$q.notify("Ocorreu um erro ao obter os contatos.")}},async contatoAdicionar(e){var o;this.grupo="",this.contatoCampo="",this.$forceUpdate();try{this.$q.loading.show(),await this.salvar();const l=this.campanha,d=l.id,i=await $utils.geeksApi({ret:{funcao:"61003235-3E37-4E2F-A7B7-A1F25FD12470",idCampanha:d,idContato:e.data.id}});if((o=i.data.ret)!=null&&o.erro){$q.notifyError(i.data.ret.erro);return}this.showAddPositiveMsg(),await this.atualizar({id:d}),this.campanha=l}finally{this.$q.loading.hide()}}},watch:{async"$route.params.id"(){const e=this.$route.params.id;!e||await this.mostrar({id:e})}},mounted(){this.sistemaPai=$utils.sistemaPai(),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema"))||{}}},po={class:"mw80 text-center"},ho={style:{padding:"10px","padding-bottom":"0px"}},fo={class:"u-container relative-position"};function vo(e,o,l,d,i,s){const u=f("ajuda"),g=f("g-label"),C=f("g-col"),h=f("badge"),_=f("BadgeCopiarUid"),y=f("g-row"),B=f("campo"),R=f("selecaoContaWhatsapp"),M=f("modalAnexo"),T=f("modalContato"),n=f("SeletorCampoTabela"),V=f("GenericModal"),I=f("PromptGrupoUnico"),H=f("PromptSegmentoUnico"),na=f("PromptOrigemMarketingUnico"),da=f("FiltroDinamico"),ca=f("JsonViewer"),ua=f("CampanhaTesteEnvio");return m(),P(W,null,[a(j,{modelValue:i.visivel,"onUpdate:modelValue":o[15]||(o[15]=r=>i.visivel=r),persistent:"",maximized:"",onKeyup:wa(s.fechar,["esc"])},{default:t(()=>[a(oa,{view:"hHh LpR fFf",container:"",class:"bg-light"},{default:t(()=>[a(ea,null,{default:t(()=>[a(L,null,{default:t(()=>[a(k,{onClick:s.fechar,icon:"arrow_back",round:"",flat:"",dense:""},null,8,["onClick"]),a(O,null,{default:t(()=>[c("Campanha: "+b(i.campanha.descricao),1)]),_:1}),a(u,{class:"q-ml-sm"}),q(a(k,{onClick:o[0]||(o[0]=r=>s.salvar_click()),label:"Salvar",color:"white","text-color":"primary",class:"q-ml-sm",unelevated:""},null,512),[[z,!i.somenteLeitura]]),e.$db.usuario.desenvolvedor()?(m(),v(k,{key:0,icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:t(()=>[a(Y,null,{default:t(()=>[q((m(),v(x,{clickable:"",onClick:o[1]||(o[1]=r=>s.mostrarJsonViewer())},{default:t(()=>[a(p,{avatar:""},{default:t(()=>[a($,{name:"mdi-file-replace",size:"sm"})]),_:1}),a(p,null,{default:t(()=>[c("Ver Objeto")]),_:1})]),_:1})),[[U]])]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1}),a(ta,{class:"u-container"},{default:t(()=>[a(y,{gutter:"md",mg:"md",bg:"bg-white"},{default:t(()=>[a(C,{col:"12"},{default:t(()=>[a(y,null,{default:t(()=>[a(C,{col:"xs",class:"center-header"},{default:t(()=>[a(g,{text:"sub1 medium",icon:"edit_note sm tertiary left"},{default:t(()=>[c("Detalhes")]),_:1})]),_:1}),a(C,{col:"xs-shrink",class:"center-header"},{default:t(()=>[a(h,{rotulo:i.campanha.status,cor:i.campanha.status==="Enviada"?"tertiary":"light",escuro:i.campanha.status==="Enviada"},null,8,["rotulo","cor","escuro"]),a(_,{id:i.campanha.id,cor:"positive",class:"q-mx-sm"},null,8,["id"]),a(k,{icon:"more_vert",flat:"",dense:"",round:"",size:"md"},{default:t(()=>[a(Y,null,{default:t(()=>[a(J,{link:"","no-border":"",separator:""},{default:t(()=>[q((m(),v(x,{clickable:"",onClick:o[2]||(o[2]=r=>s.alteraResponsavelEmpresa("responsavel"))},{default:t(()=>[a(p,{avatar:""},{default:t(()=>[a($,{name:"how_to_reg"})]),_:1}),a(p,null,{default:t(()=>[a(D,null,{default:t(()=>[c("Alterar respons\xE1vel")]),_:1})]),_:1})]),_:1})),[[U]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(C,{col:"12 md5"},{default:t(()=>{var r;return[a(B,{somenteLeitura:i.somenteLeitura||typeof((r=this.campanhaContato.find(E=>E.status==="Enviado"))==null?void 0:r.id)!="undefined",modelValue:i.campanha.descricao,"onUpdate:modelValue":o[3]||(o[3]=E=>i.campanha.descricao=E),rotulo:"Titulo da campanha",filled:"",dense:"",class:"q-md-b"},null,8,["somenteLeitura","modelValue"])]}),_:1}),a(C,{col:"12 md"},{default:t(()=>[a(B,{modelValue:i.campanha.responsavel,"onUpdate:modelValue":o[4]||(o[4]=r=>i.campanha.responsavel=r),rotulo:"Respons\xE1vel",somenteLeitura:"",filled:"",dense:"",class:"q-md-b"},null,8,["modelValue"])]),_:1}),a(C,{col:"12 md"},{default:t(()=>[a(R,{conta:i.campanha.conexao,onAtualizarConexao:o[5]||(o[5]=r=>s.whatsAlterarConta(r)),filled:""},null,8,["conta"])]),_:1}),a(C,{col:"12"},{default:t(()=>{var r;return[a(B,{modelValue:i.campanha.mensagem,"onUpdate:modelValue":o[6]||(o[6]=E=>i.campanha.mensagem=E),tipo:"textoArea",rotulo:"Mensagem",somenteLeitura:i.somenteLeitura||typeof((r=this.campanhaContato.find(E=>E.status==="Enviado"))==null?void 0:r.id)!="undefined"},null,8,["modelValue","somenteLeitura"])]}),_:1}),a(C,{col:"12"},{default:t(()=>[a(g,{caption:""},{default:t(()=>[c(" Voc\xEA pode usar os seguintes argumentos na mensagem para deixar ainda mais personalizado sua campanha: "),a(h,{class:"q-mr-xs"},{default:t(()=>[c("[Nome]")]),_:1}),a(h,{class:"q-mr-xs"},{default:t(()=>[c("[PrimeiroNome]")]),_:1}),a(h,{class:"q-mr-xs"},{default:t(()=>[c("[Apelido]")]),_:1}),a(h,{class:"q-mr-xs"},{default:t(()=>[c("[PrimeiroApelido]")]),_:1})]),_:1})]),_:1}),a(C,{col:"12"},{default:t(()=>[a(_a,{"expand-separator":"",icon:"description",label:"Log",caption:"Registro de atividades"},{default:t(()=>[a(K,null,{default:t(()=>[a(X,{style:{whiteSpace:"pre-wrap"}},{default:t(()=>[c(b(i.campanha.log),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(y,{gutter:"md",mg:"md",bg:"bg-white"},{default:t(()=>[a(C,{col:"12"},{default:t(()=>[a(k,{onClick:s.uploadClick,disable:!!i.campanhaContato.find(r=>r.status==="Enviado"),icon:"image",label:"Anexos","icon-right":"add",size:"md",outline:"","text-color":"tertiary",class:"full-width"},null,8,["onClick","disable"]),w("input",{ref:"Upload",type:"file",id:"Upload",onChange:o[7]||(o[7]=(...r)=>s.abrirArquivo&&s.abrirArquivo(...r)),style:{visibility:"hidden"}},null,544),(m(!0),P(W,null,Z(i.campanhaAnexo,r=>(m(),v(y,{key:r,gutter:"sm",mg:"sm-y",items:"center",bordered:"","rounded-borders":"",class:"itemHover"},{default:t(()=>[a(C,{col:"xs-shrink"},{default:t(()=>{var E,S;return[a(_,{id:(E=r==null?void 0:r.id)!=null?E:"",numero:((S=r==null?void 0:r.id)!=null?S:"").slice(-8),cor:"positive"},null,8,["id","numero"])]}),_:2},1024),a(C,{col:"xs",onClick:E=>s.anexoDownload(r),class:"cursor-pointer"},{default:t(()=>[a(g,{text:"bold",color:"tertiary"},{default:t(()=>[c(b(r.nomeArquivo),1)]),_:2},1024)]),_:2},1032,["onClick"]),a(C,{col:"xs-shrink"},{default:t(()=>[q(a(k,{onClick:E=>s.anexoRemove(r),disable:!!i.campanhaContato.find(E=>E.status==="Enviado"),icon:"delete",size:"md",color:"tertiary",round:"",flat:"",dense:""},null,8,["onClick","disable"]),[[z,!i.somenteLeitura]])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),a(y,{gutter:"md",mg:"md",items:"center",bg:"bg-white"},{default:t(()=>[a(C,{col:"xs"},{default:t(()=>[a(g,{text:"sub1 medium",icon:"person sm tertiary left"},{default:t(()=>[c("Contatos ("+b(i.campanhaContato.length)+")",1)]),_:1})]),_:1}),a(C,{col:"xs-shrink"},{default:t(()=>[a(ya,{modelValue:i.contatoCampo,"onUpdate:modelValue":[o[8]||(o[8]=r=>i.contatoCampo=r),s.contatoAdicionar],"use-input":"","input-debounce":"500",label:"Contatos",options:i.opcoesContatos,outlined:"",onFilter:s.contatoBuscar,dense:""},null,8,["modelValue","options","onFilter","onUpdate:modelValue"])]),_:1}),a(C,{col:"xs-shrink"},{default:t(()=>[q(a(k,{onClick:s.abrirModalMultiplos,icon:"add",size:"md",round:"",flat:"",dense:""},{default:t(()=>[a(F,null,{default:t(()=>[c(" Adicionar contatos por filtro ")]),_:1})]),_:1},8,["onClick"]),[[z,!i.somenteLeitura]]),q(a(k,{onClick:o[9]||(o[9]=r=>s.contatoRemoveTodos({})),disable:!!i.campanhaContato.find(r=>r.status==="Enviado"),icon:"delete",size:"md",color:"tertiary",round:"",flat:"",dense:"",class:"q-mr-xs"},{default:t(()=>[a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Excluir todos")]),_:1})]),_:1},8,["disable"]),[[z,!i.somenteLeitura]])]),_:1}),i.campanhaContato.length>0?(m(),v(C,{key:0,col:"xs12"},{default:t(()=>[a(ba,{items:i.campanhaContato,style:{"max-height":"65vh"}},{default:t(({item:r,index:E})=>[(m(),v(x,{key:E,class:"q-py-sm q-px-xs items-center border-full itemHover"},{default:t(()=>[a(p,{class:"hideonmobile col-auto q-pr-sm no-margin"},{default:t(()=>{var S,Q;return[w("div",po,[a(_,{id:(S=r==null?void 0:r.idContato)!=null?S:"",numero:((Q=r==null?void 0:r.idContato)!=null?Q:"").slice(-8),cor:"positive"},null,8,["id","numero"])])]}),_:2},1024),a(p,{clickable:""},{default:t(()=>[a(D,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:t(()=>[c(b(r.nome)+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Nome")]),_:1})]),_:2},1024),a(D,{caption:"",lines:"1",class:"text-tertiary ellipsis"},{default:t(()=>[c(b(r.apelido)+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Apelido")]),_:1})]),_:2},1024),a(p,{class:"hideondesktop q-mt-sm"},{default:t(()=>[a(y,{items:"center",class:"hideondesktop"},{default:t(()=>[a(C,{col:"12 sm-shrink"},{default:t(()=>{var S,Q;return[r!=null&&r.idContato?(m(),v(_,{key:0,id:(S=r==null?void 0:r.idContato)!=null?S:"",numero:((Q=r==null?void 0:r.idContato)!=null?Q:"").slice(-8),cor:"positive",class:"q-mr-sm"},null,8,["id","numero"])):A("",!0),a(h,{cor:r.status==="Enviado"?"tertiary":"light",escuro:r.status==="Enviado",rotulo:r.status==="Enviado"?"Enviado":"Rascunho",class:"q-mr-sm q-mb-sm"},null,8,["cor","escuro","rotulo"]),a(h,{cor:r!=null&&r.conexaoEnvio?"primary":"tertiary",escuro:!0,rotulo:i.objetoConexoes[r==null?void 0:r.conexaoEnvio]||"",class:"col-auto q-mx-auto"},null,8,["cor","rotulo"])]}),_:2},1024),r.dataHoraEnvio?(m(),v(C,{key:0,col:"12 sm-shrink",class:"q-mr-sm"},{default:t(()=>[a(g,{caption:"",icon:"mdi-calendar-today xs tertiary left"},{default:t(()=>[c(b(e.$filters.dataHora(r.dataHoraEnvio)),1)]),_:2},1024)]),_:2},1024)):A("",!0),r.telefone?(m(),v(C,{key:1,col:"12 sm-shrink",class:"q-mr-sm"},{default:t(()=>[a(g,{caption:"",icon:"phone xs tertiary left"},{default:t(()=>[c(b(r.telefone),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(p,{class:"hideonmobile maxw160 q-pl-sm no-margin"},{default:t(()=>[a(D,null,{default:t(()=>[a(g,{icon:"phone xs tertiary left",tip:"Telefone"},{default:t(()=>[c(b(r.telefone),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(p,{class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:t(()=>[r.dataHoraEnvio?(m(),v(D,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:t(()=>[a($,{name:"mdi-calendar-today"}),c(" "+b(e.$filters.data(r.dataHoraEnvio))+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Enviado \xE1s "+b(e.$filters.hora(r.dataHoraEnvio)),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1024),a(p,{class:"hideonmobile maxw90 q-pl-sm no-margin"},{default:t(()=>[a(h,{cor:r.status==="Enviado"?"tertiary":"light",escuro:r.status==="Enviado",rotulo:r.status==="Enviado"?"Enviado":"Rascunho",class:"col-auto q-mx-auto"},{default:t(()=>[a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Status")]),_:1})]),_:2},1032,["cor","escuro","rotulo"])]),_:2},1024),a(p,{class:"hideonmobile q-pl-sm no-margin",style:{"max-width":"max-content"}},{default:t(()=>[a(h,{cor:r!=null&&r.conexaoEnvio?"primary":"tertiary",escuro:!0,rotulo:i.objetoConexoes[r==null?void 0:r.conexaoEnvio]||"",class:"col-auto q-mx-auto"},{default:t(()=>[a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Conex\xE3o utilizada para envio da mensagem")]),_:1})]),_:2},1032,["cor","rotulo"])]),_:2},1024),q(a(p,{class:"col-auto q-pl-sm no-margin"},{default:t(()=>[a(k,{onClick:S=>s.contatoRemove(r),disable:r.status==="Enviado",icon:"delete",size:"md",color:"tertiary",round:"",flat:"",dense:""},null,8,["onClick","disable"])]),_:2},1536),[[z,!i.somenteLeitura]])]),_:2},1024))]),_:1},8,["items"])]),_:1})):A("",!0)]),_:1})]),_:1}),a(M,{ref:"modalAnexo"},null,512),a(T,{ref:"modalContato"},null,512),a(V,{ref:"filtersModal"},{genericHeader:t(()=>[c(b(i.modalTitle),1)]),genericContent:t(()=>[q(w("div",ho,[a(y,{items:"center",justify:"center"},{default:t(()=>[a(C,{class:"q-my-none q-mx-auto"},{default:t(()=>[i.opcaoAdicionar==="contato-grupo"?(m(),v(n,{key:0,modelValue:i.grupo,"onUpdate:modelValue":o[10]||(o[10]=r=>i.grupo=r),tabela:"contatoGrupo",campo:"label",label:"Filtre",buscarSemCaractere:!0,filtro:{ativo:!0,vendedores:!0}},null,8,["modelValue"])):A("",!0),i.opcaoAdicionar==="carteira-vendedor"?(m(),v(n,{key:1,modelValue:i.vendedor,"onUpdate:modelValue":o[11]||(o[11]=r=>i.vendedor=r),tabela:"contato",campo:"nome",label:"Filtre",buscarSemCaractere:!0,filtro:{ativo:!0,vendedores:!0},enableObj:!0},null,8,["modelValue"])):A("",!0),i.opcaoAdicionar==="carteira-aniversariantes"?(m(),v(y,{key:2,gutter:"md",mg:"md-l-ng",class:"date-without-year"},{default:t(()=>[a(C,{col:"12"},{default:t(()=>[a(Va,{modelValue:i.filtro.periodo.aniversario,"onUpdate:modelValue":o[12]||(o[12]=r=>i.filtro.periodo.aniversario=r),title:"Aniversariantes",range:"",subtitle:"Selecione um periodo"},null,8,["modelValue"])]),_:1})]),_:1})):A("",!0),i.opcaoAdicionar==="carteira-receitas-vencidas"?(m(),v(y,{key:3,gutter:"md",mg:"md-t",class:"invalid-recipes"},{default:t(()=>[a(C,{col:"12"},{default:t(()=>[a(B,{modelValue:i.filtro.periodo.receitaVencida.from,"onUpdate:modelValue":o[13]||(o[13]=r=>i.filtro.periodo.receitaVencida.from=r),tipo:"data",class:"no-shadow full-width",after:[{icon:"mdi-close-circle",handler(){i.filtro.periodo.receitaVencida.ini=""}}],rotulo:"De",dense:""},null,8,["modelValue","after"])]),_:1}),a(C,{col:"12"},{default:t(()=>[a(B,{modelValue:i.filtro.periodo.receitaVencida.to,"onUpdate:modelValue":o[14]||(o[14]=r=>i.filtro.periodo.receitaVencida.to=r),tipo:"data",class:"no-shadow full-width",after:[{icon:"mdi-close-circle",handler(){i.filtro.periodo.receitaVencida.fim=""}}],rotulo:"at\xE9",col:"12",dense:""},null,8,["modelValue","after"])]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1})],512),[[z,!i.somenteLeitura]])]),genericFooter:t(()=>[q(a(k,{onClick:s.concluirFiltros,label:"Avan\xE7ar",color:"primary",flat:""},null,8,["onClick"]),[[U]])]),_:1},512),a(la,{class:"bg-light q-pa-sm text-right u-bordaCima"},{default:t(()=>[w("div",fo,[q(a(k,{onClick:s.testarEnvio_click,type:"submit",icon:"send",label:"Testar Envio",color:"primary",unelevated:""},null,8,["onClick"]),[[z,!i.somenteLeitura]]),q(a(k,{onClick:s.enviar_click,type:"submit",icon:"send",label:"Enviar",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[z,!i.somenteLeitura]]),q(a(k,{onClick:s.rascunho_click,type:"submit",label:"Voltar para Rascunho",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[z,i.somenteLeitura]])])]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),a(I,{ref:"PromptGrupoUnico"},null,512),a(H,{ref:"PromptSegmentoUnico"},null,512),a(na,{ref:"PromptOrigemMarketingUnico"},null,512),a(da,{props:i.filtroDinamico,onAplicar:s.aplicarFiltroDinamico},null,8,["props","onAplicar"]),a(ca,{ref:"jsonViewer"},null,512),a(ua,{ref:"testeEnvio",onAtualizar:s.atualizar},null,8,["onAtualizar"])],64)}var go=N(mo,[["render",vo]]);const Co={components:{lista:Da,Avatar:ka,Badge:Aa,campanhaFicha:go,BadgeCopiarUid:ra,JsonViewer:sa},data(){return{lista:[],listaOriginal:[],listaLayout:{},paginacao:{atual:1,maximo:1,total:1,limite:25},filtros:{descricao:null,dataHoraCriacaoDe:null,dataHoraCriacaoAte:null,dataHoraDisparoDe:null,dataHoraDisparoAte:null,dataHoraUltimoDisparoDe:null,dataHoraUltimoDisparoAte:null,tipo:null,mensagem:null},buscaCampo:"",opcoesTipo:["Whatsapp"],tabSelecionada:{valor:"Rascunho"},tabs:[{rotulo:"Rascunhos",value:"Rascunho"},{rotulo:"Enviando",value:"Enviando"},{rotulo:"Enviadas",value:"Enviada"},{rotulo:"Todos",value:"Todos"}]}},methods:{async atualizar(){try{$q.loading.show();const e=this.paginacao.limite,o=this.paginacao.atual,l="descricao",d=$utils.eliminarVazios(this.filtros);d.status=this.tabSelecionada.valor,this.tabSelecionada.valor==="Todos"&&delete d.status,this.buscaCampo&&(d.termoBusca=this.buscaCampo);const i=(await $utils.geeksApi({ret:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",filtros:d,limit:e,page:o,sort:l}})).data.ret;i.total||(i.total=i.total=i.data.length),i.totalPages||(i.totalPages=i.total/e),this.listaLayout={};for(let s of i.data)this.listaLayout[s.id]={detalhes:!1};this.listaOriginal=$utils.clonarV2(i.data),this.lista=i.data,this.paginacao.total=i.total,this.paginacao.maximo=i.totalPages}catch(e){$q.notifyError("Erro iniciar",e)}finally{$q.loading.hide()}},async abrir(e){this.$router.replace({params:{id:e}}).finally(()=>{this.$refs.modalFicha.mostrar({id:e})})},async copiarCampanha(e){this.$q.dialog({title:"Duplicar Campanha?",message:"Deseja criar uma c\xF3pia desta campanha?",cancel:{label:"Voltar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{this.$q.loading.show();const o=await $utils.geeksApi({ret:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",id:e}}),l=$utils.clonar(o.data.ret.campanha),d=$utils.clonar(o.data.ret.campanhaContato),i=$utils.clonar(o.data.ret.campanhaAnexo);if(l.id=$utils.uuid(),l.status="Rascunho",l.dataHoraCriacao=new Date,l.dataHoraDisparo=null,l.dataHoraUltimoDisparo=null,l.log=null,await $utils.geeksApi({ret:{funcao:"65A200F2-9B9F-40E6-BD3A-282B77FC6BFB",...l}}),i.length>0)for(let s in i)i[s].id=$utils.uuid(),i[s].idCampanha=l.id,await $utils.geeksApi({ret:{funcao:"D280149A-F8EA-4103-B4AA-656707767F19",idCampanha:l.id,anexo:i[s].anexo,nomeArquivo:i[s].nomeArquivo}});if(d.length>0)for(let s of d)(await $utils.geeksApi({ret:{funcao:"B18C0CB3-5EA1-4E1C-8C31-EB354E5E3DB1",idCampanha:l.id,idContato:s.idContato,nome:s.nome,apelido:s.apelido,telefone:s.telefone,email:s.email}})).data.ret.erro?$q.notifyError("ret.data.ret.erro"):console.log("contato adicionado!");this.atualizar(),this.editarCopiaCampanha_click(l.id)}catch(o){console.log(o.message)}finally{this.$q.loading.hide()}})},editarCopiaCampanha_click(e){this.$q.dialog({title:"Campanha duplicada",message:"Deseja editar agora a c\xF3pia da campanha?",cancel:{label:"N\xE3o",push:!0,class:"bg-linght",textColor:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(async()=>{try{this.$q.loading.show(),this.abrir(e)}catch(o){console.log(o.message)}finally{this.$q.loading.hide()}})},criar_click(){this.$refs.modalFicha.criar()},limparFiltros_click(){this.filtros={descricao:null,dataHoraCriacaoDe:null,dataHoraCriacaoAte:null,dataHoraDisparoDe:null,dataHoraDisparoAte:null,dataHoraUltimoDisparoDe:null,dataHoraUltimoDisparoAte:null,tipo:null,mensagem:null},this.atualizar()},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)},async deletarCampanhaRascunho(e){const o=await $utils.geeksApi({deletar:{funcao:"B0DD9B0A-F684-4829-8772-B42670470017",id:e}});o.data.deletar.erro===0?$q.notifyPositive(o.data.deletar.mensagem):$q.notifyError(o.data.deletar.mensagem),this.atualizar()}},async mounted(){this.atualizar(),this.$route.params.id&&this.$route.params.id.length&&this.abrir(this.$route.params.id)}},_o={class:"mw80 text-center"},yo={class:"text-weight-bold"},bo={class:"text-weight-bold"};function wo(e,o,l,d,i,s){const u=f("campo"),g=f("BadgeCopiarUid"),C=f("avatar"),h=f("badge"),_=f("g-col"),y=f("g-label"),B=f("g-row"),R=f("lista",!0),M=f("campanhaFicha"),T=f("JsonViewer");return m(),P("div",null,[a(R,{titulo:"Campanhas",icone:"campaign",buscaCampo:i.buscaCampo,"onUpdate:buscaCampo":o[10]||(o[10]=n=>i.buscaCampo=n),onCriar_click:s.criar_click,onFiltro_change:s.atualizar,onLimparFiltros_click:s.limparFiltros_click,lista:i.lista,listaLayout:i.listaLayout,paginacao:i.paginacao,filtros:i.filtros,tabSelecionada:i.tabSelecionada,tabs:i.tabs,opcoesTipo:i.opcoesTipo,checkboxVisible:!1,removerTodosVisible:!1,abrirTodosVisible:!1,exportarXLSXVisible:!1,multiplosBtnNovo:!1,showQuickAdd:!1,permissaoExtras:e.$db.usuario.desenvolvedor()},{menuExtras:t(()=>[q((m(),v(x,{clickable:"",onClick:o[0]||(o[0]=n=>s.mostrarJsonViewer())},{default:t(()=>[a(p,{avatar:""},{default:t(()=>[a($,{name:"mdi-file-replace",size:"sm"})]),_:1}),a(p,null,{default:t(()=>[c("Ver Objeto")]),_:1})]),_:1})),[[U]])]),filtroCampos:t(()=>[a(u,{modelValue:i.filtros.descricao,"onUpdate:modelValue":o[1]||(o[1]=n=>i.filtros.descricao=n),rotulo:"Titulo",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:i.filtros.dataHoraCriacaoDe,"onUpdate:modelValue":o[2]||(o[2]=n=>i.filtros.dataHoraCriacaoDe=n),rotulo:"Data cria\xE7\xE3o",tipo:"data",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:i.filtros.dataHoraCriacaoAte,"onUpdate:modelValue":o[3]||(o[3]=n=>i.filtros.dataHoraCriacaoAte=n),rotulo:"at\xE9",tipo:"data",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:i.filtros.dataHoraDisparoDe,"onUpdate:modelValue":o[4]||(o[4]=n=>i.filtros.dataHoraDisparoDe=n),rotulo:"Data disparo",tipo:"data",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:i.filtros.dataHoraDisparoAte,"onUpdate:modelValue":o[5]||(o[5]=n=>i.filtros.dataHoraDisparoAte=n),rotulo:"at\xE9",tipo:"data",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:i.filtros.dataHoraUltimoDisparoDe,"onUpdate:modelValue":o[6]||(o[6]=n=>i.filtros.dataHoraUltimoDisparoDe=n),rotulo:"Data \xFAltimo disparo",tipo:"data",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:i.filtros.dataHoraUltimoDisparoAte,"onUpdate:modelValue":o[7]||(o[7]=n=>i.filtros.dataHoraUltimoDisparoAte=n),rotulo:"at\xE9",tipo:"data",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:i.filtros.mensagem,"onUpdate:modelValue":o[8]||(o[8]=n=>i.filtros.mensagem=n),rotulo:"Mensagem",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:i.paginacao.limite,"onUpdate:modelValue":o[9]||(o[9]=n=>i.paginacao.limite=n),rotulo:"Quantidade por p\xE1gina",tipo:"quantidade",min:"1",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"])]),itemLista:t(()=>[a(J,{bordered:"",class:"bg-white q-mb-xs rounded-borders"},{default:t(()=>[(m(!0),P(W,null,Z(i.lista,n=>(m(),P("div",{key:n.id,class:"itemHover cursor-pointer"},[a(x,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:t(()=>[a(p,{class:"hideonmobile col-auto q-pr-sm no-margin"},{default:t(()=>[w("div",_o,[a(g,{id:n.id,cor:"positive"},null,8,["id"])])]),_:2},1024),a(p,{onClick:V=>s.abrir(n.id)},{default:t(()=>[a(x,{class:"q-pa-none"},{default:t(()=>[a(p,{class:"col-auto items-center"},{default:t(()=>[a(C,{imagem:n.imagem,rotulo:n.descricao,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]),_:2},1024),a(p,{class:"col"},{default:t(()=>[a(D,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:t(()=>[c(b(n.descricao),1)]),_:2},1024),a(p,{class:"hideondesktop q-mt-sm"},{default:t(()=>[a(B,{mg:"xs-b"},{default:t(()=>[a(_,{col:"xs12 sm-shrink"},{default:t(()=>[a(g,{id:n.id,numero:n.id.slice(-8),cor:"positive",escuro:"",class:"q-mr-sm"},null,8,["id","numero"]),a(h,{rotulo:n.status,cor:n.status!=="Rascunho"?"tertiary":"light",escuro:n.status!=="Rascunho",class:"q-mr-sm"},null,8,["rotulo","cor","escuro"])]),_:2},1024),a(_,{col:"xs12 sm-shrink"},{default:t(()=>[n.dataHoraCriacao?(m(),v(y,{key:0,tip:`Criado \xE1s ${e.$filters.hora(n.dataHoraCriacao)}`,icon:"mdi-calendar-today xs tertiary",inline:"",class:"q-mr-sm"},{default:t(()=>[c(b(e.$filters.data(n.dataHoraCriacao)),1)]),_:2},1032,["tip"])):A("",!0),n.dataHoraDisparo?(m(),v(y,{key:1,tip:`Disparado \xE1s ${e.$filters.hora(n.dataHoraDisparo)}`,icon:"mdi-calendar-today xs tertiary",inline:"",class:"q-mr-sm"},{default:t(()=>[c(b(e.$filters.data(n.dataHoraDisparo)),1)]),_:2},1032,["tip"])):A("",!0),n.dataHoraUltimoDisparo?(m(),v(y,{key:2,tip:`\xDAltimo disparo \xE1s ${e.$filters.hora(n.dataHoraUltimoDisparo)}`,icon:"mdi-calendar xs tertiary",inline:"",class:"q-mr-sm"},{default:t(()=>[c(b(e.$filters.data(n.dataHoraUltimoDisparo)),1)]),_:2},1032,["tip"])):A("",!0)]),_:2},1024),a(_,{col:"xs12 sm-shrink",class:"q-mr-sm"},{default:t(()=>[a(y,{inline:"",class:"q-mr-sm"},{default:t(()=>[c("Contatos: "),w("span",yo,b(n.qtdeContatos),1)]),_:2},1024),a(y,{inline:"",class:"q-mr-sm"},{default:t(()=>[c("Enviados: "),w("span",bo,b(n.qtdeEnviado),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:t(()=>[n.dataHoraCriacao?(m(),v(D,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:t(()=>[a($,{name:"mdi-calendar-today"}),c(" "+b(e.$filters.data(n.dataHoraCriacao))+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Criado \xE1s "+b(e.$filters.hora(n.dataHoraCriacao)),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:t(()=>[n.dataHoraDisparo?(m(),v(D,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:t(()=>[a($,{name:"mdi-calendar-today"}),c(" "+b(e.$filters.data(n.dataHoraDisparo))+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Disparado \xE1s "+b(e.$filters.hora(n.dataHoraDisparo)),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:t(()=>[n.dataHoraUltimoDisparo?(m(),v(D,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:t(()=>[a($,{name:"mdi-calendar"}),c(" "+b(e.$filters.data(n.dataHoraUltimoDisparo))+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("\xDAltimo disparo \xE1s "+b(e.$filters.hora(n.dataHoraUltimoDisparo)),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw90 q-pl-sm no-margin"},{default:t(()=>[a(h,{cor:n.status!=="Rascunho"?"tertiary":"light",escuro:n.status!=="Rascunho",class:"col-auto q-mx-auto"},{default:t(()=>[c(b(n.status)+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Status")]),_:1})]),_:2},1032,["cor","escuro"])]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw90 q-pl-sm no-margin"},{default:t(()=>[a(D,{lines:"1",class:"ellipsis text-tertiary text-weight-bold text-right"},{default:t(()=>[c(b(n.qtdeContatos),1)]),_:2},1024),a(D,{caption:"",class:"text-tertiary text-right"},{default:t(()=>[c("Contatos")]),_:1})]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw90 q-pl-sm no-margin"},{default:t(()=>[a(D,{lines:"1",class:"ellipsis text-tertiary text-weight-bold text-right"},{default:t(()=>[c(b(n.qtdeEnviado),1)]),_:2},1024),a(D,{caption:"",class:"text-tertiary text-right"},{default:t(()=>[c("Enviados")]),_:1})]),_:2},1032,["onClick"]),a(p,{class:"hideonmobile col-auto q-pl-sm no-margin"},{default:t(()=>[a(x,{class:"q-pa-none"},{default:t(()=>[a(p,{class:"q-pr-sm no-margin"},{default:t(()=>[a(k,{onClick:V=>s.abrir(n.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},{default:t(()=>[a(F,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[c("Editar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),a(p,{class:"no-margin"},{default:t(()=>[a(k,{icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:t(()=>[a(Y,null,{default:t(()=>[q((m(),v(J,{link:"","no-border":"",separator:""},{default:t(()=>[a(x,{onClick:V=>s.copiarCampanha(n.id),clickable:"",class:"itemHover"},{default:t(()=>[a(p,{avatar:""},{default:t(()=>[a($,{name:"content_copy"})]),_:1}),a(p,null,{default:t(()=>[a(D,null,{default:t(()=>[c(" Duplicar ")]),_:1})]),_:1})]),_:2},1032,["onClick"]),n.status==="Rascunho"&&n.qtdeEnviado===0?(m(),v(x,{key:0,onClick:V=>s.deletarCampanhaRascunho(n.id),clickable:"",class:"itemHover"},{default:t(()=>[a(p,{avatar:""},{default:t(()=>[a($,{name:"delete"})]),_:1}),a(p,null,{default:t(()=>[a(D,null,{default:t(()=>[c(" Excluir ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):A("",!0)]),_:2},1024)),[[U]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(p,{class:"hideondesktop col-auto q-pl-sm no-margin"},{default:t(()=>[a(k,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:t(()=>[a(Y,null,{default:t(()=>[q((m(),v(J,{link:"","no-border":"",separator:""},{default:t(()=>[a(x,{onClick:V=>s.abrir(n.id),clickable:"",class:"itemHover"},{default:t(()=>[a(p,{avatar:""},{default:t(()=>[a($,{name:"edit"})]),_:1}),a(p,null,{default:t(()=>[a(D,null,{default:t(()=>[c(" Editar ")]),_:1})]),_:1})]),_:2},1032,["onClick"]),a(x,{onClick:V=>s.copiarCampanha(n.id),clickable:"",class:"itemHover"},{default:t(()=>[a(p,{avatar:""},{default:t(()=>[a($,{name:"content_copy"})]),_:1}),a(p,null,{default:t(()=>[a(D,null,{default:t(()=>[c(" Duplicar ")]),_:1})]),_:1})]),_:2},1032,["onClick"]),n.status==="Rascunho"&&n.qtdeEnviado===0?(m(),v(x,{key:0,onClick:V=>s.deletarCampanhaRascunho(n.id),clickable:"",class:"itemHover"},{default:t(()=>[a(p,{avatar:""},{default:t(()=>[a($,{name:"delete"})]),_:1}),a(p,null,{default:t(()=>[a(D,null,{default:t(()=>[c(" Excluir ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):A("",!0)]),_:2},1024)),[[U]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(qa)]))),128))]),_:1})]),_:1},8,["buscaCampo","onCriar_click","onFiltro_change","onLimparFiltros_click","lista","listaLayout","paginacao","filtros","tabSelecionada","tabs","opcoesTipo","permissaoExtras"]),a(M,{ref:"modalFicha",onAtualizar:s.atualizar},null,8,["onAtualizar"]),a(T,{ref:"jsonViewer"},null,512)])}var Bo=N(Co,[["render",wo]]);export{Bo as default};
