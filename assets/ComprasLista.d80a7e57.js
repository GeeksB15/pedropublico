import{_ as nt,a4 as Ct,r as ge,o as M,d as Y,w as o,f as e,L as je,E as He,h as Te,i as Re,k as N,t as J,m as Ve,e as oe,G as be,Q as de,M as Ee,H as Ze,I as Xe,n as _e,b3 as kt,b4 as lt,be as St,bf as dt,U as Me,bg as ft,dl as pt,dm as Ue,J as Ye,a_ as rt,C as $e,by as vt,ar as ze,bd as xe,q as it,az as Le,O as Pe,R as me,S as Q,j as ce,T as se,z as Et,F as ke,s as Ne,B as fe,l as ut,aW as ht,D as ot,bF as bt,ei as Dt,c as tt,b_ as at,ej as Vt,as as Pt,at as xt,dn as Ft,aV as gt,y as zt,N as Tt}from"./index.9b156bba.js";import{L as Nt}from"./Lista.e33ba20c.js";import{S as At}from"./SeletorCfop.b494ce07.js";import{C as qt}from"./Campo.7909a0e7.js";import"./xlsx.d5d25b50.js";import"./QBtnDropdown.2d29d66b.js";import"./QBtnGroup.4d3a3d67.js";import"./QScrollArea.e1ed3c28.js";const Bt={components:{SeletorNcm:Ct,SeletorCfop:At,Campo:qt},data(){return{abaSelecionada:"tab1",historicoItem:[],tabelaHistoricoItem:{colunas:[{name:"fornecedor",label:"Fornecedor",align:"left"},{name:"dataCompra",label:"Data Compra",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"},{name:"valorCusto",label:"Valor de Custo",align:"right"},{name:"valorTotal",label:"Valor Total (Custo)",align:"right"}],paginacao:{page:1,rowsPerPage:5}},estoqueItem:[],tabelaEstoqueItem:{colunas:[{name:"empresa",label:"Empresa",align:"left"},{name:"tipoEstoque",label:"Tipo estoque",align:"right"},{name:"lote",label:"Lote",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"}],paginacao:{page:1,rowsPerPage:5}},compra:{},cfop:null,cstIcms:"",cstIpi:"",contaEstoque:[],impostoCstIpi:[],impostoIcmsModalidade:[],impostoCstIcms:[],impostoCstIcmsSt:[],documentoItem:{},imposto:{},item:{},visivel:!1,contasOpcoes:[],exibirIcms:!1,exibirIcmsSt:!1,exibirIpi:!1,somenteLeituraIcms:!1,somenteLeituraIcmsSt:!1,exibirHistorico:!1,exibirEstoque:!1,exibeCfop:!1}},emits:["salvar"],methods:{async mostrar(r,s,h){var t,c,v,_;this.compra=h,this.documentoItem=$utils.clonarV2(r),this.item=$utils.clonarV2(s),await this.consultarHistoricoItem(this.item),await this.consultarEstoqueItem(this.item);const w=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:1}}),a=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:21}});this.impostoCstIcms=w.concat(a).map(p=>({rotulo:p.numero.trim()+" - "+p.descr,valor:Number(p.numero)})).sort((p,y)=>Number(p.valor)-Number(y.valor)),this.impostoIcmsModalidade=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:3}})).map(p=>({rotulo:p.numero.trim()+" - "+p.descr,valor:Number(p.numero)})).sort((p,y)=>Number(p.valor)-Number(y.valor)),this.impostoCstIcmsSt=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:4}})).map(p=>({rotulo:p.numero.trim()+" - "+p.descr,valor:Number(p.numero)})).sort((p,y)=>Number(p.valor)-Number(y.valor)),this.impostoCstIpi=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:5}})).map(p=>({rotulo:p.numero.trim()+" - "+p.descr,valor:Number(p.numero)})).sort((p,y)=>Number(p.valor)-Number(y.valor)),this.contaEstoque=(await $db.hibrido.lista({table:"financeiroPlanoConta"})).map(p=>{var y,l,I;return{rotulo:(I=(l=(y=p==null?void 0:p.descricao)!=null?y:" - "+(p==null?void 0:p.classificacao))!=null?l:" - "+(p==null?void 0:p.caminho))!=null?I:"",valor:p.id}}).sort((p,y)=>Number(p.valor)-Number(y.valor));let i;(t=this.documentoItem)!=null&&t.idCfop&&(i=await $erp().cfop.where({id:this.documentoItem.idCfop}).first()),i===void 0&&console.log("CFOP inv\xE1lido");const m=this.documentoItem.total/(this.documentoItem.quantidade||1)||0;this.documentoItem.cfop=(c=i==null?void 0:i.cfop.toString())!=null?c:"",this.documentoItem.codigoCfop=(v=i==null?void 0:i.codigoCfop)!=null?v:null,this.documentoItem.idCfop=(_=i==null?void 0:i.id)!=null?_:null,this.documentoItem.valorBaseIcms=this.documentoItem.valorBaseIcms||m,this.documentoItem.valorBaseIpi=this.documentoItem.valorBaseIpi||m,this.documentoItem.valorBaseIcmsSt=this.documentoItem.valorBaseIcmsSt||m,this.calcularImpostos(),this.exibeCfop=!0,this.visivel=!0},async salvar(){try{if(this.exibirIcms||(this.documentoItem.modalidadeBaseCalculo=null,this.documentoItem.codigoCst=null,this.documentoItem.percentualIcms=0,this.documentoItem.valorIcms=0),this.exibirIcmsSt||(this.documentoItem.modalidadeBaseCalculoST=null,this.documentoItem.percentualIcmsSt=0,this.documentoItem.valorIcmsSt=0),this.exibirIpi||(this.documentoItem.codigoCstIpi=null,this.documentoItem.percentualIpi=0,this.documentoItem.valorIpi=0),Object.keys(this.documentoItem.cfop).length>0){const r=await $db.hibrido.lista({table:"cfop",where:{cfop:Number(this.documentoItem.cfop)}});this.documentoItem.codigoCfop=r[0].codigoCfop,this.documentoItem.idCfop=r[0].id}this.documentoItem.cfop&&delete this.documentoItem.cfop,this.$emit("salvar",this.documentoItem),this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1,this.visivel=!1}catch(r){$q.notifyError("Ocorreu um erro ao salvar o produto: ",r.message)}finally{$q.notifyPositive("Produto salvo com sucesso.")}},calcularImpostos(r){var p,y,l,I,n,b,d,g,S,D;let s=(p=this.documentoItem.valorBaseIcms)!=null?p:0,h=(y=this.documentoItem.valorBaseIpi)!=null?y:0,w=(l=this.documentoItem.valorBaseIcmsSt)!=null?l:0,a=(I=this.documentoItem.percentualIcms)!=null?I:0,i=(n=this.documentoItem.percentualIpi)!=null?n:0,m=(b=this.documentoItem.percentualIVA)!=null?b:0,t=(d=this.documentoItem.percentualIcmsSt)!=null?d:0,c=(g=this.documentoItem.valorIcms)!=null?g:0,v=(S=this.documentoItem.valorIpi)!=null?S:0,_=(D=this.documentoItem.valorIcmsSt)!=null?D:0;["valorBaseIcms","percentualIcms"].includes(r)&&(c=s*a/100),r==="valorIcms"&&(a=c/s*100),["valorBaseIpi","percentualIpi"].includes(r)&&(v=h*i/100),r==="valorIpi"&&(i=v/h*100),r==="valorBaseIcmsSt"&&(m=0,w>0&&s>0&&w>=s&&(m=(w-s)/s*100),_=w*t/100-c),r==="percentualIVA"&&(w=s*(1+m/100),_=w*t/100-c),r==="percentualIcmsSt"&&(_=w*t/100-c),r==="valorIcmsSt"&&(t=_/w*100),this.documentoItem.valorBaseIcmsSt=parseFloat(w.toFixed(2)),this.documentoItem.percentualIcms=parseFloat(a.toFixed(2)),this.documentoItem.percentualIcmsSt=parseFloat(t.toFixed(2)),this.documentoItem.percentualIpi=parseFloat(i.toFixed(2)),this.documentoItem.percentualIVA=parseFloat(m.toFixed(2)),this.documentoItem.valorIcms=parseFloat(c.toFixed(2)),this.documentoItem.valorIcmsSt=parseFloat(_.toFixed(2)),this.documentoItem.valorIpi=parseFloat(v.toFixed(2)),(this.documentoItem.modalidadeBaseCalculo||this.documentoItem.codigoCst||this.documentoItem.percentualIcms>0||this.documentoItem.valorIcms>0)&&(this.exibirIcms=!0),(this.documentoItem.modalidadeBaseCalculoST||this.documentoItem.percentualIcmsSt>0||this.documentoItem.valorIcmsSt>0)&&(this.exibirIcmsSt=!0),(this.documentoItem.codigoCstIpi||this.documentoItem.percentualIpi>0||this.documentoItem.valorIpi>0)&&(this.exibirIpi=!0)},async consultarCFOP(){var h,w;const r=this.documentoItem.cfop,s=await $erp().cfop.where({cfop:Number(r)}).first();s===void 0&&console.log("CFOP inv\xE1lido"),this.documentoItem.idCfop=(h=s==null?void 0:s.id)!=null?h:null,this.documentoItem.codigoCfop=(w=s==null?void 0:s.CodigoCFOP)!=null?w:null},async consultarHistoricoItem(r){const s={};(r==null?void 0:r.atual)&&Object.keys(r.atual).length>0&&(r=r.atual);const w=(await $db.hibrido.lista({table:"documentoItem",where:{idItem:r.id}})).filter(a=>(a.operacao==="Compra"||a.operacao==="Compra de Mercadoria")&&a.status==="Finalizado"&&a.operacaoFator===1&&a.quantidade>0);for(const a of w){const i=await $db.hibrido.le({table:"documento",id:a.idDocumento}),m=await $db.hibrido.le({table:"contato",id:i.idContato});s[a.idItem]||(s[a.idItem]={fornecedores:[]}),s[a.idItem].fornecedores.push({fornecedor:m.apelido||"",dataCompra:i.dataCompra||"",quantidade:a.quantidade||"",valorCusto:a.valorItem||"",valorTotal:a.valorItem*a.quantidade||""})}Object.keys(s).length>0?(this.historicoItem=s,this.historicoItem[r.id].fornecedores.sort((a,i)=>{const m=new Date(a.dataCompra||"1900-01-01");return new Date(i.dataCompra||"1900-01-01")-m})):this.historicoItem[r.id]={fornecedores:[]},this.exibirHistorico=!0},async consultarEstoqueItem(r){const s={};(r==null?void 0:r.atual)&&Object.keys(r.atual).length>0&&(r=r.atual);const h=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",where:{idItem:r.id},whereFilter:{tipoEstoque:"Dispon\xEDvel"}});for(const w of h){const a=await $db.hibrido.le({table:"contato",id:w.idEmpresa});s[w.idItem]||(s[w.idItem]={estoques:[]}),s[w.idItem].estoques.push({empresa:a.apelido||"",tipoEstoque:w.tipoEstoque||"",lote:w.lote||"-",quantidade:w.saldo||""})}Object.keys(s).length>0?(this.estoqueItem=s,this.estoqueItem[r.id].estoques.sort((w,a)=>{const i=Number(w.quantidade||0);return Number(a.quantidade||0)-i})):this.estoqueItem[r.id]={estoques:[]},this.exibirEstoque=!0},async fechar(){this.documentoItem.cfop&&delete this.documentoItem.cfop,this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1}}},Ot=["src"],Ut={key:0},Rt={key:0};function Lt(r,s,h,w,a,i){const m=ge("badge"),t=ge("g-col"),c=ge("g-row"),v=ge("campo"),_=ge("SeletorNcm"),p=ge("SeletorCfop"),y=ge("g-label");return M(),Y($e,{modelValue:a.visivel,"onUpdate:modelValue":s[36]||(s[36]=l=>a.visivel=l),persistent:""},{default:o(()=>[e(je,{container:"",view:"hHh Lpr fFf",class:"bg-white",style:{"max-width":"980px"}},{default:o(()=>[e(He,{class:"bg-primary"},{default:o(()=>[e(Te,{class:"bg-primary text-white"},{default:o(()=>[e(Re,null,{default:o(()=>[N(J(a.documentoItem.descricaoItem),1)]),_:1}),a.item.referencia?(M(),Y(m,{key:0,cor:"tertiary",class:"q-mr-sm"},{default:o(()=>[N(J(a.item.referencia)+" ",1),e(Ve,null,{default:o(()=>[N(" Refer\xEAncia ")]),_:1})]),_:1})):oe("",!0),a.item.codigoItem?(M(),Y(m,{key:1,cor:"positive",class:"q-mr-sm"},{default:o(()=>[N(" #"+J(a.item.codigoItem.toString().padStart(4,"0"))+" ",1),e(Ve,null,{default:o(()=>[N(" C\xF3digo Item ")]),_:1})]),_:1})):oe("",!0),be(e(de,{onClick:i.fechar,dense:"",flat:"",icon:"close",round:""},null,8,["onClick"]),[[Ee]])]),_:1})]),_:1}),e(Ze,null,{default:o(()=>[e(Xe,null,{default:o(()=>[e(c,{gutter:"md"},{default:o(()=>[e(t,null,{default:o(()=>[e(c,{class:"col-12 text-center"},{default:o(()=>[e(t,null,{default:o(()=>{var l,I,n,b,d,g;return[((l=a.item)==null?void 0:l.imagem)||((n=(I=a.item)==null?void 0:I.atual)==null?void 0:n.imagem)?(M(),_e("img",{key:0,src:((b=a.item)==null?void 0:b.imagem)||((g=(d=a.item)==null?void 0:d.atual)==null?void 0:g.imagem),alt:"",style:{"max-width":"33%"}},null,8,Ot)):oe("",!0)]}),_:1})]),_:1}),e(kt,{modelValue:a.abaSelecionada,"onUpdate:modelValue":s[0]||(s[0]=l=>a.abaSelecionada=l),align:"justify",dense:"","indicator-color":"light-blue-4",class:"text-primary q-px-sm"},{default:o(()=>[e(lt,{default:"",name:"tab1",icon:"info",label:"Detalhes",class:"cinza"}),e(lt,{name:"tab2",icon:"history",label:"Compras",class:"cinza"}),e(lt,{name:"tab3",icon:"compare_arrows",label:"Estoque",class:"cinza"})]),_:1},8,["modelValue"]),e(St,{modelValue:a.abaSelecionada,"onUpdate:modelValue":s[35]||(s[35]=l=>a.abaSelecionada=l),animated:"",class:"text-tertiary"},{default:o(()=>[e(dt,{name:"tab1",class:"q-px-sm"},{default:o(()=>[e(c,null,{default:o(()=>[e(t,null,{default:o(()=>[e(v,{modelValue:a.documentoItem.observacao,"onUpdate:modelValue":s[1]||(s[1]=l=>a.documentoItem.observacao=l),tipo:"textoArea",rotulo:"Observa\xE7\xE3o",dense:"",rows:"4"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(v,{modelValue:a.documentoItem.referenciaFornecedor,"onUpdate:modelValue":s[2]||(s[2]=l=>a.documentoItem.referenciaFornecedor=l),rotulo:"Refer\xEAncia Fornecedor"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(_,{modelValue:a.documentoItem.ncm,"onUpdate:modelValue":s[3]||(s[3]=l=>a.documentoItem.ncm=l),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(p,{modelValue:a.documentoItem.cfop,"onUpdate:modelValue":s[4]||(s[4]=l=>a.documentoItem.cfop=l),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:o(()=>[e(t,null,{default:o(()=>[e(y,{text:"sub1 medium"},{default:o(()=>[N("Estoque")]),_:1})]),_:1})]),_:1}),e(c,{items:"center"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(v,{modelValue:a.documentoItem.idPlanoContaEstoque,"onUpdate:modelValue":s[5]||(s[5]=l=>a.documentoItem.idPlanoContaEstoque=l),opcoes:a.contaEstoque,tipo:"seletor",ajuda:"Plano de Conta de Estoque para Entrada de Mercadoria",dense:"",outlined:"",rotulo:"Conta Estoque"},null,8,["modelValue","opcoes"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:o(()=>[e(t,null,{default:o(()=>[e(y,{text:"sub1 medium"},{default:o(()=>[N("Impostos")]),_:1})]),_:1})]),_:1}),e(c,null,{default:o(()=>[e(Me,{label:"ICMS",modelValue:a.exibirIcms,"onUpdate:modelValue":s[6]||(s[6]=l=>a.exibirIcms=l)},null,8,["modelValue"])]),_:1}),a.exibirIcms?(M(),Y(c,{key:0,items:"center"},{default:o(()=>[e(t,{col:"12 sm6"},{default:o(()=>[e(v,{modelValue:a.documentoItem.modalidadeBaseCalculo,"onUpdate:modelValue":s[7]||(s[7]=l=>a.documentoItem.modalidadeBaseCalculo=l),opcoes:a.impostoIcmsModalidade,"somente-leitura":a.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"ICMS (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),e(t,{col:"12 sm6"},{default:o(()=>[e(v,{modelValue:a.documentoItem.codigoCst,"onUpdate:modelValue":s[8]||(s[8]=l=>a.documentoItem.codigoCst=l),opcoes:a.impostoCstIcms,"somente-leitura":a.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"CST ICMS"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:o(()=>[e(v,{modelValue:a.documentoItem.valorBaseIcms,"onUpdate:modelValue":s[9]||(s[9]=l=>a.documentoItem.valorBaseIcms=l),onBlur:s[10]||(s[10]=l=>i.calcularImpostos("valorBaseIcms")),"somente-leitura":a.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:o(()=>[e(v,{modelValue:a.documentoItem.percentualIcms,"onUpdate:modelValue":s[11]||(s[11]=l=>a.documentoItem.percentualIcms=l),onBlur:s[12]||(s[12]=l=>i.calcularImpostos("percentualIcms")),"somente-leitura":a.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS %"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:o(()=>[e(v,{modelValue:a.documentoItem.valorIcms,"onUpdate:modelValue":s[13]||(s[13]=l=>a.documentoItem.valorIcms=l),onBlur:s[14]||(s[14]=l=>i.calcularImpostos("valorIcms")),"somente-leitura":a.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):oe("",!0),e(c,null,{default:o(()=>[e(Me,{label:"ICMS ST",modelValue:a.exibirIcmsSt,"onUpdate:modelValue":s[15]||(s[15]=l=>a.exibirIcmsSt=l)},null,8,["modelValue"])]),_:1}),a.exibirIcmsSt?(M(),Y(c,{key:1,items:"center"},{default:o(()=>[e(t,{col:"12 sm6"},{default:o(()=>[e(v,{modelValue:a.documentoItem.modalidadeBaseCalculoST,"onUpdate:modelValue":s[16]||(s[16]=l=>a.documentoItem.modalidadeBaseCalculoST=l),opcoes:a.impostoCstIcmsSt,"somente-leitura":a.somenteLeituraIcmsSt,tipo:"seletor",outlined:"",rotulo:"ICMS ST (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),e(t,{col:"12 sm6"},{default:o(()=>[e(v,{modelValue:a.documentoItem.percentualIVA,"onUpdate:modelValue":s[17]||(s[17]=l=>a.documentoItem.percentualIVA=l),onBlur:s[18]||(s[18]=l=>i.calcularImpostos("percentualIVA")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IVA (%)"},null,8,["modelValue"])]),_:1}),e(t,{col:"12 sm4"},{default:o(()=>[e(v,{modelValue:a.documentoItem.valorBaseIcmsSt,"onUpdate:modelValue":s[19]||(s[19]=l=>a.documentoItem.valorBaseIcmsSt=l),onBlur:s[20]||(s[20]=l=>i.calcularImpostos("valorBaseIcmsSt")),"somente-leitura":a.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:o(()=>[e(v,{modelValue:a.documentoItem.percentualIcmsSt,"onUpdate:modelValue":s[21]||(s[21]=l=>a.documentoItem.percentualIcmsSt=l),onBlur:s[22]||(s[22]=l=>i.calcularImpostos("percentualIcmsSt")),"somente-leitura":a.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS ST (%)"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:o(()=>[e(v,{modelValue:a.documentoItem.valorIcmsSt,"onUpdate:modelValue":s[23]||(s[23]=l=>a.documentoItem.valorIcmsSt=l),onBlur:s[24]||(s[24]=l=>i.calcularImpostos("valorIcmsSt")),"somente-leitura":a.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):oe("",!0),e(c,null,{default:o(()=>[e(Me,{label:"IPI",modelValue:a.exibirIpi,"onUpdate:modelValue":s[25]||(s[25]=l=>a.exibirIpi=l)},null,8,["modelValue"])]),_:1}),a.exibirIpi?(M(),Y(c,{key:2,items:"center"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(v,{modelValue:a.documentoItem.codigoCstIpi,"onUpdate:modelValue":s[26]||(s[26]=l=>a.documentoItem.codigoCstIpi=l),opcoes:a.impostoCstIpi,tipo:"seletor",dense:"",outlined:"",rotulo:"CST IPI"},null,8,["modelValue","opcoes"])]),_:1}),e(t,{col:"12 sm4"},{default:o(()=>[e(v,{modelValue:a.documentoItem.valorBaseIpi,"onUpdate:modelValue":s[27]||(s[27]=l=>a.documentoItem.valorBaseIpi=l),onBlur:s[28]||(s[28]=l=>i.calcularImpostos("valorBaseIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base IPI"},null,8,["modelValue"])]),_:1}),e(t,{col:"12 sm4"},{default:o(()=>[e(v,{modelValue:a.documentoItem.percentualIpi,"onUpdate:modelValue":s[29]||(s[29]=l=>a.documentoItem.percentualIpi=l),onBlur:s[30]||(s[30]=l=>i.calcularImpostos("percentualIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IPI %"},null,8,["modelValue"])]),_:1}),e(t,{col:"12 sm4"},{default:o(()=>[e(v,{modelValue:a.documentoItem.valorIpi,"onUpdate:modelValue":s[31]||(s[31]=l=>a.documentoItem.valorIpi=l),onBlur:s[32]||(s[32]=l=>i.calcularImpostos("valorIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor IPI"},null,8,["modelValue"])]),_:1})]),_:1})):oe("",!0)]),_:1}),e(dt,{name:"tab2",class:"q-px-sm"},{default:o(()=>[a.exibirHistorico?(M(),Y(ft,{key:0,rows:a.historicoItem[a.documentoItem.idItem].fornecedores,columns:a.tabelaHistoricoItem.colunas,pagination:a.tabelaHistoricoItem.paginacao,"onUpdate:pagination":s[33]||(s[33]=l=>a.tabelaHistoricoItem.paginacao=l),"row-key":"index",class:"no-shadow text-left"},{body:o(l=>[e(pt,{props:l},{default:o(()=>[e(Ue,{key:"fornecedor",props:l},{default:o(()=>[N(J(l.row.fornecedor),1)]),_:2},1032,["props"]),e(Ue,{key:"dataCompra",props:l},{default:o(()=>[l.row.dataCompra!==""?(M(),_e("span",Ut,J(r.$filters.data(l.row.dataCompra)),1)):oe("",!0)]),_:2},1032,["props"]),e(Ue,{key:"quantidade",props:l},{default:o(()=>[N(J(l.row.quantidade),1)]),_:2},1032,["props"]),e(Ue,{key:"valorCusto",props:l},{default:o(()=>[N(J(r.$filters.numero(l.row.valorCusto,2)),1)]),_:2},1032,["props"]),e(Ue,{key:"valorTotal",props:l},{default:o(()=>[N(J(r.$filters.numero(l.row.valorTotal,2)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):oe("",!0)]),_:1}),e(dt,{name:"tab3",class:"q-px-sm"},{default:o(()=>[a.exibirEstoque?(M(),Y(ft,{key:0,rows:a.estoqueItem[a.documentoItem.idItem].estoques,columns:a.tabelaEstoqueItem.colunas,pagination:a.tabelaEstoqueItem.paginacao,"onUpdate:pagination":s[34]||(s[34]=l=>a.tabelaEstoqueItem.paginacao=l),"row-key":"index",class:"no-shadow text-left"},{body:o(l=>[e(pt,{props:l},{default:o(()=>[e(Ue,{key:"empresa",props:l},{default:o(()=>[N(J(l.row.empresa),1)]),_:2},1032,["props"]),e(Ue,{key:"tipoEstoque",props:l},{default:o(()=>[N(J(l.row.tipoEstoque),1)]),_:2},1032,["props"]),e(Ue,{key:"lote",props:l},{default:o(()=>[l.row.lote!==""?(M(),_e("span",Rt,J(l.row.lote),1)):oe("",!0)]),_:2},1032,["props"]),e(Ue,{key:"quantidade",props:l},{default:o(()=>[N(J(l.row.quantidade),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):oe("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ye,{class:"bg-light q-pa-sm",bordered:""},{default:o(()=>[e(Te,null,{default:o(()=>[e(rt),be(e(de,{onClick:i.fechar,label:"Cancelar",size:"md",flat:"","no-ripple":"",color:"tertiary",class:"q-mr-sm"},null,8,["onClick"]),[[Ee]]),e(de,{onClick:i.salvar,label:"Salvar",color:"primary","no-ripple":"",unelevated:""},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Mt=nt(Bt,[["render",Lt]]);const $t={components:{ModalEditarProdutoCompras:Mt,PromptItemV2:vt},data(){const r={ehOrcamento:!0,adicionar:{modal:{value:!1,name:""}},dataPrevistaEntrega:"",horaPrevistaEntrega:"",contatos:{},produtos:[],formasDePagamento:[],visivel:!1,somenteLeitura:!1,condicaoPagamentoRules:[async()=>{const s=this.compra.condicaoPagamento;return/^[\d/]*$/.test(s)}],formaPagamentoRules:[async()=>{const s=this.compra.formaDePagamento;return/^[^\d\s][a-zA-Z\s]*[^\d\s]$/.test(s)}],comprasMigrar:[],erroDesconto:!1,erroFrete:!1,erroSeguro:!1,erroOutrasDespesas:!1,exibeInfNota:!1,documentoNovo:!1,valorTotalPagamento:0,sku:0,operacao:"",alterarPrevisaoEntrega:!1};return this.limpaCampos(r),r},emits:["atualizar","dialogImprimirEtiquetas"],computed:{skus(){return this.compraItens.length>0?`${Number(this.compraItens.length)}`:"0"}},methods:{editarProduto(r){const s=this.produtos[r.idItem],h=this.compra;this.$refs.ModalEditarProdutoCompras.mostrar(r,s,h)},removerItem(r){this.compraItens=this.compraItens.filter(s=>s.id!==r.id),this.calcularTotais()},async migrarParaOutraCompra(r,s){await $tryLoading(async()=>{const h=(s==null?void 0:s.id)||$utils.uuid(),w=s?{...s}:{...this.compra,id:h,codigoDocumento:void 0,numero:void 0,notaNumero:void 0,notaSerie:void 0,naturezaOperacao:void 0,dataCompra:void 0,chaveAcesso:void 0,totalDesconto:void 0,totalPercentualDesconto:void 0,valorFrete:void 0,valorSeguro:void 0,valorOutrasDespesas:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,dataHoraPrevisto:void 0,status:"Digita\xE7\xE3o"},a={...r,id:$utils.uuid(),codigoDocumentoItem:void 0,idDocumento:h,codigoDocumento:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"};this.calcularTotais("",w,[a]),await $db.hibrido.grava("documento",{atual:w,original:s}),await $db.hibrido.grava("documentoItem",{atual:a}),this.removerItem(r),this.salvar(),$q.notifyPositive("Item migrado com sucesso!")},{mensagem:"Migrando..."})},fecharEdicaoProduto(r){const s=this.compraItens.findIndex(h=>h.id===r.id);this.compraItens[s]=$utils.clonar(r),this.calcularTotaisItem(s)},async atualizar(){var h,w;this.compraOriginal=await $db.hibrido.le({table:"documento",id:this.compra.id}),this.compra=$utils.clonarV2(this.compraOriginal),$utils.verificarErro(!this.compra.id,"Compra n\xE3o encontrada"),this.compraItensOriginal=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:this.compra.id}})).sort((a,i)=>new Date(a.dataHoraEmissao||0)-new Date(i.dataHoraEmissao||0)),this.compraItens=$utils.clonarV2(this.compraItensOriginal),this.compraCondicoesDePagamentoOriginal=(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:this.compra.id}})).sort((a,i)=>new Date(a.dataVencimento||0)-new Date(i.dataVencimento||0)),this.compraCondicoesDePagamento=$utils.clonarV2(this.compraCondicoesDePagamentoOriginal),this.compraTitulosOriginal=await $db.hibrido.lista({table:"financeiroTitulo",where:{documentoId:this.compra.id}}),this.compraTitulos=$utils.clonarV2(this.compraTitulosOriginal),this.compraMovimentacoesOriginal=await $db.hibrido.lista({table:"financeiroMovimentacao",where:{documentoId:this.compra.id}}),this.compraMovimentacoes=$utils.clonarV2(this.compraMovimentacoesOriginal),this.compraDocumentoXmlOriginal=await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:this.compra.id}}),this.compraDocumentoXml=$utils.clonarV2(this.compraDocumentoXmlOriginal),this.compra.totalComImposto=!0,this.compra.calcularTributacao=(h=this.compra.calcularTributacao)!=null?h:!0,this.compra.naoGerarFinanceiro=(w=this.compra.naoGerarFinanceiro)!=null?w:!1;const r=[this.compra.idEmpresa,this.compra.idContato,this.compra.idContatoComprador,this.compra.idContatoVendedor,this.compra.idContatoTransportadora].filter(Boolean);this.carregarImagensContatos(r);const s=this.compraItens.map(({idItem:a})=>a).filter(Boolean);if(this.carregarImagensItens(s),this.valorTotalPagamento===0)for(const a of this.compraCondicoesDePagamento)this.valorTotalPagamento=this.valorTotalPagamento+a.valor;this.compra.dataHoraPrevisto&&(this.dataPrevistaEntrega=this.compra.dataHoraPrevisto.slice(0,10),this.horaPrevistaEntrega=this.compra.dataHoraPrevisto.slice(11,16)),this.carregarComprasMigrar(this.compra),this.calcularTotais(),this.exibeInfNota=!0},async carregarContatos(r){const s=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:r}});for(const h of s)this.contatos[h.id]=h},async carregarImagensContatos(r){if(!!r.length){await $utils.dormir(200);try{await this.carregarContatos(r)}catch(s){console.error("Erro ao carregar imagens de contatos - ",s)}}},async carregarComprasMigrar(r){try{this.comprasMigrar=(await $db.hibrido.lista({table:"documento",where:{tipo:"Compra",idContato:r.idContato},whereFilter:{idEmpresa:r.idEmpresa,status:"Digita\xE7\xE3o"}})).filter(({id:s})=>s!==r.id)}catch(s){console.error("Erro ao carregar compras para migra\xE7\xE3o - ",s)}},async carregarItens(r){const s=await $db.hibrido.lista({table:"item",columns:["id","descricao","imagem","valorCustoReposicao","marca","referencia","codigoItem"],whereIn:{id:r}});for(const h of s)this.produtos[h.id]=h},async carregarImagensItens(r){if(!!r.length){await $utils.dormir(200);try{await this.carregarItens(r)}catch(s){console.error("Erro ao ler imagens de itens - ",s)}}},async salvar_click(){await $tryLoading(async()=>{if(this.compra.idContato||(this.compra.idContato=$db.usuario.logado.id),this.dataPrevistaEntrega){const r=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;this.compra.dataHoraPrevisto=ze.formatDate(r)}this.calcularTotais(),await this.salvar(),this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi salva com sucesso.":"O Pedido de Compra foi salvo com sucesso.")},{mensagem:"Salvando..."})},async excluir_click(){!await $q.dialogSimNao({title:"Excluir compra",message:`Deseja excluir ${this.compra.operacao==="Pedido de Compra"?`o ${this.compra.operacao}?`:`a ${this.compra.operacao}?`}`})||await $tryLoading(async()=>{this.visivel=!1,this.operacao=this.compra.operacao,this.compra={},this.compraCondicoesDePagamento=[],this.compraItens=[],this.compraMovimentacoes=[],this.compraTitulos=[],this.compraDocumentoXml=[],await this.salvar(),await this.fechar(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi excluida com sucesso.":"O Pedido de Compra foi excluido com sucesso.")},{mensagem:"Excluindo..."})},async criar(){await $tryLoading(async()=>{const r=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;if(!(r.length>0)){this.$q.notify({message:"N\xE3o h\xE1 empresa configurada",timeout:0,type:"negative",closeBtn:!0});return}let s=r[0];if(r.length>1){const a={ativo:!0,empresas:!0};if(s=await $g.promptContato.show({filtro:a,placeholder:"Selecione a empresa"}),!s){this.ocultarModal();return}}const h=(await $db.hibrido.lista({table:"empresa",where:{idContato:s.id}}))[0];if(!h){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}if(this.contatos[s.id]||await this.carregarContatos([s.id]),this.limpaCampos(this),this.compra={id:$utils.uuid(),tipo:"Compra",operacao:"Pedido de Compra",status:"Digita\xE7\xE3o",descricaoEmpresa:h.nome,numeroDocumentoEmpresa:h.numeroDocumentoNacional,descricaoContato:"",idContatoComprador:null,dataHoraEmissao:$utils.dataAtual(),tipoFrete:"CIF",tipoTransporte:null,idEmpresa:h.idContato,idContato:null,totalDesconto:0,totalPercentualDesconto:0,calcularTributacao:!0,totalComImposto:!0,naoGerarFinanceiro:!1,freteSeparado:!1,dataHoraPrevisto:null,valorBaseIcms:0,valorIcms:0,valorBaseIcmsSt:0,valorIcmsSt:0,valorOutrasDespesas:0},!await this.abrirModalFornecedor()){this.ocultarModal();return}this.documentoNovo=!0,this.exibeInfNota=!0,this.visivel=!0})},async validaCampos(){try{if($utils.verificarErro(!this.compra.descricaoContato,"N\xE3o \xE9 permitido finalizar a compra sem informar o fornecedor!"),$utils.verificarErro(!this.compraItens.length,"N\xE3o \xE9 permitido finalizar compra sem itens!"),!this.compra.naoGerarFinanceiro){const r=$utils.arredondar(this.compraCondicoesDePagamento.reduce((s,h)=>s+h.valor,0));$utils.verificarErro(!this.compra.formaDePagamento,"N\xE3o \xE9 permitido finalizar a compra sem informar a forma de pagamento!"),$utils.verificarErro(this.compraCondicoesDePagamento.length>0&&this.compra.totalDocumento!==r,"N\xE3o \xE9 permitido finalizar a compra se o valor total difere da soma das parcelas!"),$utils.verificarErro(this.compraCondicoesDePagamento.length===0,'Verifique se a op\xE7\xE3o "N\xE3o gerar financeiro" est\xE1 marcada, ou adicione as parcelas para finalizar a compra!')}return this.compra.operacao==="Nota de Entrada"&&($utils.verificarErro(!this.compra.notaNumero,"N\xE3o \xE9 permitido finalizar a compra sem informar o n\xFAmero da Nota de Entrada!"),$utils.verificarErro(!this.compra.notaSerie,"N\xE3o \xE9 permitido finalizar a compra sem informara s\xE9rie da Nota de Entrada!"),$utils.verificarErro(!this.compra.naturezaOperacao,"N\xE3o \xE9 permitido finalizar a compra sem informar natureza de opera\xE7\xE3o da Nota de Entrada!"),$utils.verificarErro(!this.compra.dataCompra,"N\xE3o \xE9 permitido finalizar a compra sem informar a data de compra da Nota de Entrada!"),$utils.verificarErro(!this.compra.chaveAcesso,"N\xE3o \xE9 permitido finalizar a compra sem informar a chave de acesso da Nota de Entrada!")),!0}catch(r){return $q.notifyError("Ocorreu um erro na valida\xE7\xE3o de campos",r),!1}},async finalizar_click(){if(!await this.validaCampos())return;let r=!1;this.compra.naoGerarFinanceiro||(r=await $q.dialogSimNao({title:"Gerar Financeiro",message:"Deseja gerar as provis\xF5es financeiras?"})),await $tryLoading(async()=>{this.compra.status="Finalizado",this.compra.dataHoraFinalizado=$utils.dataAtual(),this.compra.provisaoCompra=r?1:void 0,await this.finalizarItens(),r&&await this.gerarFinanceiro(),await this.salvar(),this.$emit("atualizar",{aba:"Finalizado"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi finalizada com sucesso!":"O Pedido de Compra foi finalizada com sucesso!"),r&&$q.notifyPositive("Provisionamento gerado com sucesso!")},{mensagem:"Finalizando Compra..."})},finalizarItens(){var i,m;let r=1,s=0,h=0,w=!1;const a=this.compra;if(a.subTotalProduto>0&&(a.tipoFrete==="FOB"&&a.freteSeparado===0&&(s=(a.valorFrete||0)+(a.valorSeguro||0)),r=((a.subTotalProduto||0)+(a.valorOutrasDespesas||0)-(a.totalDesconto||0)+(s||0))/(a.subTotalProduto||1)),h=this.compraItens.reduce((t,c)=>t+c.valorIcmsSt,h),h!==a.valorIcmsSt&&(w=!0),a.operacao==="Nota de Entrada")for(const t of this.compraItens)t.dataCompra=$utils.dataAtual(),w&&(t.valorIcmsSt=a.valorIcmsSt*((t==null?void 0:t.total)||0)/(a.subTotalProduto>0?a.subTotalProduto:1)),t.valorFreteRateado=a.valorFrete*(((t==null?void 0:t.total)||0)/(a.subTotalProduto||1)),t.valorSeguroRateado=a.valorSeguro*(((t==null?void 0:t.total)||0)/(a.subTotalProduto||1)),t.valorOutrasDespesasRateado=(a.valorOutrasDespesas||0)*(((t==null?void 0:t.total)||0)/(a.subTotalProduto||1)),t.descontoTotalRateado=(a.totalDesconto||0)*(((t==null?void 0:t.total)||0)/(a.subTotalProduto||1)),(t==null?void 0:t.valorIcmsSt)-(t==null?void 0:t.valorIcms)>0&&((t==null?void 0:t.valorIcmsSt)||0)-((t==null?void 0:t.valorIcms)||0),t.valorRealTotal=((t==null?void 0:t.total)||0)*r+((t==null?void 0:t.valorIpi)||0)+((t==null?void 0:t.valorIcms)||0),t.valorRealTotalImpostos=((t==null?void 0:t.total)||0)+t.valorFreteRateado+t.valorSeguroRateado+t.valorOutrasDespesasRateado-t.descontoTotalRateado+((t==null?void 0:t.valorIpi)||0)+((t==null?void 0:t.valorIcmsSt)||0),t.valorReal=t.valorRealTotalImpostos/((t==null?void 0:t.quantidade)||1),t.valorCustoReposicao=((i=this.produtos[t.idItem])==null?void 0:i.valorCustoReposicao)||0;if(a.operacao==="Pedido de Compra")for(const t of this.compraItens){w&&(t.valorIcmsSt=$utils.arredondar(a.valorIcmsSt*(t.total||0)/(a.subTotalProduto>0?a.subTotalProduto:1))),t.valorFreteRateado=$utils.arredondar((a.valorFrete||0)*(t.total||0)/(a.subTotalProduto||1),4),t.valorSeguroRateado=$utils.arredondar((a.valorSeguro||0)*(t.total||0)/(a.subTotalProduto||1),4),t.valorOutrasDespesasRateado=$utils.arredondar((a.valorOutrasDespesas||0)*(t.total||0)/(a.subTotalProduto||1),4),t.descontoTotalRateado=$utils.arredondar((a.totalDesconto||0)*(t.total||0)/(a.subTotalProduto||1),4);let c=0;t.valorIcmsSt-t.valorIcms>0&&(c=$utils.arredondar((t.valorIcmsSt||0)-(t.valorIcms||0),2)),t.valorRealTotal=$utils.arredondar((t.total||0)*r+(t.valorIpi||0)+(c>0?c:0),2),t.valorRealTotalImpostos=$utils.arredondar((t.total||0)+t.valorFreteRateado+t.valorSeguroRateado+t.valorOutrasDespesasRateado-t.descontoTotalRateado+(t.valorIpi||0)+(t.valorIcmsSt||0),4),t.valorReal=$utils.arredondar(t.valorRealTotalImpostos/(t.quantidade||1),4),t.valorCustoReposicao=$utils.arredondar(((m=this.produtos[t.idItem])==null?void 0:m.valorCustoReposicao)||0,2)}},async transformarEmNotaDeEntrada_click(){this.compra.operacao==="Pedido de Compra"&&await $tryLoading(async()=>{var h;const r=this.compraItens.map(({idItem:w})=>w).filter(Boolean),s=await $db.hibrido.lista({table:"itemFornecedor",whereIn:{idItem:r},whereFilter:{idContato:this.compra.idContato}});for(const w of this.compraItens)if(!s.some(({idItem:a})=>a===w.idItem)){const a={id:$utils.uuid(),idItem:w.idItem,idContato:this.compra.idContato,referencia:"",descricao:w.descricaoItem};await $db.hibrido.grava("itemFornecedor",{atual:a,original:{}})}for(const w of this.compraTitulos)w.formaDePagamento=(h=this.compra.formaDePagamento)!=null?h:"";this.compra.operacao="Nota de Entrada",this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",await this.salvar(),$q.notifyPositive("Nota de Entrada gerada com sucesso!")},{mensagem:"Processando..."})},async mostrar({id:r}){this.visivel=!0;const s=$utils.logarIni("ComprasFicha");await $tryLoading(async()=>{this.compra.id=r,await this.atualizar()}),$utils.logarFim(s,1)},fechar(){this.compra.status==="Finalizado"?this.$emit("atualizar",{aba:"Finalizado"}):this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),this.produtos=[],this.limpaCampos(this),this.formasDePagamento=[],this.documentoNovo=!1,this.exibeInfNota=!1,this.valorTotalPagamento=0},ocultarModal(){this.visivel=!1},async abrirModalEmpresa(){const r={ativo:!0,empresas:!0},s=await $g.promptContato.show({filtro:r,placeholder:"Selecione"});if(!s)return;let h=(await $db.hibrido.lista({table:"empresa",where:{idContato:s.id}}))[0];if(!h){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}this.contatos[s.id]||await this.carregarContatos([s.id]),this.compra.descricaoEmpresa=h.nome,this.compra.idEmpresa=h.idContato,this.compra.numeroDocumentoEmpresa=h.numeroDocumentoNacional,this.compra.InscricaoMunicipalEmpresa=h.InscricaoMunicipalEmpresa},async abrirModalComprador(){const r=await this.selecionarContato({placeholder:"Selecione o comprador",filtro:{ativo:!0,compradores:!0}});r.id&&(this.compra.idContatoComprador=r.id),this.contatos[r.id]||await this.carregarContatos([r.id])},async abrirModalFornecedor(){const r={ativo:!0},s=await $g.promptContato.show({filtro:r,placeholder:"Selecione o fornecedor"});if(!s)return s;const h=await $db.contatoTelefone.le({idContato:s.id}),w=await $db.contatoEndereco.le({idContato:s.id}),a=h.find(t=>t.tipoTelefone==="Principal"||t.tipoTelefone==="WhatsApp")||h[0]||null,i=w.find(t=>t.grupo==="Principal")||w[0]||null;let m;return i&&Object.keys(i).length>0&&(m=`${i.logradouro}, ${i.numero} ${i.complemento} - ${i.bairro} - ${i.municipio}/${i.uf}`),s.id&&(this.compra.idContato=s.id,this.compra.descricaoContato=s.nome,this.compra.numeroDocumentoContato=s.numeroDocumentoNacional,this.compra.emailContato=(s==null?void 0:s.email)||null,this.compra.regimeContato=(s==null?void 0:s.regime)||null,this.compra.telefoneContato=(a==null?void 0:a.telefone)||null,this.compra.descricaoContatoEndereco=m||null),this.contatos[s.id]||await this.carregarContatos([s.id]),s},async abrirModalVendedor(){const r=(await $db.contato.leFilhos(this.compra.idContato)).map(h=>h.id),s=await this.selecionarContato({placeholder:"Selecione o vendedor",filtro:{ativo:!0,usuarios:r}});s.id&&(this.compra.idContatoVendedor=s.id),this.contatos[s.id]||await this.carregarContatos([s.id])},async abrirModalTransportador(){const r=await this.selecionarContato({placeholder:"Selecione o transportadora",filtro:{ativo:!0,transportadoras:!0}});r.id&&(this.compra.idContatoTransportadora=r.id),this.contatos[r.id]||await this.carregarContatos([r.id])},async selecionarContato(r){const{placeholder:s,filtro:h}={placeholder:"Selecione o contato",filtro:{ativo:!0},...r},w=await $g.promptContato.show({filtro:h,placeholder:s});if(!w)throw new Error("Contato n\xE3o selecionado");return w},async adicionarItem(){let r={},s=[];for(const h of s)r[h.idItem]={item:await $db.hibrido.le({table:"item",id:h.idItem}),quantidade:h.quantidade};this.adicionar.modal.value=!0,this.adicionar.modal.name="Item"},async selecionarItens(r){var s,h;for(const w in r){let a=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",whereFilter:{idEmpresa:this.compra.idEmpresa,tipoEstoque:"Dispon\xEDvel",idItem:w}});a=a[0];const i=await $db.configuracoes.porNome("vendas.checaestoque",this.compra.idEmpresa);Number((s=i.find(l=>l.id))==null?void 0:s.valor);const m=r[w].item||{},t=((h=(await $db.hibrido.lista({table:"itemFornecedor",whereFilter:{idItem:m.id}}))[0])==null?void 0:h.referencia)||null,c=r[w].quantidade||0,v=(m==null?void 0:m.valorCustoReposicao)||(a==null?void 0:a.valorCustoMedio)||0;let _=this.compraItens.find(l=>l.idItem===w);const p=(await $erp().cfop.where({cfop:5102}).toArray())[0],y=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral");if(_)_.quantidade=$utils.arredondar(c,4),_.quantidadeRealizado=$utils.arredondar(c,4),_.subTotal=$utils.arredondar(v,2),_.total=$utils.arredondar(c*v,2);else{const l={dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:"",descricaoItem:m.descricao,id:$utils.uuid(),idDocumento:this.compra.id,idItem:m.id,referencia:m.referencia,referenciaFornecedor:t,ncm:m.ncm||null,operacao:"Compra de Mercadoria",operacaoFator:1,idCfop:p==null?void 0:p.id,idPlanoContaEstoque:y==null?void 0:y.id,quantidade:$utils.arredondar(c,4),quantidadeRealizado:$utils.arredondar(c,4),status:"Digita\xE7\xE3o",tipoItem:m.tipo,subTotal:$utils.arredondar(v,2),total:$utils.arredondar(c*v,2),unidade:m.unidade,valorCustoMedio:(a==null?void 0:a.valorCustoMedio)||0,valorItem:v,valorOriginal:v,observacao:""};this.compraItens.push(l),await this.carregarItens([m.id])}this.compra.subTotal=0,this.compra.subTotalProduto=0;for(let l in this.compraItens)this.compra.subTotal+=this.compraItens[l].total,this.compra.subTotalProduto+=this.compraItens[l].total;this.compra.subTotal=$utils.arredondar(this.compra.subTotal,2),this.compra.totalDocumento=this.compra.subTotal}},formatXml(r,s="  "){let h="",w="";return r.split(/>\s*</).forEach(a=>{a.match(/^\/\w/)&&(w=w.substring(s.length)),h+=w+"<"+a+`>
`,a.match(/^<?\w[^>]*[^\/]$/)&&(w+=s)}),h.substring(1,h.length-3)},calcularTotaisItem(r,s){const h=$utils.clonar(this.compraItens[r]),w=h.valorOriginal||0,a=h.quantidade||0;let i=h.valorItem||0,m=h.descontoPercentualItem||0,t=h.descontoItem||0,c=h.subTotal||0,v=h.total||0;s==="descontoPercentualItem"&&((m<0||m>100)&&(m=0),t=i*m/100,c=i-t),s==="descontoItem"&&((t<0||t>i)&&(t=0),m=t/i*100,c=i-t),s==="valorItem"&&(i<w&&(i=w),t>i&&(t=0,m=0),m=t/i*100,c=i-t),s==="subTotal"&&((c<0||c>i)&&(c=i),t=i-c,m=t/i*100),v=a*c,h.valorItem=i,h.descontoItem=t,h.descontoPercentualItem=m,h.subTotal=c,h.total=v,this.compraItens[r]=h,this.calcularTotais("totalDesconto")},calcularTotais(r,s,h){const w=s||$utils.clonar(this.compra),a=h||this.compraItens;let i=0,m=0,t=0,c=w.totalDesconto||0,v=w.totalPercentualDesconto||0,_=w.valorFrete||0,p=w.valorSeguro||0,y=w.valorOutrasDespesas||0,l=0,I=0,n=0,b=0,d=0;this.erroFrete=!1,this.erroSeguro=!1,this.erroOutrasDespesas=!1;for(const g of a)i+=g.total,l+=g.valorBaseIcms||0,I+=g.valorIcms||0,n+=g.valorBaseIcmsSt||0,b+=g.valorIcmsSt||0,d+=g.valorIpi||0;r==="totalPercentualDesconto"&&(this.erroDesconto=!1,(v<0||v>100)&&(this.erroDesconto=!0),c=i*v/100),r==="totalDesconto"&&(this.erroDesconto=!1,(c<0||c>i)&&(this.erroDesconto=!0),v=c/i*100),_<0&&(this.erroFrete=!0),_=w.tipoFrete==="FOB"?_:0,p<0&&(this.erroSeguro=!0),p=w.tipoFrete==="FOB"?p:0,y<0&&(this.erroOutrasDespesas=!0),w.calcularTributacao||(l=0,I=0,n=0,b=0),w.totalComImposto||(d=0),m=i-c+_+p+y,t=m+d,w.valorBaseIcms=$utils.arredondar(l,2),w.valorIcms=$utils.arredondar(I),w.valorBaseIcmsSt=$utils.arredondar(n),w.valorIcmsSt=$utils.arredondar(b),w.valorIpi=$utils.arredondar(d),w.totalDesconto=$utils.arredondar(c),w.totalPercentualDesconto=$utils.arredondar(v),w.subTotalProduto=$utils.arredondar(i),w.totalProduto=$utils.arredondar(i)-$utils.arredondar(c),w.subTotal=$utils.arredondar(m),w.totalDocumento=$utils.arredondar(t),s||(this.compra=w)},limpaCampos(r){r.compra={},r.compraOriginal={},r.compraItens=[],r.compraItensOriginal=[],r.compraCondicoesDePagamento=[],r.compraCondicoesDePagamentoOriginal=[],r.compraTitulos=[],r.compraTitulosOriginal=[],r.compraMovimentacoes=[],r.compraMovimentacoesOriginal=[],r.compraDocumentoXml=[],r.compraDocumentoXmlOriginal=[],r.dataPrevistaEntrega="",r.horaPrevistaEntrega=""},async salvar(){this.compra.totalComImposto&&delete this.compra.totalComImposto;for(const r of this.compraItens)r.dataHoraFinalizado=this.compra.dataHoraFinalizado,r.status=this.compra.status;this.compra.id?await $db.hibrido.grava("documento",{atual:this.compra,original:this.compraOriginal}):this.compraOriginal.id&&await $db.hibrido.remove("documento",this.compraOriginal),await $db.hibrido.gravaLista("documentoItem",{atual:this.compraItens,original:this.compraItensOriginal}),await $db.hibrido.gravaLista("documentoCondicaoPagamento",{atual:this.compraCondicoesDePagamento,original:this.compraCondicoesDePagamentoOriginal}),await $db.hibrido.gravaLista("financeiroTitulo",{atual:this.compraTitulos,original:this.compraTitulosOriginal}),await $db.hibrido.gravaLista("financeiroMovimentacao",{atual:this.compraMovimentacoes,original:this.compraMovimentacoesOriginal}),await $db.hibrido.gravaLista("documentoXML",{atual:this.compraDocumentoXml,original:this.compraDocumentoXmlOriginal}),this.compra.totalComImposto=!0,this.calculaKardex()},async calculaKardex(){const r=$utils.logarIni("calculaKardex"),s=this.compraItens.map(({idItem:h})=>h).filter(Boolean);try{s.length&&await $utils.geeksApi({calculaKardex:{funcao:"9913E9FD-24A5-4C0A-9F1E-AACCDC7EAB9D",idsItem:s}})}catch(h){console.error(`Erro ao calcular Kardex
`,h)}$utils.logarFim(r,s.length)},async reabrir_click(){!await $q.dialogSimNao({title:"Reabertura",message:`Deseja reabrir o documento?<br/>${this.compra.naoGerarFinanceiro?"":"<strong>O Financeiro ser\xE1 apagado!</strong>"}`,html:!0})||await $tryLoading(async()=>{await this.retornarParaDigitacao(),await this.salvar(),await this.atualizar(),$q.notifyPositive("Documento reaberto para digita\xE7\xE3o!")},{mensagem:"Reabrindo..."})},async retornarParaDigitacao(){$utils.verificarErro(this.compra.status!=="Finalizado","N\xE3o \xE9 poss\xEDvel realizar esta opera\xE7\xE3o em documento n\xE3o finalizado.");const r=this.compraTitulos.filter(({dataPagamento:s})=>s);$utils.verificarErro(r.length,"N\xE3o \xE9 poss\xEDvel excluir o Financeiro. Parcelas provisionadas j\xE1 pagas!"),this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",this.compra.operacao==="Pedido de Compra"&&(this.compraTitulos=[],this.compraMovimentacoes=[])},async removerPagamento_click(r){try{this.compraCondicoesDePagamento=this.compraCondicoesDePagamento.filter(s=>s.id!==r.id),this.compraCondicoesDePagamento.sort((s,h)=>{let w=new Date(s.dataVencimento),a=new Date(h.dataVencimento);return w-a}),await this.atualizaValorTotalPagamento({condicao:r,acao:"remover"})}catch(s){console.log(s.message)}},async gerarCondicoesDePagamento_click(){var r;try{let s=this.compra.id,h=this.compra.condicaoPagamento,w=(r=this.compra.notaNumero)!=null?r:null;this.compra.naoGerarFinanceiro||await this.gerarParcelamento(s,h,w),this.compra.naoGerarFinanceiro&&(this.compraCondicoesDePagamento=[])}catch(s){console.log(s.message)}},async gerarParcelamento(r,s,h){this.compraCondicoesDePagamento=[];const w=$utils.clonar(this.compra),a=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`,i=ze.formatDate(a)||w.dataHoraPrevisto,m=w.dataCompra||i||$utils.dataAtual(),t=s.split("/"),c=t.length,v=(w==null?void 0:w.freteSeparado)||0;let _=$utils.arredondar(w==null?void 0:w.totalDocumento,2);const p=((w==null?void 0:w.valorFrete)||0)+((w==null?void 0:w.valorSeguro)||0);if(v&&(w==null?void 0:w.tipoFrete)==="FOB"&&p>0){let I;i?I=new Date(i):(I=new Date(m),I.setDate(I.getDate()+Number(t[0]||0)));let n={id:$utils.uuid(),idDocumento:w==null?void 0:w.id,dataVencimento:ze.formatDate(I),valor:p,observacao:"Valor Frete + Seguro",freteSeparado:!0};this.compraCondicoesDePagamento.push(n),_-=p}let y=0,l=_/c;for(let I in t){let n=new Date(m);n.setDate(n.getDate()+Number(t[I]||0));let b={id:$utils.uuid(),idDocumento:w==null?void 0:w.id,dataVencimento:ze.formatDate(n),valor:l,observacao:""};this.compraCondicoesDePagamento.push(b),y+=l||0}_!==y&&(this.compraCondicoesDePagamento[0].valor+=(_||0)-(y||0)),this.valorTotalPagamento=v&&(w==null?void 0:w.tipoFrete)==="FOB"?_+p:_},async gerarFinanceiro(){var m,t;const r=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral"),s=[];for(const c of this.compraItens){if(c.idPlanoContaEstoque===r.id)continue;const v=(c.total||0)-(c.descontoTotalRateado||0),_=s.findIndex(({idPlanoContaEstoque:p})=>p===c.idPlanoContaEstoque);_!==-1?s[_].valor+=v:s.push({idPlanoContaEstoque:c.idPlanoContaEstoque,idPlanoContaDestino:"",valor:v,porcentagem:0})}for(const c of s)c.valor=$utils.arredondar(c.valor),c.porcentagem=$utils.arredondar(c.valor/this.compra.totalDocumento,4);const h=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.freteaquisicao"),w=this.compraTitulos.filter(({dataPagamento:c})=>c);$utils.verificarErro(w.length,"N\xE3o \xE9 poss\xEDvel regerar o Financeiro. Parcelas provisionadas j\xE1 pagas!");const a=ze.formatDate(new Date().setHours(0,0,0,0));this.compraTitulos=[];for(const c in this.compraCondicoesDePagamento){const v=this.compraCondicoesDePagamento[c],_=[v.observacao,this.compra.codigoDocumento?`Pedido de Compra: ${this.compra.codigoDocumento}`:"",this.compra.notaNumero?`Nota nro: ${this.compra.notaNumero}`:""].filter(Boolean).join(" | "),p={id:$utils.uuid(),dataEmissao:a,dataCompetencia:a,dataVencimento:ze.formatDate(new Date(v.dataVencimento).setHours(0,0,0,0)),dataVencimentoOriginal:ze.formatDate(new Date(v.dataVencimento).setHours(0,0,0,0)),valor:$utils.arredondar(v.valor,2),tipoJuros:"dia",valorMulta:0,percentualJuros:0,documentoTipo:this.compra.operacao,parcela:`${Number(c)+1}/${this.compraCondicoesDePagamento.length}`,descricao:this.compra.operacao,observacao:_,formaDePagamento:this.compra.operacao==="Pedido de Compra"?`Provis\xE3o Pedido - ${(m=this.compra.formaDePagamento)!=null?m:""}`:(t=this.compra.formaDePagamento)!=null?t:"",receberPagar:0,valorOriginal:$utils.arredondar(v.valor,2),documentoVinculado:1,valorTotal:$utils.arredondar(v.valor,2),valorARealizar:$utils.arredondar(v.valor,2),valorDesconto:0,percentualDesconto:0,idEmpresa:this.compra.idEmpresa,idContato:(v==null?void 0:v.freteSeparado)&&!!this.compra.idContatoTransportadora?this.compra.idContatoTransportadora:this.compra.idContato,idFinanceiroPlanoConta:v.observacao==="Valor Frete + Seguro"?h.id:r==null?void 0:r.id,documentoId:this.compra.id,idFinanceiroMovimentacaoAgrupamentoAutomatico:$utils.uuid(),cobrancaAtivo:1};this.compraTitulos.push(p)}const i=$utils.uuid();this.compraMovimentacoes=[];for(const c of s){const v={id:$utils.uuid(),idFinanceiroMovimentacaoN:i,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:r.id,dataEmissao:a,valorCredito:this.compra.totalDocumento*c.porcentagem,valorDebito:0,descricao:r.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:a,dataVencimento:a,dataMovimento:a,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(v);const _=await $db.financeiroPlanoConta.leCache({id:c.idPlanoContaEstoque}),p={id:$utils.uuid(),idFinanceiroMovimentacaoN:i,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:c.idPlanoContaEstoque,dataEmissao:a,valorCredito:0,valorDebito:this.compra.totalDocumento*c.porcentagem,descricao:_.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:a,dataVencimento:a,dataMovimento:a,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(p)}},async atualizaValorTotalPagamento({condicao:r,acao:s}){!r||s==="remover"&&(this.valorTotalPagamento=this.valorTotalPagamento-r.valor)},async ajustarPrevisaoEntrega(r){r==="alterar"&&(this.alterarPrevisaoEntrega=!0),r==="salvar"&&(await $tryLoading(async()=>{const s=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;$utils.verificarErro(!this.dataPrevistaEntrega&&this.horaPrevistaEntrega,"\xC9 necess\xE1rio preencher uma data em conjunto com a hora."),ze.formatDate(s)!==ze.formatDate(this.compra.dataHoraPrevisto)?(this.compra.dataHoraPrevisto=ze.formatDate(s)||"",await this.salvar(),await this.atualizar(),$q.notifyPositive("A previs\xE3o foi salva com sucesso")):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")}),this.alterarPrevisaoEntrega=!1)},dialogImprimirEtiquetas(r,s){this.$emit("dialogImprimirEtiquetas",{acao:r,item:s})}}},jt={class:"row items-center"},Ht={class:"col-auto"},Zt={class:"col-auto"},Xt={class:"col-auto"},Wt=fe("span",{class:"q-px-xs"},"|",-1);function Gt(r,s,h,w,a,i){const m=ge("g-label"),t=ge("g-col"),c=ge("Badge"),v=ge("BadgeCopiarUid"),_=ge("g-row"),p=ge("avatar"),y=ge("campo"),l=ge("ModalEditarProdutoCompras"),I=ge("PromptItemV2");return M(),_e(ke,null,[e($e,{modelValue:r.visivel,"onUpdate:modelValue":s[33]||(s[33]=n=>r.visivel=n),persistent:"",maximized:"",onKeyup:bt(i.fechar,["esc"])},{default:o(()=>[e(je,{view:"hHh lpR lFr",container:"",class:"bg-light"},{default:o(()=>[e(He,null,{default:o(()=>[e(Te,null,{default:o(()=>[e(de,{onClick:i.fechar,icon:"arrow_back",flat:"",round:"",dense:""},null,8,["onClick"]),e(Re,null,{default:o(()=>[N(J(r.compra.operacao),1)]),_:1}),be(e(de,{onClick:i.salvar_click,label:"Salvar",color:"white","text-color":"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[xe,r.compra.status==="Digita\xE7\xE3o"]])]),_:1})]),_:1}),e(Ze,{class:"u-container"},{default:o(()=>[e(Xe,null,{default:o(()=>[e(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:o(()=>[e(t,{col:"12 sm12 md6"},{default:o(()=>[e(_,{items:"center",justify:"end",class:"hideondesktop"},{default:o(()=>[e(t,{col:"xs-shrink",order:"1 sm0"},{default:o(()=>[be(e(m,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${r.$filters.hora(r.compra.dataHoraEmissao)}`},{default:o(()=>[N(J(r.$filters.data(r.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[xe,r.compra.dataHoraEmissao]])]),_:1}),e(t,{col:"xs-shrink",order:"1 sm0"},{default:o(()=>[be(e(m,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Finalizado \xE1s ${r.$filters.hora(r.compra.dataHoraFinalizado)}`},{default:o(()=>[N(J(r.$filters.data(r.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[xe,r.compra.dataHoraFinalizado]])]),_:1}),e(t,{col:"xs12 sm-shrink",order:"0 sm1",text:"right"},{default:o(()=>[e(c,{cor:r.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:r.compra.status!=="Digita\xE7\xE3o",class:"q-ml-sm"},{default:o(()=>[N(J(r.compra.status),1)]),_:1},8,["cor","escuro"]),e(v,{id:r.compra.id,numero:r.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"])]),_:1})]),_:1}),e(_,null,{default:o(()=>[e(t,{col:"12 sm6"},{default:o(()=>[e(_,null,{default:o(()=>[e(t,{col:"xs-shrink"},{default:o(()=>{var n,b;return[e(p,{imagem:(n=r.contatos[r.compra.idContato])==null?void 0:n.imagem,rotulo:(b=r.contatos[r.compra.idContato])==null?void 0:b.apelido,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:1}),e(t,{col:"xs"},{default:o(()=>{var n;return[e(y,{modelValue:(n=r.contatos[r.compra.idContato])==null?void 0:n.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){i.abrirModalFornecedor()}}],disable:r.compra.status!=="Digita\xE7\xE3o",rotulo:"Fornecedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1})]),_:1})]),_:1}),e(t,{col:"12 sm6"},{default:o(()=>{var n;return[e(y,{modelValue:(n=r.contatos[r.compra.idContatoVendedor])==null?void 0:n.apelido,"somente-leitura":"",disable:r.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){i.abrirModalVendedor()}}],rotulo:"Vendedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),e(t,{col:"12 sm6"},{default:o(()=>{var n;return[e(y,{modelValue:(n=r.contatos[r.compra.idEmpresa])==null?void 0:n.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){i.abrirModalEmpresa()}}],disable:r.compra.status!=="Digita\xE7\xE3o",rotulo:"Empresa",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1}),e(t,{col:"12 sm6"},{default:o(()=>{var n;return[e(y,{modelValue:(n=r.contatos[r.compra.idContatoComprador])==null?void 0:n.apelido,"somente-leitura":"",disable:r.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){i.abrirModalComprador()}}],rotulo:"Comprador",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),e(t,{col:"12 sm6"},{default:o(()=>{var n;return[e(y,{modelValue:(n=r.contatos[r.compra.idContatoTransportadora])==null?void 0:n.apelido,"somente-leitura":"",disable:r.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){i.abrirModalTransportador()}}],rotulo:"Transportadora",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),e(t,{col:"12 sm6"},{default:o(()=>[e(_,null,{default:o(()=>[e(t,{col:"7"},{default:o(()=>[e(it,{modelValue:r.dataPrevistaEntrega,"onUpdate:modelValue":s[0]||(s[0]=n=>r.dataPrevistaEntrega=n),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1}),e(t,{col:"5"},{default:o(()=>[e(it,{modelValue:r.horaPrevistaEntrega,"onUpdate:modelValue":s[1]||(s[1]=n=>r.horaPrevistaEntrega=n),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(t,{col:"12 sm12 md6"},{default:o(()=>[e(_,{justify:"end",items:"center",text:"right",class:"hideonmobile"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(_,{justify:"end",items:"center"},{default:o(()=>[e(c,{cor:r.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:r.compra.status!=="Digita\xE7\xE3o"},{default:o(()=>[N(J(r.compra.status),1)]),_:1},8,["cor","escuro"]),e(v,{id:r.compra.id,numero:r.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"]),e(de,{color:"tertiary",flat:"",icon:"more_vert",round:""},{default:o(()=>[e(Le,null,{default:o(()=>[be((M(),Y(Pe,{link:"",separator:""},{default:o(()=>[r.alterarPrevisaoEntrega?(M(),Y(me,{key:1,clickable:"",onClick:s[3]||(s[3]=n=>i.ajustarPrevisaoEntrega("salvar"))},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"local_shipping"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N("Salvar Previs\xE3o de Entrega")]),_:1})]),_:1})]),_:1})):(M(),Y(me,{key:0,disable:r.compra.status==="Digita\xE7\xE3o",clickable:"",onClick:s[2]||(s[2]=n=>i.ajustarPrevisaoEntrega("alterar"))},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"local_shipping"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N("Alterar Previs\xE3o de Entrega")]),_:1})]),_:1})]),_:1},8,["disable"])),e(me,{onClick:s[4]||(s[4]=n=>i.dialogImprimirEtiquetas("adicionar",r.compra)),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Adicionar Etiquetas ")]),_:1})]),_:1})]),_:1}),e(me,{onClick:s[5]||(s[5]=n=>i.dialogImprimirEtiquetas("impressao",r.compra)),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Imprimir Etiquetas ")]),_:1})]),_:1})]),_:1})]),_:1})),[[Ee]])]),_:1})]),_:1})]),_:1})]),_:1}),e(t,{col:"shrink"},{default:o(()=>[be(e(m,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${r.$filters.hora(r.compra.dataHoraEmissao)}`},{default:o(()=>[N(J(r.$filters.data(r.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[xe,r.compra.dataHoraEmissao]])]),_:1}),e(t,{col:"shrink"},{default:o(()=>[be(e(m,{text:"caption",icon:"mdi-calendar sm tertiary left",tip:`Finalizado \xE1s ${r.$filters.hora(r.compra.dataHoraFinalizado)}`},{default:o(()=>[N(J(r.$filters.data(r.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[xe,r.compra.dataHoraFinalizado]])]),_:1})]),_:1}),e(_,null,{default:o(()=>[e(t,null,{default:o(()=>[e(y,{modelValue:r.compra.observacao,"onUpdate:modelValue":s[6]||(s[6]=n=>r.compra.observacao=n),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",tipo:"textoArea",rotulo:"Observa\xE7\xE3o",rows:"4"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1}),e(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:o(()=>[r.exibeInfNota?(M(),Y(Et,{key:0,"default-opened":r.compra.notaNumero>0||r.documentoNovo,"header-class":"q-px-sm",class:"notaEntrada g-col col-12"},{header:o(()=>[e(Q,null,{default:o(()=>[e(m,{text:"sub1 medium",icon:"mdi-file-replace sm tertiary left"},{default:o(()=>[N("Nota de Entrada")]),_:1})]),_:1})]),default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(_,null,{default:o(()=>[e(t,{col:"12 sm6 md3"},{default:o(()=>[e(y,{modelValue:r.compra.notaNumero,"onUpdate:modelValue":s[7]||(s[7]=n=>r.compra.notaNumero=n),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Numero",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm6 md3"},{default:o(()=>[e(y,{modelValue:r.compra.notaSerie,"onUpdate:modelValue":s[8]||(s[8]=n=>r.compra.notaSerie=n),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Serie",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm6 md3"},{default:o(()=>[e(y,{modelValue:r.compra.naturezaOperacao,"onUpdate:modelValue":s[9]||(s[9]=n=>r.compra.naturezaOperacao=n),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Natureza da Opera\xE7\xE3o",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm6 md3"},{default:o(()=>[e(y,{modelValue:r.compra.dataCompra,"onUpdate:modelValue":s[10]||(s[10]=n=>r.compra.dataCompra=n),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Data compra",tipo:"data",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12"},{default:o(()=>[e(y,{modelValue:r.compra.chaveAcesso,"onUpdate:modelValue":s[11]||(s[11]=n=>r.compra.chaveAcesso=n),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Chave",dense:""},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1},8,["default-opened"])):oe("",!0)]),_:1}),e(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(m,{text:"sub1 medium",icon:"shopping_cart sm tertiary left"},{default:o(()=>[N("Carrinho "),e(de,{onClick:s[12]||(s[12]=n=>i.adicionarItem()),disable:r.compra.status!=="Digita\xE7\xE3o",icon:"add",label:"Produto",size:"md",color:"primary",flat:"",dense:"",class:"float-right q-px-sm"},null,8,["disable"])]),_:1})]),_:1}),(M(!0),_e(ke,null,Ne(r.compraItens,(n,b)=>(M(),Y(t,{col:"12",key:b},{default:o(()=>[e(Pe,{class:"full-width"},{default:o(()=>[e(me,{class:"q-px-none"},{default:o(()=>{var d;return[e(Q,{avatar:"",class:"col-auto"},{default:o(()=>{var g;return[e(p,{imagem:(g=r.produtos[n.idItem])==null?void 0:g.imagem,rotulo:n.descricaoItem,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:2},1024),e(Q,{class:"q-px-none"},{default:o(()=>[e(se,null,{default:o(()=>[N(J(n.descricaoItem),1)]),_:2},1024),e(se,{caption:""},{default:o(()=>{var g,S;return[N(J((S=(g=r.produtos[n.idItem])==null?void 0:g.marca)!=null?S:""),1)]}),_:2},1024)]),_:2},1024),be(e(Q,{avatar:""},{default:o(()=>[e(c,{denso:""},{default:o(()=>{var g,S;return[N(J((S=(g=r.produtos[n.idItem])==null?void 0:g.referencia)!=null?S:""),1)]}),_:2},1024)]),_:2},1536),[[xe,(d=r.produtos[n.idItem])==null?void 0:d.referencia]]),e(Q,{avatar:""},{default:o(()=>[fe("div",jt,[fe("div",Ht,[e(de,{color:"primary",dense:"",flat:"",icon:"edit",round:"",onClick:g=>i.editarProduto(n),disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),fe("div",Zt,[e(de,{color:"tertiary",dense:"",flat:"",icon:"delete",round:"",onClick:g=>i.removerItem(n),disable:r.compra.status!=="Digita\xE7\xE3o"},{default:o(()=>[e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N("Remover Item")]),_:1})]),_:2},1032,["onClick","disable"])]),fe("div",Xt,[e(de,{color:"tertiary",dense:"",flat:"",icon:"more_vert",round:"",disable:r.compra.status!=="Digita\xE7\xE3o"},{default:o(()=>[e(Le,null,{default:o(()=>[be((M(),Y(Pe,{link:"",separator:""},{default:o(()=>[r.compra.status==="Digita\xE7\xE3o"?(M(),_e(ke,{key:0},[(M(!0),_e(ke,null,Ne(r.comprasMigrar,g=>(M(),Y(me,{key:g.id,clickable:"",onClick:S=>i.migrarParaOutraCompra(n,g)},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"mdi-folder-move"})]),_:1}),e(Q,null,{default:o(()=>[N(J("Migrar para Compra #"+(g.numero||g.id.slice(-6))),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),e(me,{clickable:"",onClick:g=>i.migrarParaOutraCompra(n)},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"mdi-folder-move"})]),_:1}),e(Q,null,{default:o(()=>[N("Migrar para nova Compra")]),_:1})]),_:2},1032,["onClick"])],64)):oe("",!0)]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1032,["disable"])])])]),_:2},1024)]}),_:2},1024)]),_:2},1024),e(_,null,{default:o(()=>[e(t,{col:"4 md"},{default:o(()=>[e(y,{dense:"",align:"left",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Valor do produto",modelValue:n.valorItem,"onUpdate:modelValue":d=>n.valorItem=d,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",onBlur:d=>i.calcularTotaisItem(b,"valorItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024),e(t,{col:"4 md"},{default:o(()=>[e(_,{items:"center"},{default:o(()=>[e(t,{col:"shrink"},{default:o(()=>[e(ce,{name:"mdi-minus",color:"primary"})]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(y,{dense:"",opcoes:{maximumValue:100},tipo:"decimal",decimals:"2",rotulo:"Desconto percentual",modelValue:n.descontoPercentualItem,"onUpdate:modelValue":d=>n.descontoPercentualItem=d,outlined:"",suffix:"%","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",onBlur:d=>i.calcularTotaisItem(b,"descontoPercentualItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(t,{col:"4 md"},{default:o(()=>[e(y,{dense:"",tipo:"decimal",modelValue:n.descontoItem,"onUpdate:modelValue":d=>n.descontoItem=d,decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Desconto em reais",prefix:"R$",onBlur:d=>i.calcularTotaisItem(b,"descontoItem"),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),e(t,{col:"6 md"},{default:o(()=>[e(_,{items:"center"},{default:o(()=>[e(t,{col:"shrink",class:"hideonmobile"},{default:o(()=>[e(ce,{name:"mdi-equal",color:"primary"})]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(y,{dense:"",outlined:"",opcoes:{maximumValue:10,minimumValue:0},rotulo:"Subtotal",tipo:"decimal",decimals:"4",zerosDireita:"2",modelValue:n.subTotal,"onUpdate:modelValue":d=>n.subTotal=d,onBlur:d=>i.calcularTotaisItem(b,"subTotal"),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(t,{col:"6 md"},{default:o(()=>[e(_,{items:"center"},{default:o(()=>[e(t,{col:"shrink"},{default:o(()=>[e(ce,{name:"mdi-close",color:"primary"})]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(y,{dense:"",max:"100",min:"0",outlined:"",modelValue:n.quantidade,"onUpdate:modelValue":d=>n.quantidade=d,decimals:"4",zerosDireita:"0",tipo:"quantidade",onBlur:d=>i.calcularTotaisItem(b),disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","disable"]),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N("Quantidade")]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),e(t,{col:"12 md"},{default:o(()=>[e(_,{items:"center"},{default:o(()=>[e(t,{col:"shrink",class:"hideonmobile"},{default:o(()=>[e(ce,{name:"mdi-equal",color:"primary"})]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(y,{dense:"",tipo:"decimal",decimals:"2",rotulo:"Total","somente-leitura":"",modelValue:n.total,"onUpdate:modelValue":d=>n.total=d,outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(t,{col:"12"},{default:o(()=>[e(_,{gutter:"md",mg:"md-y",justify:"end",items:"center",bg:"bg-light","rounded-borders":"","min-height":"49px"},{default:o(()=>[e(t,{col:"3 sm2 md-shrink",text:"bold"},{default:o(()=>[N(" Calcular ")]),_:1}),e(t,{col:"9 sm10 md"},{default:o(()=>[e(Me,{modelValue:r.compra.calcularTributacao,"onUpdate:modelValue":[s[13]||(s[13]=n=>r.compra.calcularTributacao=n),i.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),e(t,{col:"6 md-shrink"},{default:o(()=>[N(" Base ICMS ")]),_:1}),e(t,{col:"6 md",text:"right"},{default:o(()=>[e(y,{dense:"",outlined:"",decimals:"2",zerosDireita:"2",tipo:"decimal",modelValue:r.compra.valorBaseIcms,"onUpdate:modelValue":s[14]||(s[14]=n=>r.compra.valorBaseIcms=n),"somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"6 md-shrink"},{default:o(()=>[N(" Valor ICMS ")]),_:1}),e(t,{col:"6 md",text:"right"},{default:o(()=>[e(y,{dense:"",outlined:"",modelValue:r.compra.valorIcms,"onUpdate:modelValue":s[15]||(s[15]=n=>r.compra.valorIcms=n),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"6 md-shrink"},{default:o(()=>[N(" Base ICMS ST ")]),_:1}),e(t,{col:"6 md",text:"right"},{default:o(()=>[e(y,{dense:"",outlined:"",modelValue:r.compra.valorBaseIcmsSt,"onUpdate:modelValue":s[16]||(s[16]=n=>r.compra.valorBaseIcmsSt=n),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"6 md-shrink"},{default:o(()=>[N(" ICMS ST ")]),_:1}),e(t,{col:"6 md",text:"right"},{default:o(()=>[e(y,{dense:"",outlined:"",modelValue:r.compra.valorIcmsSt,"onUpdate:modelValue":s[17]||(s[17]=n=>r.compra.valorIcmsSt=n),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1}),e(_,{mg:"lg-t",justify:"end"},{default:o(()=>[e(t,{col:"xs12 sm8 md4"},{default:o(()=>[e(_,{items:"center"},{default:o(()=>[e(t,{col:"3",text:"bold"},{default:o(()=>[N(" Subtotal ")]),_:1}),e(t,{col:"xs",text:"right bold"},{default:o(()=>[N(J(r.$filters.numero(r.compra.subTotalProduto,2)),1)]),_:1})]),_:1}),e(ut,{class:"q-mb-md q-mt-xs"}),e(_,{items:"center"},{default:o(()=>[e(t,{col:"xs3"},{default:o(()=>[N(" Desconto ")]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.totalPercentualDesconto,"onUpdate:modelValue":s[18]||(s[18]=n=>r.compra.totalPercentualDesconto=n),onBlur:s[19]||(s[19]=n=>i.calcularTotais("totalPercentualDesconto")),suffix:"%",error:r.erroDesconto,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.totalDesconto,"onUpdate:modelValue":s[20]||(s[20]=n=>r.compra.totalDesconto=n),onBlur:s[21]||(s[21]=n=>i.calcularTotais("totalDesconto")),error:r.erroDesconto,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1})]),_:1}),e(_,{items:"center"},{default:o(()=>[e(t,{col:"xs3"},{default:o(()=>[N(" Frete ")]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(ht,{class:"q-mr-md",label:"CIF",val:"CIF",modelValue:r.compra.tipoFrete,"onUpdate:modelValue":[s[22]||(s[22]=n=>r.compra.tipoFrete=n),i.calcularTotais],dense:"",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"]),e(ht,{label:"FOB",val:"FOB",modelValue:r.compra.tipoFrete,"onUpdate:modelValue":[s[23]||(s[23]=n=>r.compra.tipoFrete=n),i.calcularTotais],dense:"",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.valorFrete,"onUpdate:modelValue":s[24]||(s[24]=n=>r.compra.valorFrete=n),onBlur:i.calcularTotais,error:r.erroFrete,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),e(_,{items:"center"},{default:o(()=>[e(t,{col:"xs3"},{default:o(()=>[N(" Seguro ")]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.valorSeguro,"onUpdate:modelValue":s[25]||(s[25]=n=>r.compra.valorSeguro=n),onBlur:i.calcularTotais,error:r.erroSeguro,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),e(_,{items:"center"},{default:o(()=>[e(t,{col:"xs5"},{default:o(()=>[N(" Outras despesas ")]),_:1}),e(t,{col:"xs"},{default:o(()=>[e(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.valorOutrasDespesas,"onUpdate:modelValue":s[26]||(s[26]=n=>r.compra.valorOutrasDespesas=n),onBlur:i.calcularTotais,error:r.erroOutrasDespesas,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),e(ut,{class:"q-mt-md q-mb-xs"}),e(_,{items:"center"},{default:o(()=>[e(t,{col:"xs4",text:"bold"},{default:o(()=>[N(" Total ")]),_:1}),e(t,{col:"xs",text:"right bold"},{default:o(()=>[N(J(r.$filters.numero(r.compra.totalProduto,2)),1)]),_:1})]),_:1}),r.compra.totalComImposto?(M(),Y(_,{key:0,items:"center"},{default:o(()=>[e(t,{col:"xs4",text:"bold"},{default:o(()=>[N(" Total IPI ")]),_:1}),e(t,{col:"xs",text:"right bold"},{default:o(()=>[N(J(r.$filters.numero(r.compra.valorIpi,2)),1)]),_:1})]),_:1})):oe("",!0),e(_,{items:"center"},{default:o(()=>[e(t,{col:"xs5",text:"bold"},{default:o(()=>[N(" Total c/ Impostos ")]),_:1}),e(t,{col:"xs-shrink"},{default:o(()=>[e(Me,{disable:r.compra.status!=="Digita\xE7\xE3o",modelValue:r.compra.totalComImposto,"onUpdate:modelValue":[s[27]||(s[27]=n=>r.compra.totalComImposto=n),i.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear"},null,8,["disable","modelValue","onUpdate:modelValue"])]),_:1}),e(t,{col:"xs",text:"right bold"},{default:o(()=>[N(J(r.$filters.numero(r.compra.totalDocumento,2)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(m,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:o(()=>[N("Faturar")]),_:1})]),_:1}),e(t,{col:"12"},{default:o(()=>[e(y,{modelValue:r.compra.observacaoFaturamento,"onUpdate:modelValue":s[28]||(s[28]=n=>r.compra.observacaoFaturamento=n),tipo:"textoArea",rotulo:"Observa\xE7\xE3o faturamento",rows:"5"},null,8,["modelValue"])]),_:1}),e(t,{col:"12"},{default:o(()=>[e(ot,{ref:"formAdicionarPagamento"},{default:o(()=>[e(_,{mg:"md-y",items:"center"},{default:o(()=>[e(t,{col:"12 sm6 md"},{default:o(()=>[e(y,{modelValue:r.compra.formaDePagamento,"onUpdate:modelValue":s[29]||(s[29]=n=>r.compra.formaDePagamento=n),rules:r.formaPagamentoRules,ajuda:"Exemplo: Boleto","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Forma de pagamento"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),e(t,{col:"12 sm6 md"},{default:o(()=>[e(y,{modelValue:r.compra.condicaoPagamento,"onUpdate:modelValue":s[30]||(s[30]=n=>r.compra.condicaoPagamento=n),rules:r.condicaoPagamentoRules,ajuda:"Exemplo: 28/56/64","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Cond. Pag",tipo:"numero"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),e(t,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:o(()=>[N(" Frete Separado "),e(Me,{modelValue:r.compra.freteSeparado,"onUpdate:modelValue":[s[31]||(s[31]=n=>r.compra.freteSeparado=n),i.calcularTotais],disable:r.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),e(t,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:o(()=>[N(" N\xE3o gerar financeiro "),e(Me,{modelValue:r.compra.naoGerarFinanceiro,"onUpdate:modelValue":[s[32]||(s[32]=n=>r.compra.naoGerarFinanceiro=n),i.calcularTotais],disable:r.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),e(t,{col:"12 sm4 md",text:"center"},{default:o(()=>[e(de,{onClick:i.gerarCondicoesDePagamento_click,disable:r.compra.status!=="Digita\xE7\xE3o",color:"positive",icon:"add",label:"Forma de pagamento",outline:"",size:"sm"},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(t,{col:"12"},{default:o(()=>[be(e(m,{text:"sub1 medium"},{default:o(()=>[N("Condi\xE7\xF5es de pagamento")]),_:1},512),[[xe,r.compraCondicoesDePagamento.length>0]]),(M(!0),_e(ke,null,Ne(r.compraCondicoesDePagamento,n=>(M(),Y(Pe,{highlight:"",class:"q-pa-none",key:n.id},{default:o(()=>[e(_,{gutter:"md",mg:"sm-y",items:"center",bordered:"","rounded-borders":""},{default:o(()=>[e(t,{col:"xs6 md-shrink"},{default:o(()=>[e(y,{modelValue:n.dataVencimento,"onUpdate:modelValue":b=>n.dataVencimento=b,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),e(t,{col:"xs6 md2"},{default:o(()=>[e(y,{modelValue:n.valor,"onUpdate:modelValue":b=>n.valor=b,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",align:"left",rotulo:"Valor",decimals:"2",zerosDireita:"2",tipo:"decimal"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),e(t,{col:"xs-grow"},{default:o(()=>[e(y,{modelValue:n.observacao,"onUpdate:modelValue":b=>n.observacao=b,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"||n.observacao==="Valor Frete + Seguro",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),e(t,{col:"xs-shrink",text:"right"},{default:o(()=>[e(de,{onClick:b=>i.removerPagamento_click(n),icon:"delete",round:"",dense:"",flat:"",color:"tertiary",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),r.valorTotalPagamento>0?(M(),Y(_,{key:0,mg:"sm-t"},{default:o(()=>[e(t,{col:"xs-shrink",text:"bold"},{default:o(()=>[N(" Valor total: "+J(r.$filters.numero(r.valorTotalPagamento,2)),1)]),_:1})]),_:1})):oe("",!0)]),_:1})]),_:1}),r.$db.usuario.desenvolvedor()?(M(),Y(_,{key:0,gutter:"md",mg:"md",bg:"bg-yellow"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(m,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:o(()=>[N("Contabilidade (apenas desenvolvedor)")]),_:1})]),_:1}),e(t,{col:"12"},{default:o(()=>[r.compraTitulos.length?(M(),Y(m,{key:0,text:"sub1 medium"},{default:o(()=>[N("Titulos")]),_:1})):oe("",!0),e(Pe,{highlight:"",class:"q-pa-none"},{default:o(()=>[(M(!0),_e(ke,null,Ne(r.compraTitulos,n=>(M(),Y(_,{key:n.id,items:"center"},{default:o(()=>[e(t,{col:"sm2"},{default:o(()=>[e(y,{modelValue:n.dataVencimento,"somente-leitura":"",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),e(t,{col:"sm2"},{default:o(()=>[e(y,{modelValue:n.dataPagamento||"A pagar","somente-leitura":"",rotulo:"Data pagamento",tipo:n.dataPagamento?"data":"texto",dense:""},null,8,["modelValue","tipo"])]),_:2},1024),e(t,{col:"sm2"},{default:o(()=>[e(y,{modelValue:n.valor,"somente-leitura":"",align:"left",rotulo:"Valor",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024),e(t,{col:"sm2"},{default:o(()=>[e(y,{modelValue:n.parcela,"somente-leitura":"",align:"left",rotulo:"Parcela"},null,8,["modelValue"])]),_:2},1024),e(t,{col:"sm2"},{default:o(()=>[e(y,{modelValue:n.formaDePagamento,"somente-leitura":"",rotulo:"Forma de pagamento"},null,8,["modelValue"])]),_:2},1024),e(t,{col:"sm2"},{default:o(()=>[e(y,{modelValue:n.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(t,{col:"12"},{default:o(()=>[r.compraMovimentacoes.length?(M(),Y(m,{key:0,text:"sub1 medium"},{default:o(()=>[N("Movimenta\xE7\xF4es")]),_:1})):oe("",!0),e(Pe,{highlight:"",class:"q-pa-none"},{default:o(()=>[(M(!0),_e(ke,null,Ne(r.compraMovimentacoes,n=>(M(),Y(_,{key:n.id,gutter:"sm",mg:"sm-y",items:"center"},{default:o(()=>[e(t,{col:"xs-grow"},{default:o(()=>[e(y,{modelValue:n.descricao,"somente-leitura":"",rotulo:"Descri\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024),n.valorCredito?(M(),Y(t,{key:0,col:"xs6 md2"},{default:o(()=>[e(y,{modelValue:n.valorCredito,"somente-leitura":"",align:"left",rotulo:"Valor Credito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):oe("",!0),n.valorDebito?(M(),Y(t,{key:1,col:"xs6 md2"},{default:o(()=>[e(y,{modelValue:n.valorDebito,"somente-leitura":"",align:"left",rotulo:"Valor Debito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):oe("",!0),e(t,{col:"xs6 md-shrink"},{default:o(()=>[e(y,{modelValue:n.dataCompetencia,"somente-leitura":"",rotulo:"Data competencia",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),e(t,{col:"xs-grow"},{default:o(()=>[e(y,{modelValue:n.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):oe("",!0),r.$db.usuario.desenvolvedor()&&r.compraDocumentoXml.length?(M(),Y(_,{key:1,gutter:"md",mg:"md",bg:"bg-yellow"},{default:o(()=>[e(t,{col:"12"},{default:o(()=>[e(m,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:o(()=>[N("XML importado (apenas desenvolvedor)")]),_:1})]),_:1}),e(t,{col:"12"},{default:o(()=>[e(Pe,{highlight:"",class:"q-pa-none"},{default:o(()=>[(M(!0),_e(ke,null,Ne(r.compraDocumentoXml,n=>(M(),Y(_,{key:n.id},{default:o(()=>[fe("pre",null,J(i.formatXml(n.xmlData)),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):oe("",!0)]),_:1})]),_:1}),e(Ye,{class:"bg-light border-top"},{default:o(()=>[e(Te,{class:"bg-light text-tertiary q-px-md u-container"},{default:o(()=>[e(Re,{class:"text-subtitle2"},{default:o(()=>[N(" Valor Total: "+J(r.$filters.numero(r.compra.totalDocumento,2))+" ",1),Wt,N(" SKU: "+J(i.skus),1)]),_:1}),e(rt),be(e(de,{onClick:i.excluir_click,type:"submit",class:"q-ml-sm",color:"white","text-color":"negative",flat:"",label:"Excluir"},null,8,["onClick"]),[[xe,r.compra.status==="Digita\xE7\xE3o"]]),be(e(de,{onClick:i.finalizar_click,type:"submit",class:"q-ml-sm",color:"primary",unelevated:"",label:"Finalizar"},null,8,["onClick"]),[[xe,r.compra.status==="Digita\xE7\xE3o"]]),be(e(de,{onClick:i.reabrir_click,color:"tertiary",flat:"",label:"Reabrir",type:"submit",class:"q-ml-sm"},null,8,["onClick"]),[[xe,r.compra.status==="Finalizado"]]),be(e(de,{unelevated:"",onClick:i.transformarEmNotaDeEntrada_click,class:"q-ml-sm",color:"primary",label:"Transformar em Nota de Entrada",type:"submit"},null,8,["onClick"]),[[xe,r.compra.status==="Finalizado"&&r.compra.operacao==="Pedido de Compra"]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),e(l,{ref:"ModalEditarProdutoCompras",onSalvar:i.fecharEdicaoProduto},null,8,["onSalvar"]),e(I,{modelValue:r.adicionar.modal.value,"onUpdate:modelValue":s[34]||(s[34]=n=>r.adicionar.modal.value=n),filtro:{ativo:!0,idEmpresa:r.compra.idEmpresa},ref:"promptItem",habilitarQuantidade:!0,exibirValorVenda:!1,calculaItemCusto:!0,onSelecionarItens:i.selecionarItens},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var Qt=nt($t,[["render",Gt]]);const Kt={components:{PromptItemV2:vt},data(){return{mostrarItemModal:!1,idxItem:0,compra:{},compraItens:[],visivel:!1,edicaoGeral:{marca:"",grupo:"",subGrupo:"",percentualMarkup:0}}},emits:["atualizar","concluirImportacao"],computed:{produtosNaoVinculados(){return this.compraItens.reduce((r,s)=>r+(s.vinculado?0:1),0)},quantProdutos(){return this.compraItens.reduce((r,s)=>r+1,0)}},methods:{async mostrar(r){for(const s of r.documentosItem)this.recalcularItem_blur(s);this.compra=r,this.compraItens=r.documentosItem,this.visivel=!0},async fechar(){this.visivel=!1},async selecionarItens(r){await $tryLoading(async()=>{var m;const s=(m=Object.values(r)[0])==null?void 0:m.item;$utils.verificarErro(!(s!=null&&s.id),"Produto inv\xE1lido"),this.compraItens[this.idxItem].item=s;const{documentoItem:h,item:w,nfeProd:a}=this.compraItens[this.idxItem];h.idItem=w.id,h.descricaoItem=w.descricao;const i={id:$utils.uuid(),idItem:h.idItem,idContato:this.compra.documento.idContato,referencia:a.cProd,descricao:a.xProd};this.compra.itensFornecedor.push(i),this.compraItens[this.idxItem].vinculado=!0,$q.notifyPositive(`Produto vinculado com sucesso: ${w.descricao}`)},{mensagem:"Vinculando produto..."}),this.mostrarItemModal=!1},aplicar_click(){for(const r of this.compraItens)r.vinculado||(this.edicaoGeral.marca&&(r.item.marca=this.edicaoGeral.marca),this.edicaoGeral.grupo&&(r.item.grupo=this.edicaoGeral.grupo),this.edicaoGeral.subGrupo&&(r.item.subGrupo=this.edicaoGeral.subGrupo),this.edicaoGeral.percentualMarkup&&(r.item.percentualMarkup=this.edicaoGeral.percentualMarkup,this.recalcularItem_blur(r)))},async recalcularItem_blur(r){const{item:s,documentoItem:h,itemAnterior:w=$utils.clonarV2(r.item)}=r,{valorFreteRateado:a=0,valorSeguroRateado:i=0,valorOutrasDespesasRateado:m=0}=h;r.valoresEdicao||(r.valoresEdicao={valorOutrasDespesas:a+i+m,percentualIpi:h.percentualIpi||0,percentualIcmsSt:h.percentualIcmsSt||0,percentualDifal:0});const{valorOutrasDespesas:t,percentualIpi:c,percentualIcmsSt:v,percentualDifal:_}=r.valoresEdicao,{valorCusto:p=0,percentualMarkup:y=0,valorVenda:l=0}=s,I=p+t,n=I*c/100,b=I*v/100,d=I*_/100;s.valorCustoReposicao=$utils.arredondar(I+n+b+d,2),l!==w.valorVenda?s.percentualMarkup=$utils.arredondar(100*(l-s.valorCustoReposicao)/l,2):s.valorVenda=$utils.arredondar(s.valorCustoReposicao/(1-y/100),2),r.itemAnterior=$utils.clonarV2(s)},async adicionarItem_click(r){r.buttonLoading=!0,await this.$nextTick(),await $tryLoading(async()=>{const s=await $db.hibrido.lista({table:"item",where:{referencia:r.item.referencia}});$utils.verificarErro(s.length,"Referencia j\xE1 utilizada por outro produto"),r.documentoItem.descricaoItem=r.item.descricao,r.item.descricaoConcatenada=r.item.descricao;const h=r.nfeProd,w={id:$utils.uuid(),idItem:r.item.id,idContato:this.compra.documento.idContato,referencia:h.cProd,descricao:h.xProd};this.compra.itens.push(r.item),this.compra.itensFornecedor.push(w),r.vinculado=!0,$q.notifyPositive(`Item criado com sucesso: ${r.item.descricao}`)},{mensagem:"Cadastrando produto..."}),r.buttonLoading=!1},async salvar_click(){this.compraItens.some(({vinculado:r})=>!r)?$q.notifyError("Verifique todos os itens n\xE3o vinculados!"):(this.mostrarItemModal=!1,this.visivel=!1,this.$emit("concluirImportacao",this.compra))},async incluirTodos_click(){for(const r of this.compraItens)r.vinculado||await this.adicionarItem_click(r)}}},Yt={class:"layout-padding q-pa-none q-pb-md"},Jt={class:"items-carrinho items-center row q-pa-none rounded-borders u-container",style:{"margin-top":"12px","margin-bottom":"12px"}},ea=fe("div",{class:"col-8"},null,-1),ta={class:"col-2"},aa=["id"],oa={class:"col-12"},ra={class:"col-4 col-md"},ia={class:"col-4 col-md"},na={class:"col-4 col-md"},sa={class:"col-4 col-md"},la={class:"col-6 col-md"},da={class:"col-12 col-md"},ua={class:"col-6 col-md"},ca={class:"col-12 col-md"},ma={key:0,class:"col-12"},fa={class:"col-12 col-md-4"},pa=fe("div",{class:"col-12 col-md-auto"},"ou",-1),ha={class:"col-12 col-md-auto q-pl-none"},ga={key:1,class:"col-12 q-pt-md text-right text-bold"},va={class:"text-positive"};function ba(r,s,h,w,a,i){const m=ge("ajuda"),t=ge("campo"),c=ge("row"),v=ge("card"),_=ge("PromptItemV2");return M(),_e(ke,null,[e($e,{modelValue:a.visivel,"onUpdate:modelValue":s[4]||(s[4]=p=>a.visivel=p),persistent:"",maximized:"",onKeyup:bt(i.fechar,["esc"])},{default:o(()=>[e(je,{container:"",view:"hHh LpR fFf",class:"bg-light"},{default:o(()=>[e(He,null,{default:o(()=>[e(Te,null,{default:o(()=>[e(de,{icon:"arrow_back",flat:"",round:"",dense:"",onClick:i.fechar},null,8,["onClick"]),e(Re,null,{default:o(()=>[N("Importar XML x Cadastro")]),_:1}),e(m)]),_:1})]),_:1}),e(Ze,null,{default:o(()=>[e(Xe,null,{default:o(()=>[fe("div",Yt,[fe("div",Jt,[e(v,{icon:"mdi-set-none",label:"Propriedades para todos os produtos",class:"full-width"},{default:o(()=>[e(c,null,{default:o(()=>[e(t,{modelValue:a.edicaoGeral.marca,"onUpdate:modelValue":s[0]||(s[0]=p=>a.edicaoGeral.marca=p),rotulo:"Marca",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"]),e(t,{modelValue:a.edicaoGeral.grupo,"onUpdate:modelValue":s[1]||(s[1]=p=>a.edicaoGeral.grupo=p),rotulo:"Grupo",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"]),e(t,{modelValue:a.edicaoGeral.subGrupo,"onUpdate:modelValue":s[2]||(s[2]=p=>a.edicaoGeral.subGrupo=p),rotulo:"SubGrupo",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"])]),_:1}),e(c,{class:"q-pt-sm"},{default:o(()=>[ea,e(t,{modelValue:a.edicaoGeral.percentualMarkup,"onUpdate:modelValue":s[3]||(s[3]=p=>a.edicaoGeral.percentualMarkup=p),rotulo:"Margem de Lucro",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2",outlined:"",col:"2"},null,8,["modelValue"]),fe("div",ta,[e(de,{class:"q-ml-sm no-shadow",color:"primary",icon:"play_arrow",unelevated:"",label:"Aplicar",onClick:i.aplicar_click},null,8,["onClick"])])]),_:1})]),_:1})]),e(Dt,{items:a.compraItens.filter(({vinculado:p})=>!p),separator:""},{default:o(({item:p,index:y})=>[fe("div",{class:"items-carrinho items-center row q-pa-md bg-white rounded-borders u-container",style:{"margin-top":"12px","margin-bottom":"12px"},id:y},[e(Pe,{class:"full-width"},{default:o(()=>[e(me,{class:"q-px-none"},{default:o(()=>[e(Q,{class:"q-px-none"},{default:o(()=>[e(se,null,{default:o(()=>[e(t,{dense:"",align:"left",tipo:"texto",outlined:"",rotulo:"Descri\xE7\xE3o Item",modelValue:p.item.descricao,"onUpdate:modelValue":l=>p.item.descricao=l,"somente-leitura":!!p.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[e(t,{dense:"",align:"left",tipo:"texto",outlined:"",rotulo:"Referencia",modelValue:p.item.referencia,"onUpdate:modelValue":l=>p.item.referencia=l,"somente-leitura":!!p.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(Pe,{class:"full-width"},{default:o(()=>[e(me,{class:"q-px-none"},{default:o(()=>[e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[e(t,{dense:"",tipo:"texto",outlined:"",rotulo:"Marca",modelValue:p.item.marca,"onUpdate:modelValue":l=>p.item.marca=l,"somente-leitura":!!p.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[e(t,{dense:"",tipo:"texto",outlined:"",rotulo:"Grupo",modelValue:p.item.grupo,"onUpdate:modelValue":l=>p.item.grupo=l,"somente-leitura":!!p.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[e(t,{dense:"",tipo:"texto",outlined:"",rotulo:"SubGrupo",modelValue:p.item.subGrupo,"onUpdate:modelValue":l=>p.item.subGrupo=l,"somente-leitura":!!p.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),fe("div",oa,[e(c,{class:"q-col-gutter-sm"},{default:o(()=>[fe("div",ra,[e(t,{modelValue:p.item.valorCusto,"onUpdate:modelValue":l=>p.item.valorCusto=l,rotulo:"Valor pr\xE9 custo",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":""},null,8,["modelValue","onUpdate:modelValue"])]),fe("div",ia,[e(t,{modelValue:p.valoresEdicao.valorOutrasDespesas,"onUpdate:modelValue":l=>p.valoresEdicao.valorOutrasDespesas=l,rotulo:"Outras Despesas",dense:"",tipo:"decimal",decimals:"4","somente-leitura":!!p.vinculado,outlined:"",onBlur:l=>i.recalcularItem_blur(p)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),fe("div",na,[e(t,{modelValue:p.valoresEdicao.percentualIpi,"onUpdate:modelValue":l=>p.valoresEdicao.percentualIpi=l,rotulo:"IPI",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!p.vinculado,outlined:"",onBlur:l=>i.recalcularItem_blur(p)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),fe("div",sa,[e(t,{modelValue:p.valoresEdicao.percentualIcmsSt,"onUpdate:modelValue":l=>p.valoresEdicao.percentualIcmsSt=l,rotulo:"ST",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!p.vinculado,outlined:"",onBlur:l=>i.recalcularItem_blur(p)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),fe("div",la,[e(t,{modelValue:p.valoresEdicao.percentualDifal,"onUpdate:modelValue":l=>p.valoresEdicao.percentualDifal=l,rotulo:"DIFAL",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!p.vinculado,outlined:"",onBlur:l=>i.recalcularItem_blur(p)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),fe("div",da,[e(t,{modelValue:p.item.valorCustoReposicao,"onUpdate:modelValue":l=>p.item.valorCustoReposicao=l,rotulo:"Custo de reposi\xE7\xE3o",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":""},null,8,["modelValue","onUpdate:modelValue"])]),fe("div",ua,[e(t,{modelValue:p.item.percentualMarkup,"onUpdate:modelValue":l=>p.item.percentualMarkup=l,rotulo:"Margem de Lucro",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!p.vinculado,outlined:"",onBlur:l=>i.recalcularItem_blur(p)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),fe("div",ca,[e(t,{modelValue:p.item.valorVenda,"onUpdate:modelValue":l=>p.item.valorVenda=l,rotulo:"Valor de Venda",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":!!p.vinculado,onBlur:l=>i.recalcularItem_blur(p)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])])]),_:2},1024)]),p.vinculado?(M(),_e("div",ga," Produto vinculado ")):(M(),_e("div",ma,[e(c,{class:"q-mt-lg text-right full-width justify-end items-center"},{default:o(()=>[fe("div",fa,[e(de,{class:"q-ml-sm no-shadow",color:"primary",icon:"search",unelevated:"",label:"Vincular",onClick:()=>{a.mostrarItemModal=!a.mostrarItemModal,a.idxItem=y}},null,8,["onClick"])]),pa,fe("div",ha,[e(de,{loading:p.buttonLoading,class:"q-ml-sm no-shadow",color:"primary",icon:"add",unelevated:"",label:"Novo",onClick:l=>i.adicionarItem_click(p)},null,8,["loading","onClick"])])]),_:2},1024)]))],8,aa)]),_:1},8,["items"])])]),_:1})]),_:1}),e(Ye,{class:"bg-light"},{default:o(()=>[e(Te,null,{default:o(()=>[e(Re,null,{default:o(()=>[fe("span",va,"Produtos: "+J(i.quantProdutos)+" - N\xE3o vinculados: "+J(i.produtosNaoVinculados),1)]),_:1}),i.produtosNaoVinculados?(M(),Y(de,{key:0,class:"q-ml-sm no-shadow float-right",color:"primary",label:"Incluir Todos",onClick:i.incluirTodos_click,unelevated:""},null,8,["onClick"])):(M(),Y(de,{key:1,class:"q-ml-sm no-shadow float-right",color:"primary",label:"Salvar",onClick:i.salvar_click,unelevated:""},null,8,["onClick"]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),e(_,{modelValue:a.mostrarItemModal,"onUpdate:modelValue":s[5]||(s[5]=p=>a.mostrarItemModal=p),habilitarQuantidade:!1,filtro:{ativo:!0,idEmpresa:a.compra.idEmpresa},exibirValorVenda:!1,onSelecionarItens:i.selecionarItens,ref:"promptItem"},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var _a=nt(Kt,[["render",ba]]),_t={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,s){(function(h){r.exports=h()})(function(){return function h(w,a,i){function m(v,_){if(!a[v]){if(!w[v]){var p=typeof at=="function"&&at;if(!_&&p)return p(v,!0);if(t)return t(v,!0);var y=new Error("Cannot find module '"+v+"'");throw y.code="MODULE_NOT_FOUND",y}var l=a[v]={exports:{}};w[v][0].call(l.exports,function(I){var n=w[v][1][I];return m(n||I)},l,l.exports,h,w,a,i)}return a[v].exports}for(var t=typeof at=="function"&&at,c=0;c<i.length;c++)m(i[c]);return m}({1:[function(h,w,a){var i=h("./utils"),m=h("./support"),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(c){for(var v,_,p,y,l,I,n,b=[],d=0,g=c.length,S=g,D=i.getTypeOf(c)!=="string";d<c.length;)S=g-d,p=D?(v=c[d++],_=d<g?c[d++]:0,d<g?c[d++]:0):(v=c.charCodeAt(d++),_=d<g?c.charCodeAt(d++):0,d<g?c.charCodeAt(d++):0),y=v>>2,l=(3&v)<<4|_>>4,I=1<S?(15&_)<<2|p>>6:64,n=2<S?63&p:64,b.push(t.charAt(y)+t.charAt(l)+t.charAt(I)+t.charAt(n));return b.join("")},a.decode=function(c){var v,_,p,y,l,I,n=0,b=0,d="data:";if(c.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var g,S=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===t.charAt(64)&&S--,c.charAt(c.length-2)===t.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=m.uint8array?new Uint8Array(0|S):new Array(0|S);n<c.length;)v=t.indexOf(c.charAt(n++))<<2|(y=t.indexOf(c.charAt(n++)))>>4,_=(15&y)<<4|(l=t.indexOf(c.charAt(n++)))>>2,p=(3&l)<<6|(I=t.indexOf(c.charAt(n++))),g[b++]=v,l!==64&&(g[b++]=_),I!==64&&(g[b++]=p);return g}},{"./support":30,"./utils":32}],2:[function(h,w,a){var i=h("./external"),m=h("./stream/DataWorker"),t=h("./stream/Crc32Probe"),c=h("./stream/DataLengthProbe");function v(_,p,y,l,I){this.compressedSize=_,this.uncompressedSize=p,this.crc32=y,this.compression=l,this.compressedContent=I}v.prototype={getContentWorker:function(){var _=new m(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),p=this;return _.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new m(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},v.createWorkerFrom=function(_,p,y){return _.pipe(new t).pipe(new c("uncompressedSize")).pipe(p.compressWorker(y)).pipe(new c("compressedSize")).withStreamInfo("compression",p)},w.exports=v},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(h,w,a){var i=h("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=h("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(h,w,a){var i=h("./utils"),m=function(){for(var t,c=[],v=0;v<256;v++){t=v;for(var _=0;_<8;_++)t=1&t?3988292384^t>>>1:t>>>1;c[v]=t}return c}();w.exports=function(t,c){return t!==void 0&&t.length?i.getTypeOf(t)!=="string"?function(v,_,p,y){var l=m,I=y+p;v^=-1;for(var n=y;n<I;n++)v=v>>>8^l[255&(v^_[n])];return-1^v}(0|c,t,t.length,0):function(v,_,p,y){var l=m,I=y+p;v^=-1;for(var n=y;n<I;n++)v=v>>>8^l[255&(v^_.charCodeAt(n))];return-1^v}(0|c,t,t.length,0):0}},{"./utils":32}],5:[function(h,w,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(h,w,a){var i=null;i=typeof Promise!="undefined"?Promise:h("lie"),w.exports={Promise:i}},{lie:37}],7:[function(h,w,a){var i=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",m=h("pako"),t=h("./utils"),c=h("./stream/GenericWorker"),v=i?"uint8array":"array";function _(p,y){c.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=y,this.meta={}}a.magic="\b\0",t.inherits(_,c),_.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(t.transformTo(v,p.data),!1)},_.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new m[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(y){p.push({data:y,meta:p.meta})}},a.compressWorker=function(p){return new _("Deflate",p)},a.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(h,w,a){function i(l,I){var n,b="";for(n=0;n<I;n++)b+=String.fromCharCode(255&l),l>>>=8;return b}function m(l,I,n,b,d,g){var S,D,P=l.file,O=l.compression,q=g!==v.utf8encode,j=t.transformTo("string",g(P.name)),A=t.transformTo("string",v.utf8encode(P.name)),Z=P.comment,ae=t.transformTo("string",g(Z)),E=t.transformTo("string",v.utf8encode(Z)),B=A.length!==P.name.length,f=E.length!==Z.length,R="",le="",H="",ue=P.dir,X=P.date,ne={crc32:0,compressedSize:0,uncompressedSize:0};I&&!n||(ne.crc32=l.crc32,ne.compressedSize=l.compressedSize,ne.uncompressedSize=l.uncompressedSize);var z=0;I&&(z|=8),q||!B&&!f||(z|=2048);var F=0,ie=0;ue&&(F|=16),d==="UNIX"?(ie=798,F|=function(K,we){var De=K;return K||(De=we?16893:33204),(65535&De)<<16}(P.unixPermissions,ue)):(ie=20,F|=function(K){return 63&(K||0)}(P.dosPermissions)),S=X.getUTCHours(),S<<=6,S|=X.getUTCMinutes(),S<<=5,S|=X.getUTCSeconds()/2,D=X.getUTCFullYear()-1980,D<<=4,D|=X.getUTCMonth()+1,D<<=5,D|=X.getUTCDate(),B&&(le=i(1,1)+i(_(j),4)+A,R+="up"+i(le.length,2)+le),f&&(H=i(1,1)+i(_(ae),4)+E,R+="uc"+i(H.length,2)+H);var ee="";return ee+=`
\0`,ee+=i(z,2),ee+=O.magic,ee+=i(S,2),ee+=i(D,2),ee+=i(ne.crc32,4),ee+=i(ne.compressedSize,4),ee+=i(ne.uncompressedSize,4),ee+=i(j.length,2),ee+=i(R.length,2),{fileRecord:p.LOCAL_FILE_HEADER+ee+j+R,dirRecord:p.CENTRAL_FILE_HEADER+i(ie,2)+ee+i(ae.length,2)+"\0\0\0\0"+i(F,4)+i(b,4)+j+R+ae}}var t=h("../utils"),c=h("../stream/GenericWorker"),v=h("../utf8"),_=h("../crc32"),p=h("../signature");function y(l,I,n,b){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=n,this.encodeFileName=b,this.streamFiles=l,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}t.inherits(y,c),y.prototype.push=function(l){var I=l.meta.percent||0,n=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(l):(this.bytesWritten+=l.data.length,c.prototype.push.call(this,{data:l.data,meta:{currentFile:this.currentFile,percent:n?(I+100*(n-b-1))/n:100}}))},y.prototype.openedSource=function(l){this.currentSourceOffset=this.bytesWritten,this.currentFile=l.file.name;var I=this.streamFiles&&!l.file.dir;if(I){var n=m(l,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(l){this.accumulate=!1;var I=this.streamFiles&&!l.file.dir,n=m(l,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),I)this.push({data:function(b){return p.DATA_DESCRIPTOR+i(b.crc32,4)+i(b.compressedSize,4)+i(b.uncompressedSize,4)}(l),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var l=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var n=this.bytesWritten-l,b=function(d,g,S,D,P){var O=t.transformTo("string",P(D));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(d,2)+i(d,2)+i(g,4)+i(S,4)+i(O.length,2)+O}(this.dirRecords.length,n,l,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(l){this._sources.push(l);var I=this;return l.on("data",function(n){I.processChunk(n)}),l.on("end",function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()}),l.on("error",function(n){I.error(n)}),this},y.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(l){var I=this._sources;if(!c.prototype.error.call(this,l))return!1;for(var n=0;n<I.length;n++)try{I[n].error(l)}catch{}return!0},y.prototype.lock=function(){c.prototype.lock.call(this);for(var l=this._sources,I=0;I<l.length;I++)l[I].lock()},w.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(h,w,a){var i=h("../compressions"),m=h("./ZipFileWorker");a.generateWorker=function(t,c,v){var _=new m(c.streamFiles,v,c.platform,c.encodeFileName),p=0;try{t.forEach(function(y,l){p++;var I=function(g,S){var D=g||S,P=i[D];if(!P)throw new Error(D+" is not a valid compression method !");return P}(l.options.compression,c.compression),n=l.options.compressionOptions||c.compressionOptions||{},b=l.dir,d=l.date;l._compressWorker(I,n).withStreamInfo("file",{name:y,dir:b,date:d,comment:l.comment||"",unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions}).pipe(_)}),_.entriesCount=p}catch(y){_.error(y)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(h,w,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var m=new i;for(var t in this)typeof this[t]!="function"&&(m[t]=this[t]);return m}}(i.prototype=h("./object")).loadAsync=h("./load"),i.support=h("./support"),i.defaults=h("./defaults"),i.version="3.10.1",i.loadAsync=function(m,t){return new i().loadAsync(m,t)},i.external=h("./external"),w.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(h,w,a){var i=h("./utils"),m=h("./external"),t=h("./utf8"),c=h("./zipEntries"),v=h("./stream/Crc32Probe"),_=h("./nodejsUtils");function p(y){return new m.Promise(function(l,I){var n=y.decompressed.getContentWorker().pipe(new v);n.on("error",function(b){I(b)}).on("end",function(){n.streamInfo.crc32!==y.decompressed.crc32?I(new Error("Corrupted zip : CRC32 mismatch")):l()}).resume()})}w.exports=function(y,l){var I=this;return l=i.extend(l||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:t.utf8decode}),_.isNode&&_.isStream(y)?m.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",y,!0,l.optimizedBinaryString,l.base64).then(function(n){var b=new c(l);return b.load(n),b}).then(function(n){var b=[m.Promise.resolve(n)],d=n.files;if(l.checkCRC32)for(var g=0;g<d.length;g++)b.push(p(d[g]));return m.Promise.all(b)}).then(function(n){for(var b=n.shift(),d=b.files,g=0;g<d.length;g++){var S=d[g],D=S.fileNameStr,P=i.resolve(S.fileNameStr);I.file(P,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:l.createFolders}),S.dir||(I.file(P).unsafeOriginalName=D)}return b.zipComment.length&&(I.comment=b.zipComment),I})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(h,w,a){var i=h("../utils"),m=h("../stream/GenericWorker");function t(c,v){m.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(v)}i.inherits(t,m),t.prototype._bindStream=function(c){var v=this;(this._stream=c).pause(),c.on("data",function(_){v.push({data:_,meta:{percent:0}})}).on("error",function(_){v.isPaused?this.generatedError=_:v.error(_)}).on("end",function(){v.isPaused?v._upstreamEnded=!0:v.end()})},t.prototype.pause=function(){return!!m.prototype.pause.call(this)&&(this._stream.pause(),!0)},t.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},w.exports=t},{"../stream/GenericWorker":28,"../utils":32}],13:[function(h,w,a){var i=h("readable-stream").Readable;function m(t,c,v){i.call(this,c),this._helper=t;var _=this;t.on("data",function(p,y){_.push(p)||_._helper.pause(),v&&v(y)}).on("error",function(p){_.emit("error",p)}).on("end",function(){_.push(null)})}h("../utils").inherits(m,i),m.prototype._read=function(){this._helper.resume()},w.exports=m},{"../utils":32,"readable-stream":16}],14:[function(h,w,a){w.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(i,m){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,m);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,m)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var m=new Buffer(i);return m.fill(0),m},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(h,w,a){function i(P,O,q){var j,A=t.getTypeOf(O),Z=t.extend(q||{},_);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(P=d(P)),Z.createFolders&&(j=b(P))&&g.call(this,j,!0);var ae=A==="string"&&Z.binary===!1&&Z.base64===!1;q&&q.binary!==void 0||(Z.binary=!ae),(O instanceof p&&O.uncompressedSize===0||Z.dir||!O||O.length===0)&&(Z.base64=!1,Z.binary=!0,O="",Z.compression="STORE",A="string");var E=null;E=O instanceof p||O instanceof c?O:I.isNode&&I.isStream(O)?new n(P,O):t.prepareContent(P,O,Z.binary,Z.optimizedBinaryString,Z.base64);var B=new y(P,E,Z);this.files[P]=B}var m=h("./utf8"),t=h("./utils"),c=h("./stream/GenericWorker"),v=h("./stream/StreamHelper"),_=h("./defaults"),p=h("./compressedObject"),y=h("./zipObject"),l=h("./generate"),I=h("./nodejsUtils"),n=h("./nodejs/NodejsStreamInputAdapter"),b=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var O=P.lastIndexOf("/");return 0<O?P.substring(0,O):""},d=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},g=function(P,O){return O=O!==void 0?O:_.createFolders,P=d(P),this.files[P]||i.call(this,P,null,{dir:!0,createFolders:O}),this.files[P]};function S(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var O,q,j;for(O in this.files)j=this.files[O],(q=O.slice(this.root.length,O.length))&&O.slice(0,this.root.length)===this.root&&P(q,j)},filter:function(P){var O=[];return this.forEach(function(q,j){P(q,j)&&O.push(j)}),O},file:function(P,O,q){if(arguments.length!==1)return P=this.root+P,i.call(this,P,O,q),this;if(S(P)){var j=P;return this.filter(function(Z,ae){return!ae.dir&&j.test(Z)})}var A=this.files[this.root+P];return A&&!A.dir?A:null},folder:function(P){if(!P)return this;if(S(P))return this.filter(function(A,Z){return Z.dir&&P.test(A)});var O=this.root+P,q=g.call(this,O),j=this.clone();return j.root=q.name,j},remove:function(P){P=this.root+P;var O=this.files[P];if(O||(P.slice(-1)!=="/"&&(P+="/"),O=this.files[P]),O&&!O.dir)delete this.files[P];else for(var q=this.filter(function(A,Z){return Z.name.slice(0,P.length)===P}),j=0;j<q.length;j++)delete this.files[q[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var O,q={};try{if((q=t.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:m.utf8encode})).type=q.type.toLowerCase(),q.compression=q.compression.toUpperCase(),q.type==="binarystring"&&(q.type="string"),!q.type)throw new Error("No output type specified.");t.checkSupport(q.type),q.platform!=="darwin"&&q.platform!=="freebsd"&&q.platform!=="linux"&&q.platform!=="sunos"||(q.platform="UNIX"),q.platform==="win32"&&(q.platform="DOS");var j=q.comment||this.comment||"";O=l.generateWorker(this,q,j)}catch(A){(O=new c("error")).error(A)}return new v(O,q.type||"string",q.mimeType)},generateAsync:function(P,O){return this.generateInternalStream(P).accumulate(O)},generateNodeStream:function(P,O){return(P=P||{}).type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(O)}};w.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(h,w,a){w.exports=h("stream")},{stream:void 0}],17:[function(h,w,a){var i=h("./DataReader");function m(t){i.call(this,t);for(var c=0;c<this.data.length;c++)t[c]=255&t[c]}h("../utils").inherits(m,i),m.prototype.byteAt=function(t){return this.data[this.zero+t]},m.prototype.lastIndexOfSignature=function(t){for(var c=t.charCodeAt(0),v=t.charCodeAt(1),_=t.charCodeAt(2),p=t.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===c&&this.data[y+1]===v&&this.data[y+2]===_&&this.data[y+3]===p)return y-this.zero;return-1},m.prototype.readAndCheckSignature=function(t){var c=t.charCodeAt(0),v=t.charCodeAt(1),_=t.charCodeAt(2),p=t.charCodeAt(3),y=this.readData(4);return c===y[0]&&v===y[1]&&_===y[2]&&p===y[3]},m.prototype.readData=function(t){if(this.checkOffset(t),t===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,c},w.exports=m},{"../utils":32,"./DataReader":18}],18:[function(h,w,a){var i=h("../utils");function m(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}m.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var c,v=0;for(this.checkOffset(t),c=this.index+t-1;c>=this.index;c--)v=(v<<8)+this.byteAt(c);return this.index+=t,v},readString:function(t){return i.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},w.exports=m},{"../utils":32}],19:[function(h,w,a){var i=h("./Uint8ArrayReader");function m(t){i.call(this,t)}h("../utils").inherits(m,i),m.prototype.readData=function(t){this.checkOffset(t);var c=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,c},w.exports=m},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(h,w,a){var i=h("./DataReader");function m(t){i.call(this,t)}h("../utils").inherits(m,i),m.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},m.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},m.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},m.prototype.readData=function(t){this.checkOffset(t);var c=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,c},w.exports=m},{"../utils":32,"./DataReader":18}],21:[function(h,w,a){var i=h("./ArrayReader");function m(t){i.call(this,t)}h("../utils").inherits(m,i),m.prototype.readData=function(t){if(this.checkOffset(t),t===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,c},w.exports=m},{"../utils":32,"./ArrayReader":17}],22:[function(h,w,a){var i=h("../utils"),m=h("../support"),t=h("./ArrayReader"),c=h("./StringReader"),v=h("./NodeBufferReader"),_=h("./Uint8ArrayReader");w.exports=function(p){var y=i.getTypeOf(p);return i.checkSupport(y),y!=="string"||m.uint8array?y==="nodebuffer"?new v(p):m.uint8array?new _(i.transformTo("uint8array",p)):new t(i.transformTo("array",p)):new c(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(h,w,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(h,w,a){var i=h("./GenericWorker"),m=h("../utils");function t(c){i.call(this,"ConvertWorker to "+c),this.destType=c}m.inherits(t,i),t.prototype.processChunk=function(c){this.push({data:m.transformTo(this.destType,c.data),meta:c.meta})},w.exports=t},{"../utils":32,"./GenericWorker":28}],25:[function(h,w,a){var i=h("./GenericWorker"),m=h("../crc32");function t(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}h("../utils").inherits(t,i),t.prototype.processChunk=function(c){this.streamInfo.crc32=m(c.data,this.streamInfo.crc32||0),this.push(c)},w.exports=t},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(h,w,a){var i=h("../utils"),m=h("./GenericWorker");function t(c){m.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}i.inherits(t,m),t.prototype.processChunk=function(c){if(c){var v=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=v+c.data.length}m.prototype.processChunk.call(this,c)},w.exports=t},{"../utils":32,"./GenericWorker":28}],27:[function(h,w,a){var i=h("../utils"),m=h("./GenericWorker");function t(c){m.call(this,"DataWorker");var v=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(_){v.dataIsReady=!0,v.data=_,v.max=_&&_.length||0,v.type=i.getTypeOf(_),v.isPaused||v._tickAndRepeat()},function(_){v.error(_)})}i.inherits(t,m),t.prototype.cleanUp=function(){m.prototype.cleanUp.call(this),this.data=null},t.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},t.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},t.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,v=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,v);break;case"uint8array":c=this.data.subarray(this.index,v);break;case"array":case"nodebuffer":c=this.data.slice(this.index,v)}return this.index=v,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},w.exports=t},{"../utils":32,"./GenericWorker":28}],28:[function(h,w,a){function i(m){this.name=m||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(m){this.emit("data",m)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(m){this.emit("error",m)}return!0},error:function(m){return!this.isFinished&&(this.isPaused?this.generatedError=m:(this.isFinished=!0,this.emit("error",m),this.previous&&this.previous.error(m),this.cleanUp()),!0)},on:function(m,t){return this._listeners[m].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(m,t){if(this._listeners[m])for(var c=0;c<this._listeners[m].length;c++)this._listeners[m][c].call(this,t)},pipe:function(m){return m.registerPrevious(this)},registerPrevious:function(m){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=m.streamInfo,this.mergeStreamInfo(),this.previous=m;var t=this;return m.on("data",function(c){t.processChunk(c)}),m.on("end",function(){t.end()}),m.on("error",function(c){t.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var m=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),m=!0),this.previous&&this.previous.resume(),!m},flush:function(){},processChunk:function(m){this.push(m)},withStreamInfo:function(m,t){return this.extraStreamInfo[m]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var m in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,m)&&(this.streamInfo[m]=this.extraStreamInfo[m])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var m="Worker "+this.name;return this.previous?this.previous+" -> "+m:m}},w.exports=i},{}],29:[function(h,w,a){var i=h("../utils"),m=h("./ConvertWorker"),t=h("./GenericWorker"),c=h("../base64"),v=h("../support"),_=h("../external"),p=null;if(v.nodestream)try{p=h("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(I,n){return new _.Promise(function(b,d){var g=[],S=I._internalType,D=I._outputType,P=I._mimeType;I.on("data",function(O,q){g.push(O),n&&n(q)}).on("error",function(O){g=[],d(O)}).on("end",function(){try{var O=function(q,j,A){switch(q){case"blob":return i.newBlob(i.transformTo("arraybuffer",j),A);case"base64":return c.encode(j);default:return i.transformTo(q,j)}}(D,function(q,j){var A,Z=0,ae=null,E=0;for(A=0;A<j.length;A++)E+=j[A].length;switch(q){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(ae=new Uint8Array(E),A=0;A<j.length;A++)ae.set(j[A],Z),Z+=j[A].length;return ae;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+q+"'")}}(S,g),P);b(O)}catch(q){d(q)}g=[]}).resume()})}function l(I,n,b){var d=n;switch(n){case"blob":case"arraybuffer":d="uint8array";break;case"base64":d="string"}try{this._internalType=d,this._outputType=n,this._mimeType=b,i.checkSupport(d),this._worker=I.pipe(new m(d)),I.lock()}catch(g){this._worker=new t("error"),this._worker.error(g)}}l.prototype={accumulate:function(I){return y(this,I)},on:function(I,n){var b=this;return I==="data"?this._worker.on(I,function(d){n.call(b,d.data,d.meta)}):this._worker.on(I,function(){i.delay(n,arguments,b)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(I){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},I)}},w.exports=l},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(h,w,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",a.nodebuffer=typeof Buffer!="undefined",a.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);m.append(i),a.blob=m.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!h("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(h,w,a){for(var i=h("./utils"),m=h("./support"),t=h("./nodejsUtils"),c=h("./stream/GenericWorker"),v=new Array(256),_=0;_<256;_++)v[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;v[254]=v[254]=1;function p(){c.call(this,"utf-8 decode"),this.leftOver=null}function y(){c.call(this,"utf-8 encode")}a.utf8encode=function(l){return m.nodebuffer?t.newBufferFrom(l,"utf-8"):function(I){var n,b,d,g,S,D=I.length,P=0;for(g=0;g<D;g++)(64512&(b=I.charCodeAt(g)))==55296&&g+1<D&&(64512&(d=I.charCodeAt(g+1)))==56320&&(b=65536+(b-55296<<10)+(d-56320),g++),P+=b<128?1:b<2048?2:b<65536?3:4;for(n=m.uint8array?new Uint8Array(P):new Array(P),g=S=0;S<P;g++)(64512&(b=I.charCodeAt(g)))==55296&&g+1<D&&(64512&(d=I.charCodeAt(g+1)))==56320&&(b=65536+(b-55296<<10)+(d-56320),g++),b<128?n[S++]=b:(b<2048?n[S++]=192|b>>>6:(b<65536?n[S++]=224|b>>>12:(n[S++]=240|b>>>18,n[S++]=128|b>>>12&63),n[S++]=128|b>>>6&63),n[S++]=128|63&b);return n}(l)},a.utf8decode=function(l){return m.nodebuffer?i.transformTo("nodebuffer",l).toString("utf-8"):function(I){var n,b,d,g,S=I.length,D=new Array(2*S);for(n=b=0;n<S;)if((d=I[n++])<128)D[b++]=d;else if(4<(g=v[d]))D[b++]=65533,n+=g-1;else{for(d&=g===2?31:g===3?15:7;1<g&&n<S;)d=d<<6|63&I[n++],g--;1<g?D[b++]=65533:d<65536?D[b++]=d:(d-=65536,D[b++]=55296|d>>10&1023,D[b++]=56320|1023&d)}return D.length!==b&&(D.subarray?D=D.subarray(0,b):D.length=b),i.applyFromCharCode(D)}(l=i.transformTo(m.uint8array?"uint8array":"array",l))},i.inherits(p,c),p.prototype.processChunk=function(l){var I=i.transformTo(m.uint8array?"uint8array":"array",l.data);if(this.leftOver&&this.leftOver.length){if(m.uint8array){var n=I;(I=new Uint8Array(n.length+this.leftOver.length)).set(this.leftOver,0),I.set(n,this.leftOver.length)}else I=this.leftOver.concat(I);this.leftOver=null}var b=function(g,S){var D;for((S=S||g.length)>g.length&&(S=g.length),D=S-1;0<=D&&(192&g[D])==128;)D--;return D<0||D===0?S:D+v[g[D]]>S?D:S}(I),d=I;b!==I.length&&(m.uint8array?(d=I.subarray(0,b),this.leftOver=I.subarray(b,I.length)):(d=I.slice(0,b),this.leftOver=I.slice(b,I.length))),this.push({data:a.utf8decode(d),meta:l.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=p,i.inherits(y,c),y.prototype.processChunk=function(l){this.push({data:a.utf8encode(l.data),meta:l.meta})},a.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(h,w,a){var i=h("./support"),m=h("./base64"),t=h("./nodejsUtils"),c=h("./external");function v(n){return n}function _(n,b){for(var d=0;d<n.length;++d)b[d]=255&n.charCodeAt(d);return b}h("setimmediate"),a.newBlob=function(n,b){a.checkSupport("blob");try{return new Blob([n],{type:b})}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return d.append(n),d.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(n,b,d){var g=[],S=0,D=n.length;if(D<=d)return String.fromCharCode.apply(null,n);for(;S<D;)b==="array"||b==="nodebuffer"?g.push(String.fromCharCode.apply(null,n.slice(S,Math.min(S+d,D)))):g.push(String.fromCharCode.apply(null,n.subarray(S,Math.min(S+d,D)))),S+=d;return g.join("")},stringifyByChar:function(n){for(var b="",d=0;d<n.length;d++)b+=String.fromCharCode(n[d]);return b},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,t.allocBuffer(1)).length===1}catch{return!1}}()}};function y(n){var b=65536,d=a.getTypeOf(n),g=!0;if(d==="uint8array"?g=p.applyCanBeUsed.uint8array:d==="nodebuffer"&&(g=p.applyCanBeUsed.nodebuffer),g)for(;1<b;)try{return p.stringifyByChunk(n,d,b)}catch{b=Math.floor(b/2)}return p.stringifyByChar(n)}function l(n,b){for(var d=0;d<n.length;d++)b[d]=n[d];return b}a.applyFromCharCode=y;var I={};I.string={string:v,array:function(n){return _(n,new Array(n.length))},arraybuffer:function(n){return I.string.uint8array(n).buffer},uint8array:function(n){return _(n,new Uint8Array(n.length))},nodebuffer:function(n){return _(n,t.allocBuffer(n.length))}},I.array={string:y,array:v,arraybuffer:function(n){return new Uint8Array(n).buffer},uint8array:function(n){return new Uint8Array(n)},nodebuffer:function(n){return t.newBufferFrom(n)}},I.arraybuffer={string:function(n){return y(new Uint8Array(n))},array:function(n){return l(new Uint8Array(n),new Array(n.byteLength))},arraybuffer:v,uint8array:function(n){return new Uint8Array(n)},nodebuffer:function(n){return t.newBufferFrom(new Uint8Array(n))}},I.uint8array={string:y,array:function(n){return l(n,new Array(n.length))},arraybuffer:function(n){return n.buffer},uint8array:v,nodebuffer:function(n){return t.newBufferFrom(n)}},I.nodebuffer={string:y,array:function(n){return l(n,new Array(n.length))},arraybuffer:function(n){return I.nodebuffer.uint8array(n).buffer},uint8array:function(n){return l(n,new Uint8Array(n.length))},nodebuffer:v},a.transformTo=function(n,b){if(b=b||"",!n)return b;a.checkSupport(n);var d=a.getTypeOf(b);return I[d][n](b)},a.resolve=function(n){for(var b=n.split("/"),d=[],g=0;g<b.length;g++){var S=b[g];S==="."||S===""&&g!==0&&g!==b.length-1||(S===".."?d.pop():d.push(S))}return d.join("/")},a.getTypeOf=function(n){return typeof n=="string"?"string":Object.prototype.toString.call(n)==="[object Array]"?"array":i.nodebuffer&&t.isBuffer(n)?"nodebuffer":i.uint8array&&n instanceof Uint8Array?"uint8array":i.arraybuffer&&n instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(n){if(!i[n.toLowerCase()])throw new Error(n+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(n){var b,d,g="";for(d=0;d<(n||"").length;d++)g+="\\x"+((b=n.charCodeAt(d))<16?"0":"")+b.toString(16).toUpperCase();return g},a.delay=function(n,b,d){setImmediate(function(){n.apply(d||null,b||[])})},a.inherits=function(n,b){function d(){}d.prototype=b.prototype,n.prototype=new d},a.extend=function(){var n,b,d={};for(n=0;n<arguments.length;n++)for(b in arguments[n])Object.prototype.hasOwnProperty.call(arguments[n],b)&&d[b]===void 0&&(d[b]=arguments[n][b]);return d},a.prepareContent=function(n,b,d,g,S){return c.Promise.resolve(b).then(function(D){return i.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader!="undefined"?new c.Promise(function(P,O){var q=new FileReader;q.onload=function(j){P(j.target.result)},q.onerror=function(j){O(j.target.error)},q.readAsArrayBuffer(D)}):D}).then(function(D){var P=a.getTypeOf(D);return P?(P==="arraybuffer"?D=a.transformTo("uint8array",D):P==="string"&&(S?D=m.decode(D):d&&g!==!0&&(D=function(O){return _(O,i.uint8array?new Uint8Array(O.length):new Array(O.length))}(D))),D):c.Promise.reject(new Error("Can't read the data of '"+n+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(h,w,a){var i=h("./reader/readerFor"),m=h("./utils"),t=h("./signature"),c=h("./zipEntry"),v=h("./support");function _(p){this.files=[],this.loadOptions=p}_.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+m.pretty(y)+", expected "+m.pretty(p)+")")}},isSignature:function(p,y){var l=this.reader.index;this.reader.setIndex(p);var I=this.reader.readString(4)===y;return this.reader.setIndex(l),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),y=v.uint8array?"uint8array":"array",l=m.transformTo(y,p);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,y,l,I=this.zip64EndOfCentralSize-44;0<I;)p=this.reader.readInt(2),y=this.reader.readInt(4),l=this.reader.readData(y),this.zip64ExtensibleData[p]={id:p,length:y,value:l}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,y;for(p=0;p<this.files.length;p++)y=this.files[p],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(t.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(t.CENTRAL_FILE_HEADER);)(p=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(t.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,t.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var y=p;if(this.checkSignature(t.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===m.MAX_VALUE_16BITS||this.diskWithCentralDirStart===m.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===m.MAX_VALUE_16BITS||this.centralDirRecords===m.MAX_VALUE_16BITS||this.centralDirSize===m.MAX_VALUE_32BITS||this.centralDirOffset===m.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,t.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var l=this.centralDirOffset+this.centralDirSize;this.zip64&&(l+=20,l+=12+this.zip64EndOfCentralSize);var I=y-l;if(0<I)this.isSignature(y,t.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(p){this.reader=i(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},w.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(h,w,a){var i=h("./reader/readerFor"),m=h("./utils"),t=h("./compressedObject"),c=h("./crc32"),v=h("./utf8"),_=h("./compressions"),p=h("./support");function y(l,I){this.options=l,this.loadOptions=I}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(l){var I,n;if(l.skip(22),this.fileNameLength=l.readInt(2),n=l.readInt(2),this.fileName=l.readData(this.fileNameLength),l.skip(n),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((I=function(b){for(var d in _)if(Object.prototype.hasOwnProperty.call(_,d)&&_[d].magic===b)return _[d];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+m.pretty(this.compressionMethod)+" unknown (inner file : "+m.transformTo("string",this.fileName)+")");this.decompressed=new t(this.compressedSize,this.uncompressedSize,this.crc32,I,l.readData(this.compressedSize))},readCentralPart:function(l){this.versionMadeBy=l.readInt(2),l.skip(2),this.bitFlag=l.readInt(2),this.compressionMethod=l.readString(2),this.date=l.readDate(),this.crc32=l.readInt(4),this.compressedSize=l.readInt(4),this.uncompressedSize=l.readInt(4);var I=l.readInt(2);if(this.extraFieldsLength=l.readInt(2),this.fileCommentLength=l.readInt(2),this.diskNumberStart=l.readInt(2),this.internalFileAttributes=l.readInt(2),this.externalFileAttributes=l.readInt(4),this.localHeaderOffset=l.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");l.skip(I),this.readExtraFields(l),this.parseZIP64ExtraField(l),this.fileComment=l.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var l=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),l==0&&(this.dosPermissions=63&this.externalFileAttributes),l==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var l=i(this.extraFields[1].value);this.uncompressedSize===m.MAX_VALUE_32BITS&&(this.uncompressedSize=l.readInt(8)),this.compressedSize===m.MAX_VALUE_32BITS&&(this.compressedSize=l.readInt(8)),this.localHeaderOffset===m.MAX_VALUE_32BITS&&(this.localHeaderOffset=l.readInt(8)),this.diskNumberStart===m.MAX_VALUE_32BITS&&(this.diskNumberStart=l.readInt(4))}},readExtraFields:function(l){var I,n,b,d=l.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});l.index+4<d;)I=l.readInt(2),n=l.readInt(2),b=l.readData(n),this.extraFields[I]={id:I,length:n,value:b};l.setIndex(d)},handleUTF8:function(){var l=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=v.utf8decode(this.fileName),this.fileCommentStr=v.utf8decode(this.fileComment);else{var I=this.findExtraFieldUnicodePath();if(I!==null)this.fileNameStr=I;else{var n=m.transformTo(l,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var d=m.transformTo(l,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(d)}}},findExtraFieldUnicodePath:function(){var l=this.extraFields[28789];if(l){var I=i(l.value);return I.readInt(1)!==1||c(this.fileName)!==I.readInt(4)?null:v.utf8decode(I.readData(l.length-5))}return null},findExtraFieldUnicodeComment:function(){var l=this.extraFields[25461];if(l){var I=i(l.value);return I.readInt(1)!==1||c(this.fileComment)!==I.readInt(4)?null:v.utf8decode(I.readData(l.length-5))}return null}},w.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(h,w,a){function i(I,n,b){this.name=I,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=n,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var m=h("./stream/StreamHelper"),t=h("./stream/DataWorker"),c=h("./utf8"),v=h("./compressedObject"),_=h("./stream/GenericWorker");i.prototype={internalStream:function(I){var n=null,b="string";try{if(!I)throw new Error("No output type specified.");var d=(b=I.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),n=this._decompressWorker();var g=!this._dataBinary;g&&!d&&(n=n.pipe(new c.Utf8EncodeWorker)),!g&&d&&(n=n.pipe(new c.Utf8DecodeWorker))}catch(S){(n=new _("error")).error(S)}return new m(n,b,"")},async:function(I,n){return this.internalStream(I).accumulate(n)},nodeStream:function(I,n){return this.internalStream(I||"nodebuffer").toNodejsStream(n)},_compressWorker:function(I,n){if(this._data instanceof v&&this._data.compression.magic===I.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new c.Utf8EncodeWorker)),v.createWorkerFrom(b,I,n)},_decompressWorker:function(){return this._data instanceof v?this._data.getContentWorker():this._data instanceof _?this._data:new t(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<p.length;l++)i.prototype[p[l]]=y;w.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(h,w,a){(function(i){var m,t,c=i.MutationObserver||i.WebKitMutationObserver;if(c){var v=0,_=new c(I),p=i.document.createTextNode("");_.observe(p,{characterData:!0}),m=function(){p.data=v=++v%2}}else if(i.setImmediate||i.MessageChannel===void 0)m="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var n=i.document.createElement("script");n.onreadystatechange=function(){I(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},i.document.documentElement.appendChild(n)}:function(){setTimeout(I,0)};else{var y=new i.MessageChannel;y.port1.onmessage=I,m=function(){y.port2.postMessage(0)}}var l=[];function I(){var n,b;t=!0;for(var d=l.length;d;){for(b=l,l=[],n=-1;++n<d;)b[n]();d=l.length}t=!1}w.exports=function(n){l.push(n)!==1||t||m()}}).call(this,typeof tt!="undefined"?tt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(h,w,a){var i=h("immediate");function m(){}var t={},c=["REJECTED"],v=["FULFILLED"],_=["PENDING"];function p(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,d!==m&&n(this,d)}function y(d,g,S){this.promise=d,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function l(d,g,S){i(function(){var D;try{D=g(S)}catch(P){return t.reject(d,P)}D===d?t.reject(d,new TypeError("Cannot resolve promise with itself")):t.resolve(d,D)})}function I(d){var g=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof g=="function")return function(){g.apply(d,arguments)}}function n(d,g){var S=!1;function D(q){S||(S=!0,t.reject(d,q))}function P(q){S||(S=!0,t.resolve(d,q))}var O=b(function(){g(P,D)});O.status==="error"&&D(O.value)}function b(d,g){var S={};try{S.value=d(g),S.status="success"}catch(D){S.status="error",S.value=D}return S}(w.exports=p).prototype.finally=function(d){if(typeof d!="function")return this;var g=this.constructor;return this.then(function(S){return g.resolve(d()).then(function(){return S})},function(S){return g.resolve(d()).then(function(){throw S})})},p.prototype.catch=function(d){return this.then(null,d)},p.prototype.then=function(d,g){if(typeof d!="function"&&this.state===v||typeof g!="function"&&this.state===c)return this;var S=new this.constructor(m);return this.state!==_?l(S,this.state===v?d:g,this.outcome):this.queue.push(new y(S,d,g)),S},y.prototype.callFulfilled=function(d){t.resolve(this.promise,d)},y.prototype.otherCallFulfilled=function(d){l(this.promise,this.onFulfilled,d)},y.prototype.callRejected=function(d){t.reject(this.promise,d)},y.prototype.otherCallRejected=function(d){l(this.promise,this.onRejected,d)},t.resolve=function(d,g){var S=b(I,g);if(S.status==="error")return t.reject(d,S.value);var D=S.value;if(D)n(d,D);else{d.state=v,d.outcome=g;for(var P=-1,O=d.queue.length;++P<O;)d.queue[P].callFulfilled(g)}return d},t.reject=function(d,g){d.state=c,d.outcome=g;for(var S=-1,D=d.queue.length;++S<D;)d.queue[S].callRejected(g);return d},p.resolve=function(d){return d instanceof this?d:t.resolve(new this(m),d)},p.reject=function(d){var g=new this(m);return t.reject(g,d)},p.all=function(d){var g=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,D=!1;if(!S)return this.resolve([]);for(var P=new Array(S),O=0,q=-1,j=new this(m);++q<S;)A(d[q],q);return j;function A(Z,ae){g.resolve(Z).then(function(E){P[ae]=E,++O!==S||D||(D=!0,t.resolve(j,P))},function(E){D||(D=!0,t.reject(j,E))})}},p.race=function(d){var g=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,D=!1;if(!S)return this.resolve([]);for(var P=-1,O=new this(m);++P<S;)q=d[P],g.resolve(q).then(function(j){D||(D=!0,t.resolve(O,j))},function(j){D||(D=!0,t.reject(O,j))});var q;return O}},{immediate:36}],38:[function(h,w,a){var i={};(0,h("./lib/utils/common").assign)(i,h("./lib/deflate"),h("./lib/inflate"),h("./lib/zlib/constants")),w.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(h,w,a){var i=h("./zlib/deflate"),m=h("./utils/common"),t=h("./utils/strings"),c=h("./zlib/messages"),v=h("./zlib/zstream"),_=Object.prototype.toString,p=0,y=-1,l=0,I=8;function n(d){if(!(this instanceof n))return new n(d);this.options=m.assign({level:y,method:I,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},d||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(S!==p)throw new Error(c[S]);if(g.header&&i.deflateSetHeader(this.strm,g.header),g.dictionary){var D;if(D=typeof g.dictionary=="string"?t.string2buf(g.dictionary):_.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(S=i.deflateSetDictionary(this.strm,D))!==p)throw new Error(c[S]);this._dict_set=!0}}function b(d,g){var S=new n(g);if(S.push(d,!0),S.err)throw S.msg||c[S.err];return S.result}n.prototype.push=function(d,g){var S,D,P=this.strm,O=this.options.chunkSize;if(this.ended)return!1;D=g===~~g?g:g===!0?4:0,typeof d=="string"?P.input=t.string2buf(d):_.call(d)==="[object ArrayBuffer]"?P.input=new Uint8Array(d):P.input=d,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new m.Buf8(O),P.next_out=0,P.avail_out=O),(S=i.deflate(P,D))!==1&&S!==p)return this.onEnd(S),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(t.buf2binstring(m.shrinkBuf(P.output,P.next_out))):this.onData(m.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&S!==1);return D===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===p):D!==2||(this.onEnd(p),!(P.avail_out=0))},n.prototype.onData=function(d){this.chunks.push(d)},n.prototype.onEnd=function(d){d===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},a.Deflate=n,a.deflate=b,a.deflateRaw=function(d,g){return(g=g||{}).raw=!0,b(d,g)},a.gzip=function(d,g){return(g=g||{}).gzip=!0,b(d,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(h,w,a){var i=h("./zlib/inflate"),m=h("./utils/common"),t=h("./utils/strings"),c=h("./zlib/constants"),v=h("./zlib/messages"),_=h("./zlib/zstream"),p=h("./zlib/gzheader"),y=Object.prototype.toString;function l(n){if(!(this instanceof l))return new l(n);this.options=m.assign({chunkSize:16384,windowBits:0,to:""},n||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||n&&n.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&(15&b.windowBits)==0&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var d=i.inflateInit2(this.strm,b.windowBits);if(d!==c.Z_OK)throw new Error(v[d]);this.header=new p,i.inflateGetHeader(this.strm,this.header)}function I(n,b){var d=new l(b);if(d.push(n,!0),d.err)throw d.msg||v[d.err];return d.result}l.prototype.push=function(n,b){var d,g,S,D,P,O,q=this.strm,j=this.options.chunkSize,A=this.options.dictionary,Z=!1;if(this.ended)return!1;g=b===~~b?b:b===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof n=="string"?q.input=t.binstring2buf(n):y.call(n)==="[object ArrayBuffer]"?q.input=new Uint8Array(n):q.input=n,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new m.Buf8(j),q.next_out=0,q.avail_out=j),(d=i.inflate(q,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&A&&(O=typeof A=="string"?t.string2buf(A):y.call(A)==="[object ArrayBuffer]"?new Uint8Array(A):A,d=i.inflateSetDictionary(this.strm,O)),d===c.Z_BUF_ERROR&&Z===!0&&(d=c.Z_OK,Z=!1),d!==c.Z_STREAM_END&&d!==c.Z_OK)return this.onEnd(d),!(this.ended=!0);q.next_out&&(q.avail_out!==0&&d!==c.Z_STREAM_END&&(q.avail_in!==0||g!==c.Z_FINISH&&g!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=t.utf8border(q.output,q.next_out),D=q.next_out-S,P=t.buf2string(q.output,S),q.next_out=D,q.avail_out=j-D,D&&m.arraySet(q.output,q.output,S,D,0),this.onData(P)):this.onData(m.shrinkBuf(q.output,q.next_out)))),q.avail_in===0&&q.avail_out===0&&(Z=!0)}while((0<q.avail_in||q.avail_out===0)&&d!==c.Z_STREAM_END);return d===c.Z_STREAM_END&&(g=c.Z_FINISH),g===c.Z_FINISH?(d=i.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===c.Z_OK):g!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(q.avail_out=0))},l.prototype.onData=function(n){this.chunks.push(n)},l.prototype.onEnd=function(n){n===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg},a.Inflate=l,a.inflate=I,a.inflateRaw=function(n,b){return(b=b||{}).raw=!0,I(n,b)},a.ungzip=I},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(h,w,a){var i=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";a.assign=function(c){for(var v=Array.prototype.slice.call(arguments,1);v.length;){var _=v.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var p in _)_.hasOwnProperty(p)&&(c[p]=_[p])}}return c},a.shrinkBuf=function(c,v){return c.length===v?c:c.subarray?c.subarray(0,v):(c.length=v,c)};var m={arraySet:function(c,v,_,p,y){if(v.subarray&&c.subarray)c.set(v.subarray(_,_+p),y);else for(var l=0;l<p;l++)c[y+l]=v[_+l]},flattenChunks:function(c){var v,_,p,y,l,I;for(v=p=0,_=c.length;v<_;v++)p+=c[v].length;for(I=new Uint8Array(p),v=y=0,_=c.length;v<_;v++)l=c[v],I.set(l,y),y+=l.length;return I}},t={arraySet:function(c,v,_,p,y){for(var l=0;l<p;l++)c[y+l]=v[_+l]},flattenChunks:function(c){return[].concat.apply([],c)}};a.setTyped=function(c){c?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,m)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,t))},a.setTyped(i)},{}],42:[function(h,w,a){var i=h("./common"),m=!0,t=!0;try{String.fromCharCode.apply(null,[0])}catch{m=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{t=!1}for(var c=new i.Buf8(256),v=0;v<256;v++)c[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;function _(p,y){if(y<65537&&(p.subarray&&t||!p.subarray&&m))return String.fromCharCode.apply(null,i.shrinkBuf(p,y));for(var l="",I=0;I<y;I++)l+=String.fromCharCode(p[I]);return l}c[254]=c[254]=1,a.string2buf=function(p){var y,l,I,n,b,d=p.length,g=0;for(n=0;n<d;n++)(64512&(l=p.charCodeAt(n)))==55296&&n+1<d&&(64512&(I=p.charCodeAt(n+1)))==56320&&(l=65536+(l-55296<<10)+(I-56320),n++),g+=l<128?1:l<2048?2:l<65536?3:4;for(y=new i.Buf8(g),n=b=0;b<g;n++)(64512&(l=p.charCodeAt(n)))==55296&&n+1<d&&(64512&(I=p.charCodeAt(n+1)))==56320&&(l=65536+(l-55296<<10)+(I-56320),n++),l<128?y[b++]=l:(l<2048?y[b++]=192|l>>>6:(l<65536?y[b++]=224|l>>>12:(y[b++]=240|l>>>18,y[b++]=128|l>>>12&63),y[b++]=128|l>>>6&63),y[b++]=128|63&l);return y},a.buf2binstring=function(p){return _(p,p.length)},a.binstring2buf=function(p){for(var y=new i.Buf8(p.length),l=0,I=y.length;l<I;l++)y[l]=p.charCodeAt(l);return y},a.buf2string=function(p,y){var l,I,n,b,d=y||p.length,g=new Array(2*d);for(l=I=0;l<d;)if((n=p[l++])<128)g[I++]=n;else if(4<(b=c[n]))g[I++]=65533,l+=b-1;else{for(n&=b===2?31:b===3?15:7;1<b&&l<d;)n=n<<6|63&p[l++],b--;1<b?g[I++]=65533:n<65536?g[I++]=n:(n-=65536,g[I++]=55296|n>>10&1023,g[I++]=56320|1023&n)}return _(g,I)},a.utf8border=function(p,y){var l;for((y=y||p.length)>p.length&&(y=p.length),l=y-1;0<=l&&(192&p[l])==128;)l--;return l<0||l===0?y:l+c[p[l]]>y?l:y}},{"./common":41}],43:[function(h,w,a){w.exports=function(i,m,t,c){for(var v=65535&i|0,_=i>>>16&65535|0,p=0;t!==0;){for(t-=p=2e3<t?2e3:t;_=_+(v=v+m[c++]|0)|0,--p;);v%=65521,_%=65521}return v|_<<16|0}},{}],44:[function(h,w,a){w.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(h,w,a){var i=function(){for(var m,t=[],c=0;c<256;c++){m=c;for(var v=0;v<8;v++)m=1&m?3988292384^m>>>1:m>>>1;t[c]=m}return t}();w.exports=function(m,t,c,v){var _=i,p=v+c;m^=-1;for(var y=v;y<p;y++)m=m>>>8^_[255&(m^t[y])];return-1^m}},{}],46:[function(h,w,a){var i,m=h("../utils/common"),t=h("./trees"),c=h("./adler32"),v=h("./crc32"),_=h("./messages"),p=0,y=4,l=0,I=-2,n=-1,b=4,d=2,g=8,S=9,D=286,P=30,O=19,q=2*D+1,j=15,A=3,Z=258,ae=Z+A+1,E=42,B=113,f=1,R=2,le=3,H=4;function ue(u,U){return u.msg=_[U],U}function X(u){return(u<<1)-(4<u?9:0)}function ne(u){for(var U=u.length;0<=--U;)u[U]=0}function z(u){var U=u.state,T=U.pending;T>u.avail_out&&(T=u.avail_out),T!==0&&(m.arraySet(u.output,U.pending_buf,U.pending_out,T,u.next_out),u.next_out+=T,U.pending_out+=T,u.total_out+=T,u.avail_out-=T,U.pending-=T,U.pending===0&&(U.pending_out=0))}function F(u,U){t._tr_flush_block(u,0<=u.block_start?u.block_start:-1,u.strstart-u.block_start,U),u.block_start=u.strstart,z(u.strm)}function ie(u,U){u.pending_buf[u.pending++]=U}function ee(u,U){u.pending_buf[u.pending++]=U>>>8&255,u.pending_buf[u.pending++]=255&U}function K(u,U){var T,k,C=u.max_chain_length,V=u.strstart,L=u.prev_length,$=u.nice_match,x=u.strstart>u.w_size-ae?u.strstart-(u.w_size-ae):0,W=u.window,te=u.w_mask,G=u.prev,re=u.strstart+Z,ye=W[V+L-1],he=W[V+L];u.prev_length>=u.good_match&&(C>>=2),$>u.lookahead&&($=u.lookahead);do if(W[(T=U)+L]===he&&W[T+L-1]===ye&&W[T]===W[V]&&W[++T]===W[V+1]){V+=2,T++;do;while(W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&V<re);if(k=Z-(re-V),V=re-Z,L<k){if(u.match_start=U,$<=(L=k))break;ye=W[V+L-1],he=W[V+L]}}while((U=G[U&te])>x&&--C!=0);return L<=u.lookahead?L:u.lookahead}function we(u){var U,T,k,C,V,L,$,x,W,te,G=u.w_size;do{if(C=u.window_size-u.lookahead-u.strstart,u.strstart>=G+(G-ae)){for(m.arraySet(u.window,u.window,G,G,0),u.match_start-=G,u.strstart-=G,u.block_start-=G,U=T=u.hash_size;k=u.head[--U],u.head[U]=G<=k?k-G:0,--T;);for(U=T=G;k=u.prev[--U],u.prev[U]=G<=k?k-G:0,--T;);C+=G}if(u.strm.avail_in===0)break;if(L=u.strm,$=u.window,x=u.strstart+u.lookahead,W=C,te=void 0,te=L.avail_in,W<te&&(te=W),T=te===0?0:(L.avail_in-=te,m.arraySet($,L.input,L.next_in,te,x),L.state.wrap===1?L.adler=c(L.adler,$,te,x):L.state.wrap===2&&(L.adler=v(L.adler,$,te,x)),L.next_in+=te,L.total_in+=te,te),u.lookahead+=T,u.lookahead+u.insert>=A)for(V=u.strstart-u.insert,u.ins_h=u.window[V],u.ins_h=(u.ins_h<<u.hash_shift^u.window[V+1])&u.hash_mask;u.insert&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[V+A-1])&u.hash_mask,u.prev[V&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=V,V++,u.insert--,!(u.lookahead+u.insert<A)););}while(u.lookahead<ae&&u.strm.avail_in!==0)}function De(u,U){for(var T,k;;){if(u.lookahead<ae){if(we(u),u.lookahead<ae&&U===p)return f;if(u.lookahead===0)break}if(T=0,u.lookahead>=A&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+A-1])&u.hash_mask,T=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),T!==0&&u.strstart-T<=u.w_size-ae&&(u.match_length=K(u,T)),u.match_length>=A)if(k=t._tr_tally(u,u.strstart-u.match_start,u.match_length-A),u.lookahead-=u.match_length,u.match_length<=u.max_lazy_match&&u.lookahead>=A){for(u.match_length--;u.strstart++,u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+A-1])&u.hash_mask,T=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart,--u.match_length!=0;);u.strstart++}else u.strstart+=u.match_length,u.match_length=0,u.ins_h=u.window[u.strstart],u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+1])&u.hash_mask;else k=t._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++;if(k&&(F(u,!1),u.strm.avail_out===0))return f}return u.insert=u.strstart<A-1?u.strstart:A-1,U===y?(F(u,!0),u.strm.avail_out===0?le:H):u.last_lit&&(F(u,!1),u.strm.avail_out===0)?f:R}function pe(u,U){for(var T,k,C;;){if(u.lookahead<ae){if(we(u),u.lookahead<ae&&U===p)return f;if(u.lookahead===0)break}if(T=0,u.lookahead>=A&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+A-1])&u.hash_mask,T=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),u.prev_length=u.match_length,u.prev_match=u.match_start,u.match_length=A-1,T!==0&&u.prev_length<u.max_lazy_match&&u.strstart-T<=u.w_size-ae&&(u.match_length=K(u,T),u.match_length<=5&&(u.strategy===1||u.match_length===A&&4096<u.strstart-u.match_start)&&(u.match_length=A-1)),u.prev_length>=A&&u.match_length<=u.prev_length){for(C=u.strstart+u.lookahead-A,k=t._tr_tally(u,u.strstart-1-u.prev_match,u.prev_length-A),u.lookahead-=u.prev_length-1,u.prev_length-=2;++u.strstart<=C&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+A-1])&u.hash_mask,T=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),--u.prev_length!=0;);if(u.match_available=0,u.match_length=A-1,u.strstart++,k&&(F(u,!1),u.strm.avail_out===0))return f}else if(u.match_available){if((k=t._tr_tally(u,0,u.window[u.strstart-1]))&&F(u,!1),u.strstart++,u.lookahead--,u.strm.avail_out===0)return f}else u.match_available=1,u.strstart++,u.lookahead--}return u.match_available&&(k=t._tr_tally(u,0,u.window[u.strstart-1]),u.match_available=0),u.insert=u.strstart<A-1?u.strstart:A-1,U===y?(F(u,!0),u.strm.avail_out===0?le:H):u.last_lit&&(F(u,!1),u.strm.avail_out===0)?f:R}function ve(u,U,T,k,C){this.good_length=u,this.max_lazy=U,this.nice_length=T,this.max_chain=k,this.func=C}function Se(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new m.Buf16(2*q),this.dyn_dtree=new m.Buf16(2*(2*P+1)),this.bl_tree=new m.Buf16(2*(2*O+1)),ne(this.dyn_ltree),ne(this.dyn_dtree),ne(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new m.Buf16(j+1),this.heap=new m.Buf16(2*D+1),ne(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new m.Buf16(2*D+1),ne(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ie(u){var U;return u&&u.state?(u.total_in=u.total_out=0,u.data_type=d,(U=u.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?E:B,u.adler=U.wrap===2?0:1,U.last_flush=p,t._tr_init(U),l):ue(u,I)}function qe(u){var U=Ie(u);return U===l&&function(T){T.window_size=2*T.w_size,ne(T.head),T.max_lazy_match=i[T.level].max_lazy,T.good_match=i[T.level].good_length,T.nice_match=i[T.level].nice_length,T.max_chain_length=i[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=A-1,T.match_available=0,T.ins_h=0}(u.state),U}function Ae(u,U,T,k,C,V){if(!u)return I;var L=1;if(U===n&&(U=6),k<0?(L=0,k=-k):15<k&&(L=2,k-=16),C<1||S<C||T!==g||k<8||15<k||U<0||9<U||V<0||b<V)return ue(u,I);k===8&&(k=9);var $=new Se;return(u.state=$).strm=u,$.wrap=L,$.gzhead=null,$.w_bits=k,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=C+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+A-1)/A),$.window=new m.Buf8(2*$.w_size),$.head=new m.Buf16($.hash_size),$.prev=new m.Buf16($.w_size),$.lit_bufsize=1<<C+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new m.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=U,$.strategy=V,$.method=T,qe(u)}i=[new ve(0,0,0,0,function(u,U){var T=65535;for(T>u.pending_buf_size-5&&(T=u.pending_buf_size-5);;){if(u.lookahead<=1){if(we(u),u.lookahead===0&&U===p)return f;if(u.lookahead===0)break}u.strstart+=u.lookahead,u.lookahead=0;var k=u.block_start+T;if((u.strstart===0||u.strstart>=k)&&(u.lookahead=u.strstart-k,u.strstart=k,F(u,!1),u.strm.avail_out===0)||u.strstart-u.block_start>=u.w_size-ae&&(F(u,!1),u.strm.avail_out===0))return f}return u.insert=0,U===y?(F(u,!0),u.strm.avail_out===0?le:H):(u.strstart>u.block_start&&(F(u,!1),u.strm.avail_out),f)}),new ve(4,4,8,4,De),new ve(4,5,16,8,De),new ve(4,6,32,32,De),new ve(4,4,16,16,pe),new ve(8,16,32,32,pe),new ve(8,16,128,128,pe),new ve(8,32,128,256,pe),new ve(32,128,258,1024,pe),new ve(32,258,258,4096,pe)],a.deflateInit=function(u,U){return Ae(u,U,g,15,8,0)},a.deflateInit2=Ae,a.deflateReset=qe,a.deflateResetKeep=Ie,a.deflateSetHeader=function(u,U){return u&&u.state?u.state.wrap!==2?I:(u.state.gzhead=U,l):I},a.deflate=function(u,U){var T,k,C,V;if(!u||!u.state||5<U||U<0)return u?ue(u,I):I;if(k=u.state,!u.output||!u.input&&u.avail_in!==0||k.status===666&&U!==y)return ue(u,u.avail_out===0?-5:I);if(k.strm=u,T=k.last_flush,k.last_flush=U,k.status===E)if(k.wrap===2)u.adler=0,ie(k,31),ie(k,139),ie(k,8),k.gzhead?(ie(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),ie(k,255&k.gzhead.time),ie(k,k.gzhead.time>>8&255),ie(k,k.gzhead.time>>16&255),ie(k,k.gzhead.time>>24&255),ie(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),ie(k,255&k.gzhead.os),k.gzhead.extra&&k.gzhead.extra.length&&(ie(k,255&k.gzhead.extra.length),ie(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(u.adler=v(u.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=69):(ie(k,0),ie(k,0),ie(k,0),ie(k,0),ie(k,0),ie(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),ie(k,3),k.status=B);else{var L=g+(k.w_bits-8<<4)<<8;L|=(2<=k.strategy||k.level<2?0:k.level<6?1:k.level===6?2:3)<<6,k.strstart!==0&&(L|=32),L+=31-L%31,k.status=B,ee(k,L),k.strstart!==0&&(ee(k,u.adler>>>16),ee(k,65535&u.adler)),u.adler=1}if(k.status===69)if(k.gzhead.extra){for(C=k.pending;k.gzindex<(65535&k.gzhead.extra.length)&&(k.pending!==k.pending_buf_size||(k.gzhead.hcrc&&k.pending>C&&(u.adler=v(u.adler,k.pending_buf,k.pending-C,C)),z(u),C=k.pending,k.pending!==k.pending_buf_size));)ie(k,255&k.gzhead.extra[k.gzindex]),k.gzindex++;k.gzhead.hcrc&&k.pending>C&&(u.adler=v(u.adler,k.pending_buf,k.pending-C,C)),k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=73)}else k.status=73;if(k.status===73)if(k.gzhead.name){C=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>C&&(u.adler=v(u.adler,k.pending_buf,k.pending-C,C)),z(u),C=k.pending,k.pending===k.pending_buf_size)){V=1;break}V=k.gzindex<k.gzhead.name.length?255&k.gzhead.name.charCodeAt(k.gzindex++):0,ie(k,V)}while(V!==0);k.gzhead.hcrc&&k.pending>C&&(u.adler=v(u.adler,k.pending_buf,k.pending-C,C)),V===0&&(k.gzindex=0,k.status=91)}else k.status=91;if(k.status===91)if(k.gzhead.comment){C=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>C&&(u.adler=v(u.adler,k.pending_buf,k.pending-C,C)),z(u),C=k.pending,k.pending===k.pending_buf_size)){V=1;break}V=k.gzindex<k.gzhead.comment.length?255&k.gzhead.comment.charCodeAt(k.gzindex++):0,ie(k,V)}while(V!==0);k.gzhead.hcrc&&k.pending>C&&(u.adler=v(u.adler,k.pending_buf,k.pending-C,C)),V===0&&(k.status=103)}else k.status=103;if(k.status===103&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&z(u),k.pending+2<=k.pending_buf_size&&(ie(k,255&u.adler),ie(k,u.adler>>8&255),u.adler=0,k.status=B)):k.status=B),k.pending!==0){if(z(u),u.avail_out===0)return k.last_flush=-1,l}else if(u.avail_in===0&&X(U)<=X(T)&&U!==y)return ue(u,-5);if(k.status===666&&u.avail_in!==0)return ue(u,-5);if(u.avail_in!==0||k.lookahead!==0||U!==p&&k.status!==666){var $=k.strategy===2?function(x,W){for(var te;;){if(x.lookahead===0&&(we(x),x.lookahead===0)){if(W===p)return f;break}if(x.match_length=0,te=t._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++,te&&(F(x,!1),x.strm.avail_out===0))return f}return x.insert=0,W===y?(F(x,!0),x.strm.avail_out===0?le:H):x.last_lit&&(F(x,!1),x.strm.avail_out===0)?f:R}(k,U):k.strategy===3?function(x,W){for(var te,G,re,ye,he=x.window;;){if(x.lookahead<=Z){if(we(x),x.lookahead<=Z&&W===p)return f;if(x.lookahead===0)break}if(x.match_length=0,x.lookahead>=A&&0<x.strstart&&(G=he[re=x.strstart-1])===he[++re]&&G===he[++re]&&G===he[++re]){ye=x.strstart+Z;do;while(G===he[++re]&&G===he[++re]&&G===he[++re]&&G===he[++re]&&G===he[++re]&&G===he[++re]&&G===he[++re]&&G===he[++re]&&re<ye);x.match_length=Z-(ye-re),x.match_length>x.lookahead&&(x.match_length=x.lookahead)}if(x.match_length>=A?(te=t._tr_tally(x,1,x.match_length-A),x.lookahead-=x.match_length,x.strstart+=x.match_length,x.match_length=0):(te=t._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++),te&&(F(x,!1),x.strm.avail_out===0))return f}return x.insert=0,W===y?(F(x,!0),x.strm.avail_out===0?le:H):x.last_lit&&(F(x,!1),x.strm.avail_out===0)?f:R}(k,U):i[k.level].func(k,U);if($!==le&&$!==H||(k.status=666),$===f||$===le)return u.avail_out===0&&(k.last_flush=-1),l;if($===R&&(U===1?t._tr_align(k):U!==5&&(t._tr_stored_block(k,0,0,!1),U===3&&(ne(k.head),k.lookahead===0&&(k.strstart=0,k.block_start=0,k.insert=0))),z(u),u.avail_out===0))return k.last_flush=-1,l}return U!==y?l:k.wrap<=0?1:(k.wrap===2?(ie(k,255&u.adler),ie(k,u.adler>>8&255),ie(k,u.adler>>16&255),ie(k,u.adler>>24&255),ie(k,255&u.total_in),ie(k,u.total_in>>8&255),ie(k,u.total_in>>16&255),ie(k,u.total_in>>24&255)):(ee(k,u.adler>>>16),ee(k,65535&u.adler)),z(u),0<k.wrap&&(k.wrap=-k.wrap),k.pending!==0?l:1)},a.deflateEnd=function(u){var U;return u&&u.state?(U=u.state.status)!==E&&U!==69&&U!==73&&U!==91&&U!==103&&U!==B&&U!==666?ue(u,I):(u.state=null,U===B?ue(u,-3):l):I},a.deflateSetDictionary=function(u,U){var T,k,C,V,L,$,x,W,te=U.length;if(!u||!u.state||(V=(T=u.state).wrap)===2||V===1&&T.status!==E||T.lookahead)return I;for(V===1&&(u.adler=c(u.adler,U,te,0)),T.wrap=0,te>=T.w_size&&(V===0&&(ne(T.head),T.strstart=0,T.block_start=0,T.insert=0),W=new m.Buf8(T.w_size),m.arraySet(W,U,te-T.w_size,T.w_size,0),U=W,te=T.w_size),L=u.avail_in,$=u.next_in,x=u.input,u.avail_in=te,u.next_in=0,u.input=U,we(T);T.lookahead>=A;){for(k=T.strstart,C=T.lookahead-(A-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[k+A-1])&T.hash_mask,T.prev[k&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=k,k++,--C;);T.strstart=k,T.lookahead=A-1,we(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=A-1,T.match_available=0,u.next_in=$,u.input=x,u.avail_in=L,T.wrap=V,l},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(h,w,a){w.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(h,w,a){w.exports=function(i,m){var t,c,v,_,p,y,l,I,n,b,d,g,S,D,P,O,q,j,A,Z,ae,E,B,f,R;t=i.state,c=i.next_in,f=i.input,v=c+(i.avail_in-5),_=i.next_out,R=i.output,p=_-(m-i.avail_out),y=_+(i.avail_out-257),l=t.dmax,I=t.wsize,n=t.whave,b=t.wnext,d=t.window,g=t.hold,S=t.bits,D=t.lencode,P=t.distcode,O=(1<<t.lenbits)-1,q=(1<<t.distbits)-1;e:do{S<15&&(g+=f[c++]<<S,S+=8,g+=f[c++]<<S,S+=8),j=D[g&O];t:for(;;){if(g>>>=A=j>>>24,S-=A,(A=j>>>16&255)===0)R[_++]=65535&j;else{if(!(16&A)){if((64&A)==0){j=D[(65535&j)+(g&(1<<A)-1)];continue t}if(32&A){t.mode=12;break e}i.msg="invalid literal/length code",t.mode=30;break e}Z=65535&j,(A&=15)&&(S<A&&(g+=f[c++]<<S,S+=8),Z+=g&(1<<A)-1,g>>>=A,S-=A),S<15&&(g+=f[c++]<<S,S+=8,g+=f[c++]<<S,S+=8),j=P[g&q];a:for(;;){if(g>>>=A=j>>>24,S-=A,!(16&(A=j>>>16&255))){if((64&A)==0){j=P[(65535&j)+(g&(1<<A)-1)];continue a}i.msg="invalid distance code",t.mode=30;break e}if(ae=65535&j,S<(A&=15)&&(g+=f[c++]<<S,(S+=8)<A&&(g+=f[c++]<<S,S+=8)),l<(ae+=g&(1<<A)-1)){i.msg="invalid distance too far back",t.mode=30;break e}if(g>>>=A,S-=A,(A=_-p)<ae){if(n<(A=ae-A)&&t.sane){i.msg="invalid distance too far back",t.mode=30;break e}if(B=d,(E=0)===b){if(E+=I-A,A<Z){for(Z-=A;R[_++]=d[E++],--A;);E=_-ae,B=R}}else if(b<A){if(E+=I+b-A,(A-=b)<Z){for(Z-=A;R[_++]=d[E++],--A;);if(E=0,b<Z){for(Z-=A=b;R[_++]=d[E++],--A;);E=_-ae,B=R}}}else if(E+=b-A,A<Z){for(Z-=A;R[_++]=d[E++],--A;);E=_-ae,B=R}for(;2<Z;)R[_++]=B[E++],R[_++]=B[E++],R[_++]=B[E++],Z-=3;Z&&(R[_++]=B[E++],1<Z&&(R[_++]=B[E++]))}else{for(E=_-ae;R[_++]=R[E++],R[_++]=R[E++],R[_++]=R[E++],2<(Z-=3););Z&&(R[_++]=R[E++],1<Z&&(R[_++]=R[E++]))}break}}break}}while(c<v&&_<y);c-=Z=S>>3,g&=(1<<(S-=Z<<3))-1,i.next_in=c,i.next_out=_,i.avail_in=c<v?v-c+5:5-(c-v),i.avail_out=_<y?y-_+257:257-(_-y),t.hold=g,t.bits=S}},{}],49:[function(h,w,a){var i=h("../utils/common"),m=h("./adler32"),t=h("./crc32"),c=h("./inffast"),v=h("./inftrees"),_=1,p=2,y=0,l=-2,I=1,n=852,b=592;function d(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(E){var B;return E&&E.state?(B=E.state,E.total_in=E.total_out=B.total=0,E.msg="",B.wrap&&(E.adler=1&B.wrap),B.mode=I,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new i.Buf32(n),B.distcode=B.distdyn=new i.Buf32(b),B.sane=1,B.back=-1,y):l}function D(E){var B;return E&&E.state?((B=E.state).wsize=0,B.whave=0,B.wnext=0,S(E)):l}function P(E,B){var f,R;return E&&E.state?(R=E.state,B<0?(f=0,B=-B):(f=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?l:(R.window!==null&&R.wbits!==B&&(R.window=null),R.wrap=f,R.wbits=B,D(E))):l}function O(E,B){var f,R;return E?(R=new g,(E.state=R).window=null,(f=P(E,B))!==y&&(E.state=null),f):l}var q,j,A=!0;function Z(E){if(A){var B;for(q=new i.Buf32(512),j=new i.Buf32(32),B=0;B<144;)E.lens[B++]=8;for(;B<256;)E.lens[B++]=9;for(;B<280;)E.lens[B++]=7;for(;B<288;)E.lens[B++]=8;for(v(_,E.lens,0,288,q,0,E.work,{bits:9}),B=0;B<32;)E.lens[B++]=5;v(p,E.lens,0,32,j,0,E.work,{bits:5}),A=!1}E.lencode=q,E.lenbits=9,E.distcode=j,E.distbits=5}function ae(E,B,f,R){var le,H=E.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new i.Buf8(H.wsize)),R>=H.wsize?(i.arraySet(H.window,B,f-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(R<(le=H.wsize-H.wnext)&&(le=R),i.arraySet(H.window,B,f-R,le,H.wnext),(R-=le)?(i.arraySet(H.window,B,f-R,R,0),H.wnext=R,H.whave=H.wsize):(H.wnext+=le,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=le))),0}a.inflateReset=D,a.inflateReset2=P,a.inflateResetKeep=S,a.inflateInit=function(E){return O(E,15)},a.inflateInit2=O,a.inflate=function(E,B){var f,R,le,H,ue,X,ne,z,F,ie,ee,K,we,De,pe,ve,Se,Ie,qe,Ae,u,U,T,k,C=0,V=new i.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return l;(f=E.state).mode===12&&(f.mode=13),ue=E.next_out,le=E.output,ne=E.avail_out,H=E.next_in,R=E.input,X=E.avail_in,z=f.hold,F=f.bits,ie=X,ee=ne,U=y;e:for(;;)switch(f.mode){case I:if(f.wrap===0){f.mode=13;break}for(;F<16;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if(2&f.wrap&&z===35615){V[f.check=0]=255&z,V[1]=z>>>8&255,f.check=t(f.check,V,2,0),F=z=0,f.mode=2;break}if(f.flags=0,f.head&&(f.head.done=!1),!(1&f.wrap)||(((255&z)<<8)+(z>>8))%31){E.msg="incorrect header check",f.mode=30;break}if((15&z)!=8){E.msg="unknown compression method",f.mode=30;break}if(F-=4,u=8+(15&(z>>>=4)),f.wbits===0)f.wbits=u;else if(u>f.wbits){E.msg="invalid window size",f.mode=30;break}f.dmax=1<<u,E.adler=f.check=1,f.mode=512&z?10:12,F=z=0;break;case 2:for(;F<16;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if(f.flags=z,(255&f.flags)!=8){E.msg="unknown compression method",f.mode=30;break}if(57344&f.flags){E.msg="unknown header flags set",f.mode=30;break}f.head&&(f.head.text=z>>8&1),512&f.flags&&(V[0]=255&z,V[1]=z>>>8&255,f.check=t(f.check,V,2,0)),F=z=0,f.mode=3;case 3:for(;F<32;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}f.head&&(f.head.time=z),512&f.flags&&(V[0]=255&z,V[1]=z>>>8&255,V[2]=z>>>16&255,V[3]=z>>>24&255,f.check=t(f.check,V,4,0)),F=z=0,f.mode=4;case 4:for(;F<16;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}f.head&&(f.head.xflags=255&z,f.head.os=z>>8),512&f.flags&&(V[0]=255&z,V[1]=z>>>8&255,f.check=t(f.check,V,2,0)),F=z=0,f.mode=5;case 5:if(1024&f.flags){for(;F<16;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}f.length=z,f.head&&(f.head.extra_len=z),512&f.flags&&(V[0]=255&z,V[1]=z>>>8&255,f.check=t(f.check,V,2,0)),F=z=0}else f.head&&(f.head.extra=null);f.mode=6;case 6:if(1024&f.flags&&(X<(K=f.length)&&(K=X),K&&(f.head&&(u=f.head.extra_len-f.length,f.head.extra||(f.head.extra=new Array(f.head.extra_len)),i.arraySet(f.head.extra,R,H,K,u)),512&f.flags&&(f.check=t(f.check,R,K,H)),X-=K,H+=K,f.length-=K),f.length))break e;f.length=0,f.mode=7;case 7:if(2048&f.flags){if(X===0)break e;for(K=0;u=R[H+K++],f.head&&u&&f.length<65536&&(f.head.name+=String.fromCharCode(u)),u&&K<X;);if(512&f.flags&&(f.check=t(f.check,R,K,H)),X-=K,H+=K,u)break e}else f.head&&(f.head.name=null);f.length=0,f.mode=8;case 8:if(4096&f.flags){if(X===0)break e;for(K=0;u=R[H+K++],f.head&&u&&f.length<65536&&(f.head.comment+=String.fromCharCode(u)),u&&K<X;);if(512&f.flags&&(f.check=t(f.check,R,K,H)),X-=K,H+=K,u)break e}else f.head&&(f.head.comment=null);f.mode=9;case 9:if(512&f.flags){for(;F<16;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if(z!==(65535&f.check)){E.msg="header crc mismatch",f.mode=30;break}F=z=0}f.head&&(f.head.hcrc=f.flags>>9&1,f.head.done=!0),E.adler=f.check=0,f.mode=12;break;case 10:for(;F<32;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}E.adler=f.check=d(z),F=z=0,f.mode=11;case 11:if(f.havedict===0)return E.next_out=ue,E.avail_out=ne,E.next_in=H,E.avail_in=X,f.hold=z,f.bits=F,2;E.adler=f.check=1,f.mode=12;case 12:if(B===5||B===6)break e;case 13:if(f.last){z>>>=7&F,F-=7&F,f.mode=27;break}for(;F<3;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}switch(f.last=1&z,F-=1,3&(z>>>=1)){case 0:f.mode=14;break;case 1:if(Z(f),f.mode=20,B!==6)break;z>>>=2,F-=2;break e;case 2:f.mode=17;break;case 3:E.msg="invalid block type",f.mode=30}z>>>=2,F-=2;break;case 14:for(z>>>=7&F,F-=7&F;F<32;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if((65535&z)!=(z>>>16^65535)){E.msg="invalid stored block lengths",f.mode=30;break}if(f.length=65535&z,F=z=0,f.mode=15,B===6)break e;case 15:f.mode=16;case 16:if(K=f.length){if(X<K&&(K=X),ne<K&&(K=ne),K===0)break e;i.arraySet(le,R,H,K,ue),X-=K,H+=K,ne-=K,ue+=K,f.length-=K;break}f.mode=12;break;case 17:for(;F<14;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if(f.nlen=257+(31&z),z>>>=5,F-=5,f.ndist=1+(31&z),z>>>=5,F-=5,f.ncode=4+(15&z),z>>>=4,F-=4,286<f.nlen||30<f.ndist){E.msg="too many length or distance symbols",f.mode=30;break}f.have=0,f.mode=18;case 18:for(;f.have<f.ncode;){for(;F<3;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}f.lens[L[f.have++]]=7&z,z>>>=3,F-=3}for(;f.have<19;)f.lens[L[f.have++]]=0;if(f.lencode=f.lendyn,f.lenbits=7,T={bits:f.lenbits},U=v(0,f.lens,0,19,f.lencode,0,f.work,T),f.lenbits=T.bits,U){E.msg="invalid code lengths set",f.mode=30;break}f.have=0,f.mode=19;case 19:for(;f.have<f.nlen+f.ndist;){for(;ve=(C=f.lencode[z&(1<<f.lenbits)-1])>>>16&255,Se=65535&C,!((pe=C>>>24)<=F);){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if(Se<16)z>>>=pe,F-=pe,f.lens[f.have++]=Se;else{if(Se===16){for(k=pe+2;F<k;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if(z>>>=pe,F-=pe,f.have===0){E.msg="invalid bit length repeat",f.mode=30;break}u=f.lens[f.have-1],K=3+(3&z),z>>>=2,F-=2}else if(Se===17){for(k=pe+3;F<k;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}F-=pe,u=0,K=3+(7&(z>>>=pe)),z>>>=3,F-=3}else{for(k=pe+7;F<k;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}F-=pe,u=0,K=11+(127&(z>>>=pe)),z>>>=7,F-=7}if(f.have+K>f.nlen+f.ndist){E.msg="invalid bit length repeat",f.mode=30;break}for(;K--;)f.lens[f.have++]=u}}if(f.mode===30)break;if(f.lens[256]===0){E.msg="invalid code -- missing end-of-block",f.mode=30;break}if(f.lenbits=9,T={bits:f.lenbits},U=v(_,f.lens,0,f.nlen,f.lencode,0,f.work,T),f.lenbits=T.bits,U){E.msg="invalid literal/lengths set",f.mode=30;break}if(f.distbits=6,f.distcode=f.distdyn,T={bits:f.distbits},U=v(p,f.lens,f.nlen,f.ndist,f.distcode,0,f.work,T),f.distbits=T.bits,U){E.msg="invalid distances set",f.mode=30;break}if(f.mode=20,B===6)break e;case 20:f.mode=21;case 21:if(6<=X&&258<=ne){E.next_out=ue,E.avail_out=ne,E.next_in=H,E.avail_in=X,f.hold=z,f.bits=F,c(E,ee),ue=E.next_out,le=E.output,ne=E.avail_out,H=E.next_in,R=E.input,X=E.avail_in,z=f.hold,F=f.bits,f.mode===12&&(f.back=-1);break}for(f.back=0;ve=(C=f.lencode[z&(1<<f.lenbits)-1])>>>16&255,Se=65535&C,!((pe=C>>>24)<=F);){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if(ve&&(240&ve)==0){for(Ie=pe,qe=ve,Ae=Se;ve=(C=f.lencode[Ae+((z&(1<<Ie+qe)-1)>>Ie)])>>>16&255,Se=65535&C,!(Ie+(pe=C>>>24)<=F);){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}z>>>=Ie,F-=Ie,f.back+=Ie}if(z>>>=pe,F-=pe,f.back+=pe,f.length=Se,ve===0){f.mode=26;break}if(32&ve){f.back=-1,f.mode=12;break}if(64&ve){E.msg="invalid literal/length code",f.mode=30;break}f.extra=15&ve,f.mode=22;case 22:if(f.extra){for(k=f.extra;F<k;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}f.length+=z&(1<<f.extra)-1,z>>>=f.extra,F-=f.extra,f.back+=f.extra}f.was=f.length,f.mode=23;case 23:for(;ve=(C=f.distcode[z&(1<<f.distbits)-1])>>>16&255,Se=65535&C,!((pe=C>>>24)<=F);){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if((240&ve)==0){for(Ie=pe,qe=ve,Ae=Se;ve=(C=f.distcode[Ae+((z&(1<<Ie+qe)-1)>>Ie)])>>>16&255,Se=65535&C,!(Ie+(pe=C>>>24)<=F);){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}z>>>=Ie,F-=Ie,f.back+=Ie}if(z>>>=pe,F-=pe,f.back+=pe,64&ve){E.msg="invalid distance code",f.mode=30;break}f.offset=Se,f.extra=15&ve,f.mode=24;case 24:if(f.extra){for(k=f.extra;F<k;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}f.offset+=z&(1<<f.extra)-1,z>>>=f.extra,F-=f.extra,f.back+=f.extra}if(f.offset>f.dmax){E.msg="invalid distance too far back",f.mode=30;break}f.mode=25;case 25:if(ne===0)break e;if(K=ee-ne,f.offset>K){if((K=f.offset-K)>f.whave&&f.sane){E.msg="invalid distance too far back",f.mode=30;break}we=K>f.wnext?(K-=f.wnext,f.wsize-K):f.wnext-K,K>f.length&&(K=f.length),De=f.window}else De=le,we=ue-f.offset,K=f.length;for(ne<K&&(K=ne),ne-=K,f.length-=K;le[ue++]=De[we++],--K;);f.length===0&&(f.mode=21);break;case 26:if(ne===0)break e;le[ue++]=f.length,ne--,f.mode=21;break;case 27:if(f.wrap){for(;F<32;){if(X===0)break e;X--,z|=R[H++]<<F,F+=8}if(ee-=ne,E.total_out+=ee,f.total+=ee,ee&&(E.adler=f.check=f.flags?t(f.check,le,ee,ue-ee):m(f.check,le,ee,ue-ee)),ee=ne,(f.flags?z:d(z))!==f.check){E.msg="incorrect data check",f.mode=30;break}F=z=0}f.mode=28;case 28:if(f.wrap&&f.flags){for(;F<32;){if(X===0)break e;X--,z+=R[H++]<<F,F+=8}if(z!==(4294967295&f.total)){E.msg="incorrect length check",f.mode=30;break}F=z=0}f.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return l}return E.next_out=ue,E.avail_out=ne,E.next_in=H,E.avail_in=X,f.hold=z,f.bits=F,(f.wsize||ee!==E.avail_out&&f.mode<30&&(f.mode<27||B!==4))&&ae(E,E.output,E.next_out,ee-E.avail_out)?(f.mode=31,-4):(ie-=E.avail_in,ee-=E.avail_out,E.total_in+=ie,E.total_out+=ee,f.total+=ee,f.wrap&&ee&&(E.adler=f.check=f.flags?t(f.check,le,ee,E.next_out-ee):m(f.check,le,ee,E.next_out-ee)),E.data_type=f.bits+(f.last?64:0)+(f.mode===12?128:0)+(f.mode===20||f.mode===15?256:0),(ie==0&&ee===0||B===4)&&U===y&&(U=-5),U)},a.inflateEnd=function(E){if(!E||!E.state)return l;var B=E.state;return B.window&&(B.window=null),E.state=null,y},a.inflateGetHeader=function(E,B){var f;return E&&E.state?(2&(f=E.state).wrap)==0?l:((f.head=B).done=!1,y):l},a.inflateSetDictionary=function(E,B){var f,R=B.length;return E&&E.state?(f=E.state).wrap!==0&&f.mode!==11?l:f.mode===11&&m(1,B,R,0)!==f.check?-3:ae(E,B,R,R)?(f.mode=31,-4):(f.havedict=1,y):l},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(h,w,a){var i=h("../utils/common"),m=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],t=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],v=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];w.exports=function(_,p,y,l,I,n,b,d){var g,S,D,P,O,q,j,A,Z,ae=d.bits,E=0,B=0,f=0,R=0,le=0,H=0,ue=0,X=0,ne=0,z=0,F=null,ie=0,ee=new i.Buf16(16),K=new i.Buf16(16),we=null,De=0;for(E=0;E<=15;E++)ee[E]=0;for(B=0;B<l;B++)ee[p[y+B]]++;for(le=ae,R=15;1<=R&&ee[R]===0;R--);if(R<le&&(le=R),R===0)return I[n++]=20971520,I[n++]=20971520,d.bits=1,0;for(f=1;f<R&&ee[f]===0;f++);for(le<f&&(le=f),E=X=1;E<=15;E++)if(X<<=1,(X-=ee[E])<0)return-1;if(0<X&&(_===0||R!==1))return-1;for(K[1]=0,E=1;E<15;E++)K[E+1]=K[E]+ee[E];for(B=0;B<l;B++)p[y+B]!==0&&(b[K[p[y+B]]++]=B);if(q=_===0?(F=we=b,19):_===1?(F=m,ie-=257,we=t,De-=257,256):(F=c,we=v,-1),E=f,O=n,ue=B=z=0,D=-1,P=(ne=1<<(H=le))-1,_===1&&852<ne||_===2&&592<ne)return 1;for(;;){for(j=E-ue,Z=b[B]<q?(A=0,b[B]):b[B]>q?(A=we[De+b[B]],F[ie+b[B]]):(A=96,0),g=1<<E-ue,f=S=1<<H;I[O+(z>>ue)+(S-=g)]=j<<24|A<<16|Z|0,S!==0;);for(g=1<<E-1;z&g;)g>>=1;if(g!==0?(z&=g-1,z+=g):z=0,B++,--ee[E]==0){if(E===R)break;E=p[y+b[B]]}if(le<E&&(z&P)!==D){for(ue===0&&(ue=le),O+=f,X=1<<(H=E-ue);H+ue<R&&!((X-=ee[H+ue])<=0);)H++,X<<=1;if(ne+=1<<H,_===1&&852<ne||_===2&&592<ne)return 1;I[D=z&P]=le<<24|H<<16|O-n|0}}return z!==0&&(I[O+z]=E-ue<<24|64<<16|0),d.bits=le,0}},{"../utils/common":41}],51:[function(h,w,a){w.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(h,w,a){var i=h("../utils/common"),m=0,t=1;function c(C){for(var V=C.length;0<=--V;)C[V]=0}var v=0,_=29,p=256,y=p+1+_,l=30,I=19,n=2*y+1,b=15,d=16,g=7,S=256,D=16,P=17,O=18,q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=new Array(2*(y+2));c(ae);var E=new Array(2*l);c(E);var B=new Array(512);c(B);var f=new Array(256);c(f);var R=new Array(_);c(R);var le,H,ue,X=new Array(l);function ne(C,V,L,$,x){this.static_tree=C,this.extra_bits=V,this.extra_base=L,this.elems=$,this.max_length=x,this.has_stree=C&&C.length}function z(C,V){this.dyn_tree=C,this.max_code=0,this.stat_desc=V}function F(C){return C<256?B[C]:B[256+(C>>>7)]}function ie(C,V){C.pending_buf[C.pending++]=255&V,C.pending_buf[C.pending++]=V>>>8&255}function ee(C,V,L){C.bi_valid>d-L?(C.bi_buf|=V<<C.bi_valid&65535,ie(C,C.bi_buf),C.bi_buf=V>>d-C.bi_valid,C.bi_valid+=L-d):(C.bi_buf|=V<<C.bi_valid&65535,C.bi_valid+=L)}function K(C,V,L){ee(C,L[2*V],L[2*V+1])}function we(C,V){for(var L=0;L|=1&C,C>>>=1,L<<=1,0<--V;);return L>>>1}function De(C,V,L){var $,x,W=new Array(b+1),te=0;for($=1;$<=b;$++)W[$]=te=te+L[$-1]<<1;for(x=0;x<=V;x++){var G=C[2*x+1];G!==0&&(C[2*x]=we(W[G]++,G))}}function pe(C){var V;for(V=0;V<y;V++)C.dyn_ltree[2*V]=0;for(V=0;V<l;V++)C.dyn_dtree[2*V]=0;for(V=0;V<I;V++)C.bl_tree[2*V]=0;C.dyn_ltree[2*S]=1,C.opt_len=C.static_len=0,C.last_lit=C.matches=0}function ve(C){8<C.bi_valid?ie(C,C.bi_buf):0<C.bi_valid&&(C.pending_buf[C.pending++]=C.bi_buf),C.bi_buf=0,C.bi_valid=0}function Se(C,V,L,$){var x=2*V,W=2*L;return C[x]<C[W]||C[x]===C[W]&&$[V]<=$[L]}function Ie(C,V,L){for(var $=C.heap[L],x=L<<1;x<=C.heap_len&&(x<C.heap_len&&Se(V,C.heap[x+1],C.heap[x],C.depth)&&x++,!Se(V,$,C.heap[x],C.depth));)C.heap[L]=C.heap[x],L=x,x<<=1;C.heap[L]=$}function qe(C,V,L){var $,x,W,te,G=0;if(C.last_lit!==0)for(;$=C.pending_buf[C.d_buf+2*G]<<8|C.pending_buf[C.d_buf+2*G+1],x=C.pending_buf[C.l_buf+G],G++,$===0?K(C,x,V):(K(C,(W=f[x])+p+1,V),(te=q[W])!==0&&ee(C,x-=R[W],te),K(C,W=F(--$),L),(te=j[W])!==0&&ee(C,$-=X[W],te)),G<C.last_lit;);K(C,S,V)}function Ae(C,V){var L,$,x,W=V.dyn_tree,te=V.stat_desc.static_tree,G=V.stat_desc.has_stree,re=V.stat_desc.elems,ye=-1;for(C.heap_len=0,C.heap_max=n,L=0;L<re;L++)W[2*L]!==0?(C.heap[++C.heap_len]=ye=L,C.depth[L]=0):W[2*L+1]=0;for(;C.heap_len<2;)W[2*(x=C.heap[++C.heap_len]=ye<2?++ye:0)]=1,C.depth[x]=0,C.opt_len--,G&&(C.static_len-=te[2*x+1]);for(V.max_code=ye,L=C.heap_len>>1;1<=L;L--)Ie(C,W,L);for(x=re;L=C.heap[1],C.heap[1]=C.heap[C.heap_len--],Ie(C,W,1),$=C.heap[1],C.heap[--C.heap_max]=L,C.heap[--C.heap_max]=$,W[2*x]=W[2*L]+W[2*$],C.depth[x]=(C.depth[L]>=C.depth[$]?C.depth[L]:C.depth[$])+1,W[2*L+1]=W[2*$+1]=x,C.heap[1]=x++,Ie(C,W,1),2<=C.heap_len;);C.heap[--C.heap_max]=C.heap[1],function(he,Fe){var We,Be,Ge,Ce,Je,st,Oe=Fe.dyn_tree,ct=Fe.max_code,yt=Fe.stat_desc.static_tree,wt=Fe.stat_desc.has_stree,It=Fe.stat_desc.extra_bits,mt=Fe.stat_desc.extra_base,Qe=Fe.stat_desc.max_length,et=0;for(Ce=0;Ce<=b;Ce++)he.bl_count[Ce]=0;for(Oe[2*he.heap[he.heap_max]+1]=0,We=he.heap_max+1;We<n;We++)Qe<(Ce=Oe[2*Oe[2*(Be=he.heap[We])+1]+1]+1)&&(Ce=Qe,et++),Oe[2*Be+1]=Ce,ct<Be||(he.bl_count[Ce]++,Je=0,mt<=Be&&(Je=It[Be-mt]),st=Oe[2*Be],he.opt_len+=st*(Ce+Je),wt&&(he.static_len+=st*(yt[2*Be+1]+Je)));if(et!==0){do{for(Ce=Qe-1;he.bl_count[Ce]===0;)Ce--;he.bl_count[Ce]--,he.bl_count[Ce+1]+=2,he.bl_count[Qe]--,et-=2}while(0<et);for(Ce=Qe;Ce!==0;Ce--)for(Be=he.bl_count[Ce];Be!==0;)ct<(Ge=he.heap[--We])||(Oe[2*Ge+1]!==Ce&&(he.opt_len+=(Ce-Oe[2*Ge+1])*Oe[2*Ge],Oe[2*Ge+1]=Ce),Be--)}}(C,V),De(W,ye,C.bl_count)}function u(C,V,L){var $,x,W=-1,te=V[1],G=0,re=7,ye=4;for(te===0&&(re=138,ye=3),V[2*(L+1)+1]=65535,$=0;$<=L;$++)x=te,te=V[2*($+1)+1],++G<re&&x===te||(G<ye?C.bl_tree[2*x]+=G:x!==0?(x!==W&&C.bl_tree[2*x]++,C.bl_tree[2*D]++):G<=10?C.bl_tree[2*P]++:C.bl_tree[2*O]++,W=x,ye=(G=0)===te?(re=138,3):x===te?(re=6,3):(re=7,4))}function U(C,V,L){var $,x,W=-1,te=V[1],G=0,re=7,ye=4;for(te===0&&(re=138,ye=3),$=0;$<=L;$++)if(x=te,te=V[2*($+1)+1],!(++G<re&&x===te)){if(G<ye)for(;K(C,x,C.bl_tree),--G!=0;);else x!==0?(x!==W&&(K(C,x,C.bl_tree),G--),K(C,D,C.bl_tree),ee(C,G-3,2)):G<=10?(K(C,P,C.bl_tree),ee(C,G-3,3)):(K(C,O,C.bl_tree),ee(C,G-11,7));W=x,ye=(G=0)===te?(re=138,3):x===te?(re=6,3):(re=7,4)}}c(X);var T=!1;function k(C,V,L,$){ee(C,(v<<1)+($?1:0),3),function(x,W,te,G){ve(x),G&&(ie(x,te),ie(x,~te)),i.arraySet(x.pending_buf,x.window,W,te,x.pending),x.pending+=te}(C,V,L,!0)}a._tr_init=function(C){T||(function(){var V,L,$,x,W,te=new Array(b+1);for(x=$=0;x<_-1;x++)for(R[x]=$,V=0;V<1<<q[x];V++)f[$++]=x;for(f[$-1]=x,x=W=0;x<16;x++)for(X[x]=W,V=0;V<1<<j[x];V++)B[W++]=x;for(W>>=7;x<l;x++)for(X[x]=W<<7,V=0;V<1<<j[x]-7;V++)B[256+W++]=x;for(L=0;L<=b;L++)te[L]=0;for(V=0;V<=143;)ae[2*V+1]=8,V++,te[8]++;for(;V<=255;)ae[2*V+1]=9,V++,te[9]++;for(;V<=279;)ae[2*V+1]=7,V++,te[7]++;for(;V<=287;)ae[2*V+1]=8,V++,te[8]++;for(De(ae,y+1,te),V=0;V<l;V++)E[2*V+1]=5,E[2*V]=we(V,5);le=new ne(ae,q,p+1,y,b),H=new ne(E,j,0,l,b),ue=new ne(new Array(0),A,0,I,g)}(),T=!0),C.l_desc=new z(C.dyn_ltree,le),C.d_desc=new z(C.dyn_dtree,H),C.bl_desc=new z(C.bl_tree,ue),C.bi_buf=0,C.bi_valid=0,pe(C)},a._tr_stored_block=k,a._tr_flush_block=function(C,V,L,$){var x,W,te=0;0<C.level?(C.strm.data_type===2&&(C.strm.data_type=function(G){var re,ye=4093624447;for(re=0;re<=31;re++,ye>>>=1)if(1&ye&&G.dyn_ltree[2*re]!==0)return m;if(G.dyn_ltree[18]!==0||G.dyn_ltree[20]!==0||G.dyn_ltree[26]!==0)return t;for(re=32;re<p;re++)if(G.dyn_ltree[2*re]!==0)return t;return m}(C)),Ae(C,C.l_desc),Ae(C,C.d_desc),te=function(G){var re;for(u(G,G.dyn_ltree,G.l_desc.max_code),u(G,G.dyn_dtree,G.d_desc.max_code),Ae(G,G.bl_desc),re=I-1;3<=re&&G.bl_tree[2*Z[re]+1]===0;re--);return G.opt_len+=3*(re+1)+5+5+4,re}(C),x=C.opt_len+3+7>>>3,(W=C.static_len+3+7>>>3)<=x&&(x=W)):x=W=L+5,L+4<=x&&V!==-1?k(C,V,L,$):C.strategy===4||W===x?(ee(C,2+($?1:0),3),qe(C,ae,E)):(ee(C,4+($?1:0),3),function(G,re,ye,he){var Fe;for(ee(G,re-257,5),ee(G,ye-1,5),ee(G,he-4,4),Fe=0;Fe<he;Fe++)ee(G,G.bl_tree[2*Z[Fe]+1],3);U(G,G.dyn_ltree,re-1),U(G,G.dyn_dtree,ye-1)}(C,C.l_desc.max_code+1,C.d_desc.max_code+1,te+1),qe(C,C.dyn_ltree,C.dyn_dtree)),pe(C),$&&ve(C)},a._tr_tally=function(C,V,L){return C.pending_buf[C.d_buf+2*C.last_lit]=V>>>8&255,C.pending_buf[C.d_buf+2*C.last_lit+1]=255&V,C.pending_buf[C.l_buf+C.last_lit]=255&L,C.last_lit++,V===0?C.dyn_ltree[2*L]++:(C.matches++,V--,C.dyn_ltree[2*(f[L]+p+1)]++,C.dyn_dtree[2*F(V)]++),C.last_lit===C.lit_bufsize-1},a._tr_align=function(C){ee(C,2,3),K(C,S,ae),function(V){V.bi_valid===16?(ie(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):8<=V.bi_valid&&(V.pending_buf[V.pending++]=255&V.bi_buf,V.bi_buf>>=8,V.bi_valid-=8)}(C)}},{"../utils/common":41}],53:[function(h,w,a){w.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(h,w,a){(function(i){(function(m,t){if(!m.setImmediate){var c,v,_,p,y=1,l={},I=!1,n=m.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(m);b=b&&b.setTimeout?b:m,c={}.toString.call(m.process)==="[object process]"?function(D){process.nextTick(function(){g(D)})}:function(){if(m.postMessage&&!m.importScripts){var D=!0,P=m.onmessage;return m.onmessage=function(){D=!1},m.postMessage("","*"),m.onmessage=P,D}}()?(p="setImmediate$"+Math.random()+"$",m.addEventListener?m.addEventListener("message",S,!1):m.attachEvent("onmessage",S),function(D){m.postMessage(p+D,"*")}):m.MessageChannel?((_=new MessageChannel).port1.onmessage=function(D){g(D.data)},function(D){_.port2.postMessage(D)}):n&&"onreadystatechange"in n.createElement("script")?(v=n.documentElement,function(D){var P=n.createElement("script");P.onreadystatechange=function(){g(D),P.onreadystatechange=null,v.removeChild(P),P=null},v.appendChild(P)}):function(D){setTimeout(g,0,D)},b.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var P=new Array(arguments.length-1),O=0;O<P.length;O++)P[O]=arguments[O+1];var q={callback:D,args:P};return l[y]=q,c(y),y++},b.clearImmediate=d}function d(D){delete l[D]}function g(D){if(I)setTimeout(g,0,D);else{var P=l[D];if(P){I=!0;try{(function(O){var q=O.callback,j=O.args;switch(j.length){case 0:q();break;case 1:q(j[0]);break;case 2:q(j[0],j[1]);break;case 3:q(j[0],j[1],j[2]);break;default:q.apply(t,j)}})(P)}finally{d(D),I=!1}}}}function S(D){D.source===m&&typeof D.data=="string"&&D.data.indexOf(p)===0&&g(+D.data.slice(p.length))}})(typeof self=="undefined"?i===void 0?this:i:self)}).call(this,typeof tt!="undefined"?tt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(_t);var ya=_t.exports;const Ke={paginacao:{atual:1,maximo:1,total:1,limite:25},filtros:{numero:"",numeroCompra:null,termoBusca:"",periodoEmissao:{ini:"",fim:""},periodoFinalizado:{ini:"",fim:""},fornecedor:{nome:""},destinatario:null}},wa={components:{Lista:Nt,ComprasFicha:Qt,ComprasImportacaoXML:_a},data(){return{usuario:"",clienteSistema:"",lista:[],contatos:{},destinatarioOpcoes:[],destinatarioSelecionado:null,mostrar:{header:!0,barraTopo:!0,toolbarTitulo:!0,icone:"factory",titulo:"Compras",filtroAvancado:!0,buscar:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:""},resultado:{},busca:"",filtros:$utils.clonarV2(Ke.filtros),tabSelecionada2:{valor:"Digita\xE7\xE3o"},tabs2:[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}],tabSelecionada:{},tabs:[],paginacao:$utils.clonarV2(Ke.paginacao),xmlDevolucao:!1,xmlEstrangeiro:!1,modalXMLNotaEntrada:!1,xmlNotaEntrada:{},abrirNotadeEntrada:null,modalPrevisaoEntrega:{},configImpressao:[],configImpressaoPedidoCompra:[{valor:"ped_compra",texto:"Pedido de Compra",observacao:"Modelo 1"},{valor:"pedidoCompra",texto:"Pedido de Compra",observacao:"Modelo 2"}],dialogEtiquetas:{impressao:!1,adicionar:!1,limpar:!1,item:{}},opcoesModelo:[],modeloSelecionado:"",emBranco:0,opcoesEmpresas:[],empresaSelecionada:"",tabelasPreco:[],opcoesTabelasPreco:[],tabelaPrecoSelecionada:""}},methods:{aoSelecionarDestinatario(){this.filtros.destinatario=$utils.clonar(this.destinatarioSelecionado)},async atualizar(r){var h;const s=$utils.logarIni("ComprasLista");await $tryLoading(async()=>{var _;let{buscarDadosRecentes:w}=r!=null?r:{},a,i,m,t,c=["dataHoraFinalizado","dataHoraEmissao"],v=["desc","desc"];if(r!=null&&r.aba2&&(this.tabSelecionada.valor=r.aba2),this.tabSelecionadaAnterior&&this.tabSelecionadaAnterior!==this.tabSelecionada.valor&&(this.setOpcoesTabs(this.tabSelecionada.valor),this.filtros=$utils.clonarV2(Ke.filtros),this.paginacao=$utils.clonarV2(Ke.paginacao),this.busca="",w=!0),this.tabSelecionadaAnterior=this.tabSelecionada.valor,w&&(a=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:this.tabSelecionada.valor}),a!=null&&a._id&&(this.destinatarioSelecionado=a.filtros.destinatario,this.filtros=a.filtros,this.busca=a.termoBusca,c=a.sort,v=a.dir)),r!=null&&r.aba&&(this.tabSelecionada2.valor=r.aba),i=$utils.eliminarVazios(this.filtros),m=this.paginacao.limite,t=this.paginacao.atual,i.status=this.tabSelecionada2.valor,i.operacao=this.tabSelecionada.valor,i.termoBusca=this.busca,this.tabSelecionada2.valor==="Todos"&&delete i.status,i.operacao==="Nota na SEFAZ"){let p=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","xNomeEmitente","cpfCnpjEmitente","xNomeDestinatario","cpfCnpjDestinatario","vNF","situacao","nNF"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});p=p.filter(n=>{var b,d,g;return!(((b=this.filtros.fornecedor)==null?void 0:b.nome)&&!n.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((d=this.filtros.destinatario)==null?void 0:d.numeroDocumentoNacional)&&((g=n.cpfCnpjDestinatario)==null?void 0:g.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))});const y=await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","dhRecbto"],whereIn:{idDocumentoFiscalEletronico:p.map(n=>n.id)}}),l=[];y.forEach(n=>{var D,P;const b=p.find(O=>O.id===n.idDocumentoFiscalEletronico),d=new Date(n.dhRecbto).setHours(0,0,0,0),g=new Date((D=this.filtros.periodoEmissao)==null?void 0:D.ini).setHours(0,0,0,0),S=new Date((P=this.filtros.periodoEmissao)==null?void 0:P.fim).setHours(0,0,0,0);(g||S)&&d&&(g&&d<g||S&&d>S)||b&&l.push({id:b.id,descricaoContato:b.xNomeEmitente,numeroDocumentoContato:this.$filters.cpfCnpj(b.cpfCnpjEmitente)||"",descricaoEmpresa:b.xNomeDestinatario,numeroDocumentoEmpresa:this.$filters.cpfCnpj(b.cpfCnpjDestinatario)||"",dhRecbto:n.dhRecbto,totalDocumento:b.vNF,status:b.situacao,notaNumero:b.nNF})});const I=(t-1)*m;this.paginacao.total=l.length,this.paginacao.maximo=Math.ceil(this.paginacao.total/m)||1,l.sort((n,b)=>n.dhRecbto<b.dhRecbto?1:-1),this.lista=l.splice(I,m)}else{(_=this.filtros.destinatario)!=null&&_.value&&(i.idContatoEmpresa=this.filtros.destinatario.value);const p=await $db.compra.leListaCompleta({filtros:i,limit:m,page:t,sort:c,dir:v});this.paginacao.total=p.total,this.paginacao.maximo=p.totalPages,this.lista=p.data.compras}for(const{idContato:p}of this.lista)p&&!this.contatos[p]&&(this.contatos[p]={});this.carregarImagensContatos(this.contatos),a={_id:this.tabSelecionada.valor,tabSelecionada2:this.tabSelecionada2.valor,filtros:$utils.clonarV2(i),termoBusca:this.busca,sort:c,dir:v},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:a}),this.configuraImpressao(this.filtros.idEmpresa)}),$utils.logarFim(s,((h=this.paginacao)==null?void 0:h.total)||1)},async carregarImagensContatos(r){const s=Object.keys(r);if(!!s.length){await $utils.dormir(200);try{const h=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:s}});for(const w of h)r[w.id].imagem=w.imagem||""}catch(h){console.error("Erro ao carregar imagens de contatos - ",h)}}},adicionarXml(r){this.xmlNotaEntrada.arquivo=r[0]},async concluirImportacao(r){await $tryLoading(async()=>{await $db.compra.grava({atual:r}),$q.notifyPositive("Importa\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabSelecionada.valor="Nota de Entrada",await this.$refs.comprasFicha.mostrar({id:r.documento.id})},{mensagem:"Gravando importa\xE7\xE3o..."})},async importarXmlNotaDeEntrada(){var h,w,a,i,m,t;let r,s;try{$utils.verificarErro(!this.xmlNotaEntrada.arquivo,"Adicione um arquivo XML antes de enviar!");const v=await(n=>new Promise((b,d)=>{const g=new FileReader;g.readAsBinaryString(n),g.onload=()=>b(g.result),g.onerror=S=>d(S)}))(this.xmlNotaEntrada.arquivo),_=new DOMParser,p=new XMLSerializer,y=_.parseFromString(v,"text/xml");s=p.serializeToString(y),$utils.verificarErro(y.documentElement.nodeName==="html","Arquivo inv\xE1lido ou corrompido");const l=new Vt.Parser;let I;l.parseString(s,(n,b)=>{n&&console.log(n),I=b}),r=(t=(m=(i=(a=(w=(h=I==null?void 0:I.nfeProc)==null?void 0:h.protNFe)==null?void 0:w[0])==null?void 0:a.infProt)==null?void 0:i[0])==null?void 0:m.nProt)==null?void 0:t[0]}catch(c){return $q.notifyError("Ocorreu um erro na importa\xE7\xE3o",c),!1}if(!r&&!await $q.dialogSimNao({title:"Aviso importante",message:"O XML que est\xE1 sendo importado n\xE3o foi protocolado pela Sefaz, gostaria de importar o XML sem o protocolo?",html:!0})){$q.notifyError("Opera\xE7\xE3o para importa\xE7\xE3o de XML n\xE3o realizada!",erro);return}await $tryLoading(async()=>{const c=(await $db.hibrido.lista({table:"documentoXML",whereFilter:{xmlAux:s}}))[0];$utils.verificarErro(c==null?void 0:c.id,"Esse xml j\xE1 foi importado!");const v=await $db.compra.importaXml({xmlString:s,xmlEstrangeiro:Boolean(this.xmlEstrangeiro)});v.documentosItem.find(({vinculado:_})=>!_)?this.$refs.comprasImportacaoXML.mostrar(v):await this.concluirImportacao(v)},{mensagem:"Importando..."}),delete this.xmlNotaEntrada.arquivo,this.modalXMLNotaEntrada=!1,this.xmlEstrangeiro=!1},async fecharXmlNotaDeEntrada(){delete this.xmlNotaEntrada.arquivo},async abrir(r){this.tabSelecionada.valor!=="Nota na SEFAZ"&&this.$refs.comprasFicha.mostrar({id:r})},criarClick(){this.$refs.comprasFicha.criar()},importarXmlClick(){this.modalXMLNotaEntrada=!0},limparFiltrosClick(){this.filtros=$utils.clonarV2(Ke.filtros),this.destinatarioSelecionado=null,this.atualizar()},setOpcoesTabs(r){r!=="Nota na SEFAZ"?(this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabs2=[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}]):(this.tabSelecionada2.valor="N\xE3o Importada",this.tabs2=[{valor:"N\xE3o Importada",rotulo:"N\xE3o Importada"},{valor:"Importada",rotulo:"Importada"},{valor:"Todos",rotulo:"Todas"}])},async duplicarDocumento_click(r){!await $q.dialogSimNao({title:"Duplicar",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const s=await $db.hibrido.le({table:"documento",id:r.id});$utils.verificarErro(!s.id,"Compra n\xE3o encontrada");const h=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:r.id}})).sort((a,i)=>new Date(a.dataHoraEmissao||0)-new Date(i.dataHoraEmissao||0)),w=$utils.uuid();await $db.hibrido.grava("documento",{atual:{...s,id:w,codigoDocumento:void 0,numero:void 0,notaNumero:void 0,notaSerie:void 0,naturezaOperacao:void 0,dataCompra:void 0,chaveAcesso:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,dataHoraPrevisto:void 0,status:"Digita\xE7\xE3o",operacao:"Pedido de Compra"}}),await $db.hibrido.gravaLista("documentoItem",{atual:h.map(a=>({...a,id:$utils.uuid(),codigoDocumentoItem:void 0,idDocumento:w,codigoDocumento:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"}))}),$q.notifyPositive("Duplica\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabSelecionada.valor="Pedido de Compra",await this.$refs.comprasFicha.mostrar({id:w})},{mensagem:"Duplicando..."})},async trocarCfop_click(r){!await $q.dialogSimNao({title:"Confirma\xE7\xE3o",message:"Deseja trocar os CFOP iniciados em 5 e 6 para 1 e 2 correspondentes?"})||await $tryLoading(async()=>{var i;const s=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:r.id}}),h=$utils.clonarV2(s),w=await $db.hibrido.lista({table:"cfop",whereIn:{id:$utils.unicos(h,"idCfop")}});let a=0;for(const m of w){const t=String(m.cfop),c=t[0]==="5"?"1"+t.substr(1):t[0]==="6"?"2"+t.substr(1):t;if(c!==t){const v=(i=(await $db.hibrido.lista({table:"cfop",where:{cfop:c}}))[0])==null?void 0:i.id;$utils.verificarErro(!v,`CFOP ${c} n\xE3o encontrado`);for(const _ of h)_.idCfop===m.id&&(_.idCfop=v,a++)}}$utils.verificarErro(!a,"N\xE3o h\xE1 CFOPs com inicial 5 ou 6 para realizar trocas"),await $db.hibrido.gravaLista("documentoItem",{atual:h,original:s}),$q.notifyPositive(`Troca de CFOP realizada com sucesso em ${a} itens!`)},{mensagem:"Processando..."})},async alterarPrevisaoEntrega_click(r){var s,h;this.modalPrevisaoEntrega={visivel:!0,dataPrevistaEntrega:(s=r.dataHoraPrevisto)==null?void 0:s.slice(0,10),horaPrevistaEntrega:(h=r.dataHoraPrevisto)==null?void 0:h.slice(11,16),compra:r}},async alterarPrevisaoEntrega(){await $tryLoading(async()=>{const{compra:r,dataPrevistaEntrega:s,horaPrevistaEntrega:h}=this.modalPrevisaoEntrega;$utils.verificarErro(!s,"\xC9 necess\xE1rio preencher a data");const w=ze.formatDate(`${s} ${h||"00:00:00"}`);$utils.verificarErro(!w,"Data Inv\xE1lida"),w!==ze.formatDate(r.dataHoraPrevisto)?(await $db.hibrido.grava("documento",{atual:{id:r.id,dataHoraPrevisto:w}}),r.dataHoraPrevisto=w,$q.notifyPositive("A previs\xE3o foi salva com sucesso"),this.modalPrevisaoEntrega={}):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")})},async downloadXmlDFeFiltrados(){var r,s,h,w,a;if(!!await $q.dialogSimNao({title:"Download XML's filtrados",message:"Deseja prosseguir com a opera\xE7\xE3o?"}))try{$q.loading.show();let i=[];if($db.hibrido.isOnline())i=(a=(w=(h=await $utils.geeksApi({downloadDFe:{funcao:"2D9F9B43-47D3-491E-AD49-528EC9547BDC",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{},fornecedor:(r=this.filtros.fornecedor)==null?void 0:r.nome,numeroDocumentoNacionalDestinatario:(s=this.filtros.destinatario)==null?void 0:s.numeroDocumentoNacional,periodoRecbto:this.filtros.periodoEmissao}}))==null?void 0:h.data)==null?void 0:w.downloadDFe)!=null?a:[];else{let m=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","dhEmi","cpfCnpjEmitente","cpfCnpjDestinatario","xNomeEmitente","xNomeDestinatario"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});m=m.filter(c=>{var v,_,p;return!(((v=this.filtros.fornecedor)==null?void 0:v.nome)&&!c.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((_=this.filtros.destinatario)==null?void 0:_.numeroDocumentoNacional)&&((p=c.cpfCnpjDestinatario)==null?void 0:p.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))}),(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","chNFe","dhRecbto","xmlProt"],whereIn:{idDocumentoFiscalEletronico:m.map(c=>c.id)}})).forEach(c=>{var l,I;const v=m.find(n=>n.id===c.idDocumentoFiscalEletronico),_=new Date(c.dhRecbto).setHours(0,0,0,0),p=new Date((l=this.filtros.periodoEmissao)==null?void 0:l.ini).setHours(0,0,0,0),y=new Date((I=this.filtros.periodoEmissao)==null?void 0:I.fim).setHours(0,0,0,0);(p||y)&&_&&(p&&_<p||y&&_>y)||v&&i.push({chNFe:c.chNFe,xml:c.xmlProt,cnpj:v.cpfCnpjDestinatario})})}if((i==null?void 0:i.length)>0){const m=Array.from(new Set(i.filter(c=>c.cnpj).map(c=>c.cnpj))),t=new ya;for(const c of m)for(const v of i.filter(_=>_.cnpj===c))t.file(`${c}/${v.chNFe}.procNFe.xml`,v.xml);t.generateAsync({type:"blob"}).then(function(c){const v=new Date,_=document.createElement("a");_.href=window.URL.createObjectURL(c),_.download=`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}-${String(v.getDate()).padStart(2,"0")}_NotasEntradaSEFAZ.zip`,_.click()})}}catch{$q.notify({message:"N\xE3o foi poss\xEDvel realizar o download",type:"negative"})}finally{$q.loading.hide()}},async downloadXmlDFe(r,s){!await $q.dialogSimNao({title:"Download XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{var c;const w=(s==="Nota de Entrada"?await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:r}}):await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:r}}))[0],a=(w==null?void 0:w.xmlProt)||(w==null?void 0:w.xmlData),i=(w==null?void 0:w.chNFe)||((c=/<chNFe>(\d+)<\/chNFe>/i.exec(a))==null?void 0:c[1]);$utils.verificarErro(!a,"N\xE3o foi poss\xEDvel recuperar o XML");const m=document.createElement("a"),t=new Blob([a],{type:"text/plain"});m.setAttribute("href",window.URL.createObjectURL(t)),m.setAttribute("download",`${i||r}-procNFe.xml`),m.click()})},async importarXmlDFe(r){!await $q.dialogSimNao({title:"Importar XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const s=await $db.hibrido.le({table:"documentoFiscalEletronico",id:r}),h=(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:r}}))[0];if((s==null?void 0:s.id)&&(h==null?void 0:h.xmlProt)){const w=await $db.compra.importaXml({xmlString:h.xmlProt}),a={original:$utils.clonar(s),atual:$utils.clonar(s)};a.atual.situacao="Importada",await $db.documentoFiscalEletronico.grava(a),w.documentosItem.find(({vinculado:i})=>!i)?this.$refs.comprasImportacaoXML.mostrar(w):await this.concluirImportacao(w)}},{mensagem:"Importando..."})},async destinatarioOpcoesCarregar(){const r=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.destinatarioOpcoes=r.map(s=>({label:s.nome,value:s.id,numeroDocumentoNacional:s.numeroDocumentoNacional}))},async configuraImpressao(r){const s=await $db.configuracoes.porNome("impressao.compra",r);this.configImpressao=[...s.length?s.map(h=>({valor:h.valor,texto:h.texto,observacao:h.observacao})):[{valor:"invoice",texto:"Pedido de Compra",observacao:"Invoice"}]]},imprimirPedidoCompra(r,s){r==="pedidoCompra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/OptiSoul/pedidoCompra.html
            ?CodigoDocumento=${s}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `),r==="ped_compra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/distribuidor/email.html
            ?CodigoDocumento=${s}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &NomeReport=ped_compra
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,Versao:this.clienteSistema.versao,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Padrao:this.clienteSistema.padrao?this.clienteSistema.padrao:null,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)},async configuraEtiqueta(){const r=await $db.configuracoes.le({nome:"impressao.etiqueta"});this.opcoesModelo=[],r.some(s=>s.valor==="etiquetaFila")?this.opcoesModelo.push({rotulo:"Etiqueta Fila",valor:"etiquetaFila",modelo:"etiquetaFila"}):r.forEach(s=>{this.opcoesModelo.push({rotulo:s.texto,valor:s.observacao&&s.observacao.trim()!==""?s.observacao:s.valor,modelo:s.valor})}),this.opcoesModelo=[...this.opcoesModelo,{rotulo:"Modelos antigos:",value:"modelos-antigos",disable:!0},{rotulo:"Folha Argox",valor:"etiqueta-fila"},{rotulo:"Folha Carta",valor:"etiqueta-carta"},{rotulo:"Folha Pimaco",valor:"EtiquetaPimaco6Col"},{rotulo:"Personaliz\xE1vel",valor:"etiqueta_generica_ajustavel"}],this.modeloSelecionado=this.opcoesModelo[0].valor},async configuraEmpresas(){const r=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.opcoesEmpresas=r.map(s=>({rotulo:s.apelido||s.nome,valor:s.id,codigoEmpresa:s.codigoContato})),this.empresaSelecionada=""},async configuraTabelasPreco(){this.tabelasPreco=await $db.itemTabelaPreco.le({ativo:!0,tabelaMaster:!0})||[],this.opcoesTabelasPreco=this.tabelasPreco.map(r=>({rotulo:r.descricao,valor:r.id,codigoItemTabelaPreco:r.codigoItemTabelaPreco})),this.tabelaPrecoSelecionada=""},async dialogImprimirEtiquetas({acao:r,item:s}){try{await this.configuraEtiqueta(),await this.configuraEmpresas(),await this.configuraTabelasPreco(),this.dialogEtiquetas={[r]:!0,item:s||{},limpar:!1}}catch(h){console.error("Erro ao configurar impress\xE3o de etiquetas",h)}},imprimirEtiquetas(r){var s,h,w,a,i;if(r==="etiqueta_generica_ajustavel"||r==="etiqueta-fila"||r==="etiqueta-carta"||r==="EtiquetaPimaco6Col"){const m=r==="etiqueta_generica_ajustavel"?"":"OptiSoul/";this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/${m}${r}.html
            ?Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &EmBranco=${this.emBranco}
            &CodigoPedido=${(h=(s=this.dialogEtiquetas)==null?void 0:s.item)==null?void 0:h.codigoDocumento}
            &TabelaPreco=${this.tabelaPrecoSelecionada?encodeURIComponent(this.opcoesTabelasPreco.find(t=>t.valor===this.tabelaPrecoSelecionada).codigoItemTabelaPreco):""}
            &CodigoContatoEmpresa=${this.empresaSelecionada?encodeURIComponent(this.opcoesEmpresas.find(t=>t.valor===this.empresaSelecionada).codigoEmpresa):""}
            &cpfUsuarioLogado=${encodeURIComponent(this.usuario.cpf)}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)}else{const m=(w=this.opcoesModelo)==null?void 0:w.find(v=>v.valor===r),t=(m==null?void 0:m.modelo)||"",c=(m==null?void 0:m.valor)||"";$imprimir(t,{id:(i=(a=this.dialogEtiquetas)==null?void 0:a.item)==null?void 0:i.id,impressao:"etiquetas"},{modelo:c,idEmpresa:this.empresaSelecionada,idTabelaPreco:this.tabelaPrecoSelecionada,emBranco:this.emBranco})}},abrirImpressao(r){window.open(r.replace(/[\s\n]/g,""),"_blank").focus()},async adicionarEtiquetas(){var r;try{$q.loading.show();const s=this.dialogEtiquetas;let h=await $db.etiqueta.ler({cpfUsuarioLogado:this.usuario.numeroDocumentoNacional})||[];if(s!=null&&s.limpar){for(const m of h)await $db.etiqueta.remover(m.id);h=[]}const w=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:(r=s==null?void 0:s.item)==null?void 0:r.id}});if(!w.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}const a=w.map(m=>m.idItem),i=await $db.hibrido.lista({table:"item",columns:["id","codigoItem","descricaoConcatenada","valorVenda"],whereIn:{id:a}});if(!i.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}for(const m of i){if(h.length){const c=h.find(v=>v.idItem===m.id)||null;c&&await $db.etiqueta.remover(c==null?void 0:c.id)}const t={id:$utils.uuid(),idItem:m.id,nomeProduto:m.descricaoConcatenada,valor:m.valorVenda||0,quantidadeEtiquetas:w.find(c=>c.idItem===m.id).quantidade||0,cpfUsuarioLogado:this.usuario.numeroDocumentoNacional,dataHoraEmissao:$utils.dataAtual()};await $db.etiqueta.gravar({atual:t})}$q.loading.hide(),this.$q.dialog({title:"",message:"Ir para tela de impress\xE3o de etiquetas?",noRefocus:!0,preventClose:!0,ok:{label:"SIM",push:!0,class:"bg-primary",textColor:"white",flat:!0},cancel:{label:"N\xC3O",push:!0,color:"tertiary",flat:!0}}).onOk(()=>{this.$router.push({name:"EtiquetasLista"})}).onCancel(()=>{this.dialogEtiquetas.adicionar=!1})}catch(s){$q.loading.hide(),$q.notifyError("Erro ao adicionar etiquetas",s)}}},watch:{"tabSelecionada.valor"(){this.tabSelecionada.valor==="Nota na SEFAZ"?this.mostrar.btnMenuMais=!0:this.mostrar.btnMenuMais=!1}},async created(){await this.destinatarioOpcoesCarregar();const r=[{valor:"Pedido de Compra",rotulo:"Pedido de Compra"},{valor:"Nota de Entrada",rotulo:"Nota de Entrada"}];[52,53,62].includes(Number(this.clienteSistema.codigoSistema))&&r.push({valor:"Nota na SEFAZ",rotulo:"Nota na SEFAZ"}),this.tabSelecionada={valor:"Pedido de Compra"},this.tabs=r},async mounted(){this.usuario=JSON.parse(localStorage.getItem("usuario")),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema")),this.tabSelecionada.valor=this.$route.name,this.atualizar({buscarDadosRecentes:!0})}},Ia={id:"Compras"},Ca={class:"mw80 text-center"},ka={key:0,class:"text-weight-medium"},Sa={class:"row q-ma-md"},Ea={key:0,class:"row q-ma-md"},Da={class:"certificado-error-messages"},Va={class:"col-12"},Pa={class:"col-12"},xa={class:"q-mt-lg text-right"};function Fa(r,s,h,w,a,i){const m=ge("campo"),t=ge("BadgeCopiarUid"),c=ge("avatar"),v=ge("g-label"),_=ge("badge"),p=ge("g-col"),y=ge("g-row"),l=ge("Lista"),I=ge("ComprasFicha"),n=ge("ComprasImportacaoXML"),b=ge("row");return M(),_e("div",Ia,[e(l,{busca:a.busca,"onUpdate:busca":s[11]||(s[11]=d=>a.busca=d),onAtualizar:i.atualizar,onLimparFiltrosClick:i.limparFiltrosClick,onCriarClick:i.criarClick,lista:a.lista,tabSelecionada:a.tabSelecionada,tabs:a.tabs,tabSelecionada2:a.tabSelecionada2,tabs2:a.tabs2,paginacao:a.paginacao,mostrar:a.mostrar},{botaoNovo:o(()=>[e(de,{label:"Novo",icon:"add",unelevated:"",color:"primary","text-color":"white",class:"hideonmobile"},{default:o(()=>[e(Le,null,{default:o(()=>[e(Pe,{link:"","no-border":"",separator:""},{default:o(()=>[be((M(),Y(me,{onClick:i.criarClick,clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"add"})]),_:1}),e(Q,null,{default:o(()=>[N("Incluir Manual")]),_:1})]),_:1},8,["onClick"])),[[Ee]]),be((M(),Y(me,{onClick:i.importarXmlClick,clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"add"})]),_:1}),e(Q,null,{default:o(()=>[N("Importar XML")]),_:1})]),_:1},8,["onClick"])),[[Ee]])]),_:1})]),_:1})]),_:1}),e(de,{icon:"add",flat:"",round:"",color:"primary","text-color":"white",class:"hideondesktop"},{default:o(()=>[e(Le,null,{default:o(()=>[e(Pe,{link:"","no-border":"",separator:""},{default:o(()=>[be((M(),Y(me,{onClick:i.criarClick,clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"add"})]),_:1}),e(Q,null,{default:o(()=>[N("Incluir Manual")]),_:1})]),_:1},8,["onClick"])),[[Ee]]),be((M(),Y(me,{onClick:i.importarXmlClick,clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"add"})]),_:1}),e(Q,null,{default:o(()=>[N("Importar XML")]),_:1})]),_:1},8,["onClick"])),[[Ee]])]),_:1})]),_:1})]),_:1})]),filtroCampos:o(()=>[e(m,{modelValue:a.filtros.numero,"onUpdate:modelValue":s[0]||(s[0]=d=>a.filtros.numero=d),dense:"",rotulo:"N\xBA Nota",class:"q-mt-md"},null,8,["modelValue"]),e(m,{modelValue:a.filtros.numeroCompra,"onUpdate:modelValue":s[1]||(s[1]=d=>a.filtros.numeroCompra=d),dense:"",rotulo:"Ordem de compra",class:"q-mt-lg"},null,8,["modelValue"]),e(Pt,{modelValue:a.destinatarioSelecionado,"onUpdate:modelValue":[s[2]||(s[2]=d=>a.destinatarioSelecionado=d),i.aoSelecionarDestinatario],options:a.destinatarioOpcoes,clearable:"",dense:"",label:"Destinat\xE1rio",class:"q-mt-lg"},null,8,["modelValue","onUpdate:modelValue","options"]),e(m,{modelValue:a.filtros.fornecedor.nome,"onUpdate:modelValue":s[3]||(s[3]=d=>a.filtros.fornecedor.nome=d),dense:"",rotulo:"Fornecedor",class:"q-mt-lg"},null,8,["modelValue"]),this.tabSelecionada.valor==="Nota na SEFAZ"?(M(),_e(ke,{key:0},[e(m,{modelValue:a.filtros.periodoEmissao.ini,"onUpdate:modelValue":s[4]||(s[4]=d=>a.filtros.periodoEmissao.ini=d),dense:"",rotulo:"Data Emiss\xE3o",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),e(m,{modelValue:a.filtros.periodoEmissao.fim,"onUpdate:modelValue":s[5]||(s[5]=d=>a.filtros.periodoEmissao.fim=d),rotulo:"at\xE9",dense:"",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"])],64)):(M(),_e(ke,{key:1},[e(m,{modelValue:a.filtros.periodoEmissao.ini,"onUpdate:modelValue":s[6]||(s[6]=d=>a.filtros.periodoEmissao.ini=d),dense:"",rotulo:"Data Emiss\xE3o",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),e(m,{modelValue:a.filtros.periodoEmissao.fim,"onUpdate:modelValue":s[7]||(s[7]=d=>a.filtros.periodoEmissao.fim=d),dense:"",rotulo:"at\xE9",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"]),e(m,{modelValue:a.filtros.periodoFinalizado.ini,"onUpdate:modelValue":s[8]||(s[8]=d=>a.filtros.periodoFinalizado.ini=d),dense:"",rotulo:"Data Finalizado",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),e(m,{modelValue:a.filtros.periodoFinalizado.fim,"onUpdate:modelValue":s[9]||(s[9]=d=>a.filtros.periodoFinalizado.fim=d),dense:"",rotulo:"at\xE9",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"])],64)),e(m,{modelValue:a.paginacao.limite,"onUpdate:modelValue":s[10]||(s[10]=d=>a.paginacao.limite=d),dense:"",min:"1",tipo:"quantidade",rotulo:"Quantidade por p\xE1gina",class:"q-mt-xl q-mb-lg"},null,8,["modelValue"])]),menuExtras:o(()=>[be((M(),Y(me,{onClick:i.downloadXmlDFeFiltrados,clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"download"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N("Download")]),_:1})]),_:1}),e(Ve,null,{default:o(()=>[N("Download dos XML's filtrados")]),_:1})]),_:1},8,["onClick"])),[[Ee]])]),itemLista:o(()=>[e(Pe,{bordered:"",class:"bg-white q-mb-xs rounded-borders",style:{"min-height":"calc(100vh - 200px)"}},{default:o(()=>[(M(!0),_e(ke,null,Ne(a.lista,d=>(M(),_e("div",{key:d.id,class:"itemHover"},[e(me,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:o(()=>[e(Q,{class:"hideonmobile col-auto q-px-sm no-margin"},{default:o(()=>[fe("div",Ca,[e(t,{id:d.id,numero:d.numero,cor:"positive",escuro:""},null,8,["id","numero"])])]),_:2},1024),e(Q,{class:"col-md col-lg col-xl no-margin"},{default:o(()=>[e(me,{class:"q-pa-none"},{default:o(()=>[e(Q,{onClick:g=>i.abrir(d.id),class:"col-auto items-center"},{default:o(()=>[e(c,{imagem:(a.contatos[d.idContato]||{}).imagem,rotulo:d.descricaoContato,tamanho:"40"},null,8,["imagem","rotulo"])]),_:2},1032,["onClick"]),e(Q,{class:"col"},{default:o(()=>[e(se,{onClick:g=>i.abrir(d.id),lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:o(()=>[N(J(d.descricaoContato)+" ",1),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N("Fornecedor")]),_:1})]),_:2},1032,["onClick"]),d.descricaoEmpresa?(M(),Y(se,{key:0,onClick:g=>i.abrir(d.id),caption:""},{default:o(()=>[d.descricaoEmpresa?(M(),Y(v,{key:0,icon:"business 14px tertiary left"},{default:o(()=>[N(J(d.descricaoEmpresa)+" ",1),d.numeroDocumentoEmpresa?(M(),_e("span",ka,"("+J(d.numeroDocumentoEmpresa)+")",1)):oe("",!0)]),_:2},1024)):oe("",!0)]),_:2},1032,["onClick"])):oe("",!0),e(me,{class:"q-pa-none hideonmobile q-mt-xs",style:{"min-height":"unset"}},{default:o(()=>[d.notaNumero?(M(),Y(_,{key:0,cor:"tertiary",class:"mw50 text-center",escuro:""},{default:o(()=>[N(J(d.notaNumero)+" ",1),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N("N\xFAmero da Nota")]),_:1})]),_:2},1024)):(M(),Y(_,{key:1,cor:"warning",class:"mw50 text-center",escuro:""},{default:o(()=>[N(" S/N "),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N("N\xFAmero da Nota")]),_:1})]),_:1}))]),_:2},1024),e(Q,{class:"hideondesktop q-mt-sm"},{default:o(()=>[e(y,{mg:"xs-b"},{default:o(()=>[d.dataHoraEmissao?(M(),Y(p,{key:0,col:"shrink"},{default:o(()=>[e(v,{icon:"mdi-calendar-today xs tertiary left",tip:`Emitido \xE0s ${r.$filters.hora(d.dataHoraEmissao)}`},{default:o(()=>[N(J(r.$filters.data(d.dataHoraEmissao)),1)]),_:2},1032,["tip"])]),_:2},1024)):oe("",!0),d.dataHoraFinalizado?(M(),Y(p,{key:1,col:"shrink",class:"q-ml-sm"},{default:o(()=>[e(v,{icon:"mdi-calendar xs tertiary left",tip:`Finalizado \xE1s ${r.$filters.hora(d.dataHoraFinalizado)}`},{default:o(()=>[N(J(r.$filters.data(d.dataHoraFinalizado)),1)]),_:2},1032,["tip"])]),_:2},1024)):oe("",!0)]),_:2},1024),e(y,{mg:"xs-b"},{default:o(()=>[e(p,{col:"shrink"},{default:o(()=>[e(t,{id:d.id,numero:d.numero,cor:"positive",escuro:""},null,8,["id","numero"])]),_:2},1024),e(p,{col:"shrink",class:"q-ml-sm"},{default:o(()=>[d.notaNumero?(M(),Y(_,{key:0,cor:"tertiary",class:"mw50",escuro:""},{default:o(()=>[N(J(d.notaNumero)+" ",1),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N("N\xFAmero da Nota")]),_:1})]),_:2},1024)):(M(),Y(_,{key:1,cor:"warning",class:"mw50",escuro:""},{default:o(()=>[N(" S/N "),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N("N\xFAmero da Nota")]),_:1})]),_:1}))]),_:2},1024),e(p,{col:"shrink",class:"q-ml-sm"},{default:o(()=>[e(_,{rotulo:d.status,cor:d.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:d.status!=="Digita\xE7\xE3o"},null,8,["rotulo","cor","escuro"])]),_:2},1024)]),_:2},1024),e(y,null,{default:o(()=>[e(p,{col:"shrink",text:"bold"},{default:o(()=>[N(J(r.$filters.numero(d.totalDocumento,2)),1)]),_:2},1024),be(e(p,{col:"grow",text:"center",class:"q-ml-sm"},{default:o(()=>[N(J(d.qtdeContatos)+" Itens ",1)]),_:2},1536),[[xe,d.qtdeContatos>0]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(Q,{onClick:g=>i.abrir(d.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:o(()=>[this.tabSelecionada.valor==="Nota na SEFAZ"?(M(),_e(ke,{key:0},[d.dhRecbto?(M(),Y(se,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:o(()=>[e(ce,{name:"mdi-calendar-today"}),N(" "+J(r.$filters.data(d.dhRecbto))+" ",1),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N(" Autorizado \xE0s "+J(r.$filters.hora(d.dhRecbto)),1)]),_:2},1024)]),_:2},1024)):oe("",!0)],64)):(M(),_e(ke,{key:1},[d.dataHoraEmissao?(M(),Y(se,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:o(()=>[e(ce,{name:"mdi-calendar-today"}),N(" "+J(r.$filters.data(d.dataHoraEmissao))+" ",1),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N(" Emitido \xE0s "+J(r.$filters.hora(d.dataHoraEmissao)),1)]),_:2},1024)]),_:2},1024)):oe("",!0),d.dataHoraFinalizado?(M(),Y(se,{key:1,lines:"1",color:"tertiary",class:"ellipsis"},{default:o(()=>[e(ce,{name:"mdi-calendar"}),N(" "+J(r.$filters.data(d.dataHoraFinalizado))+" ",1),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N(" Finalizado \xE1s "+J(r.$filters.hora(d.dataHoraFinalizado)),1)]),_:2},1024)]),_:2},1024)):oe("",!0)],64))]),_:2},1032,["onClick"]),e(Q,{onClick:g=>i.abrir(d.id),class:"hideonmobile maxw100 q-pl-sm no-margin"},{default:o(()=>[e(_,{cor:d.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:d.status!=="Digita\xE7\xE3o",class:"col-auto q-mx-auto"},{default:o(()=>[N(J(d.status)+" ",1),e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N(" Status ")]),_:1})]),_:2},1032,["cor","escuro"])]),_:2},1032,["onClick"]),e(Q,{onClick:g=>i.abrir(d.id),class:"hideonmobile maxw120 q-pl-sm no-margin"},{default:o(()=>[e(se,{class:"text-tertiary text-weight-bold text-right"},{default:o(()=>[N(J(r.$filters.numero(d.totalDocumento,2)),1)]),_:2},1024),be(e(se,{class:"text-tertiary text-right"},{default:o(()=>[N(J(d.qtdeContatos)+" Itens ",1)]),_:2},1536),[[xe,d.qtdeContatos>0]])]),_:2},1032,["onClick"]),e(Q,{class:"hideonmobile col-auto q-pl-sm no-margin"},{default:o(()=>[e(me,{class:"q-pa-none"},{default:o(()=>[a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(Q,{key:0,class:"no-margin"},{default:o(()=>[e(de,{onClick:g=>i.abrir(d.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024)):oe("",!0),a.tabSelecionada.valor==="Nota na SEFAZ"?(M(),Y(Q,{key:1,class:"no-margin",style:{width:"33.6px"}},{default:o(()=>[d.status==="N\xE3o Importada"?(M(),Y(de,{key:0,onClick:g=>i.importarXmlDFe(d.id),flat:"",round:"",dense:"",icon:"mdi-upload",size:"md",color:"tertiary",class:"buttons"},{default:o(()=>[e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N("Importar XML")]),_:1})]),_:2},1032,["onClick"])):oe("",!0)]),_:2},1024)):oe("",!0),["Nota na SEFAZ","Nota de Entrada"].includes(a.tabSelecionada.valor)?(M(),Y(Q,{key:2,class:"no-margin",style:{width:"33.6px"}},{default:o(()=>[e(de,{onClick:g=>i.downloadXmlDFe(d.id,a.tabSelecionada.valor),flat:"",round:"",dense:"",icon:"mdi-download",color:"tertiary",size:"md",class:"buttons"},{default:o(()=>[e(Ve,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[N("Download XML")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(Q,{key:3,class:"no-margin"},{default:o(()=>[e(de,{icon:"print",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:o(()=>[e(Le,null,{default:o(()=>[be((M(),Y(Pe,{link:"","no-border":"",separator:""},{default:o(()=>[(M(!0),_e(ke,null,Ne(a.configImpressao,g=>(M(),Y(me,{key:g.valor,onClick:S=>r.$imprimir(g.valor,d.id),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(J(g.texto),1)]),_:2},1024),g.observacao?(M(),Y(se,{key:0,caption:""},{default:o(()=>[N(J(g.observacao),1)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(M(!0),_e(ke,null,Ne(a.configImpressaoPedidoCompra,g=>(M(),Y(me,{key:g.valor,onClick:S=>i.imprimirPedidoCompra(g.valor,d==null?void 0:d.codigoDocumento),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(J(g.texto),1)]),_:2},1024),g.observacao?(M(),Y(se,{key:0,caption:""},{default:o(()=>[N(J(g.observacao),1)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),e(me,{onClick:g=>i.dialogImprimirEtiquetas({acao:"adicionar",item:d}),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Etiquetas ")]),_:1}),e(se,{caption:""},{default:o(()=>[N(" Adicionar \xE1 Fila ")]),_:1})]),_:1})]),_:2},1032,["onClick"]),e(me,{onClick:g=>i.dialogImprimirEtiquetas({acao:"impressao",item:d}),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Etiquetas ")]),_:1}),e(se,{caption:""},{default:o(()=>[N(" Impress\xE3o Direta ")]),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(Q,{key:4,class:"no-margin"},{default:o(()=>[e(de,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:o(()=>[e(Le,null,{default:o(()=>[be((M(),Y(Pe,{link:"","no-border":"",separator:""},{default:o(()=>[a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(me,{key:0,onClick:g=>i.duplicarDocumento_click(d),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"content_copy"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Duplicar ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(me,{key:1,onClick:g=>i.alterarPrevisaoEntrega_click(d),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"local_shipping"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N("Alterar Previs\xE3o de Entrega")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(me,{key:2,onClick:g=>i.trocarCfop_click(d),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"sync_alt"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N("Trocar CFOP para consumo")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),oe("",!0)]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1024),e(Q,{class:"hideondesktop col-auto q-pl-sm no-margin"},{default:o(()=>[e(de,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:o(()=>[e(Le,null,{default:o(()=>[be((M(),Y(Pe,{link:"","no-border":"",separator:""},{default:o(()=>[oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(me,{key:1,onClick:g=>i.abrir(d.id),clickable:"",class:"itemHover"},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"edit"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Editar ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),a.tabSelecionada.valor==="Nota na SEFAZ"&&d.status==="N\xE3o Importada"?(M(),Y(me,{key:2,onClick:g=>i.importarXmlDFe(d.id),clickable:"",class:"itemHover"},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"mdi-upload"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Importar XML ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),["Nota na SEFAZ","Nota de Entrada"].includes(a.tabSelecionada.valor)?(M(),Y(me,{key:3,onClick:g=>i.downloadXmlDFe(d.id,a.tabSelecionada.valor),clickable:"",class:"itemHover"},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"mdi-download"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Download XML ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(!0),_e(ke,{key:4},Ne(a.configImpressao,g=>(M(),Y(me,{key:g.valor,onClick:S=>r.$imprimir(g.valor,d.id),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(J(g.texto),1)]),_:2},1024),g.observacao?(M(),Y(se,{key:0,caption:""},{default:o(()=>[N(J(g.observacao),1)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(!0),_e(ke,{key:5},Ne(a.configImpressaoPedidoCompra,g=>(M(),Y(me,{clickable:"",key:g.valor,onClick:S=>i.imprimirPedidoCompra(g.valor,d==null?void 0:d.codigoDocumento)},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(J(g.texto),1)]),_:2},1024),g.observacao?(M(),Y(se,{key:0,caption:""},{default:o(()=>[N(J(g.observacao),1)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(me,{key:6,clickable:"",onClick:g=>i.dialogImprimirEtiquetas({acao:"adicionar",item:d})},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Etiquetas ")]),_:1}),e(se,{caption:""},{default:o(()=>[N(" Adicionar \xE1 Fila ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(me,{key:7,clickable:"",onClick:g=>i.dialogImprimirEtiquetas({acao:"impressao",item:d})},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"print"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Etiquetas ")]),_:1}),e(se,{caption:""},{default:o(()=>[N(" Impress\xE3o Direta ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(me,{key:8,onClick:g=>i.duplicarDocumento_click(d),clickable:"",class:"itemHover"},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"content_copy"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N(" Duplicar ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(me,{key:9,onClick:g=>i.alterarPrevisaoEntrega_click(d),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"local_shipping"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N("Alterar Previs\xE3o de Entrega")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),a.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(me,{key:10,onClick:g=>i.trocarCfop_click(d),clickable:""},{default:o(()=>[e(Q,{avatar:""},{default:o(()=>[e(ce,{name:"sync_alt"})]),_:1}),e(Q,null,{default:o(()=>[e(se,null,{default:o(()=>[N("Trocar CFOP para consumo")]),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0)]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(ut)]))),128))]),_:1})]),_:1},8,["busca","onAtualizar","onLimparFiltrosClick","onCriarClick","lista","tabSelecionada","tabs","tabSelecionada2","tabs2","paginacao","mostrar"]),e(I,{ref:"comprasFicha",onAtualizar:i.atualizar,onDialogImprimirEtiquetas:i.dialogImprimirEtiquetas},null,8,["onAtualizar","onDialogImprimirEtiquetas"]),e(n,{ref:"comprasImportacaoXML",onAtualizar:i.atualizar,onConcluirImportacao:i.concluirImportacao},null,8,["onAtualizar","onConcluirImportacao"]),e($e,{modelValue:a.modalXMLNotaEntrada,"onUpdate:modelValue":s[15]||(s[15]=d=>a.modalXMLNotaEntrada=d),persistent:""},{default:o(()=>[e(je,{container:"",class:"bg-light",style:{height:"40vh",width:"50vw","max-width":"100vw"}},{default:o(()=>[fe("form",{onSubmit:s[14]||(s[14]=xt((...d)=>i.importarXmlNotaDeEntrada&&i.importarXmlNotaDeEntrada(...d),["prevent"]))},[e(He,null,{default:o(()=>[e(Te,null,{default:o(()=>[be(e(de,{onClick:i.fecharXmlNotaDeEntrada,flat:"",round:"",dense:"",icon:"close"},null,8,["onClick"]),[[Ee]]),e(Re,null,{default:o(()=>[N("Importar XML Nota de Entrada")]),_:1}),e(de,{color:"white","text-color":"primary",label:"Enviar",type:"submit",unelevated:""})]),_:1})]),_:1}),e(Ze,{class:"u-container"},{default:o(()=>[e(Xe,{style:{"min-height":"300px"}},{default:o(()=>{var d,g,S;return[fe("div",Sa,[e(Ft,{class:"col-12","hide-upload-btn":"","auto-upload":"",factory:i.adicionarXml,filter:D=>D.filter(P=>P.type==="text/xml")},null,8,["factory","filter"]),e(gt,{modelValue:a.xmlDevolucao,"onUpdate:modelValue":s[12]||(s[12]=D=>a.xmlDevolucao=D),label:"Devolu\xE7\xE3o"},null,8,["modelValue"]),e(gt,{modelValue:a.xmlEstrangeiro,"onUpdate:modelValue":s[13]||(s[13]=D=>a.xmlEstrangeiro=D),label:"Importa\xE7\xE3o do exterior"},null,8,["modelValue"])]),Object.keys((S=(g=(d=a.xmlNotaEntrada.error)==null?void 0:d.data)==null?void 0:g.fields)!=null?S:{}).length?(M(),_e("div",Ea,[fe("ul",Da,[(M(!0),_e(ke,null,Ne(Object.keys(a.xmlNotaEntrada.error.data.fields),D=>(M(),_e("li",{key:D},[fe("span",null,J(D),1),fe("span",null,J(a.xmlNotaEntrada.error.data.fields[D]),1)]))),128))])])):oe("",!0)]}),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),e($e,{modelValue:a.modalPrevisaoEntrega.visivel,"onUpdate:modelValue":s[18]||(s[18]=d=>a.modalPrevisaoEntrega.visivel=d),"content-css":{minWidth:"50vw"}},{default:o(()=>[e(zt,null,{default:o(()=>[e(Te,{class:"bg-primary text-white"},{default:o(()=>[e(Re,null,{default:o(()=>[N("Alterar Previs\xE3o de Entrega")]),_:1}),be(e(de,{dense:"",flat:"",icon:"close",round:""},null,512),[[Ee]])]),_:1}),e(Tt,null,{default:o(()=>[e(ot,{onSubmit:i.alterarPrevisaoEntrega},{default:o(()=>[e(b,{class:"q-col-gutter-md"},{default:o(()=>[fe("div",Va,[e(it,{modelValue:a.modalPrevisaoEntrega.dataPrevistaEntrega,"onUpdate:modelValue":s[16]||(s[16]=d=>a.modalPrevisaoEntrega.dataPrevistaEntrega=d),type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:""},null,8,["modelValue"])]),fe("div",Pa,[e(it,{modelValue:a.modalPrevisaoEntrega.horaPrevistaEntrega,"onUpdate:modelValue":s[17]||(s[17]=d=>a.modalPrevisaoEntrega.horaPrevistaEntrega=d),type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:""},null,8,["modelValue"])])]),_:1}),fe("div",xa,[be(e(de,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[Ee]]),e(de,{color:"primary",class:"q-ml-sm no-shadow",unelevated:"",label:"Alterar",type:"submit"})])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e($e,{modelValue:a.dialogEtiquetas.impressao,"onUpdate:modelValue":s[24]||(s[24]=d=>a.dialogEtiquetas.impressao=d)},{default:o(()=>[e(je,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"425px"}},{default:o(()=>[e(ot,{onSubmit:s[23]||(s[23]=d=>i.imprimirEtiquetas(a.modeloSelecionado)),autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:o(()=>[e(He,null,{default:o(()=>[e(Te,{class:"bg-primary text-white"},{default:o(()=>[e(Re,null,{default:o(()=>[e(ce,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),N(" Imprimir Etiquetas ")]),_:1})]),_:1})]),_:1}),e(Ze,null,{default:o(()=>[e(Xe,{class:"q-pa-md"},{default:o(()=>[e(v,{class:"q-pb-lg"},{default:o(()=>{var d,g,S,D,P,O,q,j,A,Z,ae,E,B;return[N(" Imprimir os itens: "),fe("strong",null,J((d=a.tabSelecionada)==null?void 0:d.valor)+" "+J((S=(g=a.dialogEtiquetas)==null?void 0:g.item)!=null&&S.numero?", #"+((P=(D=a.dialogEtiquetas)==null?void 0:D.item)==null?void 0:P.numero):"")+" "+J((q=(O=a.dialogEtiquetas)==null?void 0:O.item)!=null&&q.descricaoContato?" - "+((A=(j=a.dialogEtiquetas)==null?void 0:j.item)==null?void 0:A.descricaoContato):"")+" "+J((ae=(Z=a.dialogEtiquetas)==null?void 0:Z.item)!=null&&ae.notaNumero?", Nota #"+((B=(E=a.dialogEtiquetas)==null?void 0:E.item)==null?void 0:B.notaNumero):""),1),N(". ")]}),_:1}),e(m,{modelValue:a.modeloSelecionado,"onUpdate:modelValue":s[19]||(s[19]=d=>a.modeloSelecionado=d),opcoes:a.opcoesModelo,dense:"",filled:"",tipo:"seletor",rotulo:"Modelo",cor:"white","popup-content-class":"etiquetas-modelo-selecionado",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),e(m,{modelValue:a.empresaSelecionada,"onUpdate:modelValue":s[20]||(s[20]=d=>a.empresaSelecionada=d),opcoes:a.opcoesEmpresas,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Empresa",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),e(m,{modelValue:a.tabelaPrecoSelecionada,"onUpdate:modelValue":s[21]||(s[21]=d=>a.tabelaPrecoSelecionada=d),opcoes:a.opcoesTabelasPreco,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Tabela de Pre\xE7o",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),e(m,{modelValue:a.emBranco,"onUpdate:modelValue":s[22]||(s[22]=d=>a.emBranco=d),min:0,tipo:"quantidade",dense:"",filled:"",rotulo:"Etiquetas em branco",color:"tertiary","text-color":"red"},null,8,["modelValue"])]),_:1})]),_:1}),e(Ye,{class:"bg-light"},{default:o(()=>[e(Te,null,{default:o(()=>[e(rt),be(e(de,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Ee]]),e(de,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e($e,{modelValue:a.dialogEtiquetas.adicionar,"onUpdate:modelValue":s[26]||(s[26]=d=>a.dialogEtiquetas.adicionar=d)},{default:o(()=>[e(je,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"250px"}},{default:o(()=>[e(ot,{onSubmit:i.adicionarEtiquetas,autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:o(()=>[e(He,null,{default:o(()=>[e(Te,{class:"bg-primary text-white"},{default:o(()=>[e(Re,null,{default:o(()=>[e(ce,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),N(" Adicionar os itens a lista de etiquetas ")]),_:1})]),_:1})]),_:1}),e(Ze,null,{default:o(()=>[e(Xe,{class:"q-pa-md"},{default:o(()=>[e(v,{class:"q-pb-lg"},{default:o(()=>{var d,g,S,D,P,O,q,j,A,Z,ae,E,B;return[N(" Adicionar os itens: "),fe("strong",null,J((d=a.tabSelecionada)==null?void 0:d.valor)+" "+J((S=(g=a.dialogEtiquetas)==null?void 0:g.item)!=null&&S.numero?", #"+((P=(D=a.dialogEtiquetas)==null?void 0:D.item)==null?void 0:P.numero):"")+" "+J((q=(O=a.dialogEtiquetas)==null?void 0:O.item)!=null&&q.descricaoContato?" - "+((A=(j=a.dialogEtiquetas)==null?void 0:j.item)==null?void 0:A.descricaoContato):"")+" "+J((ae=(Z=a.dialogEtiquetas)==null?void 0:Z.item)!=null&&ae.notaNumero?", Nota #"+((B=(E=a.dialogEtiquetas)==null?void 0:E.item)==null?void 0:B.notaNumero):""),1),N(" \xE0 lista de etiquetas para impress\xE3o. ")]}),_:1}),e(m,{modelValue:a.dialogEtiquetas.limpar,"onUpdate:modelValue":s[25]||(s[25]=d=>a.dialogEtiquetas.limpar=d),tipo:"logico",rotulo:"Limpar lista de etiquetas anterior."},null,8,["modelValue"])]),_:1})]),_:1}),e(Ye,{class:"bg-light"},{default:o(()=>[e(Te,null,{default:o(()=>[e(rt),be(e(de,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Ee]]),e(de,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])}var Ra=nt(wa,[["render",Fa]]);export{Ra as default};
