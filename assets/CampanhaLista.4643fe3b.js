import{_ as N,o as m,d as v,w as e,f as a,y as K,h as L,i as O,k as c,G as D,Q as k,M as U,dn as aa,C as j,r as f,N as X,P as ua,L as oa,E as ea,t as y,H as ta,I as ma,D as la,n as P,F as W,s as Z,B as w,e as A,q as G,J as ia,a0 as pa,dE as ha,dG as fa,ek as va,el as ga,e0 as Ca,bd as H,az as Y,R as E,S as p,j as $,O as J,T as q,z as _a,as as ba,m as F,ei as ya,bF as wa,l as ka}from"./index.353e304f.js";import{L as Aa}from"./Lista.5f3eb6f2.js";import{Q as Da}from"./QDate.f39b958b.js";import{G as qa}from"./GenericModal.5fe00325.js";import{G as Va}from"./GChipsV2.c768a34b.js";import{J as ra}from"./JsonViewer.4ab025d3.js";import{s as xa}from"./selecaoContaWhatsapp.a7b308b7.js";import"./xlsx.5197d0f9.js";import"./QBtnDropdown.27ebcdfe.js";import"./QBtnGroup.9119c6e2.js";import"./QScrollArea.4eca576e.js";const Ea={data(){return{visivel:!1}},methods:{async anexar(t){const o=await this.toBase64(t[0]);await $utils.geeksApi({ret:{funcao:"D280149A-F8EA-4103-B4AA-656707767F19",idCampanha:this.idCampanha,anexo:o,nomeArquivo:t[0].name}}),this.resolve(!0),this.visivel=!1},onHide(){this.resolve()},async mostrar({idCampanha:t}){return this.idCampanha=t,this.visivel=!0,new Promise((o,i)=>{this.resolve=o})},toBase64(t){return new Promise((o,i)=>{const d=new FileReader;d.readAsDataURL(t),d.onload=()=>o(d.result),d.onerror=l=>i(l)})}}};function $a(t,o,i,d,l,s){return m(),v(j,{modelValue:l.visivel,"onUpdate:modelValue":o[0]||(o[0]=u=>l.visivel=u),onHide:o[1]||(o[1]=u=>s.onHide())},{default:e(()=>[a(K,null,{default:e(()=>[a(L,null,{default:e(()=>[a(O,null,{default:e(()=>[c("Anexar")]),_:1}),D(a(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1}),a(aa,{"auto-expand":"",color:"none",class:"mobile-only",label:"Foto","hide-upload-btn":"","hide-upload-progress":"","dark-light":"",url:"",ref:"fotoCampo",factory:s.anexar},null,8,["factory"]),a(aa,{"auto-expand":"",color:"none",class:"mobile-hide",extensions:".jpg,.mp3,.mp4",label:"Anexo","hide-upload-btn":"","auto-upload":"","dark-light":"",url:"",ref:"fotoCampo",factory:s.anexar},null,8,["factory"])]),_:1})]),_:1},8,["modelValue"])}var Fa=N(Ea,[["render",$a]]);const Ua={data(){return{visivel:!1,idContato:"",nome:"",apelido:"",email:"",telefone:""}},methods:{onHide(){this.resolve()},async mostrar({idCampanha:t}){return this.idCampanha=t,this.visivel=!0,new Promise((o,i)=>{this.resolve=o})},async salvarContato(){try{this.$q.loading.show(),(await $utils.geeksApi({ret:{funcao:"B18C0CB3-5EA1-4E1C-8C31-EB354E5E3DB1",idCampanha:this.idCampanha,idContato:this.idContato,nome:this.nome,apelido:this.apelido,telefone:this.telefone,email:this.email}})).data.ret.erro?$q.notifyError("ret.data.ret.erro"):(this.resolve(!0),this.cancelarContato())}finally{this.$q.loading.hide()}},cancelarContato(){this.idContato="",this.nome="",this.apelido="",this.email="",this.telefone="",this.visivel=!1},async abrirModalContato(){const t={ativo:!0},o=await $g.promptContato.show({filtro:t,placeholder:"Selecione"});if(!o)return;let d=(await $db.contato.leCompletoV3(o.id)).telefone.filter(function(l){return l.tipoTelefone.indexOf("WhatsApp")!==-1});this.idContato=o.id,this.nome=o.nome,this.apelido=o.apelido,this.telefone="",d.length!==0&&d[0].telefone&&(this.telefone=d[0].telefone),this.email=""}}};function Ba(t,o,i,d,l,s){const u=f("campo");return m(),v(j,{modelValue:l.visivel,"onUpdate:modelValue":o[3]||(o[3]=g=>l.visivel=g),onHide:o[4]||(o[4]=g=>s.onHide())},{default:e(()=>[a(K,{class:"row"},{default:e(()=>[a(L,{class:"bg-primary text-white row"},{default:e(()=>[a(O,null,{default:e(()=>[c("Contato")]),_:1}),D(a(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1}),a(X,{class:"col-12"},{default:e(()=>[a(u,{modelValue:l.nome,"onUpdate:modelValue":o[0]||(o[0]=g=>l.nome=g),rotulo:"Nome",after:[{icon:"search",handler:s.abrirModalContato}],rules:[g=>!!g||"Campo Obrigat\xF3rio"]},null,8,["modelValue","after","rules"]),a(u,{modelValue:l.apelido,"onUpdate:modelValue":o[1]||(o[1]=g=>l.apelido=g),class:"col-12",tipo:"texto",rotulo:"Apelido",rules:[g=>!!g||""]},null,8,["modelValue","rules"]),a(u,{modelValue:l.telefone,"onUpdate:modelValue":o[2]||(o[2]=g=>l.telefone=g),class:"col-12",tipo:"Telefone",rotulo:"Telefone",mask:"(##) #####-####",rules:[g=>!!g||"Campo Obrigat\xF3rio"]},null,8,["modelValue","rules"])]),_:1}),a(X,{class:"col-12"},{default:e(()=>[a(ua,{align:"right",class:"row"},{default:e(()=>[a(k,{flat:"",class:"bg-primary text-white row",onClick:s.salvarContato},{default:e(()=>[c("Salvar")]),_:1},8,["onClick"]),a(k,{flat:"",onClick:s.cancelarContato},{default:e(()=>[c("Cancelar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Ha=N(Ua,[["render",Ba]]);const Sa={components:{GChipsV2:Va},data(){return{show:!1,filtro:[]}},emits:["hide","aplicar"],methods:{async handlerSeletor(t){var d,l;const o=(l=(d=this.props)==null?void 0:d.filtro[t])==null?void 0:l.handler;let i;!o||(i=await o(),i&&this.filtro[t].valor.push(i))},async aplicar(){let t=!1;this.$refs.form.getValidationComponents().forEach(o=>{!o.validate()&&!t&&(t=!0)}),!t&&this.$emit("aplicar",$utils.clonarV2(this.filtro))}},props:{props:Object},watch:{props(){var o,i,d,l;const t=[];for(const s of(i=(o=this.props)==null?void 0:o.filtro)!=null?i:[]){const u={};"campo"in s&&(u.campo=s.campo),"operador"in s&&(u.operador=s.operador),"valor"in s&&(u.valor=s.valor),t.push(u)}this.filtro=t,this.show=(l=(d=this.props)==null?void 0:d.show)!=null?l:!1}}},za={class:"col-12"},Pa={key:0,class:"col-4"},Ra={class:"col-8"},Ma=["onClick"],Ta={class:"col-12"},La={class:"col-12"},Oa={class:"q-mb-sm"},Na={class:"col-md-6"},Qa={class:"row"},ja={class:"col-6 col-md-6"},Ia={class:"col-6 col-md-6"},Ga={class:"col-md-6"},Ja={class:"row"},Wa={class:"col-6 col-md-6"},Ya={class:"col-6 col-md-6"},Ka={class:"col-12"},Xa={class:"q-mb-sm"},Za={class:"col-6 col-sm"},ao={class:"col-6 col-sm"};function oo(t,o,i,d,l,s){const u=f("row"),g=f("campo"),C=f("GChipsV2");return m(),v(j,{modelValue:l.show,"onUpdate:modelValue":o[0]||(o[0]=h=>l.show=h),onHide:o[1]||(o[1]=h=>t.$emit("hide"))},{default:e(()=>[a(oa,{container:"",view:"hHh lpR fFf",class:"q-layout-modal bg-white"},{default:e(()=>[a(ea,null,{default:e(()=>[a(L,null,{default:e(()=>[a(O,null,{default:e(()=>[c(y(i.props.titulo),1)]),_:1}),D(a(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1})]),_:1}),a(ta,null,{default:e(()=>[a(ma,null,{default:e(()=>[a(la,{ref:"form",class:"col q-pa-md"},{default:e(()=>[(m(!0),P(W,null,Z(l.filtro,(h,_)=>(m(),P("div",{key:_},[i.props.filtro[_].tipo==="botao"&&i.props.filtro[_].handler?(m(),v(u,{key:0,class:"q-mb-xl"},{default:e(()=>[w("div",za,[a(k,{color:"primary",icon:i.props.filtro[_].icone,label:i.props.filtro[_].titulo,onClick:b=>s.handlerSeletor(_),style:{width:"100%"}},null,8,["icon","label","onClick"])])]),_:2},1024)):A("",!0),i.props.filtro[_].tipo==="seletor"&&i.props.filtro[_].handler?(m(),v(u,{key:1,class:"q-mb-xl"},{default:e(()=>[h.operador?(m(),P("div",Pa,[a(g,{tipo:"seletor","rotulo-fixo":i.props.filtro[_].titulo,options:i.props.filtro[_].operadores,modelValue:h.operador,"onUpdate:modelValue":b=>h.operador=b},null,8,["rotulo-fixo","options","modelValue","onUpdate:modelValue"])])):A("",!0),w("div",Ra,[w("div",{onClick:b=>s.handlerSeletor(_)},[a(C,{modelValue:h.valor,"onUpdate:modelValue":b=>h.valor=b,class:"q-px-none",useInput:!1,placeholder:"Filtre por C\xF3digo, N\xFAmero..."},null,8,["modelValue","onUpdate:modelValue"])],8,Ma)])]),_:2},1024)):A("",!0),i.props.filtro[_].tipo==="seletor"&&i.props.filtro[_].opcoes?(m(),v(u,{key:2,class:"q-mb-xl"},{default:e(()=>[w("div",Ta,[a(g,{tipo:"seletor","rotulo-fixo":i.props.filtro[_].titulo,options:i.props.filtro[_].opcoes,modelValue:h.valor,"onUpdate:modelValue":b=>h.valor=b,clearable:""},null,8,["rotulo-fixo","options","modelValue","onUpdate:modelValue"])])]),_:2},1024)):A("",!0),i.props.filtro[_].tipo==="periodoDiaMes"?(m(),v(u,{key:3,class:"q-mb-xl"},{default:e(()=>[w("div",La,[w("strong",Oa,y(i.props.filtro[_].titulo),1),a(u,null,{default:e(()=>{var b,B,R,M,T,n,V,I;return[w("div",Na,[c(" Data Inicial "),w("div",Qa,[w("div",ja,[a(G,{label:"Dia",modelValue:h.valor.diaInicio,"onUpdate:modelValue":S=>h.valor.diaInicio=S,rules:(B=(b=i.props.filtro[_].rules)==null?void 0:b.diaInicio)!=null?B:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])]),w("div",Ia,[a(G,{label:"M\xEAs",modelValue:h.valor.mesInicio,"onUpdate:modelValue":S=>h.valor.mesInicio=S,rules:(M=(R=i.props.filtro[_].rules)==null?void 0:R.mesInicio)!=null?M:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])])])]),w("div",Ga,[c(" Data Final "),w("div",Ja,[w("div",Wa,[a(G,{label:"Dia",modelValue:h.valor.diaFim,"onUpdate:modelValue":S=>h.valor.diaFim=S,rules:(n=(T=i.props.filtro[_].rules)==null?void 0:T.diaFim)!=null?n:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])]),w("div",Ya,[a(G,{label:"M\xEAs",modelValue:h.valor.mesFim,"onUpdate:modelValue":S=>h.valor.mesFim=S,rules:(I=(V=i.props.filtro[_].rules)==null?void 0:V.mesFim)!=null?I:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])])])])]}),_:2},1024)])]),_:2},1024)):A("",!0),i.props.filtro[_].tipo==="periodoData"?(m(),v(u,{key:4,class:"q-mb-xl"},{default:e(()=>[w("div",Ka,[w("strong",Xa,y(i.props.filtro[_].titulo),1),a(u,null,{default:e(()=>[w("div",Za,[a(g,{modelValue:h.valor.inicio,"onUpdate:modelValue":b=>h.valor.inicio=b,rotulo:"In\xEDcio",clearable:"",tipo:"data"},null,8,["modelValue","onUpdate:modelValue"])]),w("div",ao,[a(g,{modelValue:h.valor.fim,"onUpdate:modelValue":b=>h.valor.fim=b,rotulo:"Fim",clearable:"",tipo:"data"},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024)])]),_:2},1024)):A("",!0)]))),128))]),_:1},512)]),_:1})]),_:1}),a(ia,null,{default:e(()=>[a(L,{class:"bg-light"},{default:e(()=>[a(O,{class:"text-right"},{default:e(()=>[D(a(k,{flat:"",size:"md","no-ripple":"",color:"tertiary",label:"Cancelar",class:"q-mr-sm"},null,512),[[U]]),a(k,{"no-ripple":"",label:"Aplicar",color:"primary",unelevated:"",class:"no-shadow",onClick:s.aplicar},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var eo=N(Sa,[["render",oo]]);const to={data(){return{visivel:!1,telefone:"",anexo:[],campanha:{},socket:{conectado:!1,socket:{}}}},emits:["atualizar"],methods:{onHide(){this.resolve({})},testarEnvio(){try{console.log("Envio de teste");const t=this.telefone,o=this.campanha.mensagem,i=localStorage.getItem("bancoDeDados"),d=this.anexo;this.whatsEnvia({funcao:"enviar mensagem",telDestino:t,mensa:o,anexo:d,banco:i}),console.log("Teste de campanha enviado"),this.visivel=!1}catch(t){console.log(t.message)}},whatsEnvia(t){if(this.socket=$g.conexaoWpp,this.socket.conectado)try{this.socket.socket.send(JSON.stringify(t))}catch(o){console.log(o.message)}},show(t,o){return this.visivel=!0,this.telefone="",this.campanha=t,this.anexo=o,new Promise((i,d)=>{this.resolve=i})}}},lo={class:"layout-padding"},io={class:"col-12"},ro={class:"q-mt-lg text-right"};function so(t,o,i,d,l,s){const u=f("campo"),g=f("row");return m(),v(j,{modelValue:l.visivel,"onUpdate:modelValue":o[1]||(o[1]=C=>l.visivel=C),onHide:o[2]||(o[2]=C=>s.onHide())},{default:e(()=>[a(K,{class:"q-dialog-plugin"},{default:e(()=>[a(L,{class:"bg-primary text-white"},{default:e(()=>[a(O,null,{default:e(()=>[c("Testar Envio da Campanha")]),_:1}),D(a(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1}),w("div",lo,[a(la,{class:"q-pa-md",onSubmit:s.testarEnvio},{default:e(()=>[a(g,{class:"items-center q-col-gutter-md"},{default:e(()=>[w("div",io,[a(u,{modelValue:l.telefone,"onUpdate:modelValue":o[0]||(o[0]=C=>l.telefone=C),tipo:"texto",rotulo:"Telefone"},null,8,["modelValue"])])]),_:1}),w("div",ro,[D(a(k,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[U]]),a(k,{color:"primary",class:"text-white",unelevated:"",label:"Enviar Teste",type:"submit"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1},8,["modelValue"])}var no=N(to,[["render",so]]);const co={components:{modalAnexo:Fa,modalContato:Ha,BadgeCopiarUid:pa,SeletorCampoTabela:ha,GenericModal:qa,PromptGrupoUnico:fa,PromptSegmentoUnico:va,PromptOrigemMarketingUnico:ga,FiltroDinamico:eo,JsonViewer:ra,CampanhaTesteEnvio:no,selecaoContaWhatsapp:xa},data(){const t=new Date(new Date($utils.dataAtual()).toDateString()),i=new Date(t).setDate(1);return{campanha:{id:"",descricao:"Descri\xE7\xE3o",dataHoraCriacao:$utils.dataAtual(),status:"Rascunho",tipo:"",idContato:"",mensagem:"Mensagem",responsavel:"",idEmpresa:""},campanhaOriginal:{},campanhaContato:[],campanhaAnexo:[],contatoGrupo:[],vendedores:[],filtro:{periodo:{aniversario:{from:`${t.getFullYear()}-${t.getMonth()}-${t.getDate()}`,to:`${t.getFullYear()}-${t.getMonth()}-${t.getDate()+1}`},receitaVencida:{from:i,to:""}}},lastFimReceita:null,opcaoAdicionar:"",grupo:"",segmento:"",vendedor:"",visivel:!1,somenteLeitura:!1,modalTitle:"Filtre contatos",filtroDinamico:null,empresa:{},sistemaPai:"",objetoConexoes:{},opcoesTipo:[],contatoCampo:"",opcoesContatos:[]}},emits:["atualizar"],methods:{async atualizar({id:t}){try{this.$q.loading.show();const o=await $utils.geeksApi({ret:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",id:t}});this.campanha=o.data.ret.campanha,this.campanha.conexao||(this.campanha.conexao=this.clienteSistema.bancoDeDados),this.somenteLeitura=o.data.ret.campanha.status!=="Rascunho",this.campanhaOriginal=$utils.clonarV2(this.campanha),await this.$nextTick(),this.atualizarAnexo(o.data.ret.campanhaAnexo),this.atualizarContato(o.data.ret.campanhaContato)}catch(o){$q.notifyError("Ocorreu um erro ao atualizar",o)}finally{this.$q.loading.hide()}},async atualizarAnexo(t){try{await this.$nextTick(),this.campanhaAnexo=t}catch(o){$q.notifyError("Ocorreu um erro ao atualizar anexo",o)}},async atualizarContato(t){try{await this.$nextTick(),this.campanhaContato=t.map(o=>(o.ordenar=this.$utils.removerCaracteresEspeciais(o.nome),o)).sort((o,i)=>o.ordenar>i.ordenar?1:i.ordenar>o.ordenar?-1:0)}catch(o){$q.notifyError("Ocorreu um erro ao atualizar contato",o)}try{await this.$nextTick();const o={};for(const{conexaoEnvio:i}of this.campanhaContato)if(!o[i])if(!i)o[i]="Sem envio";else if(i.startsWith("cpf")){const d=i.substring(3),l=(await $db.contato.le({numeroDocumentoNacional:d}))[0];o[i]=(l==null?void 0:l.nome)+" - CPF"}else if(i.startsWith("cnpj")){const d=i.replace("_","/").substring(4),l=(await $db.hibrido.lista({table:"empresa",whereFilter:{numeroDocumentoNacional:d}}))[0];o[i]=((l==null?void 0:l.sigla)||(l==null?void 0:l.apelido))+" - CNPJ"}else o[i]=i;this.objetoConexoes=o}catch(o){$q.notifyError("Ocorreu um erro ao atualizar conexao de envio",o)}},verificarSeAlterouCampos(){return $utils.diferencaObjetos(this.campanhaOriginal,this.campanha)},async salvar(){let t=this.verificarSeAlterouCampos();Object.keys(t).length!==0&&(t.funcao="65A200F2-9B9F-40E6-BD3A-282B77FC6BFB",t.id=this.campanha.id,await $utils.geeksApi({ret:t}))},async salvar_click(t){try{$q.loading.show(),this.campanha.idContato||(this.campanha.idContato=$db.usuario.logado.id),await this.salvar(),t||(this.$router.replace({params:{id:""}}),this.$emit("atualizar"),this.visivel=!1)}catch(o){$q.notifyError("Ocorreu um erro ao salvar",o)}finally{$q.loading.hide()}},async enviar_click(){if(this.campanhaContato.length===0){this.$q.notifyError("N\xE3o \xE9 permitido enviar campanha sem lista de contatos!");return}try{$q.loading.show(),this.campanha.status="Enviando",this.campanha.dataHoraDisparo=$utils.dataAtual(),this.campanha.log=`${await this.formatDate(new Date($utils.dataAtual()))} - Campanha disparada por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional}) 
${this.campanha.log||""}`,await this.salvar(),this.fechar()}catch(t){$q.notifyError("Ocorreu um erro!",t)}finally{$q.loading.hide()}},async rascunho_click(){try{$q.loading.show(),this.campanha.status="Rascunho",this.campanha.log=`${await this.formatDate(new Date($utils.dataAtual()))} - Campanha retornada para Rascunho por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional}) 
${this.campanha.log||""}`,await this.salvar(),this.fechar()}catch(t){$q.notifyError("Ocorreu um erro!",t)}finally{$q.loading.hide()}},async mostrar(t){await this.atualizar(t),this.visivel=!0},fechar(){this.$router.replace({params:{id:""}}),this.$emit("atualizar"),this.visivel=!1},async anexar_click(){const t=this.campanha.id;await this.$refs.modalAnexo.mostrar({idCampanha:t})&&(await this.salvar(),await this.atualizar({id:t}))},showFiltersModal(t){t==="carteira-aniversariantes"?this.modalTitle="Aniversariantes":t==="carteira-receitas-vencidas"&&(this.modalTitle="Receitas vencidas"),this.opcaoAdicionar=t,this.$refs.filtersModal.show()},async anexoDownload(t){const o=await $utils.geeksApi({item:{funcao:"B546B803-45E8-40B5-9F28-CFCC323AD5FD",id:t.id}});let i=document.createElement("a");i.href=o.data.item.anexo,i.download=o.data.item.nomeArquivo,i.click()},async anexoRemove(t){this.$q.dialog({cancel:{label:"Manter",push:!0,color:"tertiary",flat:!0},title:"Tem certeza?",message:"Ao continuar voc\xEA ir\xE1 perder esse anexo.",ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{if(this.campanhaContato.find(l=>l.status==="Enviado")){this.$q.notifyError("N\xE3o \xE9 permitido remover o anexo de uma campanha que j\xE1 foi enviada!");return}this.$q.loading.show();const o=this.campanha,i=o.id,d=await $utils.geeksApi({ret:{funcao:"BE8B810E-A49A-4B38-84B8-B758AD5064EF",id:t.id}});await this.atualizar({id:i}),this.campanha=o}finally{this.$q.loading.hide()}})},async adicionarContato(){const t=this.campanha.id;await this.$refs.modalContato.mostrar({idCampanha:t})&&(await this.salvar(),await this.atualizar({id:t}))},async adicionarPorGrupo(){let t=this.grupo;try{this.$q.loading.show(),await this.salvar();const o=this.campanha,i=o.id,d=await $utils.geeksApi({ret:{funcao:"ACC16F3A-88EC-43C6-A9B1-82828ED6E593",idCampanha:i,grupo:t,idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:i}),this.campanha=o}finally{this.$q.loading.hide()}},async adicionarPorSegmento(){let t=this.segmento;try{this.$q.loading.show(),await this.salvar();const o=this.campanha,i=o.id,d=await $utils.geeksApi({ret:{funcao:"3127C40C-0DD3-42A3-A37E-8ACACB52B88D",idCampanha:i,segmento:t,idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:i}),this.campanha=o}finally{this.$q.loading.hide()}},async adicionarPorVendedor(t){this.grupo="",this.$forceUpdate();try{this.$q.loading.show(),await this.salvar();const o=this.campanha,i=o.id,d=await $utils.geeksApi({ret:{funcao:"7B03B118-39D4-4BFB-9F64-12A7020F441F",idCampanha:i,idVendedor:t.id,idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:i}),this.campanha=o}finally{this.$q.loading.hide()}},async adicionarPorContato(t){this.grupo="",this.$forceUpdate();try{this.$q.loading.show(),await this.salvar();const o=this.campanha,i=o.id,d=await $utils.geeksApi({ret:{funcao:"61003235-3E37-4E2F-A7B7-A1F25FD12470",idCampanha:i,idContato:t.id}});this.showAddPositiveMsg(),await this.atualizar({id:i}),this.campanha=o}finally{this.$q.loading.hide()}},async adicionarPorDataAniversario(){let t=new Date(this.filtro.periodo.aniversario.from),o=new Date(this.filtro.periodo.aniversario.to);typeof this.filtro.periodo.aniversario=="string"&&(t=new Date(this.filtro.periodo.aniversario),o=new Date(this.filtro.periodo.aniversario));try{this.$q.loading.show(),await this.salvar();const d=this.campanha.id,l=await $utils.geeksApi({ret:{funcao:"E3BDE3F3-6D9A-424A-B4EB-B28E9757A1E5",idCampanha:d,ini:{mes:t.getMonth()+1,dia:t.getDate()},fim:{mes:o.getMonth()+1,dia:o.getDate()},idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:d})}finally{this.$q.loading.hide()}},async adicionarPorDataReceitaVencida(){const t=new Date(this.filtro.periodo.receitaVencida.from),o=new Date(this.filtro.periodo.receitaVencida.to);if(this.lastFimReceita&&this.lastFimReceita===o.toString())return!1;this.lastFimReceita=o.toString();try{this.$q.loading.show(),await this.salvar();const d=this.campanha.id,l=await $utils.geeksApi({ret:{funcao:"BA806BC5-CAF1-4673-AD4C-572B4AF8DB25",idCampanha:d,ini:{ano:t.getFullYear(),mes:t.getMonth()+1,dia:t.getDate()},fim:{ano:o.getFullYear(),mes:o.getMonth()+1,dia:o.getDate()},idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:d})}finally{this.$q.loading.hide()}},showAddPositiveMsg(){$q.notifyPositive("Contatos vinculados com sucesso!")},async contatoRemoveTodos(){this.$q.dialog({cancel:{label:"Voltar",push:!0,color:"tertiary",flat:!0},title:"Limpar?",message:"Ao continuar sua lista de envio ficar\xE1 limpa.",ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{if(this.campanhaContato.find(d=>d.status==="Enviado")){this.$q.notifyError("N\xE3o \xE9 permitido remover um contato para o qual a campanha j\xE1 foi enviada!");return}this.$q.loading.show();const t=this.campanha,o=t.id,i=await $utils.geeksApi({ret:{funcao:"AE0FFC21-984C-46E0-A9E6-6E8A192DC750",id:o}});await this.atualizar({id:o}),this.campanha=t}finally{this.$q.loading.hide()}})},async contatoRemove(t){try{if((t==null?void 0:t.status)!=="Enviado"){this.$q.loading.show();const o=this.campanha,i=o.id,d=await $utils.geeksApi({ret:{funcao:"15D77453-DEE7-4DD1-B34C-3F6C8D2CC687",id:t.id}});await this.atualizar({id:i}),this.campanha=o}t.status==="Enviado"&&this.$q.notifyError("N\xE3o \xE9 permitido remover um contato para o qual a campanha j\xE1 foi enviada!")}finally{this.$q.loading.hide()}},async concluirFiltros(){this.opcaoAdicionar==="contato-grupo"&&this.adicionarPorGrupo(),this.opcaoAdicionar==="carteira-vendedor"&&this.adicionarPorVendedor(),this.opcaoAdicionar==="carteira-aniversariantes"&&this.adicionarPorDataAniversario(),this.opcaoAdicionar==="carteira-receitas-vencidas"&&this.adicionarPorDataReceitaVencida()},async abrirModalMultiplos(){this.opcoesTipo=Ca.map(t=>({label:t.rotulo,value:t.valor})),this.filtroDinamico={show:!0,titulo:"Filtro",filtro:[{titulo:"Empresa",campo:"contatoIdEmpresa",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const t=await $g.promptContato.show({filtro:{ativo:!0,empresas:!0},placeholder:"Selecione a empresa"});return t?{value:t.id,label:t.apelido||t.nome}:!1}},{titulo:"Grupo",campo:"contatoGrupoDescricao",tipo:"seletor",operador:"and",operadores:[{label:"Cont\xE9m todos",value:"and"},{label:"Cont\xE9m pelo menos um",value:"or"}],valor:[],handler:async()=>{const t=await $g.promptGrupoUnico.show();if(!!t.descricao)return{value:t.descricao,label:t.descricao}}},{titulo:"Carteira do Vendedor",campo:"contatoIdContatoVendedor",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const t=await $g.promptContato.show({filtro:{ativo:!0,vendedores:!0},placeholder:"Selecione o vendedor"});if(!!t)return{value:t.id,label:t.nome}}},{titulo:"Profiss\xE3o/Segmento",campo:"contatoSegmento",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const t=await $g.promptSegmentoUnico.show();if(!!t.descricao)return{value:t.descricao,label:t.descricao}}},{titulo:"Origem Marketing",campo:"contatoOrigemMarketing",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const t=await $g.promptOrigemMarketingUnico.show();if(!!t.descricao)return{value:t.descricao,label:t.descricao}}},{titulo:"Tipo de Produto",campo:"tipoProduto",tipo:"seletor",opcoes:this.opcoesTipo,valor:null},{titulo:"Sexo",campo:"contatoSexo",tipo:"seletor",opcoes:[{label:"Masculino",value:"Masculino"},{label:"Feminino",value:"Feminino"},{label:"Outro",value:"Outro"}],valor:null},{titulo:"Anivers\xE1rio",campo:"contatoDataAbertura",tipo:"periodoDiaMes",valor:{diaInicio:"",mesInicio:"",diaFim:"",mesFim:""}},{titulo:"Data da Venda",campo:"vendaDataHoraFinalizado",tipo:"periodoData",valor:{inicio:null,fim:null}},{titulo:"Per\xEDodo sem venda",campo:"periodoSemVenda",tipo:"periodoData",valor:{inicio:null,fim:null}}]},[23,37,40,42,52,53,57,58,63,68].includes(this.clienteSistema.codigoSistema)&&(this.filtroDinamico.filtro.push({titulo:"Data do Envelope",campo:"envelopeDataHoraFinalizado",tipo:"periodoData",valor:{inicio:null,fim:null}}),this.filtroDinamico.filtro.push({titulo:"Receitas Vencidas",campo:"receitaDataHoraFinalizado",tipo:"periodoData",valor:{inicio:null,fim:null}}))},async aplicarFiltroDinamico(t){try{if($q.loading.show(),await this.filtroVazio(t))return $q.notifyError("\xC9 necess\xE1rio pelo menos um filtro para aplic\xE1-lo.");await this.salvar();const o=(await $utils.geeksApi({payload:{funcao:"A8198AC8-69C0-41E2-92AE-109161145256",idCampanha:this.campanha.id,filtro:t}})).data.payload,i=o.filtrosUtilizados,d=o.qtdeContatos;if(i.length>0&&d>0){const l=await this.formatarFiltros(i);this.campanha.log=`${await this.formatDate(new Date($utils.dataAtual()))} - Adicionado os contatos por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional}) utilizando o(s) filtro(s) por:
${l}

${this.campanha.log||""}`,await this.salvar()}if(d===0){$q.notifyError("N\xE3o h\xE1 contatos para o filtro selecionado.");return}this.filtroDinamico=null,this.showAddPositiveMsg(),await this.atualizar({id:this.campanha.id})}catch(o){$q.notify({type:"negative",message:o.message}),console.error(o)}finally{$q.loading.hide()}},async filtroVazio(t){return t.every(o=>Array.isArray(o.valor)?o.valor.length===0:typeof o.valor=="object"&&o.valor!==null?Object.values(o.valor).every(i=>i===""||i===null):o.valor===null||o.valor===void 0)},async criar(){this.campanha={id:$utils.uuid(),descricao:"Descri\xE7\xE3o",dataHoraCriacao:$utils.dataAtual(),status:"Rascunho",tipo:"Whatsapp",mensagem:"Mensagem",idContato:$db.usuario.logado.id,responsavel:$db.usuario.logado.nome,conexao:this.clienteSistema.bancoDeDados,log:`${await this.formatDate(new Date($utils.dataAtual()))} - Campanha criada por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional})`},this.campanhaContato=[],this.campanhaAnexo=[],this.campanhaOriginal={},this.visivel=!0,this.somenteLeitura=!1},uploadClick(){this.$refs.Upload.click()},async abrirArquivo(t){const o=this.$refs.Upload.files;if(FileReader&&o&&o.length){var i=new FileReader;i.onload=()=>{},i.readAsDataURL(o[0]),await this.anexar(o[0])}},toBase64(t){return new Promise((o,i)=>{const d=new FileReader;d.readAsDataURL(t),d.onload=()=>o(d.result),d.onerror=l=>i(l)})},async anexar(t){await this.salvar();const o=await this.toBase64(t);await $utils.geeksApi({ret:{funcao:"D280149A-F8EA-4103-B4AA-656707767F19",idCampanha:this.campanha.id,anexo:o,nomeArquivo:t.name}}),await this.atualizar({id:this.campanha.id})},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)},async testarEnvio_click(){console.log("teste de Envio de Campanha");const t=[];this.campanhaAnexo&&this.campanhaAnexo.forEach(async o=>{const i=await this.buscaAnexo(o.id);t.push(i)}),await $utils.dormir(2e3),await this.$refs.testeEnvio.show(this.campanha,t)},async buscaAnexo(t){try{const o=await $utils.geeksApi({item:{funcao:"B546B803-45E8-40B5-9F28-CFCC323AD5FD",id:t}});return{anexo:o.data.item.anexo,nomeArquivo:o.data.item.nomeArquivo}}catch(o){console.log(o.message)}},async alteraResponsavelEmpresa(t){let o,i,d;t==="responsavel"&&(o={ativo:!0,usuario:!0},i="Selecione o respons\xE1vel",d="o respons\xE1vel"),t==="empresa"&&(o={ativo:!0,empresas:!0},i="Selecione a empresa",d="a empresa"),await $q.dialog({title:"Selecione uma das op\xE7\xF5es abaixo:",options:{type:"radio",model:"alterar",items:[{label:`Alterar ${d}`,value:"alterar",color:"primary"},{label:`Remover ${d}`,value:"remover",color:"negative"}]},cancel:{label:"CANCELAR",push:!0,color:"negative",flat:!0},ok:{label:"CONFIRMAR",push:!0,textColor:"primary",flat:!0}}).onOk(async l=>{if((await $utils.geeksApi({ler:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",id:this.campanha.id}})).data.ler.campanha||await this.salvar_click("rapido"),l==="remover")try{if(t==="responsavel"&&!this.campanha.idContato)return $q.notifyPositive("Nenhum respons\xE1vel vinculado para remover!");if(t==="empresa"&&!this.campanha.idEmpresa)return $q.notifyPositive("Nenhuma empresa vinculada para remover!");const u=await $utils.geeksApi({alterar:{funcao:"7FD8CA64-9FB6-4105-92D0-AC0603E09E3A",idCampanha:this.campanha.id,tipo:t,acao:l}});await this.atualizar({id:this.campanha.id}),$q.notifyPositive(`Removido ${d} com sucesso.`)}catch(u){$q.notifyError(`Ocorreu um erro ao remover ${d} da campanha!`),console.error(u)}if(l==="alterar")try{const u=await $g.promptContato.show({filtro:o,placeholder:i});if(t==="responsavel"&&!u){$q.notifyError("Nenhum respons\xE1vel selecionado!");return}if(t==="empresa"&&!u){$q.notifyError("Nenhuma empresa selecionada!");return}const g=await $utils.geeksApi({alterarConexao:{funcao:"7FD8CA64-9FB6-4105-92D0-AC0603E09E3A",idCampanha:this.campanha.id,tipo:t,acao:l,idContato:u.id,nomeContato:u.nome}});await this.atualizar({id:this.campanha.id}),$q.notifyPositive(`Alterado ${d} com sucesso.`)}catch(u){$q.notifyError(`Ocorreu um erro ao alterar ${d} da campanha!`),console.error(u)}}).onCancel(()=>{})},async formatDate(t){if(!(t instanceof Date))throw new Error('Argumento "data" inv\xE1lido. Voc\xEA deve passar uma inst\xE2ncia de data');const o=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),d=String(t.getDate()).padStart(2,"0"),l=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");return`${d}/${i}/${o} - ${l}:${s}:${u}`},async whatsAlterarConta(t){this.campanha.conexao=t},async formatarFiltros(t){return t.length>1?t.join(`
`):t[0]},async contatoBuscar(t,o){try{if(t=t.trim(),this.opcoesContatos=[],t.length>1){const i=(await $db.contato.ler({filtros:{termoBusca:t,ativo:!0}})).data;this.opcoesContatos=i.map(d=>({data:d,label:`${d.apelido} | ${d.nome}`,stamp:"#0000000",sublabel:d.nome,value:d.nome}))}o()}catch{o(),this.$q.notify("Ocorreu um erro ao obter os contatos.")}},async contatoAdicionar(t){var o;this.grupo="",this.contatoCampo="",this.$forceUpdate();try{this.$q.loading.show(),await this.salvar();const i=this.campanha,d=i.id,l=await $utils.geeksApi({ret:{funcao:"61003235-3E37-4E2F-A7B7-A1F25FD12470",idCampanha:d,idContato:t.data.id}});if((o=l.data.ret)!=null&&o.erro){$q.notifyError(l.data.ret.erro);return}this.showAddPositiveMsg(),await this.atualizar({id:d}),this.campanha=i}finally{this.$q.loading.hide()}}},watch:{async"$route.params.id"(){const t=this.$route.params.id;!t||await this.mostrar({id:t})}},mounted(){this.sistemaPai=$utils.sistemaPai(),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema"))||{}}},uo={class:"mw80 text-center"},mo={style:{padding:"10px","padding-bottom":"0px"}},po={class:"u-container relative-position"};function ho(t,o,i,d,l,s){const u=f("ajuda"),g=f("g-label"),C=f("g-col"),h=f("badge"),_=f("BadgeCopiarUid"),b=f("g-row"),B=f("campo"),R=f("selecaoContaWhatsapp"),M=f("modalAnexo"),T=f("modalContato"),n=f("SeletorCampoTabela"),V=f("GenericModal"),I=f("PromptGrupoUnico"),S=f("PromptSegmentoUnico"),sa=f("PromptOrigemMarketingUnico"),na=f("FiltroDinamico"),da=f("JsonViewer"),ca=f("CampanhaTesteEnvio");return m(),P(W,null,[a(j,{modelValue:l.visivel,"onUpdate:modelValue":o[15]||(o[15]=r=>l.visivel=r),persistent:"",maximized:"",onKeyup:wa(s.fechar,["esc"])},{default:e(()=>[a(oa,{view:"hHh LpR fFf",container:"",class:"bg-light"},{default:e(()=>[a(ea,null,{default:e(()=>[a(L,null,{default:e(()=>[a(k,{onClick:s.fechar,icon:"arrow_back",round:"",flat:"",dense:""},null,8,["onClick"]),a(O,null,{default:e(()=>[c("Campanha: "+y(l.campanha.descricao),1)]),_:1}),a(u,{class:"q-ml-sm"}),D(a(k,{onClick:o[0]||(o[0]=r=>s.salvar_click()),label:"Salvar",color:"white","text-color":"primary",class:"q-ml-sm",unelevated:""},null,512),[[H,!l.somenteLeitura]]),t.$db.usuario.desenvolvedor()?(m(),v(k,{key:0,icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:e(()=>[a(Y,null,{default:e(()=>[D((m(),v(E,{clickable:"",onClick:o[1]||(o[1]=r=>s.mostrarJsonViewer())},{default:e(()=>[a(p,{avatar:""},{default:e(()=>[a($,{name:"mdi-file-replace",size:"sm"})]),_:1}),a(p,null,{default:e(()=>[c("Ver Objeto")]),_:1})]),_:1})),[[U]])]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1}),a(ta,{class:"u-container"},{default:e(()=>[a(b,{gutter:"md",mg:"md",bg:"bg-white"},{default:e(()=>[a(C,{col:"12"},{default:e(()=>[a(b,null,{default:e(()=>[a(C,{col:"xs",class:"center-header"},{default:e(()=>[a(g,{text:"sub1 medium",icon:"edit_note sm tertiary left"},{default:e(()=>[c("Detalhes")]),_:1})]),_:1}),a(C,{col:"xs-shrink",class:"center-header"},{default:e(()=>[a(h,{rotulo:l.campanha.status,cor:l.campanha.status==="Enviada"?"tertiary":"light",escuro:l.campanha.status==="Enviada"},null,8,["rotulo","cor","escuro"]),a(_,{id:l.campanha.id,cor:"positive",class:"q-mx-sm"},null,8,["id"]),a(k,{icon:"more_vert",flat:"",dense:"",round:"",size:"md"},{default:e(()=>[a(Y,null,{default:e(()=>[a(J,{link:"","no-border":"",separator:""},{default:e(()=>[D((m(),v(E,{clickable:"",onClick:o[2]||(o[2]=r=>s.alteraResponsavelEmpresa("responsavel"))},{default:e(()=>[a(p,{avatar:""},{default:e(()=>[a($,{name:"how_to_reg"})]),_:1}),a(p,null,{default:e(()=>[a(q,null,{default:e(()=>[c("Alterar respons\xE1vel")]),_:1})]),_:1})]),_:1})),[[U]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(C,{col:"12 md5"},{default:e(()=>{var r;return[a(B,{somenteLeitura:l.somenteLeitura||typeof((r=this.campanhaContato.find(x=>x.status==="Enviado"))==null?void 0:r.id)!="undefined",modelValue:l.campanha.descricao,"onUpdate:modelValue":o[3]||(o[3]=x=>l.campanha.descricao=x),rotulo:"Titulo da campanha",filled:"",dense:"",class:"q-md-b"},null,8,["somenteLeitura","modelValue"])]}),_:1}),a(C,{col:"12 md"},{default:e(()=>[a(B,{modelValue:l.campanha.responsavel,"onUpdate:modelValue":o[4]||(o[4]=r=>l.campanha.responsavel=r),rotulo:"Respons\xE1vel",somenteLeitura:"",filled:"",dense:"",class:"q-md-b"},null,8,["modelValue"])]),_:1}),a(C,{col:"12 md"},{default:e(()=>[a(R,{conta:l.campanha.conexao,onAtualizarConexao:o[5]||(o[5]=r=>s.whatsAlterarConta(r)),filled:""},null,8,["conta"])]),_:1}),a(C,{col:"12"},{default:e(()=>{var r;return[a(B,{modelValue:l.campanha.mensagem,"onUpdate:modelValue":o[6]||(o[6]=x=>l.campanha.mensagem=x),tipo:"textoArea",rotulo:"Mensagem",somenteLeitura:l.somenteLeitura||typeof((r=this.campanhaContato.find(x=>x.status==="Enviado"))==null?void 0:r.id)!="undefined"},null,8,["modelValue","somenteLeitura"])]}),_:1}),a(C,{col:"12"},{default:e(()=>[a(g,{caption:""},{default:e(()=>[c(" Voc\xEA pode usar os seguintes argumentos na mensagem para deixar ainda mais personalizado sua campanha: "),a(h,{class:"q-mr-xs"},{default:e(()=>[c("[Nome]")]),_:1}),a(h,{class:"q-mr-xs"},{default:e(()=>[c("[PrimeiroNome]")]),_:1}),a(h,{class:"q-mr-xs"},{default:e(()=>[c("[Apelido]")]),_:1}),a(h,{class:"q-mr-xs"},{default:e(()=>[c("[PrimeiroApelido]")]),_:1})]),_:1})]),_:1}),a(C,{col:"12"},{default:e(()=>[a(_a,{"expand-separator":"",icon:"description",label:"Log",caption:"Registro de atividades"},{default:e(()=>[a(K,null,{default:e(()=>[a(X,{style:{whiteSpace:"pre-wrap"}},{default:e(()=>[c(y(l.campanha.log),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(b,{gutter:"md",mg:"md",bg:"bg-white"},{default:e(()=>[a(C,{col:"12"},{default:e(()=>[a(k,{onClick:s.uploadClick,disable:!!l.campanhaContato.find(r=>r.status==="Enviado"),icon:"image",label:"Anexos","icon-right":"add",size:"md",outline:"","text-color":"tertiary",class:"full-width"},null,8,["onClick","disable"]),w("input",{ref:"Upload",type:"file",id:"Upload",onChange:o[7]||(o[7]=(...r)=>s.abrirArquivo&&s.abrirArquivo(...r)),style:{visibility:"hidden"}},null,544),(m(!0),P(W,null,Z(l.campanhaAnexo,r=>(m(),v(b,{key:r,gutter:"sm",mg:"sm-y",items:"center",bordered:"","rounded-borders":"",class:"itemHover"},{default:e(()=>[a(C,{col:"xs-shrink"},{default:e(()=>{var x,z;return[a(_,{id:(x=r==null?void 0:r.id)!=null?x:"",numero:((z=r==null?void 0:r.id)!=null?z:"").slice(-8),cor:"positive"},null,8,["id","numero"])]}),_:2},1024),a(C,{col:"xs",onClick:x=>s.anexoDownload(r),class:"cursor-pointer"},{default:e(()=>[a(g,{text:"bold",color:"tertiary"},{default:e(()=>[c(y(r.nomeArquivo),1)]),_:2},1024)]),_:2},1032,["onClick"]),a(C,{col:"xs-shrink"},{default:e(()=>[D(a(k,{onClick:x=>s.anexoRemove(r),disable:!!l.campanhaContato.find(x=>x.status==="Enviado"),icon:"delete",size:"md",color:"tertiary",round:"",flat:"",dense:""},null,8,["onClick","disable"]),[[H,!l.somenteLeitura]])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),a(b,{gutter:"md",mg:"md",items:"center",bg:"bg-white"},{default:e(()=>[a(C,{col:"xs"},{default:e(()=>[a(g,{text:"sub1 medium",icon:"person sm tertiary left"},{default:e(()=>[c("Contatos ("+y(l.campanhaContato.length)+")",1)]),_:1})]),_:1}),a(C,{col:"xs-shrink"},{default:e(()=>[D(a(ba,{modelValue:l.contatoCampo,"onUpdate:modelValue":[o[8]||(o[8]=r=>l.contatoCampo=r),s.contatoAdicionar],"use-input":"","input-debounce":"500",label:"Contatos",options:l.opcoesContatos,outlined:"",onFilter:s.contatoBuscar,dense:""},null,8,["modelValue","options","onFilter","onUpdate:modelValue"]),[[H,!l.somenteLeitura]])]),_:1}),a(C,{col:"xs-shrink"},{default:e(()=>[D(a(k,{onClick:s.abrirModalMultiplos,icon:"add",size:"md",round:"",flat:"",dense:""},{default:e(()=>[a(F,null,{default:e(()=>[c(" Adicionar contatos por filtro ")]),_:1})]),_:1},8,["onClick"]),[[H,!l.somenteLeitura]]),D(a(k,{onClick:o[9]||(o[9]=r=>s.contatoRemoveTodos({})),disable:!!l.campanhaContato.find(r=>r.status==="Enviado"),icon:"delete",size:"md",color:"tertiary",round:"",flat:"",dense:"",class:"q-mr-xs"},{default:e(()=>[a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Excluir todos")]),_:1})]),_:1},8,["disable"]),[[H,!l.somenteLeitura]])]),_:1}),l.campanhaContato.length>0?(m(),v(C,{key:0,col:"xs12"},{default:e(()=>[a(ya,{items:l.campanhaContato,style:{"max-height":"65vh"}},{default:e(({item:r,index:x})=>[(m(),v(E,{key:x,class:"q-py-sm q-px-xs items-center border-full itemHover"},{default:e(()=>[a(p,{class:"hideonmobile col-auto q-pr-sm no-margin"},{default:e(()=>{var z,Q;return[w("div",uo,[a(_,{id:(z=r==null?void 0:r.idContato)!=null?z:"",numero:((Q=r==null?void 0:r.idContato)!=null?Q:"").slice(-8),cor:"positive"},null,8,["id","numero"])])]}),_:2},1024),a(p,{clickable:""},{default:e(()=>[a(q,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:e(()=>[c(y(r.nome)+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Nome")]),_:1})]),_:2},1024),a(q,{caption:"",lines:"1",class:"text-tertiary ellipsis"},{default:e(()=>[c(y(r.apelido)+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Apelido")]),_:1})]),_:2},1024),a(p,{class:"hideondesktop q-mt-sm"},{default:e(()=>[a(b,{items:"center",class:"hideondesktop"},{default:e(()=>[a(C,{col:"12 sm-shrink"},{default:e(()=>{var z,Q;return[r!=null&&r.idContato?(m(),v(_,{key:0,id:(z=r==null?void 0:r.idContato)!=null?z:"",numero:((Q=r==null?void 0:r.idContato)!=null?Q:"").slice(-8),cor:"positive",class:"q-mr-sm"},null,8,["id","numero"])):A("",!0),a(h,{cor:r.status==="Enviado"?"tertiary":"light",escuro:r.status==="Enviado",rotulo:r.status==="Enviado"?"Enviado":"Rascunho",class:"q-mr-sm q-mb-sm"},null,8,["cor","escuro","rotulo"]),a(h,{cor:r!=null&&r.conexaoEnvio?"primary":"tertiary",escuro:!0,rotulo:l.objetoConexoes[r==null?void 0:r.conexaoEnvio]||"",class:"col-auto q-mx-auto"},null,8,["cor","rotulo"])]}),_:2},1024),r.dataHoraEnvio?(m(),v(C,{key:0,col:"12 sm-shrink",class:"q-mr-sm"},{default:e(()=>[a(g,{caption:"",icon:"mdi-calendar-today xs tertiary left"},{default:e(()=>[c(y(t.$filters.dataHora(r.dataHoraEnvio)),1)]),_:2},1024)]),_:2},1024)):A("",!0),r.telefone?(m(),v(C,{key:1,col:"12 sm-shrink",class:"q-mr-sm"},{default:e(()=>[a(g,{caption:"",icon:"phone xs tertiary left"},{default:e(()=>[c(y(r.telefone),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(p,{class:"hideonmobile maxw160 q-pl-sm no-margin"},{default:e(()=>[a(q,null,{default:e(()=>[a(g,{icon:"phone xs tertiary left",tip:"Telefone"},{default:e(()=>[c(y(r.telefone),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(p,{class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:e(()=>[r.dataHoraEnvio?(m(),v(q,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:e(()=>[a($,{name:"mdi-calendar-today"}),c(" "+y(t.$filters.data(r.dataHoraEnvio))+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Enviado \xE1s "+y(t.$filters.hora(r.dataHoraEnvio)),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1024),a(p,{class:"hideonmobile maxw90 q-pl-sm no-margin"},{default:e(()=>[a(h,{cor:r.status==="Enviado"?"tertiary":"light",escuro:r.status==="Enviado",rotulo:r.status==="Enviado"?"Enviado":"Rascunho",class:"col-auto q-mx-auto"},{default:e(()=>[a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Status")]),_:1})]),_:2},1032,["cor","escuro","rotulo"])]),_:2},1024),a(p,{class:"hideonmobile q-pl-sm no-margin",style:{"max-width":"max-content"}},{default:e(()=>[a(h,{cor:r!=null&&r.conexaoEnvio?"primary":"tertiary",escuro:!0,rotulo:l.objetoConexoes[r==null?void 0:r.conexaoEnvio]||"",class:"col-auto q-mx-auto"},{default:e(()=>[a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Conex\xE3o utilizada para envio da mensagem")]),_:1})]),_:2},1032,["cor","rotulo"])]),_:2},1024),D(a(p,{class:"col-auto q-pl-sm no-margin"},{default:e(()=>[a(k,{onClick:z=>s.contatoRemove(r),disable:r.status==="Enviado",icon:"delete",size:"md",color:"tertiary",round:"",flat:"",dense:""},null,8,["onClick","disable"])]),_:2},1536),[[H,!l.somenteLeitura]])]),_:2},1024))]),_:1},8,["items"])]),_:1})):A("",!0)]),_:1})]),_:1}),a(M,{ref:"modalAnexo"},null,512),a(T,{ref:"modalContato"},null,512),a(V,{ref:"filtersModal"},{genericHeader:e(()=>[c(y(l.modalTitle),1)]),genericContent:e(()=>[D(w("div",mo,[a(b,{items:"center",justify:"center"},{default:e(()=>[a(C,{class:"q-my-none q-mx-auto"},{default:e(()=>[l.opcaoAdicionar==="contato-grupo"?(m(),v(n,{key:0,modelValue:l.grupo,"onUpdate:modelValue":o[10]||(o[10]=r=>l.grupo=r),tabela:"contatoGrupo",campo:"label",label:"Filtre",buscarSemCaractere:!0,filtro:{ativo:!0,vendedores:!0}},null,8,["modelValue"])):A("",!0),l.opcaoAdicionar==="carteira-vendedor"?(m(),v(n,{key:1,modelValue:l.vendedor,"onUpdate:modelValue":o[11]||(o[11]=r=>l.vendedor=r),tabela:"contato",campo:"nome",label:"Filtre",buscarSemCaractere:!0,filtro:{ativo:!0,vendedores:!0},enableObj:!0},null,8,["modelValue"])):A("",!0),l.opcaoAdicionar==="carteira-aniversariantes"?(m(),v(b,{key:2,gutter:"md",mg:"md-l-ng",class:"date-without-year"},{default:e(()=>[a(C,{col:"12"},{default:e(()=>[a(Da,{modelValue:l.filtro.periodo.aniversario,"onUpdate:modelValue":o[12]||(o[12]=r=>l.filtro.periodo.aniversario=r),title:"Aniversariantes",range:"",subtitle:"Selecione um periodo"},null,8,["modelValue"])]),_:1})]),_:1})):A("",!0),l.opcaoAdicionar==="carteira-receitas-vencidas"?(m(),v(b,{key:3,gutter:"md",mg:"md-t",class:"invalid-recipes"},{default:e(()=>[a(C,{col:"12"},{default:e(()=>[a(B,{modelValue:l.filtro.periodo.receitaVencida.from,"onUpdate:modelValue":o[13]||(o[13]=r=>l.filtro.periodo.receitaVencida.from=r),tipo:"data",class:"no-shadow full-width",after:[{icon:"mdi-close-circle",handler(){l.filtro.periodo.receitaVencida.ini=""}}],rotulo:"De",dense:""},null,8,["modelValue","after"])]),_:1}),a(C,{col:"12"},{default:e(()=>[a(B,{modelValue:l.filtro.periodo.receitaVencida.to,"onUpdate:modelValue":o[14]||(o[14]=r=>l.filtro.periodo.receitaVencida.to=r),tipo:"data",class:"no-shadow full-width",after:[{icon:"mdi-close-circle",handler(){l.filtro.periodo.receitaVencida.fim=""}}],rotulo:"at\xE9",col:"12",dense:""},null,8,["modelValue","after"])]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1})],512),[[H,!l.somenteLeitura]])]),genericFooter:e(()=>[D(a(k,{onClick:s.concluirFiltros,label:"Avan\xE7ar",color:"primary",flat:""},null,8,["onClick"]),[[U]])]),_:1},512),a(ia,{class:"bg-light q-pa-sm text-right u-bordaCima"},{default:e(()=>[w("div",po,[D(a(k,{onClick:s.testarEnvio_click,type:"submit",icon:"send",label:"Testar Envio",color:"primary",unelevated:""},null,8,["onClick"]),[[H,!l.somenteLeitura]]),D(a(k,{onClick:s.enviar_click,type:"submit",icon:"send",label:"Enviar",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[H,!l.somenteLeitura]]),D(a(k,{onClick:s.rascunho_click,type:"submit",label:"Voltar para Rascunho",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[H,l.somenteLeitura]])])]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),a(I,{ref:"PromptGrupoUnico"},null,512),a(S,{ref:"PromptSegmentoUnico"},null,512),a(sa,{ref:"PromptOrigemMarketingUnico"},null,512),a(na,{props:l.filtroDinamico,onAplicar:s.aplicarFiltroDinamico},null,8,["props","onAplicar"]),a(da,{ref:"jsonViewer"},null,512),a(ca,{ref:"testeEnvio",onAtualizar:s.atualizar},null,8,["onAtualizar"])],64)}var fo=N(co,[["render",ho]]);const vo={components:{Lista:Aa,campanhaFicha:fo,JsonViewer:ra},data(){return{lista:[],listaOriginal:[],listaLayout:{},mostrar:{barraTopo:!0,toolbarTitulo:!0,icone:"campaign",titulo:"Campanhas",filtroAvancado:!0,buscar:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:""},tabSelecionada:{valor:"Rascunho"},tabs:[{valor:"Rascunho",rotulo:"Rascunhos"},{valor:"Enviando",rotulo:"Enviando"},{valor:"Enviada",rotulo:"Enviadas"},{valor:"Todos",rotulo:"Todos"}],busca:"",filtros:{tipo:null,descricao:null,mensagem:null,dataHoraCriacaoDe:null,dataHoraCriacaoAte:null,dataHoraDisparoDe:null,dataHoraDisparoAte:null,dataHoraUltimoDisparoDe:null,dataHoraUltimoDisparoAte:null},paginacao:{atual:1,maximo:1,total:1,limite:25}}},methods:{async atualizar(){try{$q.loading.show();const t=this.paginacao.limite,o=this.paginacao.atual,i="descricao",d=$utils.eliminarVazios(this.filtros);d.status=this.tabSelecionada.valor,this.tabSelecionada.valor==="Todos"&&delete d.status,this.busca&&(d.termoBusca=this.busca);const l=(await $utils.geeksApi({ret:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",filtros:d,limit:t,page:o,sort:i}})).data.ret;l.total||(l.total=l.total=l.data.length),l.totalPages||(l.totalPages=l.total/t),this.listaLayout={};for(let s of l.data)this.listaLayout[s.id]={detalhes:!1};this.listaOriginal=$utils.clonarV2(l.data),this.lista=l.data,this.paginacao.total=l.total,this.paginacao.maximo=l.totalPages}catch(t){$q.notifyError("Erro iniciar",t)}finally{$q.loading.hide()}},async abrir(t){this.$router.replace({params:{id:t}}).finally(()=>{this.$refs.modalFicha.mostrar({id:t})})},async copiarCampanha(t){this.$q.dialog({title:"Duplicar Campanha?",message:"Deseja criar uma c\xF3pia desta campanha?",cancel:{label:"Voltar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{this.$q.loading.show();const o=await $utils.geeksApi({ret:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",id:t}}),i=$utils.clonar(o.data.ret.campanha),d=$utils.clonar(o.data.ret.campanhaContato),l=$utils.clonar(o.data.ret.campanhaAnexo);if(i.id=$utils.uuid(),i.status="Rascunho",i.dataHoraCriacao=new Date,i.dataHoraDisparo=null,i.dataHoraUltimoDisparo=null,i.log=null,await $utils.geeksApi({ret:{funcao:"65A200F2-9B9F-40E6-BD3A-282B77FC6BFB",...i}}),l.length>0)for(let s in l){if(!l[s].anexo){const u=await $utils.geeksApi({buscaAnexo:{funcao:"B546B803-45E8-40B5-9F28-CFCC323AD5FD",id:l[s].id}});l[s].anexo=u.data.buscaAnexo.anexo}l[s].id=$utils.uuid(),l[s].idCampanha=i.id,await $utils.geeksApi({ret:{funcao:"D280149A-F8EA-4103-B4AA-656707767F19",idCampanha:i.id,anexo:l[s].anexo,nomeArquivo:l[s].nomeArquivo}})}if(d.length>0)for(let s of d)(await $utils.geeksApi({ret:{funcao:"B18C0CB3-5EA1-4E1C-8C31-EB354E5E3DB1",idCampanha:i.id,idContato:s.idContato,nome:s.nome,apelido:s.apelido,telefone:s.telefone,email:s.email}})).data.ret.erro?$q.notifyError("ret.data.ret.erro"):console.log("contato adicionado!");this.atualizar(),this.editarCopiaCampanha_click(i.id)}catch(o){console.log(o.message)}finally{this.$q.loading.hide()}})},editarCopiaCampanha_click(t){this.$q.dialog({title:"Campanha duplicada",message:"Deseja editar agora a c\xF3pia da campanha?",cancel:{label:"N\xE3o",push:!0,class:"bg-linght",textColor:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(async()=>{try{this.$q.loading.show(),this.abrir(t)}catch(o){console.log(o.message)}finally{this.$q.loading.hide()}})},criarClick(){this.$refs.modalFicha.criar()},limparFiltrosClick(){this.filtros={descricao:null,dataHoraCriacaoDe:null,dataHoraCriacaoAte:null,dataHoraDisparoDe:null,dataHoraDisparoAte:null,dataHoraUltimoDisparoDe:null,dataHoraUltimoDisparoAte:null,tipo:null,mensagem:null},this.atualizar()},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)},async deletarCampanhaRascunho(t){const o=await $utils.geeksApi({deletar:{funcao:"B0DD9B0A-F684-4829-8772-B42670470017",id:t}});o.data.deletar.erro===0?$q.notifyPositive(o.data.deletar.mensagem):$q.notifyError(o.data.deletar.mensagem),this.atualizar()}},async mounted(){this.atualizar(),this.$route.params.id&&this.$route.params.id.length&&this.$refs.modalFicha.mostrar({id:this.$route.params.id})}},go={id:"Campanhas"},Co={class:"mw80 text-center"},_o={class:"text-weight-bold"},bo={class:"text-weight-bold"};function yo(t,o,i,d,l,s){const u=f("campo"),g=f("BadgeCopiarUid"),C=f("avatar"),h=f("badge"),_=f("g-col"),b=f("g-label"),B=f("g-row"),R=f("Lista"),M=f("campanhaFicha"),T=f("JsonViewer");return m(),P("div",go,[a(R,{busca:l.busca,"onUpdate:busca":o[10]||(o[10]=n=>l.busca=n),onCriarClick:s.criarClick,onAtualizar:s.atualizar,onLimparFiltrosClick:s.limparFiltrosClick,lista:l.lista,tabSelecionada:l.tabSelecionada,tabs:l.tabs,paginacao:l.paginacao,mostrar:l.mostrar},{menuExtras:e(()=>[D((m(),v(E,{clickable:"",onClick:o[0]||(o[0]=n=>s.mostrarJsonViewer())},{default:e(()=>[a(p,{avatar:""},{default:e(()=>[a($,{name:"mdi-file-replace",size:"sm"})]),_:1}),a(p,null,{default:e(()=>[c("Ver Objeto")]),_:1})]),_:1})),[[U]])]),filtroCampos:e(()=>[a(u,{modelValue:l.filtros.descricao,"onUpdate:modelValue":o[1]||(o[1]=n=>l.filtros.descricao=n),rotulo:"Titulo",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:l.filtros.mensagem,"onUpdate:modelValue":o[2]||(o[2]=n=>l.filtros.mensagem=n),rotulo:"Mensagem",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),a(u,{modelValue:l.filtros.dataHoraCriacaoDe,"onUpdate:modelValue":o[3]||(o[3]=n=>l.filtros.dataHoraCriacaoDe=n),rotulo:"Data cria\xE7\xE3o",tipo:"data",dense:"",class:"q-mb-xs"},null,8,["modelValue"]),a(u,{modelValue:l.filtros.dataHoraCriacaoAte,"onUpdate:modelValue":o[4]||(o[4]=n=>l.filtros.dataHoraCriacaoAte=n),rotulo:"at\xE9",tipo:"data",dense:"",class:"q-mb-xl"},null,8,["modelValue"]),a(u,{modelValue:l.filtros.dataHoraDisparoDe,"onUpdate:modelValue":o[5]||(o[5]=n=>l.filtros.dataHoraDisparoDe=n),rotulo:"Data disparo",tipo:"data",dense:"",class:"q-mb-xs"},null,8,["modelValue"]),a(u,{modelValue:l.filtros.dataHoraDisparoAte,"onUpdate:modelValue":o[6]||(o[6]=n=>l.filtros.dataHoraDisparoAte=n),rotulo:"at\xE9",tipo:"data",dense:"",class:"q-mb-xl"},null,8,["modelValue"]),a(u,{modelValue:l.filtros.dataHoraUltimoDisparoDe,"onUpdate:modelValue":o[7]||(o[7]=n=>l.filtros.dataHoraUltimoDisparoDe=n),rotulo:"Data \xFAltimo disparo",tipo:"data",dense:"",class:"q-mb-xs"},null,8,["modelValue"]),a(u,{modelValue:l.filtros.dataHoraUltimoDisparoAte,"onUpdate:modelValue":o[8]||(o[8]=n=>l.filtros.dataHoraUltimoDisparoAte=n),rotulo:"at\xE9",tipo:"data",dense:"",class:"q-mb-xl"},null,8,["modelValue"]),a(u,{modelValue:l.paginacao.limite,"onUpdate:modelValue":o[9]||(o[9]=n=>l.paginacao.limite=n),rotulo:"Quantidade por p\xE1gina",tipo:"quantidade",min:"1",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"])]),itemLista:e(()=>[a(J,{bordered:"",class:"bg-white q-mb-xs rounded-borders"},{default:e(()=>[(m(!0),P(W,null,Z(l.lista,n=>(m(),P("div",{key:n.id,class:"itemHover cursor-pointer"},[a(E,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:e(()=>[a(p,{class:"hideonmobile col-auto q-pr-sm no-margin"},{default:e(()=>[w("div",Co,[a(g,{id:n.id,numero:n.id.slice(-8),cor:"positive"},null,8,["id","numero"])])]),_:2},1024),a(p,{onClick:V=>s.abrir(n.id),class:"col-md col-lg col-xl no-margin"},{default:e(()=>[a(E,{class:"q-pa-none"},{default:e(()=>[a(p,{class:"col-auto items-center"},{default:e(()=>[a(C,{imagem:n.imagem,rotulo:n.descricao,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]),_:2},1024),a(p,{class:"col"},{default:e(()=>[a(q,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:e(()=>[c(y(n.descricao),1)]),_:2},1024),a(p,{class:"hideondesktop q-mt-sm"},{default:e(()=>[a(B,{mg:"xs-b"},{default:e(()=>[a(_,{col:"xs12 sm-shrink"},{default:e(()=>[a(g,{id:n.id,numero:n.id.slice(-8),cor:"positive",escuro:"",class:"q-mr-sm"},null,8,["id","numero"]),a(h,{rotulo:n.status,cor:n.status!=="Rascunho"?"tertiary":"light",escuro:n.status!=="Rascunho",class:"q-mr-sm"},null,8,["rotulo","cor","escuro"])]),_:2},1024),a(_,{col:"xs12 sm-shrink"},{default:e(()=>[n.dataHoraCriacao?(m(),v(b,{key:0,tip:`Criado \xE1s ${t.$filters.hora(n.dataHoraCriacao)}`,icon:"mdi-calendar-today xs tertiary",inline:"",class:"q-mr-sm"},{default:e(()=>[c(y(t.$filters.data(n.dataHoraCriacao)),1)]),_:2},1032,["tip"])):A("",!0),n.dataHoraDisparo?(m(),v(b,{key:1,tip:`Disparado \xE1s ${t.$filters.hora(n.dataHoraDisparo)}`,icon:"mdi-calendar-today xs tertiary",inline:"",class:"q-mr-sm"},{default:e(()=>[c(y(t.$filters.data(n.dataHoraDisparo)),1)]),_:2},1032,["tip"])):A("",!0),n.dataHoraUltimoDisparo?(m(),v(b,{key:2,tip:`\xDAltimo disparo \xE1s ${t.$filters.hora(n.dataHoraUltimoDisparo)}`,icon:"mdi-calendar xs tertiary",inline:"",class:"q-mr-sm"},{default:e(()=>[c(y(t.$filters.data(n.dataHoraUltimoDisparo)),1)]),_:2},1032,["tip"])):A("",!0)]),_:2},1024),a(_,{col:"xs12 sm-shrink",class:"q-mr-sm"},{default:e(()=>[a(b,{inline:"",class:"q-mr-sm"},{default:e(()=>[c("Contatos: "),w("span",_o,y(n.qtdeContatos),1)]),_:2},1024),a(b,{inline:"",class:"q-mr-sm"},{default:e(()=>[c("Enviados: "),w("span",bo,y(n.qtdeEnviado),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:e(()=>[n.dataHoraCriacao?(m(),v(q,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:e(()=>[a($,{name:"mdi-calendar-today"}),c(" "+y(t.$filters.data(n.dataHoraCriacao))+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Criado \xE1s "+y(t.$filters.hora(n.dataHoraCriacao)),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:e(()=>[n.dataHoraDisparo?(m(),v(q,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:e(()=>[a($,{name:"mdi-calendar-today"}),c(" "+y(t.$filters.data(n.dataHoraDisparo))+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Disparado \xE1s "+y(t.$filters.hora(n.dataHoraDisparo)),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:e(()=>[n.dataHoraUltimoDisparo?(m(),v(q,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:e(()=>[a($,{name:"mdi-calendar"}),c(" "+y(t.$filters.data(n.dataHoraUltimoDisparo))+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("\xDAltimo disparo \xE1s "+y(t.$filters.hora(n.dataHoraUltimoDisparo)),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw90 q-pl-sm no-margin"},{default:e(()=>[a(h,{cor:n.status!=="Rascunho"?"tertiary":"light",escuro:n.status!=="Rascunho",class:"col-auto q-mx-auto"},{default:e(()=>[c(y(n.status)+" ",1),a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Status")]),_:1})]),_:2},1032,["cor","escuro"])]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw90 q-pl-sm no-margin"},{default:e(()=>[a(q,{lines:"1",class:"ellipsis text-tertiary text-weight-bold text-right"},{default:e(()=>[c(y(n.qtdeContatos),1)]),_:2},1024),a(q,{caption:"",class:"text-tertiary text-right"},{default:e(()=>[c("Contatos")]),_:1})]),_:2},1032,["onClick"]),a(p,{onClick:V=>s.abrir(n.id),class:"hideonmobile maxw90 q-pl-sm no-margin"},{default:e(()=>[a(q,{lines:"1",class:"ellipsis text-tertiary text-weight-bold text-right"},{default:e(()=>[c(y(n.qtdeEnviado),1)]),_:2},1024),a(q,{caption:"",class:"text-tertiary text-right"},{default:e(()=>[c("Enviados")]),_:1})]),_:2},1032,["onClick"]),a(p,{class:"hideonmobile col-auto q-pl-sm no-margin"},{default:e(()=>[a(E,{class:"q-pa-none"},{default:e(()=>[a(p,{class:"q-pr-sm no-margin"},{default:e(()=>[a(k,{onClick:V=>s.abrir(n.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},{default:e(()=>[a(F,{anchor:"bottom middle",self:"center middle"},{default:e(()=>[c("Editar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),a(p,{class:"no-margin"},{default:e(()=>[a(k,{icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:e(()=>[a(Y,null,{default:e(()=>[D((m(),v(J,{link:"","no-border":"",separator:""},{default:e(()=>[a(E,{onClick:V=>s.copiarCampanha(n.id),clickable:"",class:"itemHover"},{default:e(()=>[a(p,{avatar:""},{default:e(()=>[a($,{name:"content_copy"})]),_:1}),a(p,null,{default:e(()=>[a(q,null,{default:e(()=>[c(" Duplicar ")]),_:1})]),_:1})]),_:2},1032,["onClick"]),n.status==="Rascunho"&&n.qtdeEnviado===0?(m(),v(E,{key:0,onClick:V=>s.deletarCampanhaRascunho(n.id),clickable:"",class:"itemHover"},{default:e(()=>[a(p,{avatar:""},{default:e(()=>[a($,{name:"delete"})]),_:1}),a(p,null,{default:e(()=>[a(q,null,{default:e(()=>[c(" Excluir ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):A("",!0)]),_:2},1024)),[[U]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(p,{class:"hideondesktop col-auto q-pl-sm no-margin"},{default:e(()=>[a(k,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:e(()=>[a(Y,null,{default:e(()=>[D((m(),v(J,{link:"","no-border":"",separator:""},{default:e(()=>[a(E,{onClick:V=>s.abrir(n.id),clickable:"",class:"itemHover"},{default:e(()=>[a(p,{avatar:""},{default:e(()=>[a($,{name:"edit"})]),_:1}),a(p,null,{default:e(()=>[a(q,null,{default:e(()=>[c(" Editar ")]),_:1})]),_:1})]),_:2},1032,["onClick"]),a(E,{onClick:V=>s.copiarCampanha(n.id),clickable:"",class:"itemHover"},{default:e(()=>[a(p,{avatar:""},{default:e(()=>[a($,{name:"content_copy"})]),_:1}),a(p,null,{default:e(()=>[a(q,null,{default:e(()=>[c(" Duplicar ")]),_:1})]),_:1})]),_:2},1032,["onClick"]),n.status==="Rascunho"&&n.qtdeEnviado===0?(m(),v(E,{key:0,onClick:V=>s.deletarCampanhaRascunho(n.id),clickable:"",class:"itemHover"},{default:e(()=>[a(p,{avatar:""},{default:e(()=>[a($,{name:"delete"})]),_:1}),a(p,null,{default:e(()=>[a(q,null,{default:e(()=>[c(" Excluir ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):A("",!0)]),_:2},1024)),[[U]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(ka)]))),128))]),_:1})]),_:1},8,["busca","onCriarClick","onAtualizar","onLimparFiltrosClick","lista","tabSelecionada","tabs","paginacao","mostrar"]),a(M,{ref:"modalFicha",onAtualizar:s.atualizar},null,8,["onAtualizar"]),a(T,{ref:"jsonViewer"},null,512)])}var Bo=N(vo,[["render",yo]]);export{Bo as default};
