import{_ as ue,aF as K,b1 as fe,c3 as se,bC as re,o as d,d as c,w as a,f as e,L as ce,B as F,at as pe,E as he,h as ie,i as me,j as g,k as r,G as X,Q as U,M as Z,I as be,H as _e,R as v,S as s,T as f,t as u,e as _,O as J,n as P,F as z,s as S,m as Q,W as le,aV as oe,l as Y,as as ve,c$ as ge,aX as ke,J as ye,a_ as Fe,C as we,aE as M,d0 as Ce,bc as Be,r as W,d1 as te,az as $,bd as ne,y as Ee,bu as qe,u as de}from"./index.9b156bba.js";import{e as xe}from"./emitirNFe.35117289.js";import{n as Ve}from"./nfePrincipal.7455ee94.js";import{F as Pe}from"./FaturaModal.c2a34fd1.js";import{D as ze}from"./DocumentosFiscais.9a161678.js";import{M as De}from"./ModalHistoricoStatus.d2a763d2.js";import{Q as Ie}from"./QSpinnerHourglass.c114b667.js";import{Q as Ne}from"./QSpinnerDots.b0dfb5d8.js";const Se={computed:{visivel:{get(){return this.modelValue},async set(i){this.$emit("update:modelValue",i)}},ativarBotaoEmissaoBoleto(){var l,q,h,t;const i=Number((q=(l=this.boletos)==null?void 0:l.financeiroBanco)==null?void 0:q.value);return Number.isInteger(i)&&i&&((t=(h=this.boletos)==null?void 0:h.condicoesPagamento)==null?void 0:t.find(p=>p.checked))}},data(){return{boletos:{codigoFinanceiroBanco:"",condicoesPagamento:[],bancos:[],emitidos:!1,emitir:!1,loading:!1,cancelarAtualizarBoletos:!1}}},emits:["update:modelValue"],methods:{async atualizar(){var i,l,q,h,t;try{if((i=this.fatura)!=null&&i.id){this.boletos={codigoFinanceiroBanco:"",condicoesPagamento:[],bancos:[],emitidos:!1,emitir:!1,loading:!1,cancelarAtualizarBoletos:!1};const p=[],x=await K().formaPagamento.toArray(),D=await K().empresa.where({idContato:(l=this.fatura)==null?void 0:l.idEmpresa}).toArray();if(await(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:(q=this.fatura)==null?void 0:q.id}})).forEach(B=>{const I=x.find(w=>w.id===B.idFormaPagamento&&w.tipo===99&&w.tipoFinanceiro==="T\xEDtulo em aberto");I&&p.push({dataVencimento:B.dataVencimento,descricao:I.descricao,idFinanceiroTitulo:B.idFinanceiroTitulo,codigoFinanceiroBoleto:"",checked:!1,disable:!0,valor:B.valor})}),!p.length)return;const A=[];await K().financeiroBanco.each(B=>{if(!!B.ativo){if(B.id==="7D07229E-B35E-42AA-A312-78313BE61B2F"){A.push(B);return}B.idEmpresa&&D.find(I=>I.id===B.idEmpresa)&&A.push(B)}});const L=[...new Set(A.map(B=>B.codigoBanco))],O=[];await K()._banco.each(B=>{L.find(I=>I===B.codigoBanco)&&O.push(B)}),this.boletos.condicoesPagamento=fe.exports.orderBy(p,"dataVencimento","asc");const R=[];for(const B of A){const I=O.find(n=>n.codigoBanco===B.codigoBanco)||{};if(!I)continue;const w=(I.descricao||"").trim(),C=(B.agencia||"").trim(),V=(B.conta||"").trim();if(!I.arquivoBoleto||!w||!C||!V)continue;let o=w+" - Ag. "+C+" C/C "+V;R.push({arquivoBoleto:I.arquivoBoleto,label:o,value:B.codigoFinanceiroBanco})}R.length&&(this.boletos.financeiroBanco=R[0],this.boletos.bancos=R);const j=(await $db.hibrido.lista({table:"documentoFiscalEletronico",where:{idDocumento:(h=this.fatura)==null?void 0:h.id}})).find(B=>B.situacao==="Emitido")||null;for(const B of(t=this.boletos)==null?void 0:t.condicoesPagamento)B.checked=!1,B.disable=!0,B.codigoFinanceiroBoleto="",B.codigoFinanceiroTitulo="",B.banco={};this.boletos.docFiscal=j,this.boletos.financeiroBanco=this.boletos.bancos[0],this.$nextTick().then(async()=>{await this.atualizarBoletos()})}}catch(p){console.error("ERRO: ",p)}},async atualizarBoletos(){var i;try{let l,q,h,t;t=(i=this.boletos)==null?void 0:i.condicoesPagamento,h=t.reduce((x,D)=>x+"'"+D.idFinanceiroTitulo+"',",""),h=h.slice(0,h.length-1),l=`
            select
              fTitulo.id,
              fTitulo.codigoFinanceiroTitulo,
              fBoleto.codigoFinanceiroBoleto,
              fBoleto.dataEmissao,
              b.descricao,
              fBanco.agencia,
              fBanco.conta,
              b.arquivoBoleto
            from financeiroTitulo fTitulo
              left join financeiroBoleto fBoleto on(fBoleto.codigoFinanceiroBoleto = fTitulo.codigoFinanceiroBoleto)
              left join financeiroBanco fBanco on(fBanco.CodigoFinanceiroBanco = fBoleto.codigoFinanceiroBanco)
              left join _banco b on(b.codigoBanco = fBanco.codigoBanco)
            where fTitulo.id in (${h})
          `,this.boletos.cancelarAtualizarBoletos=!1;let p=0;do{try{q=await se(l),p=0}catch(x){q=[],++p%3===0&&this.$q.notifyError(x.message)}for(const x of q){const D=t.find(H=>H.idFinanceiroTitulo===x.id);D&&(x.codigoFinanceiroBoleto&&(D.codigoFinanceiroBoleto=x.codigoFinanceiroBoleto,D.banco={descricao:x.descricao,dataEmissao:x.dataEmissao,agencia:x.agencia,conta:x.conta,arquivoBoleto:x.arquivoBoleto}),x.codigoFinanceiroTitulo&&(D.codigoFinanceiroTitulo=x.codigoFinanceiroTitulo,D.disable=!1))}if(q.length===t.length||this.boletos.cancelarAtualizarBoletos)break;await re(5e3)}while(1)}catch{$q.notify({message:"N\xE3o foi poss\xEDvel atualizar os boletos.",type:"tertiary"})}},async emitirImprimirBoleto(){var x,D,H,A,L,O,R,j,B,I;this.boletos.loading=!0;let i,l,q,h={},t=[];q=(D=(x=this.boletos)==null?void 0:x.condicoesPagamento)==null?void 0:D.filter(w=>w.checked);for(const w of q){if(w.codigoFinanceiroBoleto&&(w.banco||{}).arquivoBoleto){if(!h[w.banco.arquivoBoleto]){h[w.banco.arquivoBoleto]=[w.codigoFinanceiroBoleto];continue}h[w.banco.arquivoBoleto].push(w.codigoFinanceiroBoleto);continue}t.push(w.codigoFinanceiroTitulo)}if((t==null?void 0:t.length)&&((A=(H=this.boletos)==null?void 0:H.financeiroBanco)==null?void 0:A.value)){let w,C,V,o=0,n=0,m,k="";if(this.cancelarEmitirBoletos=!1,(L=this.boletos)!=null&&L.docFiscal&&(k=`${this.boletos.docFiscal.nNF} / S\xE9rie ${this.boletos.docFiscal.serie} | `),m=(j=((R=(O=this.boletos)==null?void 0:O.bancos)==null?void 0:R.find(y=>{var E,N;return y.value===((N=(E=this.boletos)==null?void 0:E.financeiroBanco)==null?void 0:N.value)}))||{})==null?void 0:j.arquivoBoleto,!m){this.$q.notifyError("Arquivo boleto n\xE3o encontrado");return}i=`sp_financeiro_boletoEmitir ${(I=(B=this.boletos)==null?void 0:B.financeiroBanco)==null?void 0:I.value}, '${t==null?void 0:t.join(",")}', '${k}'`;do{if(this.cancelarEmitirBoletos)break;try{l=await se(i),o=0}catch(y){l=[],++o%3===0&&this.$q.notifyError(y.message)}if(w=(l||[])[0],C=((w||{}).Msg||"").trim(),V=((w||{}).Retorno||"").trim(),C==="Boleto Gerado com sucesso!"&&V){const y=V.substring(0,V.length-1).split(",");if(!h[m]){h[m]=y;break}for(const E of y)h[m].push(E);break}else++n%3===0&&this.$q.notifyError(C);await re(5e3)}while(1)}let p=JSON.parse(localStorage.getItem("clienteSistema"))||{};for(const w in h){let C;C="https://rel.storage.b15.com.br/Relatorios/"+w+".html?",C+="CodigoFinanceiroBoleto="+h[w].join(","),C+="&Banco="+p.bancoDeDados,C+="&URLServidor="+p.urlServidor,window.open(C)}await this.atualizarBoletos(),this.boletos.loading=!1},checkboxTodos(i){var l,q,h,t,p,x,D,H,A,L,O,R,j,B,I,w,C,V,o,n;if(i==="emitidos"&&((h=(q=(l=this.boletos)==null?void 0:l.condicoesPagamento)==null?void 0:q.filter(m=>!m.disable&&m.codigoFinanceiroBoleto))==null?void 0:h.length))for(const m of(p=(t=this.boletos)==null?void 0:t.condicoesPagamento)==null?void 0:p.filter(k=>!k.disable&&k.codigoFinanceiroBoleto))m.checked=!!this.boletos.emitidos;if(i==="emitir"&&((H=(D=(x=this.boletos)==null?void 0:x.condicoesPagamento)==null?void 0:D.filter(m=>!m.disable&&!m.codigoFinanceiroBoleto))==null?void 0:H.length))for(const m of(L=(A=this.boletos)==null?void 0:A.condicoesPagamento)==null?void 0:L.filter(k=>!k.disable&&!k.codigoFinanceiroBoleto))m.checked=!!this.boletos.emitir;if(!i){if((j=(R=(O=this.boletos)==null?void 0:O.condicoesPagamento)==null?void 0:R.filter(m=>!m.disable&&m.codigoFinanceiroBoleto))!=null&&j.length){const m=(I=(B=this.boletos)==null?void 0:B.condicoesPagamento)==null?void 0:I.filter(k=>!k.disable&&k.codigoFinanceiroBoleto);this.boletos.emitidos=m.reduce((k,y)=>k&&y.checked,!0)}if((V=(C=(w=this.boletos)==null?void 0:w.condicoesPagamento)==null?void 0:C.filter(m=>!m.disable&&!m.codigoFinanceiroBoleto))!=null&&V.length){const m=(n=(o=this.boletos)==null?void 0:o.condicoesPagamento)==null?void 0:n.filter(k=>!k.disable&&!k.codigoFinanceiroBoleto);this.boletos.emitir=m.reduce((k,y)=>k&&y.checked,!0)}}}},props:{modelValue:{type:Boolean,required:!0},fatura:{type:Object,required:!0,default:()=>({})}},watch:{async visivel(i){i&&await this.atualizar()}}},Te={class:"text-weight-medium q-px-xs"},Re={class:"text-weight-medium q-px-xs"},He={class:"text-weight-bold q-pr-xs"},Ae={class:"text-weight-bold q-pr-xs"},Qe={class:"text-weight-bold q-pr-xs"},Oe={class:"text-weight-medium float-right"};function Me(i,l,q,h,t,p){return d(),c(we,{modelValue:p.visivel,"onUpdate:modelValue":l[8]||(l[8]=x=>p.visivel=x)},{default:a(()=>[e(ce,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"500px"}},{default:a(()=>[F("form",{onSubmit:l[7]||(l[7]=pe(x=>p.emitirImprimirBoleto(),["prevent"])),class:"q-pa-sm"},[e(he,null,{default:a(()=>[e(ie,null,{default:a(()=>[e(me,null,{default:a(()=>[e(g,{name:"receipt_long",size:"sm",class:"q-mr-sm"}),r(" Emiss\xE3o de Boleto ")]),_:1}),X(e(U,{icon:"close",flat:"",round:"",dense:""},null,512),[[Z]])]),_:1})]),_:1}),e(be,null,{default:a(()=>[e(_e,null,{default:a(()=>{var x,D,H,A,L,O,R,j,B,I,w;return[(x=t.boletos)!=null&&x.docFiscal?(d(),c(v,{key:0,class:"q-py-none q-px-sm"},{default:a(()=>[e(s,{class:"no-margin"},{default:a(()=>[e(f,{header:""},{default:a(()=>{var C,V,o,n;return[e(g,{name:"insert_drive_file",size:"xs",class:"q-mr-xs"}),r(" Nota fiscal: "),F("span",Te,u((V=(C=t.boletos)==null?void 0:C.docFiscal)==null?void 0:V.nNF),1),r(" | S\xE9rie: "),F("span",Re,u((n=(o=t.boletos)==null?void 0:o.docFiscal)==null?void 0:n.serie),1)]}),_:1})]),_:1})]),_:1})):_("",!0),(A=(H=(D=t.boletos)==null?void 0:D.condicoesPagamento)==null?void 0:H.filter(C=>C.disable))!=null&&A.length?(d(),c(J,{key:1,dense:"",highlight:"",bordered:"","rounded-borders":"",class:"q-pa-none q-mx-sm q-my-lg"},{default:a(()=>{var C,V;return[e(f,{header:"",class:"text-weight-medium text-center"},{default:a(()=>[e(Ie,{size:"xs",class:"q-mr-sm"}),r(" Recuperando informa\xE7\xF5es do servidor... ")]),_:1}),(d(!0),P(z,null,S((V=(C=t.boletos)==null?void 0:C.condicoesPagamento)==null?void 0:V.filter(o=>o.disable),(o,n)=>X((d(),c(v,{key:n,tag:"label"},{default:a(()=>[e(s,{side:""},{default:a(()=>[o!=null&&o.disable?(d(),c(Ne,{key:0})):_("",!0)]),_:2},1024),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(o==null?void 0:o.descricao),1)]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,{class:"text-weight-medium text-center"},{default:a(()=>[F("span",null,[r(u(i.$filters.data(o==null?void 0:o.dataVencimento))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>[r(" Data de Vencimento ")]),_:1})])]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,{class:"text-weight-medium text-right"},{default:a(()=>[r(u(i.$filters.numero(o==null?void 0:o.valor,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[le]])),128))]}),_:1})):_("",!0),(R=(O=(L=t.boletos)==null?void 0:L.condicoesPagamento)==null?void 0:O.filter(C=>!C.disable&&C.codigoFinanceiroBoleto))!=null&&R.length?(d(),c(J,{key:2,dense:"",highlight:"",bordered:"","rounded-borders":"",class:"q-pa-none q-mx-sm q-my-lg"},{default:a(()=>{var C,V;return[e(f,{header:"",class:"text-weight-medium"},{default:a(()=>[F("span",null,[e(oe,{modelValue:t.boletos.emitidos,"onUpdate:modelValue":[l[0]||(l[0]=o=>t.boletos.emitidos=o),l[1]||(l[1]=o=>p.checkboxTodos("emitidos"))]},null,8,["modelValue"]),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>[r(u(t.boletos.emitidos?"Desmarcar Todos":"Marcar Todos"),1)]),_:1})]),r(" Boletos Emitidos ")]),_:1}),(d(!0),P(z,null,S((V=(C=t.boletos)==null?void 0:C.condicoesPagamento)==null?void 0:V.filter(o=>!o.disable&&o.codigoFinanceiroBoleto),(o,n)=>X((d(),c(v,{key:n,tag:"label"},{default:a(()=>[e(s,{side:""},{default:a(()=>[e(oe,{modelValue:o.checked,"onUpdate:modelValue":[m=>o.checked=m,l[2]||(l[2]=m=>p.checkboxTodos())]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[e(v,{class:"q-pa-none",style:{"min-height":"22px"}},{default:a(()=>[e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(o==null?void 0:o.descricao),1)]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,{class:"text-weight-medium text-center"},{default:a(()=>[F("span",null,[r(u(i.$filters.data(o==null?void 0:o.dataVencimento))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>[r(" Data de Vencimento ")]),_:1})])]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,{class:"text-weight-medium text-right"},{default:a(()=>[r(u(i.$filters.numero(o==null?void 0:o.valor,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(Y,{class:"q-mx-sm"}),e(f,{caption:""},{default:a(()=>{var m,k,y,E;return[F("span",He,u((m=o==null?void 0:o.banco)==null?void 0:m.descricao)+",",1),r(" Ag.: "),F("span",Ae,u((k=o==null?void 0:o.banco)==null?void 0:k.agencia)+",",1),r(" C/C: "),F("span",Qe,u((y=o==null?void 0:o.banco)==null?void 0:y.conta),1),F("span",Oe,[r(u(i.$filters.data((E=o==null?void 0:o.banco)==null?void 0:E.dataEmissao))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>{var N;return[r(" Emitido \xE1s "+u(i.$filters.hora((N=o==null?void 0:o.banco)==null?void 0:N.dataEmissao)),1)]}),_:2},1024)])]}),_:2},1024)]),_:2},1024)]),_:2},1024)),[[le]])),128))]}),_:1})):_("",!0),(I=(B=(j=t.boletos)==null?void 0:j.condicoesPagamento)==null?void 0:B.filter(C=>!C.disable&&!C.codigoFinanceiroBoleto))!=null&&I.length?(d(),c(J,{key:3,dense:"",highlight:"",bordered:"","rounded-borders":"",class:"q-pa-none q-mx-sm q-my-lg"},{default:a(()=>{var C,V;return[e(f,{header:"",class:"text-weight-medium"},{default:a(()=>[F("span",null,[e(oe,{modelValue:t.boletos.emitir,"onUpdate:modelValue":[l[3]||(l[3]=o=>t.boletos.emitir=o),l[4]||(l[4]=o=>p.checkboxTodos("emitir"))]},null,8,["modelValue"]),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>[r(u(t.boletos.emitir?"Desmarcar Todos":"Marcar Todos"),1)]),_:1})]),r(" Boletos a Emitir ")]),_:1}),e(v,{class:"q-pa-none"},{default:a(()=>[e(s,null,{default:a(()=>[e(ve,{modelValue:t.boletos.financeiroBanco,"onUpdate:modelValue":l[5]||(l[5]=o=>t.boletos.financeiroBanco=o),options:t.boletos.bancos,dense:"",filled:"",label:"Op\xE7\xF5es de Bancos",class:"q-field--with-bottom"},null,8,["modelValue","options"])]),_:1})]),_:1}),(d(!0),P(z,null,S((V=(C=t.boletos)==null?void 0:C.condicoesPagamento)==null?void 0:V.filter(o=>!o.disable&&!o.codigoFinanceiroBoleto),(o,n)=>X((d(),c(v,{key:n,tag:"label"},{default:a(()=>[e(s,{side:""},{default:a(()=>[e(oe,{modelValue:o.checked,"onUpdate:modelValue":[m=>o.checked=m,l[6]||(l[6]=m=>p.checkboxTodos())]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(o==null?void 0:o.descricao),1)]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,{class:"text-weight-medium text-center"},{default:a(()=>[F("span",null,[r(u(i.$filters.data(o==null?void 0:o.dataVencimento))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>[r(" Data de Vencimento ")]),_:1})])]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,{class:"text-weight-medium text-right"},{default:a(()=>[r(u(i.$filters.numero(o==null?void 0:o.valor,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[le]])),128))]}),_:1})):_("",!0),e(ge,{showing:(w=t.boletos)==null?void 0:w.loading},{default:a(()=>[e(ke,{size:"50px",color:"primary"})]),_:1},8,["showing"])]}),_:1})]),_:1}),e(ye,{class:"bg-light"},{default:a(()=>[e(ie,null,{default:a(()=>[e(Fe),X(e(U,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Z]]),e(U,{disable:!p.ativarBotaoEmissaoBoleto,type:"submit",label:"Imprimir",color:"primary",unelevated:""},null,8,["disable"])]),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"])}var Ue=ue(Se,[["render",Me]]);const Le={components:{FaturaModal:Pe,nfePrincipal:Ve,DocumentosFiscais:ze,ModalHistoricoStatus:De,EmitirBoletos:Ue},computed:{config(){return M.configuracoes.valores},mostrarOpcaoRemoverFatura(){return this.dados.fatura.status==="Aberta"&&!this.dados.vendas.length&&!this.dados.documentosEnvelope.length&&!this.dados.carnes.length&&!this.dados.condicaoPagamento.length}},data(){return{dbUsuario:M.usuario,width:0,dados:{fatura:{}},contatos:{},detalhesVisivel:!1,sistemaPai:"",configImpressaoCarne:[],configImpressaoConvenio:[],configImpressaoFatura:[],configImpressaoEnvelope:[],boletos:{visivel:!1,fatura:{},btnEmitirBoleto:!1},podeEditar:!1,mostrarBotaoEnviarAvaliacao:!1,mostrarBotaoEnviarPedidosProtheus:!1,mostrarBotaoEmitirCupom:!1}},emits:["executar","carregou","verificarListaLayout"],mixins:[Ce,xe],props:{id:{required:!0,type:String},layout:{type:String,default:"card"}},methods:{async enviarPedidosProtheus(i){await $db.fatura.enviarPedidosProtheus(i)},async removerFatura(){try{await new Promise((i,l)=>{this.$q.dialog({message:"Esta a\xE7\xE3o ir\xE1 remover esta fatura.",noRefocus:!0,preventClose:!0,title:"Tem certeza?",cancel:{label:"CANCELAR",push:!0,color:"tertiary",flat:!0},ok:{label:"CONTINUAR",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{i()}).onCancel(()=>{l()})})}catch{return}this.dados.fatura.id?(await M.fatura.remover(this.dados.fatura.id),this.$emit("executar","atualizar")):this.$q.notify("N\xE3o foi poss\xEDvel realizar a opera\xE7\xE3o")},abrirEmitirBoletos(i){this.boletos.visivel=!0,this.boletos.fatura=i},alternarDetalhes(i){this.detalhesVisivel=!this.detalhesVisivel,this.layout==="lista"&&this.$emit("verificarListaLayout",{id:i,acao:"detalhes",estado:this.detalhesVisivel})},async atualizar(){const i={},l=await M.fatura.leCompleto(this.id);if(l.vendas.sort((h,t)=>new Date(h.dataHoraFinalizado)<new Date(t.dataHoraFinalizado)?-1:1),l.documentosEnvelope.sort((h,t)=>new Date(h.dataHoraFinalizado)<new Date(t.dataHoraFinalizado)?-1:1),l.carnes.sort((h,t)=>new Date(h.dataVencimento)<new Date(t.dataVencimento)?-1:1),l.vendas)for(const h of l.vendas)i[h.idContatoVendedor]||(i[h.idContatoVendedor]=await M.contato.le({id:h.idContatoVendedor})),i[h.idContatoDigitador]||(i[h.idContatoDigitador]=await M.contato.le({id:h.idContatoDigitador}));if(l.documentosEnvelope)for(const h of l.documentosEnvelope)i[h.idContatoVendedor]||(i[h.idContatoVendedor]=await M.contato.le({id:h.idContatoVendedor})),i[h.idContatoDigitador]||(i[h.idContatoDigitador]=await M.contato.le({id:h.idContatoDigitador}));if(l.fatura.idContato){const h=l.fatura.idContato;i[h]||(i[h]=await M.contato.le({id:h}))}if(l.fatura.idEmpresa){const h=l.fatura.idEmpresa;i[h]||(i[h]=await M.contato.le({id:h}))}if(l.fatura){let h=[],t=[];for(const p of l.vendas)h.push(p.idContatoVendedor),t.push(p.idContatoDigitador);for(const p of l.documentosEnvelope)h.push(p.idContatoVendedor),t.push(p.idContatoDigitador);l.fatura.vendedores=[...new Set(h)],l.fatura.digitadores=[...new Set(t)]}this.contatos=i,this.dados=l,this.condicaoPagamento=l.condicaoPagamento,await this.resumeCondicaoPagamento();const q=(await M.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.podeEditar=!1,q.find(h=>h.id===l.fatura.idEmpresa)&&(this.podeEditar=!0),await this.configuraVisibilidadeBotoes(),await this.configuraVisibilidadeBtnBoletos(),await this.configuraImpressaoCarne(l.fatura.idEmpresa),await this.configuraImpressaoConvenio(l.fatura.idEmpresa),await this.configuraImpressaoEnvelope(l.fatura.idEmpresa),await this.configuraImpressaoFatura(l.fatura.idEmpresa),this.$nextTick(()=>{l.fatura.id===localStorage.getItem("idFatura")&&(this.podeEditar&&this.$refs.faturaModal.mostrar({id:this.dados.fatura.id}),localStorage.removeItem("idFatura"))})},editar(){this.$refs.faturaModal.mostrar({id:this.dados.fatura.id})},async executar(i){switch(i){case"atualizar":case"finalizar":case"retornarOrcamento":case"remover":this.$emit("executar","atualizar");return}await this.atualizar()},async sendReview(i){try{this.$q.loading.show();const l=[],q=this.contatos[i.idContato],h=await $api.bten.send(q,i);for(let t=0;t<h.length;t++){const p=h[t];p.status?l.push(p.telefone):this.$q.notifyError(`Falha ao enviar NPS para ${p.telefone}!`)}this.$q.loading.hide(),l.length&&this.$q.notifyPositive(`NPS enviado para ${l.join(",")}!`)}catch(l){if(l.name==="GeeksException"){this.$q.notifyAlert(l.message);return}this.$q.notifyError("N\xE3o foi possivel enviar NPS para o contato.",l)}finally{this.$q.loading.hide()}},fechouNFe(i){i&&$utils.emitter.emit("atualizarDocumentosFiscais")},async configuraImpressaoConvenio(i){const l=await M.configuracoes.porNome("impressao.convenio",i);this.configImpressaoConvenio=[...l.length?l.map(q=>({texto:"Imprimir Conv\xEAnio",...q})):[{valor:"convenio",texto:"Imprimir Conv\xEAnio"}]]},async configuraImpressaoCarne(i){const l=await M.configuracoes.porNome("impressao.carne",i);this.configImpressaoCarne=[...l.length?l.map(q=>({texto:"Imprimir Carn\xEA",...q})):[{valor:"carne-crediario",texto:"Reimprimir carn\xEA e notas promiss\xF3rias da fatura"}]]},async configuraImpressaoEnvelope(i){const l=await M.configuracoes.porNome("impressao.envelope",i);this.configImpressaoEnvelope=[...l.length?l.map(q=>({texto:"Imprimir Envelope",...q})):[{valor:"envelope",texto:"Imprimir Envelope"},{valor:"envelopeMini",texto:"Imprimir Envelope Mini"}]]},async configuraImpressaoFatura(i){const l=await M.configuracoes.porNome("impressao.fatura",i),q=[{valor:"invoice",texto:"Fatura (Invoice)"},{valor:"fatura-recibo",texto:"Recibo"}];this.sistemaPai==="optisoul"&&q.push({valor:"termoGarantia",texto:"Termo de Garantia"}),this.configImpressaoFatura=[...l.length?l.map(h=>({texto:"Imprimir Fatura",...h})):q]},async configuraVisibilidadeBotoes(){var h,t,p,x,D;let i,l,q;i=await $db.configuracoes.leValorComFiltroEmpresa("integrador.idDispositivo",this.dados.fatura.idEmpresa),this.mostrarBotaoEmitirCupom=!!i,i=await $db.configuracoes.porNome("integracao.bten.business"),l=(t=(h=i[0])==null?void 0:h.valor)!=null?t:!1,i=await $db.configuracoes.porNome("integracao.bten.authorization"),q=(x=(p=i[0])==null?void 0:p.valor)!=null?x:!1,this.mostrarBotaoEnviarAvaliacao=l&&q,i=await $db.configuracoes.porNome("protheus.credentials"),this.mostrarBotaoEnviarPedidosProtheus=!!((D=i[0])!=null&&D.valor)&&!!this.dados.fatura.dataHoraFinalizado},async configuraVisibilidadeBtnBoletos(){var i,l,q,h,t,p,x,D;try{if((l=(i=this.dados)==null?void 0:i.fatura)!=null&&l.id){const H=[],A=await K().formaPagamento.toArray(),L=await K().empresa.where({idContato:(h=(q=this.dados)==null?void 0:q.fatura)==null?void 0:h.idEmpresa}).toArray();if(await(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:(p=(t=this.dados)==null?void 0:t.fatura)==null?void 0:p.id}})).forEach(w=>{const C=A.find(V=>V.id===w.idFormaPagamento&&V.tipo===99&&V.tipoFinanceiro==="T\xEDtulo em aberto");C&&H.push({descricao:C.descricao})}),!H.length)return;const R=[];await K().financeiroBanco.each(w=>{if(!!w.ativo){if(w.id==="7D07229E-B35E-42AA-A312-78313BE61B2F"){R.push(w);return}w.idEmpresa&&L.find(C=>C.id===w.idEmpresa)&&R.push(w)}});const j=[...new Set(R.map(w=>w.codigoBanco))],B=[];await K()._banco.each(w=>{j.find(C=>C===b.codigoBanco)&&B.push(w)});const I=[];for(const w of R){B.find(V=>V.codigoBanco===w.codigoBanco);I.push({codigoBanco:w.codigoBanco})}this.boletos.btnEmitirBoleto=!!((x=H||[])!=null&&x.length)&&!!((D=I||[])!=null&&D.length)}}catch(H){console.error("ERRO: ",H)}},onResize(){this.width=window.innerWidth}},async mounted(){this.sistemaPai=Be(),await this.atualizar(),this.$emit("carregou")}},je={id:"FaturaCard"},Ge={class:"col-12 col-md-6 q-pl-none"},Je={class:"q-item-section"},We={class:"col-3 col-md hideonmobile"},Xe={class:"text-left q-my-none"},Ke={class:"col-3 col-md hideonmobile"},Ye={class:"text-left q-my-none"},Ze={class:"col-6 col-md hideonmobile"},$e={class:"text-right text-h5 text-positive text-weight-bold q-my-none"},ea={class:"text-right text-weight-normal text-tertiary text-body2 q-my-none"},aa={class:"col-12 col-md-6"},ta={class:"col-12 col-md-6 full-height items-end hideonmobile"},oa={class:"col-6"},la={class:"text-left q-my-none hideondesktop"},ia={class:"text-left q-my-none"},sa={class:"col-6"},ra={class:"text-right text-weight-normal text-tertiary text-body2 q-my-none"},na={class:"text-right text-h5 text-positive text-weight-bold q-my-none"},da={class:"col-12 full-height items-end"},ua={class:"col-12 col-md-6"},ma={class:"text-subtitle1 text-weight-bold q-ma-none items-center"},fa={class:"col-12 col-md-4"},ca=F("p",{class:"text-subtitle1 text-weight-bold q-ma-none"}," Faturamento ",-1),pa={class:"q-ma-none"},ha={class:"col-12 col-md-2 text-right"},ba=F("p",{class:"text-subtitle1 text-weight-bold q-ma-none"}," Desconto ",-1),_a={class:"q-ma-none"},va={class:"mw80 text-center"},ga={style:{"margin-left":"14px"}},ka={style:{"margin-left":"14px"}},ya={class:"float-right text-weight-medium text-right q-ml-sm",style:{"min-width":"70px"}},Fa=F("span",{class:"text-weight-medium q-pr-sm"},"Obs.:",-1);function wa(i,l,q,h,t,p){const x=W("avatar"),D=W("badge"),H=W("BadgeCopiarUid"),A=W("row"),L=W("documentos-fiscais"),O=W("g-label"),R=W("g-col"),j=W("DocumentosFiscais"),B=W("g-row"),I=W("fatura-modal"),w=W("modal-historico-status"),C=W("nfePrincipal"),V=W("EmitirBoletos");return d(),P("div",je,[q.layout==="card"?(d(),P(z,{key:0},[t.dados.fatura.id?(d(),c(Ee,{key:0,class:"extratoItem bg-grey-1 q-pa-sm no-shadow"},{default:a(()=>[e(A,{class:"items-center q-mx-none q-px-none q-mb-sm"},{default:a(()=>[F("div",Ge,[e(ie,{class:"q-pa-none"},{default:a(()=>{var o,n,m,k,y,E;return[e(x,{imagem:(t.contatos[t.dados.fatura.idContato]||{}).imagem,rotulo:t.dados.fatura.descricaoContato,tamanho:"40",style:{float:"left"}},null,8,["imagem","rotulo"]),e(me,null,{default:a(()=>[F("div",Je,[e(f,null,{default:a(()=>[r(u((t.contatos[t.dados.fatura.idContato]||{}).apelido),1)]),_:1}),(t.contatos[t.dados.fatura.idContato]||{}).nome!==(t.contatos[t.dados.fatura.idContato]||{}).apelido?(d(),c(f,{key:0,caption:""},{default:a(()=>[r(u((t.contatos[t.dados.fatura.idContato]||{}).nome),1)]),_:1})):_("",!0)])]),_:1}),e(D,{rotulo:t.dados.fatura.status,cor:"tertiary",escuro:"",class:"q-mr-sm"},null,8,["rotulo"]),e(H,{id:(n=(o=t.dados)==null?void 0:o.fatura)==null?void 0:n.id,numero:(k=(m=t.dados)==null?void 0:m.fatura)==null?void 0:k.numero,cor:((E=(y=t.dados)==null?void 0:y.fatura)==null?void 0:E.status)==="Finalizada"?"positive":"tertiary",escuro:""},null,8,["id","numero","cor"])]}),_:1})]),F("div",We,[F("p",Xe,[t.dados.fatura.dataHoraEmissao?(d(),c(g,{key:0,name:"mdi-calendar-today "})):_("",!0),r(" "+u(i.$filters.data(t.dados.fatura.dataHoraEmissao))+" ",1),e(Q,null,{default:a(()=>[r(" Emiss\xE3o ")]),_:1})])]),F("div",Ke,[F("p",Ye,[t.dados.fatura.dataHoraFinalizado?(d(),c(g,{key:0,name:"mdi-calendar-check"})):_("",!0),r(" "+u(i.$filters.data(t.dados.fatura.dataHoraFinalizado))+" ",1),e(Q,null,{default:a(()=>[r(" Finalizado ")]),_:1})])]),F("div",Ze,[F("p",$e,u(i.$filters.numero(t.dados.fatura.totalDocumento,2)),1),F("p",ea,u(i.$filters.numero(t.dados.fatura.subTotal,2)),1)])]),_:1}),e(Y,{class:"hideondesktop q-mb-sm"}),e(A,{class:"q-mx-none q-px-none items-end"},{default:a(()=>[F("div",aa,[e(J,{class:"no-border text-tertiary"},{default:a(()=>[(d(!0),P(z,null,S(t.dados.vendas,o=>(d(),c(v,{key:o.id,class:"items-center q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:a(()=>[e(s,{avatar:"",class:"mw80"},{default:a(()=>[e(f,null,{default:a(()=>[r(u(o.tipo)+" ",1),e(te,{dark:"",color:"tertiary",denso:"",round:""},{default:a(()=>[r("#"+u(parseInt(o.numero)||(o.id||"").slice(-6)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(i.$filters.data(o.dataHoraFinalizado))+" - "+u((t.contatos[o.idContatoVendedor]||{}).apelido)+" ",1),e(Q,null,{default:a(()=>[r(" Data Finalizado - Vendedor ")]),_:1})]),_:2},1024)]),_:2},1024),e(s,{avatar:"",class:"mw50"},{default:a(()=>[e(te,{dark:"",rounded:"",color:"tertiary",denso:""},{default:a(()=>[r(u(o.status),1)]),_:2},1024)]),_:2},1024),e(s,{right:"",top:"",class:"mw50"},{default:a(()=>[e(f,null,{default:a(()=>[r(u(i.$filters.numero(o.totalDocumento,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(J,{class:"no-border text-tertiary"},{default:a(()=>[(d(!0),P(z,null,S(t.dados.documentosEnvelope,o=>(d(),c(v,{key:o.id,class:"items-center q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:a(()=>[e(s,{avatar:"",class:"mw80"},{default:a(()=>[e(f,null,{default:a(()=>[r(u(o.tipo)+" ",1),e(te,{dark:"",color:"tertiary",denso:"",round:""},{default:a(()=>[r("#"+u(parseInt(o.numero)||(o.id||"").slice(-6)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(i.$filters.data(o.dataHoraFinalizado))+" - "+u((t.contatos[o.idContatoVendedor]||{}).apelido)+" ",1),e(Q,null,{default:a(()=>[r(" Data Finalizado - Vendedor ")]),_:1})]),_:2},1024)]),_:2},1024),e(s,{avatar:"",class:"mw50"},{default:a(()=>[e(te,{dark:"",rounded:"",color:"tertiary",denso:""},{default:a(()=>[r(u(o.status),1)]),_:2},1024)]),_:2},1024),e(s,{right:"",top:"",class:"mw50"},{default:a(()=>[e(f,null,{default:a(()=>[r(u(i.$filters.numero(o.totalDocumento,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(J,{class:"no-border text-tertiary"},{default:a(()=>[(d(!0),P(z,null,S(t.dados.carnes,o=>(d(),c(v,{key:o.id,class:"q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:a(()=>[e(s,{avatar:"",class:"mw80"},{default:a(()=>[e(f,null,{default:a(()=>[r(" Carn\xEA "),e(te,{dark:"",color:"tertiary",denso:"",round:""},{default:a(()=>[r("#"+u((o.id||"").slice(-6)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(i.$filters.data(o.dataVencimento)),1)]),_:2},1024)]),_:2},1024),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(o.formaDePagamento),1)]),_:2},1024)]),_:2},1024),e(s,{right:"",top:""},{default:a(()=>[e(f,null,{default:a(()=>[r(u(i.$filters.numero(o.valorTotal,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),F("div",ta,[e(Y,{class:"hideondesktop q-mb-sm q-mt-xs"}),e(U,{rounded:"",dense:"",flat:"",icon:"more_vert",color:"tertiary",class:"no-shadow q-ma-xs",size:"md",style:{float:"right"}},{default:a(()=>[e($,null,{default:a(()=>[X((d(),c(J,{link:"",separator:""},{default:a(()=>[t.dados.fatura.id?(d(),c(v,{key:0,clickable:"",onClick:l[0]||(l[0]=o=>i.$refs.documentosFiscais.emitirCupom(t.dados.fatura.id))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Emitir cupom")]),_:1})]),_:1})]),_:1})):_("",!0),i.$utils.mapearStatus(t.dados.fatura).permiteNota?(d(),P(z,{key:1},[e(v,{clickable:"",onClick:l[1]||(l[1]=o=>i.emitirNFeV2({idFatura:t.dados.fatura.id},1,"Venda"))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("NFe de Sa\xEDda/Venda")]),_:1})]),_:1})]),_:1}),e(v,{clickable:"",onClick:l[2]||(l[2]=o=>i.emitirNFeV2({idFatura:t.dados.fatura.id},0,"Devolu\xE7\xE3o"))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("NFe de Entrada/Devolu\xE7\xE3o")]),_:1})]),_:1})]),_:1}),e(v,{clickable:"",onClick:l[3]||(l[3]=o=>i.emitirNFeV2({idFatura:t.dados.fatura.id},1,"Remessa"))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("NFe de Remessa")]),_:1})]),_:1})]),_:1})],64)):_("",!0),p.mostrarOpcaoRemoverFatura?(d(),c(v,{key:2,clickable:"",onClick:l[4]||(l[4]=o=>p.removerFatura())},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-trash-can"})]),_:1}),e(s,null,{default:a(()=>[r("Remover Fatura")]),_:1})]),_:1})):_("",!0),e(v,{clickable:"",onClick:l[5]||(l[5]=o=>i.$refs.modalHistoricoStatus.mostrar({idDocumento:t.dados.fatura.id}))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"history"})]),_:1}),e(s,null,{default:a(()=>[r("Hist\xF3rico do Status")]),_:1})]),_:1}),t.mostrarBotaoEnviarAvaliacao&&t.dados.fatura.status==="Finalizada"?(d(),c(v,{key:3,clickable:"",onClick:l[6]||(l[6]=o=>p.sendReview(t.dados.fatura))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-file-replace-outline"})]),_:1}),e(s,null,{default:a(()=>[r("Enviar Avalia\xE7\xE3o")]),_:1})]),_:1})):_("",!0),t.mostrarBotaoEnviarPedidosProtheus?(d(),c(v,{key:4,clickable:"",onClick:l[7]||(l[7]=o=>p.enviarPedidosProtheus(t.dados.fatura.id))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"send"})]),_:1}),e(s,null,{default:a(()=>[r("Enviar Pedidos - Protheus")]),_:1})]),_:1})):_("",!0)]),_:1})),[[Z]])]),_:1})]),_:1}),t.podeEditar?(d(),c(U,{key:0,rounded:"",dense:"",flat:"",icon:"edit",color:"primary",class:"no-shadow q-ma-xs",size:"md",onClick:p.editar,style:{float:"right"}},null,8,["onClick"])):_("",!0),e(U,{rounded:"",dense:"",flat:"",icon:"print",color:"primary",class:"no-shadow q-ma-xs",size:"md",style:{float:"right"}},{default:a(()=>[e($,null,{default:a(()=>[X((d(),c(J,{link:"",separator:""},{default:a(()=>{var o;return[(o=t.boletos)!=null&&o.btnEmitirBoleto?(d(),c(v,{key:0,clickable:"",onClick:l[8]||(l[8]=n=>{var m;return p.abrirEmitirBoletos((m=t.dados)==null?void 0:m.fatura)})},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-printer"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Emitir Boleto")]),_:1})]),_:1})]),_:1})):_("",!0),(d(!0),P(z,null,S(t.configImpressaoFatura,n=>(d(),c(v,{clickable:"",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t.sistemaPai==="optisoul"?(d(!0),P(z,{key:1},S(t.configImpressaoEnvelope,n=>(d(),c(v,{clickable:"",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):_("",!0),(d(!0),P(z,null,S(t.configImpressaoCarne,n=>(d(),c(v,{clickable:"",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(d(!0),P(z,null,S(t.configImpressaoConvenio,n=>(d(),c(v,{clickable:"",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})),[[Z]])]),_:1})]),_:1}),e(U,{rounded:"",dense:"",flat:"",icon:t.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down",size:"md",class:"no-shadow q-ma-xs",color:"tertiary",style:{float:"right"},onClick:p.alternarDetalhes},null,8,["icon","onClick"])])]),_:1}),e(Y,{class:"hideondesktop q-mb-sm q-mt-xs"}),e(A,{class:"hideondesktop"},{default:a(()=>[F("div",oa,[F("p",la,[t.dados.fatura.dataHoraEmissao?(d(),c(g,{key:0,name:"mdi-calendar-today"})):_("",!0),r(" "+u(i.$filters.data(t.dados.fatura.dataHoraEmissao))+" ",1),e(Q,null,{default:a(()=>[r(" Emiss\xE3o ")]),_:1})]),F("p",ia,[t.dados.fatura.dataHoraFinalizado?(d(),c(g,{key:0,name:"mdi-calendar-check"})):_("",!0),r(" "+u(i.$filters.data(t.dados.fatura.dataHoraFinalizado))+" ",1),t.dados.fatura.dataHoraFinalizado?(d(),c(Q,{key:1},{default:a(()=>[r(" Finalizado ")]),_:1})):_("",!0)])]),F("div",sa,[F("p",ra,u(i.$filters.numero(t.dados.fatura.subTotal,2)),1),F("p",na,u(i.$filters.numero(t.dados.fatura.totalDocumento,2)),1)]),F("div",da,[e(Y,{class:"hideondesktop q-mb-sm q-mt-xs"}),e(U,{rounded:"",dense:"",flat:"",icon:"more_vert",color:"tertiary",class:"no-shadow q-ma-xs",size:"md",style:{float:"right"}},{default:a(()=>[e($,null,{default:a(()=>[X((d(),c(J,{link:"",separator:""},{default:a(()=>[t.mostrarBotaoEmitirCupom&&t.dados.fatura.id?(d(),c(v,{key:0,clickable:"",onClick:l[9]||(l[9]=o=>i.$refs.documentosFiscais.emitirCupom(t.dados.fatura.id))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Emitir cupom")]),_:1})]),_:1})]),_:1})):_("",!0),i.$utils.mapearStatus(t.dados.fatura).permiteNota?(d(),P(z,{key:1},[e(v,{clickable:"",onClick:l[10]||(l[10]=o=>i.emitirNFeV2({idFatura:t.dados.fatura.id},1,"Venda"))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("NFe de Sa\xEDda/Venda")]),_:1})]),_:1})]),_:1}),e(v,{clickable:"",onClick:l[11]||(l[11]=o=>i.emitirNFeV2({idFatura:t.dados.fatura.id},0,"Devolu\xE7\xE3o"))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("NFe de Entrada/Devolu\xE7\xE3o")]),_:1})]),_:1})]),_:1}),e(v,{clickable:"",onClick:l[12]||(l[12]=o=>i.emitirNFeV2({idFatura:t.dados.fatura.id},1,"Remessa"))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("NFe de Remessa")]),_:1})]),_:1})]),_:1})],64)):_("",!0),p.mostrarOpcaoRemoverFatura?(d(),c(v,{key:2,clickable:"",onClick:l[13]||(l[13]=o=>p.removerFatura())},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-trash-can"})]),_:1}),e(s,null,{default:a(()=>[r("Remover Fatura")]),_:1})]),_:1})):_("",!0),e(v,{clickable:"",onClick:l[14]||(l[14]=o=>i.$refs.modalHistoricoStatus.mostrar({idDocumento:t.dados.fatura.id}))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"history"})]),_:1}),e(s,null,{default:a(()=>[r("Hist\xF3rico do Status")]),_:1})]),_:1}),t.mostrarBotaoEnviarAvaliacao&&t.dados.fatura.status==="Finalizada"?(d(),c(v,{key:3,clickable:"",onClick:l[15]||(l[15]=o=>p.sendReview(t.dados.fatura))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-file-replace-outline"})]),_:1}),e(s,null,{default:a(()=>[r("Enviar Avalia\xE7\xE3o")]),_:1})]),_:1})):_("",!0),t.mostrarBotaoEnviarPedidosProtheus?(d(),c(v,{key:4,clickable:"",onClick:l[16]||(l[16]=o=>p.enviarPedidosProtheus(t.dados.fatura.id))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"send"})]),_:1}),e(s,null,{default:a(()=>[r("Enviar Pedidos - Protheus")]),_:1})]),_:1})):_("",!0)]),_:1})),[[Z]])]),_:1})]),_:1}),t.podeEditar?(d(),c(U,{key:0,rounded:"",dense:"",flat:"",icon:"edit",color:"primary",class:"no-shadow q-ma-xs",size:"md",onClick:p.editar,style:{float:"right"}},null,8,["onClick"])):_("",!0),e(U,{rounded:"",dense:"",flat:"",icon:"print",color:"primary",class:"no-shadow q-ma-xs",size:"md",style:{float:"right"}},{default:a(()=>[e($,null,{default:a(()=>[e(J,{link:"",separator:""},{default:a(()=>{var o;return[(o=t.boletos)!=null&&o.btnEmitirBoleto?(d(),c(v,{key:0,clickable:"",onClick:l[17]||(l[17]=n=>{var m;return p.abrirEmitirBoletos((m=t.dados)==null?void 0:m.fatura)})},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-printer"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Emitir Boleto")]),_:1})]),_:1})]),_:1})):_("",!0),(d(!0),P(z,null,S(t.configImpressaoFatura,n=>(d(),c(v,{clickable:"",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t.sistemaPai==="optisoul"?(d(!0),P(z,{key:1},S(t.configImpressaoEnvelope,n=>(d(),c(v,{clickable:"",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):_("",!0),(d(!0),P(z,null,S(t.configImpressaoCarne,n=>(d(),c(v,{clickable:"",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(d(!0),P(z,null,S(t.configImpressaoConvenio,n=>(d(),c(v,{clickable:"",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})]),_:1}),e(U,{rounded:"",dense:"",flat:"",icon:t.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down",size:"md",class:"no-shadow q-ma-xs",color:"tertiary",style:{float:"right"},onClick:p.alternarDetalhes},null,8,["icon","onClick"])])]),_:1}),t.detalhesVisivel?(d(),c(Y,{key:0,class:"hideondesktop q-my-sm"})):_("",!0),X(e(A,{class:"items-start q-mx-none q-px-none q-mt-md"},{default:a(()=>[F("div",ua,[F("p",ma,[e(g,{name:"business"}),r(" "+u(t.dados.fatura.descricaoEmpresa),1)]),e(L,{ref:"documentosFiscais",idFatura:t.dados.fatura.id},null,8,["idFatura"])]),F("div",fa,[ca,F("p",pa,u(t.dados.fatura.observacaoFaturamento),1),e(J,{class:"no-border"},{default:a(()=>[(d(!0),P(z,null,S(i.condicaoPagamentoResumo,o=>(d(),c(v,{key:o.id,class:"q-pa-none row",style:{"min-height":"auto"}},{default:a(()=>[e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(o.formaPagamento),1)]),_:2},1024)]),_:2},1024),e(s,{class:"text-right"},{default:a(()=>[e(f,null,{default:a(()=>[r(u(i.$filters.numero(o.valor,2))+u(o.parcelas>1?` (em ${o.parcelas}x)`:""),1)]),_:2},1024)]),_:2},1024),e(s,{right:""},{default:a(()=>[e(f,null,{default:a(()=>[r(u(i.$filters.data(o.dataVencimento)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),F("div",ha,[ba,F("p",_a,u(i.$filters.numero(t.dados.fatura.totalDesconto,2)),1)])]),_:1},512),[[ne,t.detalhesVisivel]])]),_:1})):_("",!0)],64)):_("",!0),q.layout==="lista"?(d(),P(z,{key:1},[e(qe,{onResize:p.onResize},null,8,["onResize"]),t.dados.fatura.id?(d(),c(v,{key:0,clickable:"","manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:a(()=>[e(s,{class:"hideonmobile col-auto q-pr-sm no-margin"},{default:a(()=>{var o,n,m,k,y,E;return[F("div",va,[e(H,{id:(n=(o=t.dados)==null?void 0:o.fatura)==null?void 0:n.id,numero:(k=(m=t.dados)==null?void 0:m.fatura)==null?void 0:k.numero,cor:((E=(y=t.dados)==null?void 0:y.fatura)==null?void 0:E.status)==="Finalizada"?"positive":"tertiary",escuro:""},null,8,["id","numero","cor"])])]}),_:1}),e(s,{class:"col-md col-lg col-xl no-margin"},{default:a(()=>[e(v,{class:"q-pa-none"},{default:a(()=>[e(s,{onClick:l[18]||(l[18]=o=>p.editar()),class:"col-auto items-center"},{default:a(()=>{var o,n,m,k,y;return[e(x,{imagem:(m=t.contatos[(n=(o=t.dados)==null?void 0:o.fatura)==null?void 0:n.idContato]||{})==null?void 0:m.imagem,tamanho:"40",rotulo:(y=(k=t.dados)==null?void 0:k.fatura)==null?void 0:y.descricaoContato,style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]}),_:1}),e(s,{onClick:l[19]||(l[19]=o=>p.editar()),class:"col"},{default:a(()=>{var o,n,m;return[e(f,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:a(()=>{var k,y,E;return[F("span",null,[r(u((E=t.contatos[(y=(k=t.dados)==null?void 0:k.fatura)==null?void 0:y.idContato]||{})==null?void 0:E.apelido)+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>[r("Cliente")]),_:1})])]}),_:1}),e(f,{caption:"",class:"hideondesktop"},{default:a(()=>{var k,y,E,N,T,G;return[e(H,{id:(y=(k=t.dados)==null?void 0:k.fatura)==null?void 0:y.id,numero:(N=(E=t.dados)==null?void 0:E.fatura)==null?void 0:N.numero,cor:((G=(T=t.dados)==null?void 0:T.fatura)==null?void 0:G.status)==="Finalizada"?"positive":"tertiary",escuro:"",class:"q-mr-sm"},null,8,["id","numero","cor"])]}),_:1}),t.contatos[t.dados.fatura.idEmpresa]?(d(),c(f,{key:0,caption:"",lines:"2"},{default:a(()=>{var k,y;return[F("span",null,[e(g,{name:"business"}),r(" "+u(((k=t.contatos[t.dados.fatura.idEmpresa])==null?void 0:k.apelido)||((y=t.contatos[t.dados.fatura.idEmpresa])==null?void 0:y.nome))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>[r(" Empresa ")]),_:1})])]}),_:1})):_("",!0),(m=(n=(o=t.dados)==null?void 0:o.fatura)==null?void 0:n.vendedores)!=null&&m.length?(d(),c(f,{key:1,caption:"",lines:"2"},{default:a(()=>{var k,y,E;return[F("span",null,[e(g,{name:"mdi-account-tie"}),r(" "+u((E=(y=(k=t.dados)==null?void 0:k.fatura)==null?void 0:y.vendedores)==null?void 0:E.map(N=>{var T;return(T=t.contatos[N])==null?void 0:T.apelido}).filter(Boolean).join(", "))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>{var N,T,G;return[r(u(((G=(T=(N=t.dados)==null?void 0:N.fatura)==null?void 0:T.vendedores)==null?void 0:G.length)>1?"Vendedores":"Vendedor"),1)]}),_:1})])]}),_:1})):_("",!0),e(s,{class:"hideondesktop q-mt-sm"},{default:a(()=>[e(v,{class:"q-pa-none",style:{"min-height":"36px!important"}},{default:a(()=>[e(s,{top:"",class:"col-5 no-margin"},{default:a(()=>{var k,y,E,N;return[(y=(k=t.dados)==null?void 0:k.fatura)!=null&&y.dataHoraEmissao?(d(),c(f,{key:0,caption:""},{default:a(()=>{var T,G;return[e(g,{name:"mdi-calendar-today",style:{position:"absolute","margin-top":"2px"}}),F("span",ga,u(i.$filters.data((G=(T=t.dados)==null?void 0:T.fatura)==null?void 0:G.dataHoraEmissao)),1)]}),_:1})):_("",!0),(N=(E=t.dados)==null?void 0:E.fatura)!=null&&N.dataHoraFinalizado?(d(),c(f,{key:1,caption:""},{default:a(()=>{var T,G;return[e(g,{name:"mdi-calendar",style:{position:"absolute","margin-top":"2px"}}),F("span",ka,u(i.$filters.data((G=(T=t.dados)==null?void 0:T.fatura)==null?void 0:G.dataHoraFinalizado)),1)]}),_:1})):_("",!0)]}),_:1}),e(s,{top:"",class:"col-7 no-margin text-right"},{default:a(()=>{var k,y,E,N,T,G;return[(y=(k=t.dados)==null?void 0:k.fatura)!=null&&y.totalDocumento?(d(),c(f,{key:0,caption:"",class:"text-weight-bold"},{default:a(()=>{var ee,ae;return[r(u(i.$filters.numero((ae=(ee=t.dados)==null?void 0:ee.fatura)==null?void 0:ae.totalDocumento,2)),1)]}),_:1})):_("",!0),((N=(E=t.dados)==null?void 0:E.fatura)==null?void 0:N.subTotal)!==((G=(T=t.dados)==null?void 0:T.fatura)==null?void 0:G.totalDocumento)?(d(),c(f,{key:1,caption:""},{default:a(()=>{var ee,ae;return[r(u(i.$filters.numero((ae=(ee=t.dados)==null?void 0:ee.fatura)==null?void 0:ae.subTotal,2)),1)]}),_:1})):_("",!0)]}),_:1})]),_:1})]),_:1})]}),_:1})]),_:1})]),_:1}),e(s,{onClick:l[20]||(l[20]=o=>p.editar()),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:a(()=>{var o,n,m,k;return[(n=(o=t.dados)==null?void 0:o.fatura)!=null&&n.dataHoraEmissao?(d(),c(f,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:a(()=>{var y,E;return[F("span",null,[e(g,{name:"mdi-calendar-today"}),r(" "+u(i.$filters.data((E=(y=t.dados)==null?void 0:y.fatura)==null?void 0:E.dataHoraEmissao))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>{var N,T;return[r(" Emitido \xE0s "+u(i.$filters.hora((T=(N=t.dados)==null?void 0:N.fatura)==null?void 0:T.dataHoraEmissao)),1)]}),_:1})])]}),_:1})):_("",!0),(k=(m=t.dados)==null?void 0:m.fatura)!=null&&k.dataHoraFinalizado?(d(),c(f,{key:1,lines:"1",color:"tertiary",class:"ellipsis"},{default:a(()=>{var y,E;return[F("span",null,[e(g,{name:"mdi-calendar"}),r(" "+u(i.$filters.data((E=(y=t.dados)==null?void 0:y.fatura)==null?void 0:E.dataHoraFinalizado))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>{var N,T;return[r(" Finalizado \xE1s "+u(i.$filters.hora((T=(N=t.dados)==null?void 0:N.fatura)==null?void 0:T.dataHoraFinalizado)),1)]}),_:1})])]}),_:1})):_("",!0)]}),_:1}),e(s,{onClick:l[21]||(l[21]=o=>p.editar()),class:"hideonmobile maxw120 q-pl-sm no-margin"},{default:a(()=>{var o,n,m,k;return[(n=(o=t.dados)==null?void 0:o.fatura)!=null&&n.totalDocumento?(d(),c(f,{key:0,class:"text-weight-bold text-right"},{default:a(()=>{var y,E;return[F("span",null,[r(u(i.$filters.numero((E=(y=t.dados)==null?void 0:y.fatura)==null?void 0:E.totalDocumento,2))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>[r(" Total ")]),_:1})])]}),_:1})):_("",!0),(k=(m=t.dados)==null?void 0:m.fatura)!=null&&k.subTotal?(d(),c(f,{key:1,class:"text-caption text-right"},{default:a(()=>{var y,E;return[F("span",null,[r(u(i.$filters.numero((E=(y=t.dados)==null?void 0:y.fatura)==null?void 0:E.subTotal,2))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:a(()=>[r(" Subtotal ")]),_:1})])]}),_:1})):_("",!0)]}),_:1}),e(s,{class:"col-auto q-pl-sm no-margin"},{default:a(()=>[e(v,{class:"q-pa-none"},{default:a(()=>[e(s,{class:"hideonmobile no-margin"},{default:a(()=>[e(U,{onClick:l[22]||(l[22]=o=>{var n,m;return p.alternarDetalhes((m=(n=t.dados)==null?void 0:n.fatura)==null?void 0:m.id)}),round:"",flat:"",dense:"",size:"md",color:"tertiary",icon:t.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["icon"])]),_:1}),e(s,{class:"hideonmobile no-margin"},{default:a(()=>[t.podeEditar?(d(),c(U,{key:0,onClick:l[23]||(l[23]=o=>p.editar()),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""})):_("",!0)]),_:1}),e(s,{class:"hideonmobile no-margin"},{default:a(()=>[e(U,{icon:"print",size:"md",round:"",flat:"",dense:"",class:"hideonmobile"},{default:a(()=>[e($,null,{default:a(()=>[X((d(),c(J,{link:"","no-border":"",separator:""},{default:a(()=>{var o;return[(o=t.boletos)!=null&&o.btnEmitirBoleto?(d(),c(v,{key:0,onClick:l[24]||(l[24]=n=>{var m;return p.abrirEmitirBoletos((m=t.dados)==null?void 0:m.fatura)}),clickable:""},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-printer"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Emitir Boleto")]),_:1})]),_:1})]),_:1})):_("",!0),(d(!0),P(z,null,S(t.configImpressaoFatura,n=>(d(),c(v,{key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0"),clickable:""},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t.sistemaPai==="optisoul"?(d(!0),P(z,{key:1},S(t.configImpressaoEnvelope,n=>(d(),c(v,{clickable:"",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):_("",!0),(d(!0),P(z,null,S(t.configImpressaoCarne,n=>(d(),c(v,{key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0"),clickable:""},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(d(!0),P(z,null,S(t.configImpressaoConvenio,n=>(d(),c(v,{key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0"),clickable:""},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})),[[Z]])]),_:1})]),_:1})]),_:1}),e(s,{class:"no-margin"},{default:a(()=>[e(U,{icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:a(()=>[e($,null,{default:a(()=>[X((d(),c(J,{link:"","no-border":"",separator:""},{default:a(()=>{var o;return[t.podeEditar?(d(),c(v,{key:0,onClick:l[25]||(l[25]=n=>p.editar()),clickable:"",class:"hideondesktop"},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"edit"})]),_:1}),e(s,null,{default:a(()=>[r(" Editar ")]),_:1})]),_:1})):_("",!0),e(v,{onClick:l[26]||(l[26]=n=>{var m,k;return p.alternarDetalhes((k=(m=t.dados)==null?void 0:m.fatura)==null?void 0:k.id)}),clickable:"",class:"hideondesktop"},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:t.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])]),_:1}),e(s,null,{default:a(()=>[r(" Detalhes ")]),_:1})]),_:1}),t.dados.fatura.id?(d(),c(v,{key:1,clickable:"",onClick:l[27]||(l[27]=n=>i.$refs.documentosFiscais.emitirCupom(t.dados.fatura.id))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Emitir cupom")]),_:1})]),_:1})]),_:1})):_("",!0),i.$utils.mapearStatus(t.dados.fatura).permiteNota?(d(),c(v,{key:2,clickable:"",onClick:l[28]||(l[28]=n=>i.emitirNFeV2({idFatura:t.dados.fatura.id},1,"Venda"))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("NFe de Sa\xEDda/Venda")]),_:1})]),_:1})]),_:1})):_("",!0),i.$utils.mapearStatus(t.dados.fatura).permiteNota?(d(),c(v,{key:3,clickable:"",onClick:l[29]||(l[29]=n=>i.emitirNFeV2({idFatura:t.dados.fatura.id},0,"Devolu\xE7\xE3o"))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("NFe de Entrada/Devolu\xE7\xE3o")]),_:1})]),_:1})]),_:1})):_("",!0),i.$utils.mapearStatus(t.dados.fatura).permiteNota?(d(),c(v,{key:4,clickable:"",onClick:l[30]||(l[30]=n=>i.emitirNFeV2({idFatura:t.dados.fatura.id},1,"Remessa"))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"account_balance"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("NFe de Remessa")]),_:1})]),_:1})]),_:1})):_("",!0),p.mostrarOpcaoRemoverFatura?(d(),c(v,{key:5,clickable:"",onClick:l[31]||(l[31]=n=>p.removerFatura())},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-trash-can"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Remover Fatura")]),_:1})]),_:1})]),_:1})):_("",!0),e(v,{clickable:"",onClick:l[32]||(l[32]=n=>i.$refs.modalHistoricoStatus.mostrar({idDocumento:t.dados.fatura.id}))},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"history"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Hist\xF3rico do Status")]),_:1})]),_:1})]),_:1}),t.mostrarBotaoEnviarAvaliacao&&t.dados.fatura.status==="Finalizada"?(d(),c(v,{key:6,onClick:l[33]||(l[33]=n=>p.sendReview(t.dados.fatura)),clickable:""},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-file-replace-outline"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Enviar Avalia\xE7\xE3o")]),_:1})]),_:1})]),_:1})):_("",!0),(o=t.boletos)!=null&&o.btnEmitirBoleto?(d(),c(v,{key:7,clickable:"",onClick:l[34]||(l[34]=n=>{var m;return p.abrirEmitirBoletos((m=t.dados)==null?void 0:m.fatura)}),class:"hideondesktop"},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"mdi-printer"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r("Emitir Boleto")]),_:1})]),_:1})]),_:1})):_("",!0),(d(!0),P(z,null,S(t.configImpressaoFatura,n=>(d(),c(v,{key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0"),clickable:"",class:"hideondesktop"},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t.sistemaPai==="optisoul"?(d(!0),P(z,{key:8},S(t.configImpressaoEnvelope,n=>(d(),c(v,{clickable:"",class:"hideondesktop",key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0")},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):_("",!0),(d(!0),P(z,null,S(t.configImpressaoCarne,n=>(d(),c(v,{key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0"),clickable:"",class:"hideondesktop"},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(d(!0),P(z,null,S(t.configImpressaoConvenio,n=>(d(),c(v,{key:n.valor,onClick:m=>i.$imprimir(n.valor,(t.dados.fatura||{}).id||"0"),clickable:"",class:"hideondesktop"},{default:a(()=>[e(s,{avatar:""},{default:a(()=>[e(g,{name:"print"})]),_:1}),e(s,null,{default:a(()=>[e(f,null,{default:a(()=>[r(u(n.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})),[[Z]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):_("",!0),X(e(B,{gutter:"md-x lg-y"},{default:a(()=>[t.dados.fatura.totalDesconto?(d(),c(R,{key:0,col:"xs12"},{default:a(()=>[e(O,{caption:t.width<=992,text:"sub2 regular",class:de(["q-pr-sm",`${t.width<=992?"text-left":"text-right"}`])},{default:a(()=>[r(" Desconto: "),F("span",ya,u(i.$filters.numero(t.dados.fatura.totalDesconto,2)),1)]),_:1},8,["caption","class"])]),_:1})):_("",!0),e(R,{col:"xs12 md6",bordered:""},{default:a(()=>[t.dados.fatura.observacaoFaturamento||i.condicaoPagamentoResumo.length||t.dados.fatura.totalDesconto?(d(),c(O,{key:0,icon:`attach_money ${t.width<=992?"15px":"xs"} tertiary`,caption:t.width<=992,text:"sub2 medium",class:"q-mb-md"},{default:a(()=>[r(" Faturamento ")]),_:1},8,["icon","caption"])):_("",!0),t.dados.fatura.observacaoFaturamento?(d(),c(O,{key:1,text:"sub2 regular",class:"q-mb-md q-mx-xs",caption:t.width<=992},{default:a(()=>[Fa,r(" "+u(t.dados.fatura.observacaoFaturamento),1)]),_:1},8,["caption"])):_("",!0),i.condicaoPagamentoResumo.length?(d(),c(J,{key:2},{default:a(()=>[(d(!0),P(z,null,S(i.condicaoPagamentoResumo,o=>(d(),c(v,{key:o.id,class:de([`${i.condicaoPagamentoResumo.length>1?"border-bottom":""}`,"q-px-sm q-py-none q-mb-md"])},{default:a(()=>[e(s,null,{default:a(()=>[e(f,{class:"text-weight-medium",caption:t.width<=992},{default:a(()=>[r(u(o.formaPagamento),1)]),_:2},1032,["caption"]),e(s,{class:"hideondesktop"},{default:a(()=>[e(v,{class:"q-pa-none"},{default:a(()=>[e(s,{class:"maxw80 no-margin"},{default:a(()=>[e(f,{caption:"",class:"text-weight-medium"},{default:a(()=>[r(u(i.$filters.data(o.dataVencimento)),1)]),_:2},1024),e(f,{caption:""},{default:a(()=>[r(u(i.$filters.hora(o.dataVencimento)),1)]),_:2},1024)]),_:2},1024),e(s,{class:"no-margin"},{default:a(()=>[e(f,{class:"text-right text-weight-medium",caption:t.width<=992},{default:a(()=>[r(u(i.$filters.numero(o.valor,2)),1)]),_:2},1032,["caption"]),o.parcelas?(d(),c(f,{key:0,caption:"",class:"text-right"},{default:a(()=>[r(u(o.parcelas>1?`(${o.parcelas}x)`:""),1)]),_:2},1024)):_("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(s,{class:"maxw80 no-margin hideonmobile"},{default:a(()=>[e(f,{class:"text-weight-medium",caption:t.width<=992},{default:a(()=>[r(u(i.$filters.data(o.dataVencimento)),1)]),_:2},1032,["caption"]),e(f,{caption:""},{default:a(()=>[r(u(i.$filters.hora(o.dataVencimento)),1)]),_:2},1024)]),_:2},1024),e(s,{class:"maxw100 no-margin hideonmobile"},{default:a(()=>[e(f,{class:"text-right text-weight-medium",caption:t.width<=992},{default:a(()=>[r(u(i.$filters.numero(o.valor,2)),1)]),_:2},1032,["caption"]),o.parcelas?(d(),c(f,{key:0,caption:"",class:"text-right"},{default:a(()=>[r(u(o.parcelas>1?`(${o.parcelas}x)`:""),1)]),_:2},1024)):_("",!0)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})):_("",!0)]),_:1}),e(R,{col:"xs12 md6",bordered:""},{default:a(()=>[e(j,{idFatura:t.dados.fatura.id,ref:"documentosFiscais"},null,8,["idFatura"])]),_:1})]),_:1},512),[[ne,t.dados.fatura.id&&t.detalhesVisivel]]),t.dados.fatura.id?(d(),c(Y,{key:1})):_("",!0)],64)):_("",!0),e(I,{onExecutar:p.executar,ref:"faturaModal"},null,8,["onExecutar"]),e(w,{ref:"modalHistoricoStatus"},null,512),e(C,{onFechar:p.fechouNFe},null,8,["onFechar"]),e(V,{modelValue:t.boletos.visivel,"onUpdate:modelValue":l[35]||(l[35]=o=>t.boletos.visivel=o),fatura:t.boletos.fatura},null,8,["modelValue","fatura"])])}var Da=ue(Le,[["render",wa]]);export{Da as F};
