import{_ as R,r as y,au as I,o as b,d as g,w as o,f as e,L as Q,D as J,E as j,h as H,Q as _,e as P,i as G,k,t as T,H as $,G as N,q as K,n as D,F as z,s as A,as as O,R as L,av as S,bh as E,S as f,j as w,T as x,x as W,bF as X,C as B,em as Y,az as M,O as q,M as U,B as Z,l as ee}from"./index.9b156bba.js";import{L as oe}from"./Lista.e33ba20c.js";import"./QBtnDropdown.2d29d66b.js";import"./QBtnGroup.4d3a3d67.js";import"./QScrollArea.e1ed3c28.js";const v={habilitarSalvar:!0,habilitarVoltar:!0,idContato:"",somenteLeitura:!1,titulo:"Contato",visivel:!1},te={components:{},computed:{dataAberturaLabel(){return this.ehCPF?"Data Nascimento":this.ehCNPJ?"Data Abertura":"Data Nascimento/Data Abertura"},ehCPF(){var l;return((l=this.contato.numeroDocumentoNacional)==null?void 0:l.length)===14},ehCNPJ(){var l;return((l=this.contato.numeroDocumentoNacional)==null?void 0:l.length)===18},numeroDocumentoNacionalLabel(){return this.ehCPF?"CPF":this.ehCNPJ?"CNPJ":"CPF/CNPJ"},numeroDocumentoEstadualLabel(){return this.ehCPF?"RG":this.ehCNPJ?"Inscri\xE7\xE3o Estadual":"RG/IE"}},data(){return{contato:{},contatoCompletoOriginal:{},contatoEnderecos:[],contatoTelefones:[],enderecoTipos:[{label:"Principal",value:"Principal",icon:"star",color:"orange"},{label:"Cobran\xE7a",value:"Cobran\xE7a",icon:"attach_money"},{label:"Comercial",value:"Comercial",icon:"business"},{label:"Correspond\xEAncia",value:"Correspond\xEAncia",icon:"mail"},{label:"Entrega",value:"Entrega",icon:"local_shipping"},{label:"Instala\xE7\xE3o",value:"Instala\xE7\xE3o",icon:"build"},{label:"Residencial",value:"Residencial",icon:"store_mall_directory"},{label:"Outros",value:"Outros",icon:"location_city"}],model:{},telefoneTipos:[{label:"Principal",value:"Principal",color:"orange",icon:"star"},{label:"Comercial",value:"Comercial",color:"dark",icon:"phone"},{label:"Celular",value:"Celular",color:"dark",icon:"phone_iphone"},{label:"Fixo",value:"Fixo",color:"dark",icon:"phone"},{label:"WhatsApp",value:"WhatsApp",color:"positive",icon:"mdi-whatsapp",ix:"duo"}],validationRules:{}}},emits:["evento"],methods:{adicionarEndereco(){const l={id:$utils.uuid(),idContato:this.contato.id};this.contatoEnderecos.push(l),console.log(this.contatoEnderecos)},adicionarTelefone(){const l={id:$utils.uuid(),idContato:this.contato.id};this.contatoTelefones.push(l)},cfgValidationRules(){this.validationRules={required:[l=>!!l||"Campo obrigat\xF3rio"],numeroDocumentoNacional:[()=>{const l=(this.contato.numeroDocumentoNacional||"").replace(/\D/g,"");return l.trim()?$utils.validarDocumentoNacional(l)?!0:"Documento inv\xE1lido":!0}]}},async ehDocumentoNacionalExistente(){var l,a;for(const d of $db.contato.contatos){if(d.id===this.contato.id)continue;const h=(l=d.numeroDocumentoNacional)==null?void 0:l.replace(/\D/g,"");if(!!h&&((a=this.contato.numeroDocumentoNacional)==null?void 0:a.replace(/\D/g,""))===h)return new Promise((t,n)=>{$q.dialog({title:"Contato encontrado. Deseja utiliz\xE1-lo?",message:`
                <div style="width:40px;text-align:right;font-weight:bold;display:inline-block;margin-right:10px;">Nome</div>
                ${d.nome}
                <br />
                <div style="width:40px;text-align:right;font-weight:bold;display:inline-block;margin-right:10px;">${this.ehCPF?"CPF":"CNPJ"}</div>
                ${d.numeroDocumentoNacional}
              `,persistent:!0,html:!0,cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-info",textColor:"white",flat:!0}}).onOk(()=>{t(!0),this.$emit("evento","contatoEncontrado",d.id)}).onCancel(()=>{t(!0)})})}},enderecoIcone(l){const a=this.enderecoTipos.find(d=>d.label===l)||{};return{color:a.color||"dark",name:a.icon||"store_mall_directory",size:l==="Principal"?"18px":"24px"}},removerEndereco(l){this.contatoEnderecos=this.contatoEnderecos.filter(a=>a.id!==l)},removerTelefone(l){this.contatoTelefones=this.contatoTelefones.filter(a=>a.id!==l)},async salvar(){if(!!this.model.habilitarSalvar&&!await this.ehDocumentoNacionalExistente())try{$q.loading.show({message:"Salvando contato...",html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),await $db.contato.gravar({atual:{...this.contatoCompletoOriginal,contato:this.contato,telefone:this.contatoTelefones,endereco:this.contatoEnderecos},original:this.contatoCompletoOriginal}),this.$emit("evento","sucessoAoSalvar",this.contato.id),this.$q.notify({message:"Contato salvo",type:"positive"})}catch{this.$q.notify({message:"N\xE3o foi poss\xEDvel salvar o contato",type:"negative"})}finally{$q.loading.hide()}},async setup(){var t,n,c,r,m,p,C,s,i,u,F;const l={habilitarVoltar:(n=(t=this.modelValue)==null?void 0:t.habilitarVoltar)!=null?n:v==null?void 0:v.habilitarVoltar,somenteLeitura:(r=(c=this.modelValue)==null?void 0:c.somenteLeitura)!=null?r:v==null?void 0:v.somenteLeitura,titulo:(p=(m=this.modelValue)==null?void 0:m.titulo)!=null?p:v==null?void 0:v.titulo,visivel:(s=(C=this.modelValue)==null?void 0:C.visivel)!=null?s:v==null?void 0:v.visivel,habilitarSalvar:(u=(i=this.modelValue)==null?void 0:i.habilitarSalvar)!=null?u:v==null?void 0:v.habilitarSalvar};let a,d,h;if(l.habilitarSalvar=!l.somenteLeitura&&l.habilitarSalvar,(F=this.modelValue)!=null&&F.idContato){const V=await $db.contato.leCompletoV3(this.modelValue.idContato);this.contatoCompletoOriginal=$utils.clonarV2(V),a=V==null?void 0:V.contato,d=V==null?void 0:V.telefone,h=V==null?void 0:V.endereco}this.contato=a!=null?a:{id:$utils.uuid(),ativo:!0},this.contatoTelefones=d!=null?d:[],this.contatoEnderecos=h!=null?h:[],this.cfgValidationRules(),this.model=l},voltar(){!this.model.habilitarVoltar||(this.model.visivel=!1)}},props:{modelValue:{type:Object,required:!0}},watch:{modelValue(){this.setup()}},created(){this.setup()}};function ae(l,a,d,h,t,n){const c=y("BadgeCopiarUid"),r=y("g-col"),m=y("campo"),p=y("g-row"),C=y("g-label"),s=I("mask");return b(),g(B,{modelValue:t.model.visivel,"onUpdate:modelValue":a[5]||(a[5]=i=>t.model.visivel=i),maximized:"",persistent:"",onKeyup:X(n.voltar,["esc"])},{default:o(()=>[e(Q,{container:"",class:"bg-light"},{default:o(()=>[e(J,{onSubmit:n.salvar},{default:o(()=>[e(j,null,{default:o(()=>[e(H,{class:"bg-primary text-white"},{default:o(()=>[t.model.habilitarVoltar?(b(),g(_,{key:0,onClick:n.voltar,icon:"arrow_back",round:"",flat:"",dense:""},null,8,["onClick"])):P("",!0),e(G,null,{default:o(()=>[k(T(t.model.titulo),1)]),_:1}),t.model.habilitarSalvar?(b(),g(_,{key:1,label:"Salvar",type:"submit",unelevated:"",color:"white","text-color":"primary"})):P("",!0)]),_:1})]),_:1}),e($,{class:"u-container"},{default:o(()=>[e(p,{gutter:"md",mg:"md-y",bg:"bg-white","rounded-borders":""},{default:o(()=>[e(r,{col:"12",text:"right"},{default:o(()=>[e(c,{id:t.contato.id,numero:t.contato.codigoContato,cor:"positive"},null,8,["id","numero"])]),_:1}),e(r,{col:"12"},{default:o(()=>[e(m,{modelValue:t.contato.apelido,"onUpdate:modelValue":a[0]||(a[0]=i=>t.contato.apelido=i),somenteLeitura:t.model.somenteLeitura,rotulo:"Apelido",dense:""},null,8,["modelValue","somenteLeitura"])]),_:1}),e(r,{col:"12"},{default:o(()=>[e(m,{modelValue:t.contato.nome,"onUpdate:modelValue":a[1]||(a[1]=i=>t.contato.nome=i),somenteLeitura:t.model.somenteLeitura,rules:t.validationRules.required,rotulo:"Nome completo",dense:""},null,8,["modelValue","somenteLeitura","rules"])]),_:1}),e(r,{col:"12 sm"},{default:o(()=>[N(e(K,{label:n.numeroDocumentoNacionalLabel,class:"q-pb-xs",modelValue:t.contato.numeroDocumentoNacional,"onUpdate:modelValue":a[2]||(a[2]=i=>t.contato.numeroDocumentoNacional=i),dense:"",rules:t.validationRules.numeroDocumentoNacional,onBlur:n.ehDocumentoNacionalExistente,readonly:t.model.somenteLeitura},null,8,["label","modelValue","rules","onBlur","readonly"]),[[s,["###.###.###-##","##.###.###/####-##"]]])]),_:1}),e(r,{col:"12 sm"},{default:o(()=>[e(m,{modelValue:t.contato.numeroDocumentoEstadual,"onUpdate:modelValue":a[3]||(a[3]=i=>t.contato.numeroDocumentoEstadual=i),rotulo:n.numeroDocumentoEstadualLabel,dense:"",somenteLeitura:t.model.somenteLeitura},null,8,["modelValue","rotulo","somenteLeitura"])]),_:1}),e(r,{col:"12 sm"},{default:o(()=>[e(m,{modelValue:t.contato.dataAbertura,"onUpdate:modelValue":a[4]||(a[4]=i=>t.contato.dataAbertura=i),rotulo:n.dataAberturaLabel,dense:"",somenteLeitura:t.model.somenteLeitura},null,8,["modelValue","rotulo","somenteLeitura"])]),_:1})]),_:1}),e(p,{gutter:"md",mg:"md-b",bg:"bg-white","rounded-borders":""},{default:o(()=>[e(r,{col:"12"},{default:o(()=>[e(C,{text:"h6"},{default:o(()=>[k("Telefones")]),_:1})]),_:1}),e(r,{col:"12"},{default:o(()=>[(b(!0),D(z,null,A(t.contatoTelefones,i=>(b(),g(p,{key:i.id,gutter:"md",items:"center",mg:"md-b",bordered:"","rounded-borders":""},{default:o(()=>[e(r,{col:"12 sm"},{default:o(()=>[e(O,{modelValue:i.tipoTelefone,"onUpdate:modelValue":u=>i.tipoTelefone=u,readonly:t.model.somenteLeitura,options:t.telefoneTipos,"option-value":"value","option-label":"label","emit-value":"","map-options":"",dense:"",label:"Tipo"},{before:o(()=>[e(_,{flat:"",round:"",icon:(t.telefoneTipos.find(u=>u.value===i.tipoTelefone)||{}).icon||"star",color:"tertiary",size:"sm"},null,8,["icon"])]),option:o(u=>[e(L,S(E(u.itemProps)),{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(w,{name:u.opt.icon},null,8,["name"])]),_:2},1024),e(f,null,{default:o(()=>[e(x,{innerHTML:u.opt.label},null,8,["innerHTML"])]),_:2},1024)]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","readonly","options"])]),_:2},1024),e(r,{col:"12 sm"},{default:o(()=>[e(m,{modelValue:i.telefone,"onUpdate:modelValue":u=>i.telefone=u,rotulo:"Telefone",dense:"",somenteLeitura:t.model.somenteLeitura},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),e(r,{col:"grow sm"},{default:o(()=>[e(m,{modelValue:i.observacao,"onUpdate:modelValue":u=>i.observacao=u,rotulo:"Observa\xE7\xE3o",dense:"",somenteLeitura:t.model.somenteLeitura},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),t.model.somenteLeitura?P("",!0):(b(),g(r,{key:0,col:"shrink",text:"center"},{default:o(()=>[e(_,{onClick:u=>n.removerTelefone(i.id),icon:"delete",size:"md",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024))]),_:2},1024))),128))]),_:1}),t.model.somenteLeitura?P("",!0):(b(),g(r,{key:0,col:"12",text:"center",mg:"md-t-ng"},{default:o(()=>[e(_,{onClick:n.adicionarTelefone,icon:"add",label:"Telefone",size:"sm",outline:"",color:"positive"},null,8,["onClick"])]),_:1}))]),_:1}),e(p,{gutter:"md",mg:"md-b",bg:"bg-white","rounded-borders":""},{default:o(()=>[e(r,{col:"12"},{default:o(()=>[e(C,{text:"h6"},{default:o(()=>[k("Endere\xE7os")]),_:1})]),_:1}),e(r,{col:"12"},{default:o(()=>[(b(!0),D(z,null,A(t.contatoEnderecos,i=>(b(),g(p,{key:i.id,gutter:"md",items:"center",mg:"md-b",bordered:"","rounded-borders":""},{default:o(()=>[e(r,{col:"12 md3"},{default:o(()=>[e(O,{modelValue:i.grupo,"onUpdate:modelValue":u=>i.grupo=u,readonly:t.model.somenteLeitura,options:t.enderecoTipos,"option-value":"value","option-label":"label","emit-value":"","map-options":"",dense:"",label:"Grupo"},{before:o(()=>[e(w,W(n.enderecoIcone(i.grupo),{color:"tertiary",size:"xs",class:"q-mx-xs"}),null,16)]),option:o(u=>[e(L,S(E(u.itemProps)),{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(w,{name:u.opt.icon},null,8,["name"])]),_:2},1024),e(f,null,{default:o(()=>[e(x,{innerHTML:u.opt.label},null,8,["innerHTML"])]),_:2},1024)]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","readonly","options"])]),_:2},1024),e(r,{col:"12 sm4 md3"},{default:o(()=>[e(m,{modelValue:i.cep,"onUpdate:modelValue":u=>i.cep=u,somenteLeitura:t.model.somenteLeitura,rotulo:"CEP",dense:""},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),e(r,{col:"2 sm2 md2"},{default:o(()=>[e(m,{modelValue:i.uf,"onUpdate:modelValue":u=>i.uf=u,somenteLeitura:t.model.somenteLeitura,rotulo:"UF",dense:""},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),e(r,{col:"10 sm6 md4"},{default:o(()=>[e(m,{modelValue:i.municipio,"onUpdate:modelValue":u=>i.municipio=u,somenteLeitura:t.model.somenteLeitura,rotulo:"Munic\xEDpio",dense:""},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),e(r,{col:"12 sm9 md7"},{default:o(()=>[e(m,{modelValue:i.logradouro,"onUpdate:modelValue":u=>i.logradouro=u,somenteLeitura:t.model.somenteLeitura,rotulo:"Logradouro",dense:""},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),e(r,{col:"12 sm3 md2"},{default:o(()=>[e(m,{modelValue:i.numero,"onUpdate:modelValue":u=>i.numero=u,somenteLeitura:t.model.somenteLeitura,rotulo:"N\xFAmero",dense:""},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),e(r,{col:"12 sm6 md3"},{default:o(()=>[e(m,{modelValue:i.complemento,"onUpdate:modelValue":u=>i.complemento=u,somenteLeitura:t.model.somenteLeitura,rotulo:"Complemento",dense:""},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),e(r,{col:"12 sm6 md6"},{default:o(()=>[e(m,{modelValue:i.bairro,"onUpdate:modelValue":u=>i.bairro=u,somenteLeitura:t.model.somenteLeitura,rotulo:"Bairro",dense:""},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),e(r,{col:"grow md"},{default:o(()=>[e(m,{modelValue:i.pais,"onUpdate:modelValue":u=>i.pais=u,somenteLeitura:t.model.somenteLeitura,rotulo:"Pa\xEDs",dense:""},null,8,["modelValue","onUpdate:modelValue","somenteLeitura"])]),_:2},1024),t.model.somenteLeitura?P("",!0):(b(),g(r,{key:0,col:"shrink",text:"center"},{default:o(()=>[e(_,{onClick:u=>n.removerEndereco(i.id),icon:"delete",size:"md",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024))]),_:2},1024))),128))]),_:1}),t.model.somenteLeitura?P("",!0):(b(),g(r,{key:0,col:"12",text:"center",mg:"md-t-ng"},{default:o(()=>[e(_,{onClick:n.adicionarEndereco,icon:"add",label:"Endere\xE7o",size:"sm",outline:"",color:"positive"},null,8,["onClick"])]),_:1}))]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","onKeyup"])}var le=R(te,[["render",ae]]);const ie={components:{Lista:oe,ModalCriarContatoCompleto:le,Pupilometro:Y},data(){return{lista:[],pupilometro:{},propsModalCriarContatoCompleto:{},mostrar:{header:!0,barraTopo:!0,toolbarTitulo:!0,icone:"mdi-eye-settings-outline",titulo:"Pupil\xF4metro",buscar:!0,filtroAvancado:!1,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!1,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:""},busca:null,buscaAnterior:null,paginacao:null}},methods:{async irParaAtendimento(l){var h,t;const a=/^idEnvelope:/.test(l.referencia)?(h=l.referencia)==null?void 0:h.replace(/^idEnvelope:/,""):null;let d=/^idContato:/.test(l.referencia)?(t=l.referencia)==null?void 0:t.replace(/^idContato:/,""):null;if(a){const n=await $db.hibrido.le({table:"documento",id:a});d=n==null?void 0:n.idContato}this.$router.push({name:"Atendimento",params:{id:d||"0"}})},async abrir(l){$db.pupilometro.limpar();const a=async d=>{$db.pupilometro[d]=await $db.pupilometro.leFoto({id:l.id,tipoFoto:d})};await Promise.all([a("foto"),a("fotoOriginal")]),$db.pupilometro.medidas=l.json.medidas,this.pupilometro={visivel:!1,somenteLeitura:!0,avancar:"CartaoMedidas"},$db.pupilometro.medidas.tipo!=="Cart\xE3o"&&(this.pupilometro.avancar="Medidas"),this.pupilometro.visivel=!0},async atualizar(){var a,d;const l=$utils.logarIni("Pupil\xF4metroListar");await $tryLoading(async()=>{$db.hibrido.isOnline()?await this.atualizarOnline():await this.atualizarOffline(),this.atualizarFotosOnline()}),$utils.logarFim(l,(d=(a=this.paginacao)==null?void 0:a.total)!=null?d:1)},async atualizarOffline(){var l,a,d,h;try{$q.loading.show({message:"Carregando...",html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"});let t,n;(!this.paginacao||this.busca!==this.buscaAnterior)&&(this.buscaAnterior=this.busca,this.paginacao={atual:1,maximo:1,total:1,limite:15}),t=await $db.pupilometro.ler({termoBusca:this.busca,recordsPerPage:this.paginacao.limite,page:this.paginacao.atual}),this.paginacao.maximo=t.totalPages,this.paginacao.total=t.totalRecords,n=t.result;for(const c of n){let r,m,p,C,s;if(c.json=(a=JSON.parse((l=c.json)!=null?l:null))!=null?a:{},c.nome="Contato n\xE3o identificado",r=/^idEnvelope:/.test(c.referencia)?(d=c.referencia)==null?void 0:d.replace(/^idEnvelope:/,""):null,m=/^idContato:/.test(c.referencia)?(h=c.referencia)==null?void 0:h.replace(/^idContato:/,""):null,!(!r&&!m)){if(r){if(p=await $db.hibrido.le({table:"documento",id:r}),!(p!=null&&p.idContato))continue;m=p.idContato}C=(await $db.contato.ler({filtros:{id:m}})).data,s=C[0],s!=null&&s.nome&&(c.nome=s.nome)}}this.lista=n.sort((c,r)=>c.dataModificacao>r.dataModificacao?-1:1)}catch(t){console.log(t.message)}finally{$q.loading.hide()}},async atualizarOnline(){var l,a,d,h;try{$q.loading.show({message:"Carregando...",html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"});let t,n;(!this.paginacao||this.busca!==this.buscaAnterior)&&(this.buscaAnterior=this.busca,this.paginacao={atual:1,maximo:1,total:1,limite:15}),t=await $db.pupilometro.leListaCompleta({termoBusca:this.busca,recordsPerPage:this.paginacao.limite,page:this.paginacao.atual}),this.paginacao.maximo=t.totalPages,this.paginacao.total=t.total,n=t.data;for(const c of n){let r,m,p,C,s;if(c.json=(a=JSON.parse((l=c.Json)!=null?l:null))!=null?a:{},c.nome="Contato n\xE3o identificado",r=/^idEnvelope:/.test(c.Referencia)?(d=c.Referencia)==null?void 0:d.replace(/^idEnvelope:/,""):null,m=/^idContato:/.test(c.Referencia)?(h=c.Referencia)==null?void 0:h.replace(/^idContato:/,""):null,!(!r&&!m)){if(r){if(p=await $db.hibrido.le({table:"documento",id:r}),!(p!=null&&p.idContato))continue;m=p.idContato}C=(await $db.contato.ler({filtros:{id:m}})).data,s=C[0],s!=null&&s.nome&&(c.nome=s.nome)}}this.lista=n.sort((c,r)=>c.dataModificacao>r.dataModificacao?-1:1)}catch(t){console.log(t.message)}finally{$q.loading.hide()}},async atualizarFotosOnline(){try{for(const l of this.lista)l.foto=await $db.pupilometro.leFoto({id:l.id,tipoFoto:"foto"})}catch{console.error("Erro ao carregar fotos da lista",error)}},async eventoModalCriarContatoCompleto(l,a){l==="sucessoAoSalvar"&&await this.salvar(a),l==="contatoEncontrado"&&await this.salvar(a)},fechar(l=""){if(l==="fechar"&&(this.pupilometro={visivel:!1}),l==="abrirContato"){if(this.pupilometro.somenteLeitura){this.pupilometro={visivel:!1};return}this.pupilometro.somenteLeitura||(this.propsModalCriarContatoCompleto={visivel:!0})}},fecharOld(){if(this.pupilometro.somenteLeitura){this.pupilometro={visivel:!1};return}this.pupilometro.somenteLeitura||(this.propsModalCriarContatoCompleto={visivel:!0})},async criarClick(l){if($db.pupilometro.limpar(),l==="Cart\xE3o"){$db.pupilometro.medidas.tipo=l,$db.pupilometro.medidas.olhoDireito.centroOlho.top=345,$db.pupilometro.medidas.olhoDireito.centroOlho.left=255,$db.pupilometro.medidas.olhoEsquerdo.centroOlho.top=345,$db.pupilometro.medidas.olhoEsquerdo.centroOlho.left=450,$db.pupilometro.medidas.nariz.top=0,$db.pupilometro.medidas.nariz.left=0,$db.pupilometro.medidas.ponte=23,this.pupilometro={visivel:!0,somenteLeitura:!1,avancar:"CartaoFoto"},await this.$nextTick(),this.$refs.pupilometro.cartaoNovo();return}$db.pupilometro.medidas.tipo="Arma\xE7\xE3o",this.pupilometro={visivel:!0,somenteLeitura:!1,avancar:"TirarFoto"}},async salvar(l){try{$q.loading.show({message:"Salvando medidas...",html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),this.propsModalCriarContatoCompleto={visivel:!1};const a=$utils.uuid();await $db.hibrido.grava("json",{atual:{id:a,descricao:"Pupil\xF4metro",referencia:"idContato:"+l,json:JSON.stringify({medidas:$db.pupilometro.medidas})}});try{await Promise.all([$db.pupilometro.gravaFoto({base64:$db.pupilometro.foto,idPupilometro:a,tipoFoto:"foto"}),$db.pupilometro.gravaFoto({base64:$db.pupilometro.fotoOriginal,idPupilometro:a,tipoFoto:"fotoOriginal"})])}catch(d){this.$q.notifyError("N\xE3o foi poss\xEDvel salvar a foto",d)}this.pupilometro={visivel:!1},$q.notifyPositive("Medidas salvas com sucesso"),await this.atualizar()}catch(a){this.$q.notifyError("N\xE3o foi poss\xEDvel salvar as medidas",a)}finally{$q.loading.hide()}}},created(){this.atualizar()}},re={id:"PupilometrosLista"},ne={class:"mw80 text-center"};function se(l,a,d,h,t,n){const c=y("BadgeCopiarUid"),r=y("avatar"),m=y("Lista"),p=y("ModalCriarContatoCompleto"),C=y("Pupilometro");return b(),D("div",re,[e(m,{busca:t.busca,"onUpdate:busca":a[4]||(a[4]=s=>t.busca=s),onAtualizar:n.atualizar,onCriarClick:n.criarClick,lista:t.lista,paginacao:t.paginacao,mostrar:t.mostrar},{botaoNovo:o(()=>[e(_,{icon:"add",label:"Novo",color:"primary","text-color":"white",unelevated:"",class:"hideonmobile"},{default:o(()=>[e(M,null,{default:o(()=>[e(q,{link:"","no-border":"",separator:""},{default:o(()=>[N((b(),g(L,{onClick:a[0]||(a[0]=s=>n.criarClick("Presencial")),clickable:""},{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(w,{name:"add"})]),_:1}),e(f,null,{default:o(()=>[e(x,null,{default:o(()=>[k("Pupilometro (Arma\xE7\xE3o)")]),_:1})]),_:1})]),_:1})),[[U]]),N((b(),g(L,{onClick:a[1]||(a[1]=s=>n.criarClick("Cart\xE3o")),clickable:""},{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(w,{name:"add"})]),_:1}),e(f,null,{default:o(()=>[e(x,null,{default:o(()=>[k("Pupilometro (Cart\xE3o)")]),_:1})]),_:1})]),_:1})),[[U]])]),_:1})]),_:1})]),_:1}),e(_,{icon:"add",color:"primary","text-color":"white",round:"",unelevated:"",class:"hideondesktop"},{default:o(()=>[e(M,null,{default:o(()=>[e(q,{link:"","no-border":"",separator:""},{default:o(()=>[N((b(),g(L,{onClick:a[2]||(a[2]=s=>n.criarClick("Presencial")),clickable:""},{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(w,{name:"add"})]),_:1}),e(f,null,{default:o(()=>[e(x,null,{default:o(()=>[k("Pupilometro (Arma\xE7\xE3o)")]),_:1})]),_:1})]),_:1})),[[U]]),N((b(),g(L,{onClick:a[3]||(a[3]=s=>n.criarClick("Cart\xE3o")),clickable:""},{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(w,{name:"add"})]),_:1}),e(f,null,{default:o(()=>[e(x,null,{default:o(()=>[k("Pupilometro (Cart\xE3o)")]),_:1})]),_:1})]),_:1})),[[U]])]),_:1})]),_:1})]),_:1})]),itemLista:o(()=>[e(q,{bordered:"",class:"bg-white q-mb-xs rounded-borders"},{default:o(()=>[(b(!0),D(z,null,A(t.lista,s=>(b(),D("div",{key:s.id,class:"itemHover"},[e(L,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:o(()=>[e(f,{class:"hideonmobile col-auto q-pr-sm no-margin"},{default:o(()=>[Z("div",ne,[e(c,{id:s.id,numero:s.codigoJson,cor:"positive"},null,8,["id","numero"])])]),_:2},1024),e(f,{class:"col-xs no-margin"},{default:o(()=>[e(L,{class:"q-pa-none"},{default:o(()=>[e(f,{onClick:i=>n.abrir(s),class:"col-auto items-center cursor-pointer"},{default:o(()=>[s.foto?(b(),g(r,{key:0,imagem:s.foto,rotulo:s.nome,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])):P("",!0)]),_:2},1032,["onClick"]),e(f,{onClick:i=>n.abrir(s),class:"col cursor-pointer"},{default:o(()=>[e(x,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:o(()=>[k(T(s.nome),1)]),_:2},1024),e(x,{caption:"",lines:"1",class:"text-tertiary ellipsis"},{default:o(()=>[k(T(l.$filters.dataHora(s.dataCriacao)),1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),e(f,{class:"col-auto q-pl-sm no-margin"},{default:o(()=>[e(L,{class:"q-pa-none"},{default:o(()=>[e(f,{class:"q-pr-sm no-margin"},{default:o(()=>[e(_,{onClick:i=>n.abrir(s),icon:"mdi-eye-settings-outline",size:"md",color:"tertiary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024),e(f,{class:"q-pr-sm no-margin"},{default:o(()=>[e(_,{onClick:i=>n.irParaAtendimento(s),icon:"mdi-account-switch",size:"md",color:"tertiary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(ee)]))),128))]),_:1})]),_:1},8,["busca","onAtualizar","onCriarClick","lista","paginacao","mostrar"]),e(p,{modelValue:t.propsModalCriarContatoCompleto,"onUpdate:modelValue":a[5]||(a[5]=s=>t.propsModalCriarContatoCompleto=s),onEvento:n.eventoModalCriarContatoCompleto},null,8,["modelValue","onEvento"]),e(B,{modelValue:t.pupilometro.visivel,"onUpdate:modelValue":a[6]||(a[6]=s=>t.pupilometro.visivel=s),maximized:""},{default:o(()=>[e(Q,{class:"bg-light"},{default:o(()=>[e(C,{ref:"pupilometro",avancar:t.pupilometro.avancar,somenteLeitura:t.pupilometro.somenteLeitura,onFecharModal:n.fechar},null,8,["avancar","somenteLeitura","onFecharModal"])]),_:1})]),_:1},8,["modelValue"])])}var fe=R(ie,[["render",se]]);export{fe as default};
