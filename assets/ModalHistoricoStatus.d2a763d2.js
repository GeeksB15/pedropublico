import{_ as Q,Z as H,r as U,o as l,d as u,w as o,f as e,L as k,E as q,h as S,i as C,k as g,G as D,Q as T,M as V,H as B,I as E,B as m,O as L,n as b,F as w,s as N,l as A,e as h,R as I,S as x,T as y,t as d,j as F,C as $}from"./index.9b156bba.js";const M={components:{Avatar:H},computed:{dadosEncontrados(){return(this.dados.status||[]).length}},data(){return{dados:{status:[],contatos:{}},visivel:!1}},methods:{async exibirHistorico(c){var _,v,t;let i;try{i=setTimeout(()=>{$q.loading.show({message:"Carregando informa\xE7\xF5es...",boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"})},500);const n=await $db.documentoStatus.leHistoricoOnline(c);for(const s of n){const a=[];let r,p,f;!(s.cpfUsuario||((_=s.cpfUsuario)==null?void 0:_.replace(/\D/g,"")))||this.dados.contatos[s.cpfUsuario]||this.dados.contatos[(v=s.cpfUsuario)==null?void 0:v.replace(/\D/g,"")]||(r=s.cpfUsuario,p=await $erp().contato.where({numeroDocumentoNacional:r}).toArray(),Array.prototype.push.apply(a,p),r=(t=s.cpfUsuario)==null?void 0:t.replace(/\D/g,""),r&&r!==s.cpfUsuario&&(p=await $erp().contato.where({numeroDocumentoNacional:r}).toArray(),Array.prototype.push.apply(a,p)),f=a[0],f&&(this.dados.contatos[s.cpfUsuario]={nome:f.nome,imagem:f.imagem}))}this.dados.status=n}catch(n){this.$q.notify({type:"negative",message:n.message})}finally{clearTimeout(i),$q.loading.hide()}},async mostrar(c){const{idDocumento:i}=c;if(await this.exibirHistorico(i),!(this.dados.status||[]).length){this.$q.notify({type:"warning",message:"N\xE3o h\xE1 hist\xF3rico dispon\xEDvel."});return}this.visivel=!0},onHide(){this.dados={status:[],contatos:{}}}}},O={class:"layout-padding",container:""},P={class:"q-mr-sm"},R={class:"q-mr-md"};function j(c,i,_,v,t,n){const s=U("avatar");return l(),u($,{modelValue:t.visivel,"onUpdate:modelValue":i[0]||(i[0]=a=>t.visivel=a),onHide:n.onHide},{default:o(()=>[e(k,{view:"hHh LpR fFf",container:"",class:"bg-white"},{default:o(()=>[e(q,null,{default:o(()=>[e(S,null,{default:o(()=>[e(C,null,{default:o(()=>[g("Hist\xF3rico do Status")]),_:1}),D(e(T,{dense:"",flat:"",icon:"close",round:""},null,512),[[V]])]),_:1})]),_:1}),e(B,null,{default:o(()=>[e(E,null,{default:o(()=>[m("div",O,[n.dadosEncontrados?(l(),u(L,{key:0,"no-border":"",dense:"",class:"q-my-md"},{default:o(()=>[(l(!0),b(w,null,N(t.dados.status,(a,r)=>(l(),b(w,{key:a.codigoDocumentoStatus},[r?(l(),u(A,{key:0})):h("",!0),e(I,{class:"item-center q-my-sm"},{default:o(()=>[e(x,{avatar:""},{default:o(()=>[e(s,{imagem:(t.dados.contatos[a.cpfUsuario]||{}).imagem,rotulo:(t.dados.contatos[a.cpfUsuario]||{}).nome,tamanho:"40"},null,8,["imagem","rotulo"])]),_:2},1024),e(x,null,{default:o(()=>[a.observacao?(l(),u(y,{key:0,class:"text-body1 text-weight-regular text-black q-pb-sm"},{default:o(()=>[g(d(a.observacao),1)]),_:2},1024)):h("",!0),t.dados.contatos[a.cpfUsuario]?(l(),u(y,{key:1,caption:"",class:"q-pb-xs"},{default:o(()=>[m("strong",null,d((t.dados.contatos[a.cpfUsuario]||{}).nome),1)]),_:2},1024)):h("",!0),e(y,{class:"text-body2 text-weight-light text-black"},{default:o(()=>[m("span",P,d(a.statusOriginal),1),m("span",null,[e(F,{name:"east",color:"primary",class:"q-mr-sm"}),g(d(a.statusFinalizado),1)])]),_:2},1024),e(y,{class:"text-body2"},{default:o(()=>[m("span",R,d(c.$filters.data(a.dataHoraEmissao)),1),g(d(c.$filters.hora(a.dataHoraEmissao)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)],64))),128))]),_:1})):h("",!0)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onHide"])}var G=Q(M,[["render",j]]);export{G as M};
