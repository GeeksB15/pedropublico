import{_ as $,X as A,Y as P,r as h,o as f,n as b,f as o,w as a,R as N,S as g,j as k,k as r,B as d,O as R,F as B,s as I,T as c,d as F,aT as U,e as v,t as C,m as _,Q as L,l as O}from"./index.f2a220da.js";import{l as M}from"./listaV2.e27b952f.js";import{m as z}from"./ContatoModalFicha.77fb38c2.js";import{C as X}from"./ContatoCombinar.1ef0a848.js";import{X as x}from"./xlsx.ff88a118.js";import"./QBreadcrumbs.89e7e2ae.js";import"./ContatoFicha.c26c99c8.js";import"./Icone.9245dff5.js";import"./SeletorPais.407129f0.js";import"./open-url.108a4da6.js";const G={components:{lista:M,modalContatoFicha:z,Avatar:A,Badge:P,ContatoCombinar:X},computed:{titulo(){return this.$route.name==="FaturaB15Optidados"?"Fatura B-15 Optidados":this.$route.name==="FaturaB15"?"Fatura B-15":""}},data(){let t=new Date,e=new Date(new Date(new Date(new Date().setDate(1)).setHours(0,0,0,0)).setFullYear(t.getFullYear()-1)),s=new Date(new Date(new Date(t).setMonth(t.getMonth()+1)).setDate(0));return{lista:[],listaOriginal:[],listaLayout:{},contatoCombinar:!1,campos:{nome:"",apelido:"",numeroDocumentoNacional:"",telefone:"",cep:"",numero:""},paginacao:{atual:1,maximo:1,total:1,limite:25},filtros:{nome:null,apelido:null,numeroDocumentoNacional:null,periodo:{ini:e,fim:s}},buscaCampo:"",tabSelecionada:{valor:"EmAberto"},tabs:[{rotulo:"Em Aberto",value:"EmAberto"},{rotulo:"Finalizadas",value:"Finalizado"},{rotulo:"Todas",value:"Todos"}],msgRestricao:"",showAllPreviewDetail:!1,checkboxModel:!1}},methods:{async atualizar(){try{$q.loading.show();const t=$utils.eliminarVazios(this.filtros),e=new Date(this.filtros.periodo.ini).toISOString(),s=new Date(this.filtros.periodo.fim).toISOString(),p=JSON.parse(localStorage.getItem("usuario"));let l;delete t.ativo,this.tabSelecionada.valor==="Ativos"&&(t.ativo=!0),this.tabSelecionada.valor==="Excluidos"&&(t.ativo=!1),this.filtro={periodo:{ini:e,fim:s}},l=(await this.$utils.geeksApi({funcao:{funcao:"2A40FEB6-DCAF-4903-81AF-9ECC9477D03D",periodo:this.filtro.periodo,paginacao:{atual:this.paginacao.atual,limite:this.paginacao.limite},nome:this.filtros.nome||"",apelido:this.filtros.apelido||"",numeroDocumentoNacional:this.filtros.numeroDocumentoNacional||"",usuarioCpf:p.numeroDocumentoNacional,status:this.tabSelecionada.valor}})).data.funcao,this.listaLayout={};for(let n of l.data){const u=await $db.contato.leCompletoV3(n.id);u.detalhes=!1,u.remover=!1,u.ende=$db.contato.contatoBase().endereco[0],this.listaLayout[n.id]=u}this.listaOriginal=$utils.clonarV2(l.data),this.lista=l.data,this.paginacao.total=l.total,this.paginacao.maximo=l.totalPages}catch(t){$q.notifyError("Erro iniciar",t)}finally{$q.loading.hide()}},contatoCriarPorModal_click(){this.$refs.modalFicha.show({id:""})},limparFiltros_click(){this.filtros={tab:"Ativos",nome:null,apelido:null,numeroDocumentoNacional:null,telefone:null,cidade:null,uf:null,grupo:null,segmento:null,estoque:null,vendedor:null},this.atualizar()},checkBoxGeral_click(){for(let t of this.lista)this.listaLayout[t.id].remover=this.checkboxModel},async removerTodos(){$q.dialog({title:"Remover Contatos",message:"Deseja remover todos os contatos selecionados?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{for(let t of this.lista)if(this.listaLayout[t.id].remover){let e=$utils.clonarV2(t);t.ativo=!1;try{await $db.contato.gravar({original:{contato:e},atual:{contato:t}})}catch{$q.notify("Houve um erro ao remover os contatos. Tente novamente")}}})},async restaurarTodos(){$q.dialog({title:"Restaurar itens",message:"Deseja restaurar todos os itens selecionados?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{for(let t of this.lista)if(this.listaLayout[t.id].remover){let e=$utils.clonarV2(t);t.ativo=!0;try{await $db.contato.gravar({original:{contato:e},atual:{contato:t}})}catch{$q.notify("Houve um erro ao restaurar os itens. Tente novamente")}}})},async abrirDetalhesItem(t,e){var s,p;this.listaLayout[t.id].detalhes=e||!((s=this.listaLayout[t.id])!=null&&s.detalhes),(p=this.listaLayout[t.id])!=null&&p.detalhes&&await $db.contato.leCompleto(t.id)},abrirTodosPreview(){this.showAllPreviewDetail=!this.showAllPreviewDetail,this.lista.forEach(t=>{this.abrirDetalhesItem(t,this.showAllPreviewDetail)})},async exportarXLSX_click(){try{$q.loading.show();const t=$utils.eliminarVazios(this.filtros);delete t.ativo,this.tabSelecionada.valor==="Ativos"&&(t.ativo=!0),this.tabSelecionada.valaor==="Excluidos"&&(t.ativo=!1);const e=await $db.contato.leRefatorado({filtros:t,limit:999999,page:1,sort:"descricao"}),s=x.utils.book_new(),p=x.utils.json_to_sheet(e.data,{header:Object.keys(e.data[0])});x.utils.book_append_sheet(s,p,"contatos"),x.writeFile(s,"contatos.xlsx")}catch(t){$q.notifyError("Erro iniciar",t)}finally{$q.loading.hide()}},imprimirBoleto(t){JSON.parse(localStorage.getItem("usuario"));const e=JSON.parse(localStorage.getItem("clienteSistema"));if(e.bancoDeDados="B15App",e.versao="15A",this.$route.name==="FaturaB15Optidados"){let s=`https://rel.storage.b15.com.br/Relatorios/email.html?rid=${t.id.toString().replace(/-/g,"")}&CodigoFinanceiroBoleto=${t.CodigoFinanceiroBoleto}&NomeReport=boleto_layout_itau&URLServidor=https://api.b15.com.br/sql/srv210&Banco=${e.bancoDeDados}&CodigoUsuario=${188}&hfCodigoSistema={data:{ CodigoUsuario: ${188}, CodigoSistema: ${4}, CodigoClienteSistema: ${35}, Sistema: _GeeksInterno, Versao: ${e.versao}, URLServidor: https://api.b15.com.br/sql/srv210,BancoDeDados: ${e.bancoDeDados},CodigoCliente: ${14},Cliente: GEEKSSOLUESEMSOFTWARELTDA,Padrao: false,Administrador: true,GrupoInterno: ${e.grupoInterno}}}`.trim();window.open(s,"_blank")}if(this.$route.name==="FaturaB15"){let s=`https://rel.storage.b15.com.br/Relatorios/email.html?rid=${t.id.toString().replace(/-/g,"")}&CodigoFinanceiroBoleto=${t.CodigoFinanceiroBoleto}&NomeReport=boleto_layout_itau&URLServidor=https://api.b15.com.br/sql/srv210&Banco=${e.bancoDeDados}&CodigoUsuario=${188}&hfCodigoSistema={data:{ CodigoUsuario: ${188}, CodigoSistema: ${4}, CodigoClienteSistema: ${35}, Sistema: _GeeksInterno, Versao: ${e.versao}, URLServidor: https://api.b15.com.br/sql/srv210,BancoDeDados: ${e.bancoDeDados},CodigoCliente: ${14},Cliente: GEEKSSOLUESEMSOFTWARELTDA,Padrao: false,Administrador: true,GrupoInterno: ${e.grupoInterno}}}`.trim();window.open(s,"_blank")}},copiarCodigoBarras(t){const e=document.createElement("INPUT");e.value=t,e.type="text",document.body.appendChild(e);try{e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$q.notify({message:"Codigo de barras copiado para a \xE1rea de transfer\xEAncia.",type:"info"})}catch(s){this.$q.notifyError("Erro ao copiar Codigo de barras",s)}e.type="hidden",window.getSelection().removeAllRanges()}},async mounted(){var e;const t=await $utils.conduta.obter();this.msgRestricao=(e=t==null?void 0:t.restricao)!=null?e:"",this.atualizar()}},j={id:"Faturas15Lista"},H={class:"col-auto q-pl-none items-center"},J={class:"col"},W={class:"col-12"},Y={class:"text-tertiary q-col-gutter-xs"},K={key:1},Z={key:0,class:"q-pa-md showPreviewDetail"},ee={class:"col-12 q-mb-md"},oe={class:"col-12 col-md-3"},te={class:"col-12 col-md-3"},ae={class:"col-12 col-md"},le={key:1,class:"row q-px-md q-pb-md showPreviewDetail"};function ie(t,e,s,p,l,n){const u=h("campo"),w=h("badge"),m=h("row"),Q=h("avatar"),q=h("lista"),T=h("modalContatoFicha"),E=h("ContatoCombinar");return f(),b("div",j,[o(q,{titulo:n.titulo,onCriar_click:n.contatoCriarPorModal_click,onCheckBoxGeral_click:n.checkBoxGeral_click,icone:"attach_money",onFiltro_change:n.atualizar,onLimparFiltros_click:n.limparFiltros_click,onAbrirTodosPreview:n.abrirTodosPreview,onExportarXLSX_click:n.exportarXLSX_click,onRemoverTodos:n.removerTodos,onRestaurarTodos:n.restaurarTodos,tabSelecionada:l.tabSelecionada,tabs:l.tabs,lista:l.lista,listaLayout:l.listaLayout,paginacao:l.paginacao,filtros:l.filtros,buscaCampo:l.buscaCampo,"onUpdate:buscaCampo":e[8]||(e[8]=i=>l.buscaCampo=i),checkboxModel:l.checkboxModel,"onUpdate:checkboxModel":e[9]||(e[9]=i=>l.checkboxModel=i),abrirTodosVisible:!1,exportarXLSXVisible:!1,permissaoExtras:!1,removerTodosVisible:!1,checkboxVisible:!1,permissaoNovo:!1,bannerMsg:l.msgRestricao},{menuExtras:a(()=>[o(N,{clickable:"",onClick:e[0]||(e[0]=()=>{this.contatoCombinar=!0})},{default:a(()=>[o(g,{avatar:""},{default:a(()=>[o(k,{name:"compare_arrows",size:"sm"})]),_:1}),o(g,null,{default:a(()=>e[11]||(e[11]=[r("Combinar")])),_:1})]),_:1})]),filtroCampos:a(()=>[o(u,{modelValue:l.filtros.nome,"onUpdate:modelValue":e[1]||(e[1]=i=>l.filtros.nome=i),rotulo:"Nome/Raz\xE3o",dense:""},null,8,["modelValue"]),o(u,{modelValue:l.filtros.apelido,"onUpdate:modelValue":e[2]||(e[2]=i=>l.filtros.apelido=i),rotulo:"Apelido/Fantasia",dense:""},null,8,["modelValue"]),o(u,{modelValue:l.filtros.numeroDocumentoNacional,"onUpdate:modelValue":e[3]||(e[3]=i=>l.filtros.numeroDocumentoNacional=i),rotulo:"CPF/CNPJ",dense:""},null,8,["modelValue"]),e[12]||(e[12]=d("p",null,null,-1)),e[13]||(e[13]=d("span",{class:"col-12 text-body1 text-dark"},"Per\xEDodo",-1)),o(u,{modelValue:l.filtros.periodo.ini,"onUpdate:modelValue":e[4]||(e[4]=i=>l.filtros.periodo.ini=i),tipo:"data",class:"no-shadow full-width",rotulo:"De",col:"12",after:[{icon:"mdi-close-circle",handler(){l.filtros.periodo.ini=""}}],dense:""},null,8,["modelValue","after"]),o(u,{modelValue:l.filtros.periodo.fim,"onUpdate:modelValue":e[5]||(e[5]=i=>l.filtros.periodo.fim=i),tipo:"data",class:"no-shadow full-width",rotulo:"at\xE9",col:"12",after:[{icon:"mdi-close-circle",handler(){l.filtros.periodo.fim=""}}],dense:""},null,8,["modelValue","after"]),e[14]||(e[14]=d("p",null,null,-1)),o(u,{modelValue:l.paginacao.limite,"onUpdate:modelValue":e[6]||(e[6]=i=>l.paginacao.limite=i),min:"1",rotulo:"Quantidade por p\xE1gina",tipo:"quantidade",dense:""},null,8,["modelValue"])]),itemLista:a(()=>[o(R,{class:"rounded-borders"},{default:a(()=>[(f(!0),b(B,null,I(l.lista,i=>{var V,S;return f(),b("div",{key:i,class:"itemHover fullWidth"},[o(N,{"manual-focus":"",clickable:"",class:"items-center d-flex q-pa-xs"},{default:a(()=>[o(g,{avatar:"",center:"",class:"mw120 hideonmobile"},{default:a(()=>[o(c,null,{default:a(()=>[o(m,{class:"items-center"},{default:a(()=>[v("",!0),d("p",null,[o(w,{class:"q-mr-sm",escuro:"",cor:"positive"},{default:a(()=>[r(" #"+C(parseInt(i.numero)||(i.id||"").slice(-6)),1)]),_:2},1024)])]),_:2},1024)]),_:2},1024)]),_:2},1024),o(g,{clickable:""},{default:a(()=>[o(m,{class:"items-center q-col-gutter-x-sm"},{default:a(()=>[o(U,{modelValue:l.checkboxModel,"onUpdate:modelValue":e[7]||(e[7]=y=>l.checkboxModel=y),class:"q-ma-none q-pa-none hideondesktop"},null,8,["modelValue"]),d("div",H,[o(Q,{imagem:i.photo,tamanho:"40",rotulo:i.nome,style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]),d("div",J,[o(c,{class:"text-tertiary text-weight-bold"},{default:a(()=>[r(C(i.Cliente),1)]),_:2},1024),o(c,{caption:"",class:"text-tertiary"},{default:a(()=>[r(C(i.nome),1)]),_:2},1024),o(m,{class:"hideondesktop items-center q-my-sm"},{default:a(()=>[d("div",W,[o(w,{class:"q-mr-sm",escuro:"",cor:"positive"},{default:a(()=>e[15]||(e[15]=[r("#0001")])),_:1})])]),_:1})])]),_:2},1024)]),_:2},1024),o(g,null,{default:a(()=>[o(c,{class:"text-tertiary"},{default:a(()=>[o(m,null,{default:a(()=>[o(k,{class:"text-tertiary",name:"today"}),o(c,null,{default:a(()=>[r(C(t.$filters.data(i.DataVencimento)),1)]),_:2},1024),o(_,null,{default:a(()=>e[16]||(e[16]=[r("Data de Vencimento")])),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),o(g,null,{default:a(()=>[o(c,{class:"text-tertiary"},{default:a(()=>[r(" R$ "+C(t.$filters.numero(i.ValorOriginal,2))+" ",1),o(_,null,{default:a(()=>e[17]||(e[17]=[r("Valor")])),_:1})]),_:2},1024)]),_:2},1024),o(g,{side:"",top:""},{default:a(()=>[d("div",Y,[v("",!0),i.receberPagar===!0&&i.dataPagamento===null?(f(),b("div",K,[o(L,{color:"tertiary",size:"md",icon:"mdi-barcode-scan",flat:"",dense:"",round:"",class:"buttons",onClick:D=>n.copiarCodigoBarras(i.LinhaDigitavel)},null,8,["onClick"]),o(L,{color:"tertiary",flat:"",icon:"print",onClick:D=>n.imprimirBoleto(i)},null,8,["onClick"])])):v("",!0),i.receberPagar===!0&&i.dataPagamento!==null?(f(),F(c,{key:2,class:"text-tertiary"},{default:a(()=>[o(m,null,{default:a(()=>[o(c,null,{default:a(()=>[o(w,{class:"q-mr-sm",escuro:"",cor:"positive"},{default:a(()=>[o(k,{class:"text-white",name:"today"}),r(" Pago em "+C(t.$filters.data(i.dataPagamento)),1)]),_:2},1024),o(_,null,{default:a(()=>e[18]||(e[18]=[r("Data de Pagamento")])),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024)):v("",!0),v("",!0)])]),_:2},1024)]),_:2},1024),(V=l.listaLayout[i.id])!=null&&V.detalhes?(f(),b("div",Z,[o(m,{class:"q-col-gutter-md text-tertiary"},{default:a(()=>[d("div",ee,[o(c,null,{default:a(()=>e[24]||(e[24]=[r("52x - Descri\xE7\xE3o do item ")])),_:1})])]),_:1}),o(m,{class:"q-col-gutter-md text-tertiary"},{default:a(()=>[d("div",oe,[o(c,{class:"text-tertiary"},{default:a(()=>[o(m,null,{default:a(()=>[o(k,{class:"text-tertiary",name:"today"}),o(c,null,{default:a(()=>e[25]||(e[25]=[r("22/01/2021 ")])),_:1}),o(_,null,{default:a(()=>e[26]||(e[26]=[r("Data de Emiss\xE3o")])),_:1})]),_:1})]),_:1})]),d("div",te,[o(c,{class:"text-tertiary"},{default:a(()=>[o(m,null,{default:a(()=>[o(k,{class:"text-tertiary",name:"today"}),o(c,null,{default:a(()=>e[27]||(e[27]=[r("22/01/2021 ")])),_:1}),o(_,null,{default:a(()=>e[28]||(e[28]=[r("Data de Vencimento")])),_:1})]),_:1})]),_:1})]),d("div",ae,[o(c,{class:"text-tertiary text-right"},{default:a(()=>[e[30]||(e[30]=d("small",null,"Descontos",-1)),e[31]||(e[31]=d("br",null,null,-1)),e[32]||(e[32]=r(" R$100,00 ")),o(_,null,{default:a(()=>e[29]||(e[29]=[r("Valor")])),_:1})]),_:1})])]),_:1})])):v("",!0),(S=l.listaLayout[i.id])!=null&&S.detalhes?(f(),b("div",le,[(f(!0),b(B,null,I(i.tags,y=>(f(),F(w,{class:"q-mr-sm",escuro:"",cor:"primary",key:y},{default:a(()=>[r(C(y),1)]),_:2},1024))),128))])):v("",!0),o(O)])}),128))]),_:1})]),_:1},8,["titulo","onCriar_click","onCheckBoxGeral_click","onFiltro_change","onLimparFiltros_click","onAbrirTodosPreview","onExportarXLSX_click","onRemoverTodos","onRestaurarTodos","tabSelecionada","tabs","lista","listaLayout","paginacao","filtros","buscaCampo","checkboxModel","bannerMsg"]),o(T,{ref:"modalFicha"},null,512),o(E,{modelValue:l.contatoCombinar,"onUpdate:modelValue":e[10]||(e[10]=i=>l.contatoCombinar=i),onAtualizar:n.atualizar},null,8,["modelValue","onAtualizar"])])}var Ce=$(G,[["render",ie]]);export{Ce as default};
