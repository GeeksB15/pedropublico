import{_ as R,o as h,d as _,w as t,f as o,y as W,h as T,i as N,k as u,G as q,Q as k,M as U,dl as aa,C as I,r as C,N as Y,P as ma,L as oa,E as ea,t as w,H as ta,I as pa,D as ia,n as L,F as J,s as Z,B as f,e as D,q as G,J as la,Z as ha,dw as fa,dy as va,el as ga,em as Ca,dU as ba,bb as H,ax as K,R as z,S as A,j as P,O as X,T as $,z as ya,aq as wa,m as B,ej as _a,bD as Aa,l as ka}from"./index.129a5639.js";import{L as Da}from"./Lista.0485e31d.js";import{Q as qa}from"./QDate.b26a7401.js";import{G as xa}from"./GenericModal.e17be869.js";import{G as Va}from"./GChipsV2.1a9b23b5.js";import{J as sa}from"./JsonViewer.a65c2dba.js";import{s as ra}from"./selecaoContaWhatsapp.ff7b29c1.js";import"./xlsx.38714f5b.js";import"./QBtnDropdown.549d789e.js";import"./QBtnGroup.dde1c940.js";import"./QScrollArea.93b95b42.js";const Ea={data(){return{visivel:!1}},methods:{async anexar(e){const a=await this.toBase64(e[0]);await $utils.geeksApi({ret:{funcao:"D280149A-F8EA-4103-B4AA-656707767F19",idCampanha:this.idCampanha,anexo:a,nomeArquivo:e[0].name}}),this.resolve(!0),this.visivel=!1},onHide(){this.resolve()},async mostrar({idCampanha:e}){return this.idCampanha=e,this.visivel=!0,new Promise((a,l)=>{this.resolve=a})},toBase64(e){return new Promise((a,l)=>{const d=new FileReader;d.readAsDataURL(e),d.onload=()=>a(d.result),d.onerror=i=>l(i)})}}};function $a(e,a,l,d,i,n){return h(),_(I,{modelValue:i.visivel,"onUpdate:modelValue":a[0]||(a[0]=c=>i.visivel=c),onHide:a[1]||(a[1]=c=>n.onHide())},{default:t(()=>[o(W,null,{default:t(()=>[o(T,null,{default:t(()=>[o(N,null,{default:t(()=>a[2]||(a[2]=[u("Anexar")])),_:1}),q(o(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1}),o(aa,{"auto-expand":"",color:"none",class:"mobile-only",label:"Foto","hide-upload-btn":"","hide-upload-progress":"","dark-light":"",url:"",ref:"fotoCampo",factory:n.anexar},null,8,["factory"]),o(aa,{"auto-expand":"",color:"none",class:"mobile-hide",extensions:".jpg,.mp3,.mp4",label:"Anexo","hide-upload-btn":"","auto-upload":"","dark-light":"",url:"",ref:"fotoCampo",factory:n.anexar},null,8,["factory"])]),_:1})]),_:1},8,["modelValue"])}var Fa=R(Ea,[["render",$a]]);const Ba={data(){return{visivel:!1,idContato:"",nome:"",apelido:"",email:"",telefone:""}},methods:{onHide(){this.resolve()},async mostrar({idCampanha:e}){return this.idCampanha=e,this.visivel=!0,new Promise((a,l)=>{this.resolve=a})},async salvarContato(){try{this.$q.loading.show(),(await $utils.geeksApi({ret:{funcao:"B18C0CB3-5EA1-4E1C-8C31-EB354E5E3DB1",idCampanha:this.idCampanha,idContato:this.idContato,nome:this.nome,apelido:this.apelido,telefone:this.telefone,email:this.email}})).data.ret.erro?$q.notifyError("ret.data.ret.erro"):(this.resolve(!0),this.cancelarContato())}finally{this.$q.loading.hide()}},cancelarContato(){this.idContato="",this.nome="",this.apelido="",this.email="",this.telefone="",this.visivel=!1},async abrirModalContato(){const e={ativo:!0},a=await $g.promptContato.show({filtro:e,placeholder:"Selecione"});if(!a)return;let d=(await $db.contato.leCompletoV3(a.id)).telefone.filter(function(i){return i.tipoTelefone.indexOf("WhatsApp")!==-1});this.idContato=a.id,this.nome=a.nome,this.apelido=a.apelido,this.telefone="",d.length!==0&&d[0].telefone&&(this.telefone=d[0].telefone),this.email=""}}};function Ua(e,a,l,d,i,n){const c=C("campo");return h(),_(I,{modelValue:i.visivel,"onUpdate:modelValue":a[3]||(a[3]=g=>i.visivel=g),onHide:a[4]||(a[4]=g=>n.onHide())},{default:t(()=>[o(W,{class:"row"},{default:t(()=>[o(T,{class:"bg-primary text-white row"},{default:t(()=>[o(N,null,{default:t(()=>a[5]||(a[5]=[u("Contato")])),_:1}),q(o(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1}),o(Y,{class:"col-12"},{default:t(()=>[o(c,{modelValue:i.nome,"onUpdate:modelValue":a[0]||(a[0]=g=>i.nome=g),rotulo:"Nome",after:[{icon:"search",handler:n.abrirModalContato}],rules:[g=>!!g||"Campo Obrigat\xF3rio"]},null,8,["modelValue","after","rules"]),o(c,{modelValue:i.apelido,"onUpdate:modelValue":a[1]||(a[1]=g=>i.apelido=g),class:"col-12",tipo:"texto",rotulo:"Apelido",rules:[g=>!!g||""]},null,8,["modelValue","rules"]),o(c,{modelValue:i.telefone,"onUpdate:modelValue":a[2]||(a[2]=g=>i.telefone=g),class:"col-12",tipo:"Telefone",rotulo:"Telefone",mask:"(##) #####-####",rules:[g=>!!g||"Campo Obrigat\xF3rio"]},null,8,["modelValue","rules"])]),_:1}),o(Y,{class:"col-12"},{default:t(()=>[o(ma,{align:"right",class:"row"},{default:t(()=>[o(k,{flat:"",class:"bg-primary text-white row",onClick:n.salvarContato},{default:t(()=>a[6]||(a[6]=[u("Salvar")])),_:1},8,["onClick"]),o(k,{flat:"",onClick:n.cancelarContato},{default:t(()=>a[7]||(a[7]=[u("Cancelar")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Sa=R(Ba,[["render",Ua]]);const Ha={components:{GChipsV2:Va},data(){return{show:!1,filtro:[]}},emits:["hide","aplicar"],methods:{async handlerSeletor(e){var d,i;const a=(i=(d=this.props)==null?void 0:d.filtro[e])==null?void 0:i.handler;let l;!a||(l=await a(),l&&this.filtro[e].valor.push(l))},async aplicar(){let e=!1;this.$refs.form.getValidationComponents().forEach(a=>{!a.validate()&&!e&&(e=!0)}),!e&&this.$emit("aplicar",$utils.clonarV2(this.filtro))}},props:{props:Object},watch:{props(){var a,l,d,i;const e=[];for(const n of(l=(a=this.props)==null?void 0:a.filtro)!=null?l:[]){const c={};"campo"in n&&(c.campo=n.campo),"operador"in n&&(c.operador=n.operador),"valor"in n&&(c.valor=n.valor),e.push(c)}this.filtro=e,this.show=(i=(d=this.props)==null?void 0:d.show)!=null?i:!1}}},za={class:"col-12"},Pa={key:0,class:"col-4"},Ma={class:"col-8"},Oa=["onClick"],La={class:"col-12"},Ta={class:"col-12"},Na={class:"q-mb-sm"},Ra={class:"col-md-6"},ja={class:"row"},Ia={class:"col-6 col-md-6"},Qa={class:"col-6 col-md-6"},Ga={class:"col-md-6"},Ja={class:"row"},Wa={class:"col-6 col-md-6"},Ya={class:"col-6 col-md-6"},Ka={class:"col-12"},Xa={class:"q-mb-sm"},Za={class:"col-6 col-sm"},ao={class:"col-6 col-sm"};function oo(e,a,l,d,i,n){const c=C("row"),g=C("campo"),b=C("GChipsV2");return h(),_(I,{modelValue:i.show,"onUpdate:modelValue":a[0]||(a[0]=p=>i.show=p),onHide:a[1]||(a[1]=p=>e.$emit("hide"))},{default:t(()=>[o(oa,{container:"",view:"hHh lpR fFf",class:"q-layout-modal bg-white"},{default:t(()=>[o(ea,null,{default:t(()=>[o(T,null,{default:t(()=>[o(N,null,{default:t(()=>[u(w(l.props.titulo),1)]),_:1}),q(o(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1})]),_:1}),o(ta,null,{default:t(()=>[o(pa,null,{default:t(()=>[o(ia,{ref:"form",class:"col q-pa-md"},{default:t(()=>[(h(!0),L(J,null,Z(i.filtro,(p,v)=>(h(),L("div",{key:v},[l.props.filtro[v].tipo==="botao"&&l.props.filtro[v].handler?(h(),_(c,{key:0,class:"q-mb-xl"},{default:t(()=>[f("div",za,[o(k,{color:"primary",icon:l.props.filtro[v].icone,label:l.props.filtro[v].titulo,onClick:y=>n.handlerSeletor(v),style:{width:"100%"}},null,8,["icon","label","onClick"])])]),_:2},1024)):D("",!0),l.props.filtro[v].tipo==="seletor"&&l.props.filtro[v].handler?(h(),_(c,{key:1,class:"q-mb-xl"},{default:t(()=>[p.operador?(h(),L("div",Pa,[o(g,{tipo:"seletor","rotulo-fixo":l.props.filtro[v].titulo,options:l.props.filtro[v].operadores,modelValue:p.operador,"onUpdate:modelValue":y=>p.operador=y},null,8,["rotulo-fixo","options","modelValue","onUpdate:modelValue"])])):D("",!0),f("div",Ma,[f("div",{onClick:y=>n.handlerSeletor(v)},[o(b,{modelValue:p.valor,"onUpdate:modelValue":y=>p.valor=y,class:"q-px-none",useInput:!1,placeholder:"Filtre por C\xF3digo, N\xFAmero..."},null,8,["modelValue","onUpdate:modelValue"])],8,Oa)])]),_:2},1024)):D("",!0),l.props.filtro[v].tipo==="seletor"&&l.props.filtro[v].opcoes?(h(),_(c,{key:2,class:"q-mb-xl"},{default:t(()=>[f("div",La,[o(g,{tipo:"seletor","rotulo-fixo":l.props.filtro[v].titulo,options:l.props.filtro[v].opcoes,modelValue:p.valor,"onUpdate:modelValue":y=>p.valor=y,clearable:""},null,8,["rotulo-fixo","options","modelValue","onUpdate:modelValue"])])]),_:2},1024)):D("",!0),l.props.filtro[v].tipo==="periodoDiaMes"?(h(),_(c,{key:3,class:"q-mb-xl"},{default:t(()=>[f("div",Ta,[f("strong",Na,w(l.props.filtro[v].titulo),1),o(c,null,{default:t(()=>{var y,F,S,m,V,r,E,Q;return[f("div",Ra,[a[2]||(a[2]=u(" Data Inicial ")),f("div",ja,[f("div",Ia,[o(G,{label:"Dia",modelValue:p.valor.diaInicio,"onUpdate:modelValue":M=>p.valor.diaInicio=M,rules:(F=(y=l.props.filtro[v].rules)==null?void 0:y.diaInicio)!=null?F:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])]),f("div",Qa,[o(G,{label:"M\xEAs",modelValue:p.valor.mesInicio,"onUpdate:modelValue":M=>p.valor.mesInicio=M,rules:(m=(S=l.props.filtro[v].rules)==null?void 0:S.mesInicio)!=null?m:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])])])]),f("div",Ga,[a[3]||(a[3]=u(" Data Final ")),f("div",Ja,[f("div",Wa,[o(G,{label:"Dia",modelValue:p.valor.diaFim,"onUpdate:modelValue":M=>p.valor.diaFim=M,rules:(r=(V=l.props.filtro[v].rules)==null?void 0:V.diaFim)!=null?r:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])]),f("div",Ya,[o(G,{label:"M\xEAs",modelValue:p.valor.mesFim,"onUpdate:modelValue":M=>p.valor.mesFim=M,rules:(Q=(E=l.props.filtro[v].rules)==null?void 0:E.mesFim)!=null?Q:[],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","onUpdate:modelValue","rules"])])])])]}),_:2},1024)])]),_:2},1024)):D("",!0),l.props.filtro[v].tipo==="periodoData"?(h(),_(c,{key:4,class:"q-mb-xl"},{default:t(()=>[f("div",Ka,[f("strong",Xa,w(l.props.filtro[v].titulo),1),o(c,null,{default:t(()=>[f("div",Za,[o(g,{modelValue:p.valor.inicio,"onUpdate:modelValue":y=>p.valor.inicio=y,rotulo:"In\xEDcio",clearable:"",tipo:"data"},null,8,["modelValue","onUpdate:modelValue"])]),f("div",ao,[o(g,{modelValue:p.valor.fim,"onUpdate:modelValue":y=>p.valor.fim=y,rotulo:"Fim",clearable:"",tipo:"data"},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024)])]),_:2},1024)):D("",!0)]))),128))]),_:1},512)]),_:1})]),_:1}),o(la,null,{default:t(()=>[o(T,{class:"bg-light"},{default:t(()=>[o(N,{class:"text-right"},{default:t(()=>[q(o(k,{flat:"",size:"md","no-ripple":"",color:"tertiary",label:"Cancelar",class:"q-mr-sm"},null,512),[[U]]),o(k,{"no-ripple":"",label:"Aplicar",color:"primary",unelevated:"",class:"no-shadow",onClick:n.aplicar},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var eo=R(Ha,[["render",oo]]);const to={components:{selecaoContaWhatsapp:ra},data(){return{visivel:!1,telefone:"",anexo:[],campanha:{},socket:{conectado:!1,socket:{}}}},emits:["atualizar"],methods:{onHide(){this.resolve({})},testarEnvio(){try{const e=this.telefone,a=this.campanha.mensagem,l=this.contaWhats,d=this.anexo;this.whatsEnvia({funcao:"enviar mensagem",telDestino:e,mensa:a,anexo:d,banco:l}),this.visivel=!1}catch(e){console.log(e.message)}},whatsEnvia(e){if(this.socket=$g.conexaoWpp,this.socket.conectado)try{this.socket.socket.send(JSON.stringify(e))}catch(a){console.log(a.message)}},show(e,a){return this.visivel=!0,this.telefone="",this.campanha=e,this.anexo=a,this.contaWhats=this.campanha.conexao,new Promise((l,d)=>{this.resolve=l})},whatsAlterarConta(e){this.contaWhats=e}}},io={class:"layout-padding"},lo={class:"col-12"},so={class:"col-12"},ro={class:"q-mt-lg text-right"};function no(e,a,l,d,i,n){const c=C("selecaoContaWhatsapp"),g=C("campo"),b=C("row");return h(),_(I,{modelValue:i.visivel,"onUpdate:modelValue":a[2]||(a[2]=p=>i.visivel=p),onHide:a[3]||(a[3]=p=>n.onHide())},{default:t(()=>[o(W,{class:"q-dialog-plugin"},{default:t(()=>[o(T,{class:"bg-primary text-white"},{default:t(()=>[o(N,null,{default:t(()=>a[4]||(a[4]=[u("Testar Envio da Campanha")])),_:1}),q(o(k,{dense:"",flat:"",icon:"close",round:""},null,512),[[U]])]),_:1}),f("div",io,[o(ia,{class:"q-pa-md",onSubmit:n.testarEnvio},{default:t(()=>[o(b,{class:"items-center q-col-gutter-md"},{default:t(()=>[f("div",lo,[o(c,{conta:e.contaWhats,onAtualizarConexao:a[0]||(a[0]=p=>n.whatsAlterarConta(p)),outlined:""},null,8,["conta"])]),f("div",so,[o(g,{modelValue:i.telefone,"onUpdate:modelValue":a[1]||(a[1]=p=>i.telefone=p),tipo:"texto",rotulo:"Telefone"},null,8,["modelValue"])])]),_:1}),f("div",ro,[q(o(k,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[U]]),o(k,{color:"primary",class:"text-white",unelevated:"",label:"Enviar Teste",type:"submit"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1},8,["modelValue"])}var uo=R(to,[["render",no]]);const co={components:{modalAnexo:Fa,modalContato:Sa,BadgeCopiarUid:ha,SeletorCampoTabela:fa,GenericModal:xa,PromptGrupoUnico:va,PromptSegmentoUnico:ga,PromptOrigemMarketingUnico:Ca,FiltroDinamico:eo,JsonViewer:sa,CampanhaTesteEnvio:uo,selecaoContaWhatsapp:ra},data(){const e=new Date(new Date($utils.dataAtual()).toDateString()),l=new Date(e).setDate(1);return{campanha:{id:"",descricao:"Descri\xE7\xE3o",dataHoraCriacao:$utils.dataAtual(),status:"Rascunho",tipo:"",idContato:"",mensagem:"Mensagem",responsavel:"",idEmpresa:""},campanhaOriginal:{},campanhaContato:[],campanhaAnexo:[],contatoGrupo:[],vendedores:[],filtro:{periodo:{aniversario:{from:`${e.getFullYear()}-${e.getMonth()}-${e.getDate()}`,to:`${e.getFullYear()}-${e.getMonth()}-${e.getDate()+1}`},receitaVencida:{from:l,to:""}}},lastFimReceita:null,opcaoAdicionar:"",grupo:"",segmento:"",vendedor:"",visivel:!1,somenteLeitura:!1,modalTitle:"Filtre contatos",filtroDinamico:null,empresa:{},sistemaPai:"",objetoConexoes:{},opcoesTipo:[],contatoCampo:"",opcoesContatos:[]}},emits:["atualizar"],methods:{async atualizar({id:e}){try{this.$q.loading.show();const a=await $utils.geeksApi({ret:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",id:e}});this.campanha=a.data.ret.campanha,this.campanha.conexao||(this.campanha.conexao=this.clienteSistema.bancoDeDados),this.somenteLeitura=a.data.ret.campanha.status!=="Rascunho",this.campanhaOriginal=$utils.clonarV2(this.campanha),await this.$nextTick(),this.atualizarAnexo(a.data.ret.campanhaAnexo),this.atualizarContato(a.data.ret.campanhaContato)}catch(a){$q.notifyError("Ocorreu um erro ao atualizar",a)}finally{this.$q.loading.hide()}},async atualizarAnexo(e){try{await this.$nextTick(),this.campanhaAnexo=e}catch(a){$q.notifyError("Ocorreu um erro ao atualizar anexo",a)}},async atualizarContato(e){try{await this.$nextTick(),this.campanhaContato=e.map(a=>(a.ordenar=this.$utils.removerCaracteresEspeciais(a.nome),a)).sort((a,l)=>a.ordenar>l.ordenar?1:l.ordenar>a.ordenar?-1:0)}catch(a){$q.notifyError("Ocorreu um erro ao atualizar contato",a)}try{await this.$nextTick();const a={};for(const{conexaoEnvio:l}of this.campanhaContato)if(!a[l])if(!l)a[l]="Sem envio";else if(l.startsWith("cpf")){const d=l.substring(3),i=(await $db.contato.le({numeroDocumentoNacional:d}))[0];a[l]=(i==null?void 0:i.nome)+" - CPF"}else if(l.startsWith("cnpj")){const d=l.replace("_","/").substring(4),i=(await $db.hibrido.lista({table:"empresa",whereFilter:{numeroDocumentoNacional:d}}))[0];a[l]=((i==null?void 0:i.sigla)||(i==null?void 0:i.apelido))+" - CNPJ"}else a[l]=l;this.objetoConexoes=a}catch(a){$q.notifyError("Ocorreu um erro ao atualizar conexao de envio",a)}},verificarSeAlterouCampos(){return $utils.diferencaObjetos(this.campanhaOriginal,this.campanha)},async salvar(){let e=this.verificarSeAlterouCampos();Object.keys(e).length!==0&&(e.funcao="65A200F2-9B9F-40E6-BD3A-282B77FC6BFB",e.id=this.campanha.id,await $utils.geeksApi({ret:e}))},async salvar_click(e){try{$q.loading.show(),this.campanha.idContato||(this.campanha.idContato=$db.usuario.logado.id),await this.salvar(),e||(this.$router.replace({params:{id:""}}),this.$emit("atualizar"),this.visivel=!1)}catch(a){$q.notifyError("Ocorreu um erro ao salvar",a)}finally{$q.loading.hide()}},async enviar_click(){if(this.campanhaContato.length===0){this.$q.notifyError("N\xE3o \xE9 permitido enviar campanha sem lista de contatos!");return}try{$q.loading.show(),this.campanha.status="Enviando",this.campanha.dataHoraDisparo=$utils.dataAtual(),this.campanha.log=`${await this.formatDate(new Date($utils.dataAtual()))} - Campanha disparada por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional}) 
${this.campanha.log||""}`,await this.salvar(),this.fechar()}catch(e){$q.notifyError("Ocorreu um erro!",e)}finally{$q.loading.hide()}},async rascunho_click(){try{$q.loading.show(),this.campanha.status="Rascunho",this.campanha.log=`${await this.formatDate(new Date($utils.dataAtual()))} - Campanha retornada para Rascunho por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional}) 
${this.campanha.log||""}`,await this.salvar(),this.fechar()}catch(e){$q.notifyError("Ocorreu um erro!",e)}finally{$q.loading.hide()}},async mostrar(e){await this.atualizar(e),this.visivel=!0},fechar(){this.$router.replace({params:{id:""}}),this.$emit("atualizar"),this.visivel=!1},async anexar_click(){const e=this.campanha.id;await this.$refs.modalAnexo.mostrar({idCampanha:e})&&(await this.salvar(),await this.atualizar({id:e}))},showFiltersModal(e){e==="carteira-aniversariantes"?this.modalTitle="Aniversariantes":e==="carteira-receitas-vencidas"&&(this.modalTitle="Receitas vencidas"),this.opcaoAdicionar=e,this.$refs.filtersModal.show()},async anexoDownload(e){const a=await $utils.geeksApi({item:{funcao:"B546B803-45E8-40B5-9F28-CFCC323AD5FD",id:e.id}});let l=document.createElement("a");l.href=a.data.item.anexo,l.download=a.data.item.nomeArquivo,l.click()},async anexoRemove(e){this.$q.dialog({cancel:{label:"Manter",push:!0,color:"tertiary",flat:!0},title:"Tem certeza?",message:"Ao continuar voc\xEA ir\xE1 perder esse anexo.",ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{if(this.campanhaContato.find(i=>i.status==="Enviado")){this.$q.notifyError("N\xE3o \xE9 permitido remover o anexo de uma campanha que j\xE1 foi enviada!");return}this.$q.loading.show();const a=this.campanha,l=a.id,d=await $utils.geeksApi({ret:{funcao:"BE8B810E-A49A-4B38-84B8-B758AD5064EF",id:e.id}});await this.atualizar({id:l}),this.campanha=a}finally{this.$q.loading.hide()}})},async adicionarContato(){const e=this.campanha.id;await this.$refs.modalContato.mostrar({idCampanha:e})&&(await this.salvar(),await this.atualizar({id:e}))},async adicionarPorGrupo(){let e=this.grupo;try{this.$q.loading.show(),await this.salvar();const a=this.campanha,l=a.id,d=await $utils.geeksApi({ret:{funcao:"ACC16F3A-88EC-43C6-A9B1-82828ED6E593",idCampanha:l,grupo:e,idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:l}),this.campanha=a}finally{this.$q.loading.hide()}},async adicionarPorSegmento(){let e=this.segmento;try{this.$q.loading.show(),await this.salvar();const a=this.campanha,l=a.id,d=await $utils.geeksApi({ret:{funcao:"3127C40C-0DD3-42A3-A37E-8ACACB52B88D",idCampanha:l,segmento:e,idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:l}),this.campanha=a}finally{this.$q.loading.hide()}},async adicionarPorVendedor(e){this.grupo="",this.$forceUpdate();try{this.$q.loading.show(),await this.salvar();const a=this.campanha,l=a.id,d=await $utils.geeksApi({ret:{funcao:"7B03B118-39D4-4BFB-9F64-12A7020F441F",idCampanha:l,idVendedor:e.id,idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:l}),this.campanha=a}finally{this.$q.loading.hide()}},async adicionarPorContato(e){this.grupo="",this.$forceUpdate();try{this.$q.loading.show(),await this.salvar();const a=this.campanha,l=a.id,d=await $utils.geeksApi({ret:{funcao:"61003235-3E37-4E2F-A7B7-A1F25FD12470",idCampanha:l,idContato:e.id}});this.showAddPositiveMsg(),await this.atualizar({id:l}),this.campanha=a}finally{this.$q.loading.hide()}},async adicionarPorDataAniversario(){let e=new Date(this.filtro.periodo.aniversario.from),a=new Date(this.filtro.periodo.aniversario.to);typeof this.filtro.periodo.aniversario=="string"&&(e=new Date(this.filtro.periodo.aniversario),a=new Date(this.filtro.periodo.aniversario));try{this.$q.loading.show(),await this.salvar();const d=this.campanha.id,i=await $utils.geeksApi({ret:{funcao:"E3BDE3F3-6D9A-424A-B4EB-B28E9757A1E5",idCampanha:d,ini:{mes:e.getMonth()+1,dia:e.getDate()},fim:{mes:a.getMonth()+1,dia:a.getDate()},idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:d})}finally{this.$q.loading.hide()}},async adicionarPorDataReceitaVencida(){const e=new Date(this.filtro.periodo.receitaVencida.from),a=new Date(this.filtro.periodo.receitaVencida.to);if(this.lastFimReceita&&this.lastFimReceita===a.toString())return!1;this.lastFimReceita=a.toString();try{this.$q.loading.show(),await this.salvar();const d=this.campanha.id,i=await $utils.geeksApi({ret:{funcao:"BA806BC5-CAF1-4673-AD4C-572B4AF8DB25",idCampanha:d,ini:{ano:e.getFullYear(),mes:e.getMonth()+1,dia:e.getDate()},fim:{ano:a.getFullYear(),mes:a.getMonth()+1,dia:a.getDate()},idEmpresa:this.campanha.idEmpresa}});this.showAddPositiveMsg(),await this.atualizar({id:d})}finally{this.$q.loading.hide()}},showAddPositiveMsg(){$q.notifyPositive("Contatos vinculados com sucesso!")},async contatoRemoveTodos(){this.$q.dialog({cancel:{label:"Voltar",push:!0,color:"tertiary",flat:!0},title:"Limpar?",message:"Ao continuar sua lista de envio ficar\xE1 limpa.",ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{if(this.campanhaContato.find(d=>d.status==="Enviado")){this.$q.notifyError("N\xE3o \xE9 permitido remover um contato para o qual a campanha j\xE1 foi enviada!");return}this.$q.loading.show();const e=this.campanha,a=e.id,l=await $utils.geeksApi({ret:{funcao:"AE0FFC21-984C-46E0-A9E6-6E8A192DC750",id:a}});await this.atualizar({id:a}),this.campanha=e}finally{this.$q.loading.hide()}})},async contatoRemove(e){try{if((e==null?void 0:e.status)!=="Enviado"){this.$q.loading.show();const a=this.campanha,l=a.id,d=await $utils.geeksApi({ret:{funcao:"15D77453-DEE7-4DD1-B34C-3F6C8D2CC687",id:e.id}});await this.atualizar({id:l}),this.campanha=a}e.status==="Enviado"&&this.$q.notifyError("N\xE3o \xE9 permitido remover um contato para o qual a campanha j\xE1 foi enviada!")}finally{this.$q.loading.hide()}},async concluirFiltros(){this.opcaoAdicionar==="contato-grupo"&&this.adicionarPorGrupo(),this.opcaoAdicionar==="carteira-vendedor"&&this.adicionarPorVendedor(),this.opcaoAdicionar==="carteira-aniversariantes"&&this.adicionarPorDataAniversario(),this.opcaoAdicionar==="carteira-receitas-vencidas"&&this.adicionarPorDataReceitaVencida()},async abrirModalMultiplos(){this.opcoesTipo=ba.map(e=>({label:e.rotulo,value:e.valor})),this.filtroDinamico={show:!0,titulo:"Filtro",filtro:[{titulo:"Empresa",campo:"contatoIdEmpresa",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptContato.show({filtro:{ativo:!0,empresas:!0},placeholder:"Selecione a empresa"});return e?{value:e.id,label:e.apelido||e.nome}:!1}},{titulo:"Grupo",campo:"contatoGrupoDescricao",tipo:"seletor",operador:"and",operadores:[{label:"Cont\xE9m todos",value:"and"},{label:"Cont\xE9m pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptGrupoUnico.show();if(!!e.descricao)return{value:e.descricao,label:e.descricao}}},{titulo:"Carteira do Vendedor",campo:"contatoIdContatoVendedor",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptContato.show({filtro:{ativo:!0,vendedores:!0},placeholder:"Selecione o vendedor"});if(!!e)return{value:e.id,label:e.nome}}},{titulo:"Profiss\xE3o/Segmento",campo:"contatoSegmento",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptSegmentoUnico.show();if(!!e.descricao)return{value:e.descricao,label:e.descricao}}},{titulo:"Origem Marketing",campo:"contatoOrigemMarketing",tipo:"seletor",operador:"or",operadores:[{label:"Pelo menos um",value:"or"}],valor:[],handler:async()=>{const e=await $g.promptOrigemMarketingUnico.show();if(!!e.descricao)return{value:e.descricao,label:e.descricao}}},{titulo:"Tipo de Produto",campo:"tipoProduto",tipo:"seletor",opcoes:this.opcoesTipo,valor:null},{titulo:"Sexo",campo:"contatoSexo",tipo:"seletor",opcoes:[{label:"Masculino",value:"Masculino"},{label:"Feminino",value:"Feminino"},{label:"Outro",value:"Outro"}],valor:null},{titulo:"Anivers\xE1rio",campo:"contatoDataAbertura",tipo:"periodoDiaMes",valor:{diaInicio:"",mesInicio:"",diaFim:"",mesFim:""}},{titulo:"Data da Venda",campo:"vendaDataHoraFinalizado",tipo:"periodoData",valor:{inicio:null,fim:null}},{titulo:"Per\xEDodo sem venda",campo:"periodoSemVenda",tipo:"periodoData",valor:{inicio:null,fim:null}}]},[23,37,40,42,52,53,57,58,63,68].includes(this.clienteSistema.codigoSistema)&&(this.filtroDinamico.filtro.push({titulo:"Data do Envelope",campo:"envelopeDataHoraFinalizado",tipo:"periodoData",valor:{inicio:null,fim:null}}),this.filtroDinamico.filtro.push({titulo:"Receitas Vencidas",campo:"receitaDataHoraFinalizado",tipo:"periodoData",valor:{inicio:null,fim:null}}))},async aplicarFiltroDinamico(e){try{if($q.loading.show(),await this.filtroVazio(e))return $q.notifyError("\xC9 necess\xE1rio pelo menos um filtro para aplic\xE1-lo.");await this.salvar();const a=(await $utils.geeksApi({payload:{funcao:"A8198AC8-69C0-41E2-92AE-109161145256",idCampanha:this.campanha.id,filtro:e}})).data.payload,l=a.filtrosUtilizados,d=a.qtdeContatos;if(l.length>0&&d>0){const i=await this.formatarFiltros(l);this.campanha.log=`${await this.formatDate(new Date($utils.dataAtual()))} - Adicionado os contatos por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional}) utilizando o(s) filtro(s) por:
${i}

${this.campanha.log||""}`,await this.salvar()}if(d===0){$q.notifyError("N\xE3o h\xE1 contatos para o filtro selecionado.");return}this.filtroDinamico=null,this.showAddPositiveMsg(),await this.atualizar({id:this.campanha.id})}catch(a){$q.notify({type:"negative",message:a.message}),console.error(a)}finally{$q.loading.hide()}},async filtroVazio(e){return e.every(a=>Array.isArray(a.valor)?a.valor.length===0:typeof a.valor=="object"&&a.valor!==null?Object.values(a.valor).every(l=>l===""||l===null):a.valor===null||a.valor===void 0)},async criar(){this.campanha={id:$utils.uuid(),descricao:"Descri\xE7\xE3o",dataHoraCriacao:$utils.dataAtual(),status:"Rascunho",tipo:"Whatsapp",mensagem:"Mensagem",idContato:$db.usuario.logado.id,responsavel:$db.usuario.logado.nome,conexao:this.clienteSistema.bancoDeDados,log:`${await this.formatDate(new Date($utils.dataAtual()))} - Campanha criada por ${$db.usuario.logado.nome} (${$db.usuario.logado.numeroDocumentoNacional})`},this.campanhaContato=[],this.campanhaAnexo=[],this.campanhaOriginal={},this.visivel=!0,this.somenteLeitura=!1},uploadClick(){this.$refs.Upload.click()},async abrirArquivo(e){const a=this.$refs.Upload.files;if(FileReader&&a&&a.length){var l=new FileReader;l.onload=()=>{},l.readAsDataURL(a[0]),await this.anexar(a[0])}},toBase64(e){return new Promise((a,l)=>{const d=new FileReader;d.readAsDataURL(e),d.onload=()=>a(d.result),d.onerror=i=>l(i)})},async anexar(e){await this.salvar();const a=await this.toBase64(e);await $utils.geeksApi({ret:{funcao:"D280149A-F8EA-4103-B4AA-656707767F19",idCampanha:this.campanha.id,anexo:a,nomeArquivo:e.name}}),await this.atualizar({id:this.campanha.id})},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)},async testarEnvio_click(){console.log("teste de Envio de Campanha");const e=[];this.campanhaAnexo&&this.campanhaAnexo.forEach(async a=>{const l=await this.buscaAnexo(a.id);e.push(l)}),await $utils.dormir(2e3),await this.$refs.testeEnvio.show(this.campanha,e)},async buscaAnexo(e){try{const a=await $utils.geeksApi({item:{funcao:"B546B803-45E8-40B5-9F28-CFCC323AD5FD",id:e}});return{anexo:a.data.item.anexo,nomeArquivo:a.data.item.nomeArquivo}}catch(a){console.log(a.message)}},async alteraResponsavelEmpresa(e){let a,l,d;e==="responsavel"&&(a={ativo:!0,usuario:!0},l="Selecione o respons\xE1vel",d="o respons\xE1vel"),e==="empresa"&&(a={ativo:!0,empresas:!0},l="Selecione a empresa",d="a empresa"),await $q.dialog({title:"Selecione uma das op\xE7\xF5es abaixo:",options:{type:"radio",model:"alterar",items:[{label:`Alterar ${d}`,value:"alterar",color:"primary"},{label:`Remover ${d}`,value:"remover",color:"negative"}]},cancel:{label:"CANCELAR",push:!0,color:"negative",flat:!0},ok:{label:"CONFIRMAR",push:!0,textColor:"primary",flat:!0}}).onOk(async i=>{if((await $utils.geeksApi({ler:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",id:this.campanha.id}})).data.ler.campanha||await this.salvar_click("rapido"),i==="remover")try{if(e==="responsavel"&&!this.campanha.idContato)return $q.notifyPositive("Nenhum respons\xE1vel vinculado para remover!");if(e==="empresa"&&!this.campanha.idEmpresa)return $q.notifyPositive("Nenhuma empresa vinculada para remover!");const c=await $utils.geeksApi({alterar:{funcao:"7FD8CA64-9FB6-4105-92D0-AC0603E09E3A",idCampanha:this.campanha.id,tipo:e,acao:i}});await this.atualizar({id:this.campanha.id}),$q.notifyPositive(`Removido ${d} com sucesso.`)}catch(c){$q.notifyError(`Ocorreu um erro ao remover ${d} da campanha!`),console.error(c)}if(i==="alterar")try{const c=await $g.promptContato.show({filtro:a,placeholder:l});if(e==="responsavel"&&!c){$q.notifyError("Nenhum respons\xE1vel selecionado!");return}if(e==="empresa"&&!c){$q.notifyError("Nenhuma empresa selecionada!");return}const g=await $utils.geeksApi({alterarConexao:{funcao:"7FD8CA64-9FB6-4105-92D0-AC0603E09E3A",idCampanha:this.campanha.id,tipo:e,acao:i,idContato:c.id,nomeContato:c.nome}});await this.atualizar({id:this.campanha.id}),$q.notifyPositive(`Alterado ${d} com sucesso.`)}catch(c){$q.notifyError(`Ocorreu um erro ao alterar ${d} da campanha!`),console.error(c)}}).onCancel(()=>{})},async formatDate(e){if(!(e instanceof Date))throw new Error('Argumento "data" inv\xE1lido. Voc\xEA deve passar uma inst\xE2ncia de data');const a=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),d=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),c=String(e.getSeconds()).padStart(2,"0");return`${d}/${l}/${a} - ${i}:${n}:${c}`},async whatsAlterarConta(e){this.campanha.conexao=e},async formatarFiltros(e){return e.length>1?e.join(`
`):e[0]},async contatoBuscar(e,a){try{if(e=e.trim(),this.opcoesContatos=[],e.length>1){const l=(await $db.contato.ler({filtros:{termoBusca:e,ativo:!0}})).data;this.opcoesContatos=l.map(d=>({data:d,label:`${d.apelido} | ${d.nome}`,stamp:"#0000000",sublabel:d.nome,value:d.nome}))}a()}catch{a(),this.$q.notify("Ocorreu um erro ao obter os contatos.")}},async contatoAdicionar(e){var a;this.grupo="",this.contatoCampo="",this.$forceUpdate();try{this.$q.loading.show(),await this.salvar();const l=this.campanha,d=l.id,i=await $utils.geeksApi({ret:{funcao:"61003235-3E37-4E2F-A7B7-A1F25FD12470",idCampanha:d,idContato:e.data.id}});if((a=i.data.ret)!=null&&a.erro){$q.notifyError(i.data.ret.erro);return}this.showAddPositiveMsg(),await this.atualizar({id:d}),this.campanha=l}finally{this.$q.loading.hide()}}},watch:{async"$route.params.id"(){const e=this.$route.params.id;!e||await this.mostrar({id:e})}},mounted(){this.sistemaPai=$utils.sistemaPai(),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema"))||{}}},mo={class:"mw80 text-center"},po={style:{padding:"10px","padding-bottom":"0px"}},ho={class:"u-container relative-position"};function fo(e,a,l,d,i,n){const c=C("ajuda"),g=C("g-label"),b=C("g-col"),p=C("badge"),v=C("BadgeCopiarUid"),y=C("g-row"),F=C("campo"),S=C("selecaoContaWhatsapp"),m=C("modalAnexo"),V=C("modalContato"),r=C("SeletorCampoTabela"),E=C("GenericModal"),Q=C("PromptGrupoUnico"),M=C("PromptSegmentoUnico"),na=C("PromptOrigemMarketingUnico"),da=C("FiltroDinamico"),ua=C("JsonViewer"),ca=C("CampanhaTesteEnvio");return h(),L(J,null,[o(I,{modelValue:i.visivel,"onUpdate:modelValue":a[15]||(a[15]=s=>i.visivel=s),persistent:"",maximized:"",onKeyup:Aa(n.fechar,["esc"])},{default:t(()=>[o(oa,{view:"hHh LpR fFf",container:"",class:"bg-light"},{default:t(()=>[o(ea,null,{default:t(()=>[o(T,null,{default:t(()=>[o(k,{onClick:n.fechar,icon:"arrow_back",round:"",flat:"",dense:""},null,8,["onClick"]),o(N,null,{default:t(()=>[u("Campanha: "+w(i.campanha.descricao),1)]),_:1}),o(c,{class:"q-ml-sm"}),q(o(k,{onClick:a[0]||(a[0]=s=>n.salvar_click()),label:"Salvar",color:"white","text-color":"primary",class:"q-ml-sm",unelevated:""},null,512),[[H,!i.somenteLeitura]]),e.$db.usuario.desenvolvedor()?(h(),_(k,{key:0,icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:t(()=>[o(K,null,{default:t(()=>[q((h(),_(z,{clickable:"",onClick:a[1]||(a[1]=s=>n.mostrarJsonViewer())},{default:t(()=>[o(A,{avatar:""},{default:t(()=>[o(P,{name:"mdi-file-replace",size:"sm"})]),_:1}),o(A,null,{default:t(()=>a[16]||(a[16]=[u("Ver Objeto")])),_:1})]),_:1})),[[U]])]),_:1})]),_:1})):D("",!0)]),_:1})]),_:1}),o(ta,{class:"u-container"},{default:t(()=>[o(y,{gutter:"md",mg:"md",bg:"bg-white"},{default:t(()=>[o(b,{col:"12"},{default:t(()=>[o(y,null,{default:t(()=>[o(b,{col:"xs",class:"center-header"},{default:t(()=>[o(g,{text:"sub1 medium",icon:"edit_note sm tertiary left"},{default:t(()=>a[17]||(a[17]=[u("Detalhes")])),_:1})]),_:1}),o(b,{col:"xs-shrink",class:"center-header"},{default:t(()=>[o(p,{rotulo:i.campanha.status,cor:i.campanha.status==="Enviada"?"tertiary":"light",escuro:i.campanha.status==="Enviada"},null,8,["rotulo","cor","escuro"]),o(v,{id:i.campanha.id,cor:"positive",class:"q-mx-sm"},null,8,["id"]),o(k,{icon:"more_vert",flat:"",dense:"",round:"",size:"md"},{default:t(()=>[o(K,null,{default:t(()=>[o(X,{link:"","no-border":"",separator:""},{default:t(()=>[q((h(),_(z,{clickable:"",onClick:a[2]||(a[2]=s=>n.alteraResponsavelEmpresa("responsavel"))},{default:t(()=>[o(A,{avatar:""},{default:t(()=>[o(P,{name:"how_to_reg"})]),_:1}),o(A,null,{default:t(()=>[o($,null,{default:t(()=>a[18]||(a[18]=[u("Alterar respons\xE1vel")])),_:1})]),_:1})]),_:1})),[[U]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(b,{col:"12 md5"},{default:t(()=>{var s;return[o(F,{somenteLeitura:i.somenteLeitura||typeof((s=this.campanhaContato.find(x=>x.status==="Enviado"))==null?void 0:s.id)!="undefined",modelValue:i.campanha.descricao,"onUpdate:modelValue":a[3]||(a[3]=x=>i.campanha.descricao=x),rotulo:"Titulo da campanha",filled:"",dense:"",class:"q-md-b"},null,8,["somenteLeitura","modelValue"])]}),_:1}),o(b,{col:"12 md"},{default:t(()=>[o(F,{modelValue:i.campanha.responsavel,"onUpdate:modelValue":a[4]||(a[4]=s=>i.campanha.responsavel=s),rotulo:"Respons\xE1vel",somenteLeitura:"",filled:"",dense:"",class:"q-md-b"},null,8,["modelValue"])]),_:1}),o(b,{col:"12 md"},{default:t(()=>[o(S,{conta:i.campanha.conexao,onAtualizarConexao:a[5]||(a[5]=s=>n.whatsAlterarConta(s)),filled:""},null,8,["conta"])]),_:1}),o(b,{col:"12"},{default:t(()=>{var s;return[o(F,{modelValue:i.campanha.mensagem,"onUpdate:modelValue":a[6]||(a[6]=x=>i.campanha.mensagem=x),tipo:"textoArea",rotulo:"Mensagem",somenteLeitura:i.somenteLeitura||typeof((s=this.campanhaContato.find(x=>x.status==="Enviado"))==null?void 0:s.id)!="undefined"},null,8,["modelValue","somenteLeitura"])]}),_:1}),o(b,{col:"12"},{default:t(()=>[o(g,{caption:""},{default:t(()=>[a[23]||(a[23]=u(" Voc\xEA pode usar os seguintes argumentos na mensagem para deixar ainda mais personalizado sua campanha: ")),o(p,{class:"q-mr-xs"},{default:t(()=>a[19]||(a[19]=[u("[Nome]")])),_:1}),o(p,{class:"q-mr-xs"},{default:t(()=>a[20]||(a[20]=[u("[PrimeiroNome]")])),_:1}),o(p,{class:"q-mr-xs"},{default:t(()=>a[21]||(a[21]=[u("[Apelido]")])),_:1}),o(p,{class:"q-mr-xs"},{default:t(()=>a[22]||(a[22]=[u("[PrimeiroApelido]")])),_:1})]),_:1})]),_:1}),o(b,{col:"12"},{default:t(()=>[o(ya,{"expand-separator":"",icon:"description",label:"Log",caption:"Registro de atividades"},{default:t(()=>[o(W,null,{default:t(()=>[o(Y,{style:{whiteSpace:"pre-wrap"}},{default:t(()=>[u(w(i.campanha.log),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(y,{gutter:"md",mg:"md",bg:"bg-white"},{default:t(()=>[o(b,{col:"12"},{default:t(()=>[o(k,{onClick:n.uploadClick,disable:!!i.campanhaContato.find(s=>s.status==="Enviado"),icon:"image",label:"Anexos","icon-right":"add",size:"md",outline:"","text-color":"tertiary",class:"full-width"},null,8,["onClick","disable"]),f("input",{ref:"Upload",type:"file",id:"Upload",onChange:a[7]||(a[7]=(...s)=>n.abrirArquivo&&n.abrirArquivo(...s)),style:{visibility:"hidden"}},null,544),(h(!0),L(J,null,Z(i.campanhaAnexo,s=>(h(),_(y,{key:s,gutter:"sm",mg:"sm-y",items:"center",bordered:"","rounded-borders":"",class:"itemHover"},{default:t(()=>[o(b,{col:"xs-shrink"},{default:t(()=>{var x,O;return[o(v,{id:(x=s==null?void 0:s.id)!=null?x:"",numero:((O=s==null?void 0:s.id)!=null?O:"").slice(-8),cor:"positive"},null,8,["id","numero"])]}),_:2},1024),o(b,{col:"xs",onClick:x=>n.anexoDownload(s),class:"cursor-pointer"},{default:t(()=>[o(g,{text:"bold",color:"tertiary"},{default:t(()=>[u(w(s.nomeArquivo),1)]),_:2},1024)]),_:2},1032,["onClick"]),o(b,{col:"xs-shrink"},{default:t(()=>[q(o(k,{onClick:x=>n.anexoRemove(s),disable:!!i.campanhaContato.find(x=>x.status==="Enviado"),icon:"delete",size:"md",color:"tertiary",round:"",flat:"",dense:""},null,8,["onClick","disable"]),[[H,!i.somenteLeitura]])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),o(y,{gutter:"md",mg:"md",items:"center",bg:"bg-white"},{default:t(()=>[o(b,{col:"xs"},{default:t(()=>[o(g,{text:"sub1 medium",icon:"person sm tertiary left"},{default:t(()=>[u("Contatos ("+w(i.campanhaContato.length)+")",1)]),_:1})]),_:1}),o(b,{col:"xs-shrink"},{default:t(()=>[q(o(wa,{modelValue:i.contatoCampo,"onUpdate:modelValue":[a[8]||(a[8]=s=>i.contatoCampo=s),n.contatoAdicionar],"use-input":"","input-debounce":"500",label:"Contatos",options:i.opcoesContatos,outlined:"",onFilter:n.contatoBuscar,dense:""},null,8,["modelValue","options","onFilter","onUpdate:modelValue"]),[[H,!i.somenteLeitura]])]),_:1}),o(b,{col:"xs-shrink"},{default:t(()=>[q(o(k,{onClick:n.abrirModalMultiplos,icon:"add",size:"md",round:"",flat:"",dense:""},{default:t(()=>[o(B,null,{default:t(()=>a[24]||(a[24]=[u(" Adicionar contatos por filtro ")])),_:1})]),_:1},8,["onClick"]),[[H,!i.somenteLeitura]]),q(o(k,{onClick:a[9]||(a[9]=s=>n.contatoRemoveTodos({})),disable:!!i.campanhaContato.find(s=>s.status==="Enviado"),icon:"delete",size:"md",color:"tertiary",round:"",flat:"",dense:"",class:"q-mr-xs"},{default:t(()=>[o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[25]||(a[25]=[u("Excluir todos")])),_:1})]),_:1},8,["disable"]),[[H,!i.somenteLeitura]])]),_:1}),i.campanhaContato.length>0?(h(),_(b,{key:0,col:"xs12"},{default:t(()=>[o(_a,{items:i.campanhaContato,style:{"max-height":"65vh"}},{default:t(({item:s,index:x})=>[(h(),_(z,{key:x,class:"q-py-sm q-px-xs items-center border-full itemHover"},{default:t(()=>[o(A,{class:"hideonmobile col-auto q-pr-sm no-margin"},{default:t(()=>{var O,j;return[f("div",mo,[o(v,{id:(O=s==null?void 0:s.idContato)!=null?O:"",numero:((j=s==null?void 0:s.idContato)!=null?j:"").slice(-8),cor:"positive"},null,8,["id","numero"])])]}),_:2},1024),o(A,{clickable:""},{default:t(()=>[o($,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:t(()=>[u(w(s.nome)+" ",1),o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[26]||(a[26]=[u("Nome")])),_:1})]),_:2},1024),o($,{caption:"",lines:"1",class:"text-tertiary ellipsis"},{default:t(()=>[u(w(s.apelido)+" ",1),o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[27]||(a[27]=[u("Apelido")])),_:1})]),_:2},1024),o(A,{class:"hideondesktop q-mt-sm"},{default:t(()=>[o(y,{items:"center",class:"hideondesktop"},{default:t(()=>[o(b,{col:"12 sm-shrink"},{default:t(()=>{var O,j;return[s!=null&&s.idContato?(h(),_(v,{key:0,id:(O=s==null?void 0:s.idContato)!=null?O:"",numero:((j=s==null?void 0:s.idContato)!=null?j:"").slice(-8),cor:"positive",class:"q-mr-sm"},null,8,["id","numero"])):D("",!0),o(p,{cor:s.status==="Enviado"?"tertiary":"light",escuro:s.status==="Enviado",rotulo:s.status==="Enviado"?"Enviado":"Rascunho",class:"q-mr-sm q-mb-sm"},null,8,["cor","escuro","rotulo"]),o(p,{cor:s!=null&&s.conexaoEnvio?"primary":"tertiary",escuro:!0,rotulo:i.objetoConexoes[s==null?void 0:s.conexaoEnvio]||"",class:"col-auto q-mx-auto"},null,8,["cor","rotulo"])]}),_:2},1024),s.dataHoraEnvio?(h(),_(b,{key:0,col:"12 sm-shrink",class:"q-mr-sm"},{default:t(()=>[o(g,{caption:"",icon:"mdi-calendar-today xs tertiary left"},{default:t(()=>[u(w(e.$filters.dataHora(s.dataHoraEnvio)),1)]),_:2},1024)]),_:2},1024)):D("",!0),s.telefone?(h(),_(b,{key:1,col:"12 sm-shrink",class:"q-mr-sm"},{default:t(()=>[o(g,{caption:"",icon:"phone xs tertiary left"},{default:t(()=>[u(w(s.telefone),1)]),_:2},1024)]),_:2},1024)):D("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024),o(A,{class:"hideonmobile maxw160 q-pl-sm no-margin"},{default:t(()=>[o($,null,{default:t(()=>[o(g,{icon:"phone xs tertiary left",tip:"Telefone"},{default:t(()=>[u(w(s.telefone),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),o(A,{class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:t(()=>[s.dataHoraEnvio?(h(),_($,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:t(()=>[o(P,{name:"mdi-calendar-today"}),u(" "+w(e.$filters.data(s.dataHoraEnvio))+" ",1),o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[u("Enviado \xE1s "+w(e.$filters.hora(s.dataHoraEnvio)),1)]),_:2},1024)]),_:2},1024)):D("",!0)]),_:2},1024),o(A,{class:"hideonmobile maxw90 q-pl-sm no-margin"},{default:t(()=>[o(p,{cor:s.status==="Enviado"?"tertiary":"light",escuro:s.status==="Enviado",rotulo:s.status==="Enviado"?"Enviado":"Rascunho",class:"col-auto q-mx-auto"},{default:t(()=>[o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[28]||(a[28]=[u("Status")])),_:1})]),_:2},1032,["cor","escuro","rotulo"])]),_:2},1024),o(A,{class:"hideonmobile q-pl-sm no-margin",style:{"max-width":"max-content"}},{default:t(()=>[o(p,{cor:s!=null&&s.conexaoEnvio?"primary":"tertiary",escuro:!0,rotulo:i.objetoConexoes[s==null?void 0:s.conexaoEnvio]||"",class:"col-auto q-mx-auto"},{default:t(()=>[o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[29]||(a[29]=[u("Conex\xE3o utilizada para envio da mensagem")])),_:1})]),_:2},1032,["cor","rotulo"])]),_:2},1024),q(o(A,{class:"col-auto q-pl-sm no-margin"},{default:t(()=>[o(k,{onClick:O=>n.contatoRemove(s),disable:s.status==="Enviado",icon:"delete",size:"md",color:"tertiary",round:"",flat:"",dense:""},null,8,["onClick","disable"])]),_:2},1536),[[H,!i.somenteLeitura]])]),_:2},1024))]),_:1},8,["items"])]),_:1})):D("",!0)]),_:1})]),_:1}),o(m,{ref:"modalAnexo"},null,512),o(V,{ref:"modalContato"},null,512),o(E,{ref:"filtersModal"},{genericHeader:t(()=>[u(w(i.modalTitle),1)]),genericContent:t(()=>[q(f("div",po,[o(y,{items:"center",justify:"center"},{default:t(()=>[o(b,{class:"q-my-none q-mx-auto"},{default:t(()=>[i.opcaoAdicionar==="contato-grupo"?(h(),_(r,{key:0,modelValue:i.grupo,"onUpdate:modelValue":a[10]||(a[10]=s=>i.grupo=s),tabela:"contatoGrupo",campo:"label",label:"Filtre",buscarSemCaractere:!0,filtro:{ativo:!0,vendedores:!0}},null,8,["modelValue"])):D("",!0),i.opcaoAdicionar==="carteira-vendedor"?(h(),_(r,{key:1,modelValue:i.vendedor,"onUpdate:modelValue":a[11]||(a[11]=s=>i.vendedor=s),tabela:"contato",campo:"nome",label:"Filtre",buscarSemCaractere:!0,filtro:{ativo:!0,vendedores:!0},enableObj:!0},null,8,["modelValue"])):D("",!0),i.opcaoAdicionar==="carteira-aniversariantes"?(h(),_(y,{key:2,gutter:"md",mg:"md-l-ng",class:"date-without-year"},{default:t(()=>[o(b,{col:"12"},{default:t(()=>[o(qa,{modelValue:i.filtro.periodo.aniversario,"onUpdate:modelValue":a[12]||(a[12]=s=>i.filtro.periodo.aniversario=s),title:"Aniversariantes",range:"",subtitle:"Selecione um periodo"},null,8,["modelValue"])]),_:1})]),_:1})):D("",!0),i.opcaoAdicionar==="carteira-receitas-vencidas"?(h(),_(y,{key:3,gutter:"md",mg:"md-t",class:"invalid-recipes"},{default:t(()=>[o(b,{col:"12"},{default:t(()=>[o(F,{modelValue:i.filtro.periodo.receitaVencida.from,"onUpdate:modelValue":a[13]||(a[13]=s=>i.filtro.periodo.receitaVencida.from=s),tipo:"data",class:"no-shadow full-width",after:[{icon:"mdi-close-circle",handler(){i.filtro.periodo.receitaVencida.ini=""}}],rotulo:"De",dense:""},null,8,["modelValue","after"])]),_:1}),o(b,{col:"12"},{default:t(()=>[o(F,{modelValue:i.filtro.periodo.receitaVencida.to,"onUpdate:modelValue":a[14]||(a[14]=s=>i.filtro.periodo.receitaVencida.to=s),tipo:"data",class:"no-shadow full-width",after:[{icon:"mdi-close-circle",handler(){i.filtro.periodo.receitaVencida.fim=""}}],rotulo:"at\xE9",col:"12",dense:""},null,8,["modelValue","after"])]),_:1})]),_:1})):D("",!0)]),_:1})]),_:1})],512),[[H,!i.somenteLeitura]])]),genericFooter:t(()=>[q(o(k,{onClick:n.concluirFiltros,label:"Avan\xE7ar",color:"primary",flat:""},null,8,["onClick"]),[[U]])]),_:1},512),o(la,{class:"bg-light q-pa-sm text-right u-bordaCima"},{default:t(()=>[f("div",ho,[q(o(k,{onClick:n.testarEnvio_click,type:"submit",icon:"send",label:"Testar Envio",color:"primary",unelevated:""},null,8,["onClick"]),[[H,!i.somenteLeitura]]),q(o(k,{onClick:n.enviar_click,type:"submit",icon:"send",label:"Enviar",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[H,!i.somenteLeitura]]),q(o(k,{onClick:n.rascunho_click,type:"submit",label:"Voltar para Rascunho",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[H,i.somenteLeitura]])])]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),o(Q,{ref:"PromptGrupoUnico"},null,512),o(M,{ref:"PromptSegmentoUnico"},null,512),o(na,{ref:"PromptOrigemMarketingUnico"},null,512),o(da,{props:i.filtroDinamico,onAplicar:n.aplicarFiltroDinamico},null,8,["props","onAplicar"]),o(ua,{ref:"jsonViewer"},null,512),o(ca,{ref:"testeEnvio",onAtualizar:n.atualizar},null,8,["onAtualizar"])],64)}var vo=R(co,[["render",fo]]);const go={components:{Lista:Da,campanhaFicha:vo,JsonViewer:sa},data(){return{usuario:"",lista:[],mostrar:{header:!0,barraTopo:!0,toolbarTitulo:!0,icone:"campaign",titulo:"Campanhas",filtroAvancado:!0,buscar:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:""},busca:"",filtrosOriginal:{},filtros:{termoBusca:null,tipo:null,descricao:null,mensagem:null,dataHoraCriacaoDe:null,dataHoraCriacaoAte:null,dataHoraDisparoDe:null,dataHoraDisparoAte:null,dataHoraUltimoDisparoDe:null,dataHoraUltimoDisparoAte:null},tabSelecionada:{valor:"Rascunho"},tabs:[{valor:"Rascunho",rotulo:"Rascunhos"},{valor:"Enviando",rotulo:"Enviando"},{valor:"Enviada",rotulo:"Enviadas"},{valor:"Todos",rotulo:"Todos"}],paginacao:{atual:1,maximo:1,total:1,limite:25}}},methods:{async atualizar(e){var a,l,d,i,n,c,g,b,p,v,y,F;try{$q.loading.show(),this.lista=[],this.tabSelecionadaAnt!==this.tabSelecionada.valor&&(this.paginacao.atual=1),this.tabSelecionadaAnt=this.tabSelecionada.valor;let{buscarDadosRecentes:S}=e!=null?e:{},m={},V={};S&&(m=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:"CampanhasLista_"+((a=this.usuario)==null?void 0:a.id)}),m!=null&&m._id&&(this.tabSelecionada.valor=m==null?void 0:m.tabSelecionada,this.busca=(m==null?void 0:m.busca)||"",this.filtros={termoBusca:((l=m==null?void 0:m.filtros)==null?void 0:l.termoBusca)||null,tipo:((d=m==null?void 0:m.filtros)==null?void 0:d.tipo)||null,descricao:((i=m==null?void 0:m.filtros)==null?void 0:i.descricao)||null,mensagem:((n=m==null?void 0:m.filtros)==null?void 0:n.mensagem)||null,dataHoraCriacaoDe:((c=m==null?void 0:m.filtros)==null?void 0:c.dataHoraCriacaoDe)||null,dataHoraCriacaoAte:((g=m==null?void 0:m.filtros)==null?void 0:g.dataHoraCriacaoAte)||null,dataHoraDisparoDe:((b=m==null?void 0:m.filtros)==null?void 0:b.dataHoraDisparoDe)||null,dataHoraDisparoAte:((p=m==null?void 0:m.filtros)==null?void 0:p.dataHoraDisparoAte)||null,dataHoraUltimoDisparoDe:((v=m==null?void 0:m.filtros)==null?void 0:v.dataHoraUltimoDisparoDe)||null,dataHoraUltimoDisparoAte:((y=m==null?void 0:m.filtros)==null?void 0:y.dataHoraUltimoDisparoAte)||null},this.compareObject(this.filtrosOriginal,this.filtros,["termoBusca"])&&(this.$refs.campanhasLista.filtros=!0))),V=$utils.eliminarVazios(this.filtros),V.status=this.tabSelecionada.valor,this.tabSelecionada.valor==="Todos"&&delete V.status,this.busca&&(/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/.test(this.busca)?(V={},this.tabSelecionada.valor="Todos",this.paginacao.atual=1,V.id=this.busca):V.termoBusca=this.busca);const r=(await $utils.geeksApi({ret:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",filtros:V,limit:this.paginacao.limite,page:this.paginacao.atual,sort:"descricao"}})).data.ret;r.total||(r.total=r.total=r.data.length),r.totalPages||(r.totalPages=r.total/this.paginacao.limite),this.lista=r.data,this.paginacao.total=r.total,this.paginacao.maximo=r.totalPages,m={_id:"CampanhasLista_"+((F=this.usuario)==null?void 0:F.id),tabSelecionada:this.tabSelecionada.valor,busca:this.busca,filtros:$utils.clonar(V)},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:m})}catch(S){$q.notifyError("Erro iniciar",S)}finally{$q.loading.hide()}},async abrir(e){this.$router.replace({params:{id:e}}).finally(()=>{this.$refs.modalFicha.mostrar({id:e})})},async copiarCampanha(e){this.$q.dialog({title:"Duplicar Campanha?",message:"Deseja criar uma c\xF3pia desta campanha?",cancel:{label:"Voltar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{this.$q.loading.show();const a=await $utils.geeksApi({ret:{funcao:"5FBF590B-9B92-4C38-A205-3B4233541140",id:e}}),l=$utils.clonar(a.data.ret.campanha),d=$utils.clonar(a.data.ret.campanhaContato),i=$utils.clonar(a.data.ret.campanhaAnexo);if(l.id=$utils.uuid(),l.status="Rascunho",l.dataHoraCriacao=new Date,l.dataHoraDisparo=null,l.dataHoraUltimoDisparo=null,l.log=null,await $utils.geeksApi({ret:{funcao:"65A200F2-9B9F-40E6-BD3A-282B77FC6BFB",...l}}),i.length>0)for(let n in i){if(!i[n].anexo){const c=await $utils.geeksApi({buscaAnexo:{funcao:"B546B803-45E8-40B5-9F28-CFCC323AD5FD",id:i[n].id}});i[n].anexo=c.data.buscaAnexo.anexo}i[n].id=$utils.uuid(),i[n].idCampanha=l.id,await $utils.geeksApi({ret:{funcao:"D280149A-F8EA-4103-B4AA-656707767F19",idCampanha:l.id,anexo:i[n].anexo,nomeArquivo:i[n].nomeArquivo}})}if(d.length>0)for(let n of d)(await $utils.geeksApi({ret:{funcao:"B18C0CB3-5EA1-4E1C-8C31-EB354E5E3DB1",idCampanha:l.id,idContato:n.idContato,nome:n.nome,apelido:n.apelido,telefone:n.telefone,email:n.email}})).data.ret.erro?$q.notifyError("ret.data.ret.erro"):console.log("contato adicionado!");await this.atualizar(),this.editarCopiaCampanha_click(l.id)}catch(a){console.log(a.message)}finally{this.$q.loading.hide()}})},editarCopiaCampanha_click(e){this.$q.dialog({title:"Campanha duplicada",message:"Deseja editar agora a c\xF3pia da campanha?",cancel:{label:"N\xE3o",push:!0,class:"bg-linght",textColor:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(async()=>{try{this.$q.loading.show(),this.abrir(e)}catch(a){console.log(a.message)}finally{this.$q.loading.hide()}})},criarClick(){this.$refs.modalFicha.criar()},async limparFiltrosClick(){this.filtros=$utils.clonar(this.filtrosOriginal),await this.atualizar()},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)},async deletarCampanhaRascunho(e){const a=await $utils.geeksApi({deletar:{funcao:"B0DD9B0A-F684-4829-8772-B42670470017",id:e}});a.data.deletar.erro===0?$q.notifyPositive(a.data.deletar.mensagem):$q.notifyError(a.data.deletar.mensagem),await this.atualizar()},compareObject(e,a,l=[]){const d=Object.keys(e);for(const i of d)if(!l.includes(i)){if(typeof e[i]=="object"&&e[i]!==null){if(!this.compareObject(e[i],a[i],l))continue;return!0}else if(e[i]!==a[i])return!0}return!1}},async mounted(){this.usuario=JSON.parse(localStorage.getItem("usuario")),this.filtrosOriginal=$utils.clonar(this.filtros),this.$route.params.id&&this.$route.params.id.length?(this.$refs.modalFicha.mostrar({id:this.$route.params.id}),this.busca=this.$route.params.id,await this.atualizar()):await this.atualizar({buscarDadosRecentes:!0})}},Co={id:"CampanhasLista"},bo={class:"mw80 text-center"},yo={class:"text-weight-medium q-mr-xs"},wo={class:"text-weight-medium q-mr-xs"},_o={class:"text-weight-medium q-mr-xs"},Ao={class:"text-weight-medium"},ko={class:"text-weight-medium"},Do={class:"text-weight-medium"},qo={class:"text-weight-medium"},xo={class:"text-weight-medium"};function Vo(e,a,l,d,i,n){const c=C("campo"),g=C("BadgeCopiarUid"),b=C("avatar"),p=C("badge"),v=C("g-col"),y=C("g-label"),F=C("g-row"),S=C("Lista"),m=C("campanhaFicha"),V=C("JsonViewer");return h(),L("div",Co,[o(S,{ref:"campanhasLista",busca:i.busca,"onUpdate:busca":a[10]||(a[10]=r=>i.busca=r),onCriarClick:n.criarClick,onAtualizar:n.atualizar,onLimparFiltrosClick:n.limparFiltrosClick,lista:i.lista,tabSelecionada:i.tabSelecionada,tabs:i.tabs,paginacao:i.paginacao,mostrar:i.mostrar},{menuExtras:t(()=>[q((h(),_(z,{onClick:a[0]||(a[0]=r=>n.mostrarJsonViewer()),clickable:""},{default:t(()=>[o(A,{avatar:""},{default:t(()=>[o(P,{name:"mdi-file-replace",size:"sm"})]),_:1}),o(A,null,{default:t(()=>a[11]||(a[11]=[u("Ver Objeto")])),_:1})]),_:1})),[[U]])]),filtroCampos:t(()=>[o(c,{modelValue:i.filtros.descricao,"onUpdate:modelValue":a[1]||(a[1]=r=>i.filtros.descricao=r),dense:"",rotulo:"Nome da Campanha",class:"q-mt-sm"},null,8,["modelValue"]),o(c,{modelValue:i.filtros.mensagem,"onUpdate:modelValue":a[2]||(a[2]=r=>i.filtros.mensagem=r),dense:"",rotulo:"Mensagem",class:"q-mt-lg"},null,8,["modelValue"]),o(c,{modelValue:i.filtros.dataHoraCriacaoDe,"onUpdate:modelValue":a[3]||(a[3]=r=>i.filtros.dataHoraCriacaoDe=r),dense:"",rotulo:"Data cria\xE7\xE3o",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),o(c,{modelValue:i.filtros.dataHoraCriacaoAte,"onUpdate:modelValue":a[4]||(a[4]=r=>i.filtros.dataHoraCriacaoAte=r),rotulo:"at\xE9",tipo:"data",dense:"",class:"q-mt-sm"},null,8,["modelValue"]),o(c,{modelValue:i.filtros.dataHoraDisparoDe,"onUpdate:modelValue":a[5]||(a[5]=r=>i.filtros.dataHoraDisparoDe=r),dense:"",rotulo:"Data disparo",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),o(c,{modelValue:i.filtros.dataHoraDisparoAte,"onUpdate:modelValue":a[6]||(a[6]=r=>i.filtros.dataHoraDisparoAte=r),dense:"",rotulo:"at\xE9",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"]),o(c,{modelValue:i.filtros.dataHoraUltimoDisparoDe,"onUpdate:modelValue":a[7]||(a[7]=r=>i.filtros.dataHoraUltimoDisparoDe=r),dense:"",rotulo:"Data \xFAltimo disparo",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),o(c,{modelValue:i.filtros.dataHoraUltimoDisparoAte,"onUpdate:modelValue":a[8]||(a[8]=r=>i.filtros.dataHoraUltimoDisparoAte=r),dense:"",rotulo:"at\xE9",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"]),o(c,{modelValue:i.paginacao.limite,"onUpdate:modelValue":a[9]||(a[9]=r=>i.paginacao.limite=r),dense:"",tipo:"quantidade",rotulo:"Quantidade por p\xE1gina",min:"1",class:"q-mt-xl q-mb-lg"},null,8,["modelValue"])]),itemLista:t(()=>[o(X,{bordered:"",class:"bg-white q-mb-xs rounded-borders"},{default:t(()=>[(h(!0),L(J,null,Z(i.lista,r=>(h(),L("div",{key:r.id,class:"itemHover"},[o(z,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:t(()=>[o(A,{class:"hideonmobile col-auto q-pr-sm no-margin"},{default:t(()=>[f("div",bo,[o(g,{id:r.id,numero:r.id.slice(-8),cor:"positive",dica:"ID Campanha"},null,8,["id","numero"])])]),_:2},1024),o(A,{class:"col no-margin"},{default:t(()=>[o(z,{class:"q-pa-none"},{default:t(()=>[o(A,{class:"col-auto items-center"},{default:t(()=>[o(b,{imagem:r.imagem,rotulo:r.descricao,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]),_:2},1024),o(A,{onClick:E=>n.abrir(r.id),class:"col cursor-pointer"},{default:t(()=>[o($,{lines:"2",class:"text-weight-bold ellipsis-2-lines"},{default:t(()=>[f("span",null,[u(w(r.descricao||"Sem descri\xE7\xE3o")+" ",1),o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[12]||(a[12]=[u("Descri\xE7\xE3o")])),_:1})])]),_:2},1024),r.responsavel?(h(),_($,{key:0,caption:""},{default:t(()=>[f("span",null,[u(w(r.responsavel)+" ",1),o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[13]||(a[13]=[u("Respons\xE1vel")])),_:1})])]),_:2},1024)):D("",!0),o(A,{class:"hideondesktop q-mt-sm"},{default:t(()=>[o(F,{mg:"xs-b"},{default:t(()=>[o(v,{col:"12",class:"q-mt-xs"},{default:t(()=>[o(g,{id:r.id,escuro:"",cor:"positive",numero:r.id.slice(-8),class:"q-mr-sm"},null,8,["id","numero"]),o(p,{rotulo:r.status,class:"q-mr-sm",cor:r.status!=="Rascunho"?"tertiary":"light",escuro:r.status!=="Rascunho"},null,8,["rotulo","cor","escuro"])]),_:2},1024),r.dataHoraCriacao?(h(),_(v,{key:0,col:"12",class:"q-mt-xs"},{default:t(()=>[o(y,null,{default:t(()=>[a[14]||(a[14]=u(" Cria\xE7\xE3o: ")),f("span",yo,w(e.$filters.data(r.dataHoraCriacao)),1),u(" "+w(e.$filters.hora(r.dataHoraCriacao)),1)]),_:2},1024)]),_:2},1024)):D("",!0),r.dataHoraDisparo?(h(),_(v,{key:1,col:"12",class:"q-mt-xs"},{default:t(()=>[o(y,null,{default:t(()=>[a[15]||(a[15]=u(" Disparo: ")),f("span",wo,w(e.$filters.data(r.dataHoraDisparo)),1),u(" "+w(e.$filters.hora(r.dataHoraDisparo)),1)]),_:2},1024)]),_:2},1024)):D("",!0),r.dataHoraUltimoDisparo?(h(),_(v,{key:2,col:"12",class:"q-mt-xs"},{default:t(()=>[o(y,null,{default:t(()=>[a[16]||(a[16]=u(" \xDAltimo: ")),f("span",_o,w(e.$filters.data(r.dataHoraUltimoDisparo)),1),u(" "+w(e.$filters.hora(r.dataHoraUltimoDisparo)),1)]),_:2},1024)]),_:2},1024)):D("",!0),o(v,{col:"12",class:"q-mt-xs"},{default:t(()=>[o(y,{inline:"",class:"q-mr-sm"},{default:t(()=>[a[17]||(a[17]=u(" Contatos: ")),f("span",Ao,w(r.qtdeContatos),1)]),_:2},1024),o(y,{inline:"",class:"q-mr-sm"},{default:t(()=>[a[18]||(a[18]=u(" Enviados: ")),f("span",ko,w(r.qtdeEnviado),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(A,{onClick:E=>n.abrir(r.id),class:"hideonmobile maxw150 q-pl-sm no-margin cursor-pointer"},{default:t(()=>[r.dataHoraCriacao?(h(),_($,{key:0,caption:"",lines:"1",class:"ellipsis"},{default:t(()=>[f("span",null,[o(P,{name:"mdi-calendar-today",class:"q-mr-xs"}),f("span",Do,w(e.$filters.data(r.dataHoraCriacao)),1),u(" "+w(e.$filters.hora(r.dataHoraCriacao))+" ",1),o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[19]||(a[19]=[u(" Criado ")])),_:1})])]),_:2},1024)):D("",!0),r.dataHoraDisparo?(h(),_($,{key:1,caption:"",lines:"1",class:"ellipsis"},{default:t(()=>[f("span",null,[o(P,{name:"mdi-calendar-today",class:"q-mr-xs"}),f("span",qo,w(e.$filters.data(r.dataHoraDisparo)),1),u(" "+w(e.$filters.hora(r.dataHoraDisparo))+" ",1),o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[20]||(a[20]=[u(" Disparado ")])),_:1})])]),_:2},1024)):D("",!0),r.dataHoraUltimoDisparo?(h(),_($,{key:2,caption:"",lines:"1",class:"ellipsis"},{default:t(()=>[f("span",null,[o(P,{name:"mdi-calendar",class:"q-mr-xs"}),f("span",xo,w(e.$filters.data(r.dataHoraUltimoDisparo)),1),u(" "+w(e.$filters.hora(r.dataHoraUltimoDisparo))+" ",1),o(B,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[21]||(a[21]=[u(" \xDAltimo Disparo ")])),_:1})])]),_:2},1024)):D("",!0)]),_:2},1032,["onClick"]),o(A,{onClick:E=>n.abrir(r.id),class:"hideonmobile maxw90 q-pl-sm no-margin cursor-pointer"},{default:t(()=>[o(p,{rotulo:r.status,dica:"Status",class:"col-auto q-mx-auto",cor:r.status!=="Rascunho"?"tertiary":"light",escuro:r.status!=="Rascunho"},null,8,["rotulo","cor","escuro"])]),_:2},1032,["onClick"]),o(A,{onClick:E=>n.abrir(r.id),class:"hideonmobile maxw60 q-pl-sm no-margin cursor-pointer"},{default:t(()=>[o($,{class:"text-weight-bold text-right"},{default:t(()=>[u(w(r.qtdeContatos),1)]),_:2},1024),o($,{caption:"",class:"text-right"},{default:t(()=>a[22]||(a[22]=[u("Contatos")])),_:1})]),_:2},1032,["onClick"]),o(A,{onClick:E=>n.abrir(r.id),class:"hideonmobile maxw60 q-pl-sm no-margin cursor-pointer"},{default:t(()=>[o($,{class:"text-weight-bold text-right"},{default:t(()=>[u(w(r.qtdeEnviado),1)]),_:2},1024),o($,{caption:"",class:"text-right"},{default:t(()=>a[23]||(a[23]=[u("Enviados")])),_:1})]),_:2},1032,["onClick"]),o(A,{class:"col-auto q-pl-sm no-margin"},{default:t(()=>[o(z,{class:"q-pa-none"},{default:t(()=>[o(A,{class:"hideonmobile no-margin"},{default:t(()=>[o(k,{onClick:E=>n.abrir(r.id),round:"",flat:"",dense:"",icon:"edit",size:"md",color:"primary"},null,8,["onClick"])]),_:2},1024),o(A,{class:"no-margin"},{default:t(()=>[o(k,{icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:t(()=>[o(K,null,{default:t(()=>[q((h(),_(X,{link:"","no-border":"",separator:""},{default:t(()=>[o(z,{onClick:E=>n.abrir(r.id),clickable:"",class:"hideondesktop"},{default:t(()=>[o(A,{avatar:""},{default:t(()=>[o(P,{name:"edit"})]),_:1}),o(A,null,{default:t(()=>a[24]||(a[24]=[u("Editar")])),_:1})]),_:2},1032,["onClick"]),o(z,{onClick:E=>n.copiarCampanha(r.id),clickable:""},{default:t(()=>[o(A,{avatar:""},{default:t(()=>[o(P,{name:"content_copy"})]),_:1}),o(A,null,{default:t(()=>a[25]||(a[25]=[u("Duplicar")])),_:1})]),_:2},1032,["onClick"]),r.status==="Rascunho"&&r.qtdeEnviado===0?(h(),_(z,{key:0,onClick:E=>n.deletarCampanhaRascunho(r.id),clickable:""},{default:t(()=>[o(A,{avatar:""},{default:t(()=>[o(P,{name:"delete"})]),_:1}),o(A,null,{default:t(()=>a[26]||(a[26]=[u("Excluir")])),_:1})]),_:2},1032,["onClick"])):D("",!0)]),_:2},1024)),[[U]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),o(ka)]))),128))]),_:1})]),_:1},8,["busca","onCriarClick","onAtualizar","onLimparFiltrosClick","lista","tabSelecionada","tabs","paginacao","mostrar"]),o(m,{ref:"modalFicha",onAtualizar:n.atualizar},null,8,["onAtualizar"]),o(V,{ref:"jsonViewer"},null,512)])}var Lo=R(go,[["render",Vo]]);export{Lo as default};
