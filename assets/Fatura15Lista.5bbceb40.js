import{_ as T,Y as P,Z as A,p as h,o as f,d as _,f as e,w as a,P as N,R as b,j as y,e as r,N as R,F as B,r as I,S as d,i as F,b1 as U,l as g,x as c,t as v,k as C,D as L,a4 as M}from"./index.88955961.js";import{l as O}from"./listaV2.145775a7.js";import{m as z}from"./ContatoModalFicha.fa07e2f1.js";import{M as G}from"./ContatoCombinar.9711795c.js";import{x as w}from"./xlsx.9225bf66.js";import"./QBreadcrumbs.aa2200da.js";import"./ContatoFicha.5d230473.js";import"./Icone.afe174ba.js";import"./SeletorPais.4a2267e1.js";import"./open-url.de6258fb.js";const X={components:{lista:O,modalContatoFicha:z,Avatar:P,Badge:A,ModalCombinarContato:G},computed:{titulo(){return this.$route.name==="FaturaB15Optidados"?"Fatura B-15 Optidados":this.$route.name==="FaturaB15"?"Fatura B-15":""}},data(){let t=new Date,o=new Date(new Date(new Date(new Date().setDate(1)).setHours(0,0,0,0)).setFullYear(t.getFullYear()-1)),s=new Date(new Date(new Date(t).setMonth(t.getMonth()+1)).setDate(0));return{lista:[],listaOriginal:[],listaLayout:{},modalCombinarContatos:!1,campos:{nome:"",apelido:"",numeroDocumentoNacional:"",telefone:"",cep:"",numero:""},paginacao:{atual:1,maximo:1,total:1,limite:25},filtros:{nome:null,apelido:null,numeroDocumentoNacional:null,periodo:{ini:o,fim:s}},buscaCampo:"",tabSelecionada:{valor:"EmAberto"},tabs:[{rotulo:"Em Aberto",value:"EmAberto"},{rotulo:"Finalizadas",value:"Finalizado"},{rotulo:"Todas",value:"Todos"}],msgRestricao:"",showAllPreviewDetail:!1,checkboxModel:!1}},methods:{async atualizar(){try{$q.loading.show();const t=$utils.eliminarVazios(this.filtros),o=new Date(this.filtros.periodo.ini).toISOString(),s=new Date(this.filtros.periodo.fim).toISOString(),p=JSON.parse(localStorage.getItem("usuario"));let l;delete t.ativo,this.tabSelecionada.valor==="Ativos"&&(t.ativo=!0),this.tabSelecionada.valor==="Excluidos"&&(t.ativo=!1),this.filtro={periodo:{ini:o,fim:s}},l=(await this.$utils.geeksApi({funcao:{funcao:"2A40FEB6-DCAF-4903-81AF-9ECC9477D03D",periodo:this.filtro.periodo,paginacao:{atual:this.paginacao.atual,limite:this.paginacao.limite},nome:this.filtros.nome||"",apelido:this.filtros.apelido||"",numeroDocumentoNacional:this.filtros.numeroDocumentoNacional||"",usuarioCpf:p.numeroDocumentoNacional,status:this.tabSelecionada.valor}})).data.funcao,this.listaLayout={};for(let n of l.data){const u=await $db.contato.leCompletoV3(n.id);u.detalhes=!1,u.remover=!1,u.ende=$db.contato.contatoBase().endereco[0],this.listaLayout[n.id]=u}this.listaOriginal=$utils.clonarV2(l.data),this.lista=l.data,this.paginacao.total=l.total,this.paginacao.maximo=l.totalPages}catch(t){$q.notifyError("Erro iniciar",t)}finally{$q.loading.hide()}},contatoCriarPorModal_click(){this.$refs.modalFicha.show({id:""})},limparFiltros_click(){this.filtros={tab:"Ativos",nome:null,apelido:null,numeroDocumentoNacional:null,telefone:null,cidade:null,uf:null,grupo:null,segmento:null,estoque:null,vendedor:null},this.atualizar()},checkBoxGeral_click(){for(let t of this.lista)this.listaLayout[t.id].remover=this.checkboxModel},async removerTodos(){$q.dialog({title:"Remover Contatos",message:"Deseja remover todos os contatos selecionados?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{for(let t of this.lista)if(this.listaLayout[t.id].remover){let o=$utils.clonarV2(t);t.ativo=!1;try{await $db.contato.gravar({original:{contato:o},atual:{contato:t}})}catch{$q.notify("Houve um erro ao remover os contatos. Tente novamente")}}})},async restaurarTodos(){$q.dialog({title:"Restaurar itens",message:"Deseja restaurar todos os itens selecionados?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{for(let t of this.lista)if(this.listaLayout[t.id].remover){let o=$utils.clonarV2(t);t.ativo=!0;try{await $db.contato.gravar({original:{contato:o},atual:{contato:t}})}catch{$q.notify("Houve um erro ao restaurar os itens. Tente novamente")}}})},async abrirDetalhesItem(t,o){var s,p;this.listaLayout[t.id].detalhes=o||!((s=this.listaLayout[t.id])!=null&&s.detalhes),(p=this.listaLayout[t.id])!=null&&p.detalhes&&await $db.contato.leCompleto(t.id)},abrirTodosPreview(){this.showAllPreviewDetail=!this.showAllPreviewDetail,this.lista.forEach(t=>{this.abrirDetalhesItem(t,this.showAllPreviewDetail)})},async exportarXLSX_click(){try{$q.loading.show();const t=$utils.eliminarVazios(this.filtros);delete t.ativo,this.tabSelecionada.valor==="Ativos"&&(t.ativo=!0),this.tabSelecionada.valaor==="Excluidos"&&(t.ativo=!1);const o=await $db.contato.leRefatorado({filtros:t,limit:999999,page:1,sort:"descricao"}),s=w.utils.book_new(),p=w.utils.json_to_sheet(o.data,{header:Object.keys(o.data[0])});w.utils.book_append_sheet(s,p,"contatos"),w.writeFile(s,"contatos.xlsx")}catch(t){$q.notifyError("Erro iniciar",t)}finally{$q.loading.hide()}},imprimirBoleto(t){JSON.parse(localStorage.getItem("usuario"));const o=JSON.parse(localStorage.getItem("clienteSistema"));if(o.bancoDeDados="B15App",o.versao="15A",this.$route.name==="FaturaB15Optidados"){let s=`https://rel.storage.b15.com.br/Relatorios/email.html?rid=${t.id.toString().replace(/-/g,"")}&CodigoFinanceiroBoleto=${t.CodigoFinanceiroBoleto}&NomeReport=boleto_layout_itau&URLServidor=https://api.b15.com.br/sql/srv210&Banco=${o.bancoDeDados}&CodigoUsuario=${188}&hfCodigoSistema={data:{ CodigoUsuario: ${188}, CodigoSistema: ${4}, CodigoClienteSistema: ${35}, Sistema: _GeeksInterno, Versao: ${o.versao}, URLServidor: https://api.b15.com.br/sql/srv210,BancoDeDados: ${o.bancoDeDados},CodigoCliente: ${14},Cliente: GEEKSSOLUESEMSOFTWARELTDA,Padrao: false,Administrador: true,GrupoInterno: ${o.grupoInterno}}}`.trim();window.open(s,"_blank")}if(this.$route.name==="FaturaB15"){let s=`https://rel.storage.b15.com.br/Relatorios/email.html?rid=${t.id.toString().replace(/-/g,"")}&CodigoFinanceiroBoleto=${t.CodigoFinanceiroBoleto}&NomeReport=boleto_layout_itau&URLServidor=https://api.b15.com.br/sql/srv210&Banco=${o.bancoDeDados}&CodigoUsuario=${188}&hfCodigoSistema={data:{ CodigoUsuario: ${188}, CodigoSistema: ${4}, CodigoClienteSistema: ${35}, Sistema: _GeeksInterno, Versao: ${o.versao}, URLServidor: https://api.b15.com.br/sql/srv210,BancoDeDados: ${o.bancoDeDados},CodigoCliente: ${14},Cliente: GEEKSSOLUESEMSOFTWARELTDA,Padrao: false,Administrador: true,GrupoInterno: ${o.grupoInterno}}}`.trim();window.open(s,"_blank")}},copiarCodigoBarras(t){const o=document.createElement("INPUT");o.value=t,o.type="text",document.body.appendChild(o);try{o.select(),document.execCommand("copy"),document.body.removeChild(o),this.$q.notify({message:"Codigo de barras copiado para a \xE1rea de transfer\xEAncia.",type:"info"})}catch(s){this.$q.notifyError("Erro ao copiar Codigo de barras",s)}o.type="hidden",window.getSelection().removeAllRanges()}},async mounted(){var o;const t=await $utils.conduta.obter();this.msgRestricao=(o=t==null?void 0:t.restricao)!=null?o:"",this.atualizar()}},j=c("p",null,null,-1),H=c("span",{class:"col-12 text-body1 text-dark"},"Per\xEDodo",-1),J=c("p",null,null,-1),W={class:"col-auto q-pl-none items-center"},Y={class:"col"},K={class:"col-12"},Z={class:"text-tertiary q-col-gutter-xs"},ee={key:1},oe={key:0,class:"q-pa-md showPreviewDetail"},te={class:"col-12 q-mb-md"},ae={class:"col-12 col-md-3"},le={class:"col-12 col-md-3"},ie={class:"col-12 col-md"},re=c("small",null,"Descontos",-1),se=c("br",null,null,-1),ne={key:1,class:"row q-px-md q-pb-md showPreviewDetail"};function de(t,o,s,p,l,n){const u=h("campo"),k=h("badge"),m=h("row"),Q=h("avatar"),q=h("lista"),E=h("modalContatoFicha"),$=h("modalCombinarContato");return f(),_("div",null,[e(q,{titulo:n.titulo,onCriar_click:n.contatoCriarPorModal_click,onCheckBoxGeral_click:n.checkBoxGeral_click,icone:"attach_money",onFiltro_change:n.atualizar,onLimparFiltros_click:n.limparFiltros_click,onAbrirTodosPreview:n.abrirTodosPreview,onExportarXLSX_click:n.exportarXLSX_click,onRemoverTodos:n.removerTodos,onRestaurarTodos:n.restaurarTodos,tabSelecionada:l.tabSelecionada,tabs:l.tabs,lista:l.lista,listaLayout:l.listaLayout,paginacao:l.paginacao,filtros:l.filtros,buscaCampo:l.buscaCampo,"onUpdate:buscaCampo":o[8]||(o[8]=i=>l.buscaCampo=i),checkboxModel:l.checkboxModel,"onUpdate:checkboxModel":o[9]||(o[9]=i=>l.checkboxModel=i),abrirTodosVisible:!1,exportarXLSXVisible:!1,permissaoExtras:!1,removerTodosVisible:!1,checkboxVisible:!1,permissaoNovo:!1,bannerMsg:l.msgRestricao},{menuExtras:a(()=>[e(N,{clickable:"",onClick:o[0]||(o[0]=()=>{this.modalCombinarContatos=!0})},{default:a(()=>[e(b,{avatar:""},{default:a(()=>[e(y,{name:"compare_arrows",size:"sm"})]),_:1}),e(b,null,{default:a(()=>[r("Combinar")]),_:1})]),_:1})]),filtroCampos:a(()=>[e(u,{modelValue:l.filtros.nome,"onUpdate:modelValue":o[1]||(o[1]=i=>l.filtros.nome=i),rotulo:"Nome/Raz\xE3o",dense:""},null,8,["modelValue"]),e(u,{modelValue:l.filtros.apelido,"onUpdate:modelValue":o[2]||(o[2]=i=>l.filtros.apelido=i),rotulo:"Apelido/Fantasia",dense:""},null,8,["modelValue"]),e(u,{modelValue:l.filtros.numeroDocumentoNacional,"onUpdate:modelValue":o[3]||(o[3]=i=>l.filtros.numeroDocumentoNacional=i),rotulo:"CPF/CNPJ",dense:""},null,8,["modelValue"]),j,H,e(u,{modelValue:l.filtros.periodo.ini,"onUpdate:modelValue":o[4]||(o[4]=i=>l.filtros.periodo.ini=i),tipo:"data",class:"no-shadow full-width",rotulo:"De",col:"12",after:[{icon:"mdi-close-circle",handler(){l.filtros.periodo.ini=""}}],dense:""},null,8,["modelValue","after"]),e(u,{modelValue:l.filtros.periodo.fim,"onUpdate:modelValue":o[5]||(o[5]=i=>l.filtros.periodo.fim=i),tipo:"data",class:"no-shadow full-width",rotulo:"at\xE9",col:"12",after:[{icon:"mdi-close-circle",handler(){l.filtros.periodo.fim=""}}],dense:""},null,8,["modelValue","after"]),J,e(u,{modelValue:l.paginacao.limite,"onUpdate:modelValue":o[6]||(o[6]=i=>l.paginacao.limite=i),min:"1",rotulo:"Quantidade por p\xE1gina",tipo:"quantidade",dense:""},null,8,["modelValue"])]),itemLista:a(()=>[e(R,{class:"rounded-borders"},{default:a(()=>[(f(!0),_(B,null,I(l.lista,i=>{var V,S;return f(),_("div",{key:i,class:"itemHover fullWidth"},[e(N,{"manual-focus":"",clickable:"",class:"items-center d-flex q-pa-xs"},{default:a(()=>[e(b,{avatar:"",center:"",class:"mw120 hideonmobile"},{default:a(()=>[e(d,null,{default:a(()=>[e(m,{class:"items-center"},{default:a(()=>[g("",!0),c("p",null,[e(k,{class:"q-mr-sm",escuro:"",cor:"positive"},{default:a(()=>[r(" #"+v(parseInt(i.numero)||(i.id||"").slice(-6)),1)]),_:2},1024)])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(b,{clickable:""},{default:a(()=>[e(m,{class:"items-center q-col-gutter-x-sm"},{default:a(()=>[e(U,{modelValue:l.checkboxModel,"onUpdate:modelValue":o[7]||(o[7]=x=>l.checkboxModel=x),class:"q-ma-none q-pa-none hideondesktop"},null,8,["modelValue"]),c("div",W,[e(Q,{imagem:i.photo,tamanho:"40",rotulo:i.nome,style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]),c("div",Y,[e(d,{class:"text-tertiary text-weight-bold"},{default:a(()=>[r(v(i.Cliente),1)]),_:2},1024),e(d,{caption:"",class:"text-tertiary"},{default:a(()=>[r(v(i.nome),1)]),_:2},1024),e(m,{class:"hideondesktop items-center q-my-sm"},{default:a(()=>[c("div",K,[e(k,{class:"q-mr-sm",escuro:"",cor:"positive"},{default:a(()=>[r("#0001")]),_:1})])]),_:1})])]),_:2},1024)]),_:2},1024),e(b,null,{default:a(()=>[e(d,{class:"text-tertiary"},{default:a(()=>[e(m,null,{default:a(()=>[e(y,{class:"text-tertiary",name:"today"}),e(d,null,{default:a(()=>[r(v(t.$filters.data(i.DataVencimento)),1)]),_:2},1024),e(C,null,{default:a(()=>[r("Data de Vencimento")]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),e(b,null,{default:a(()=>[e(d,{class:"text-tertiary"},{default:a(()=>[r(" R$ "+v(t.$filters.numero(i.ValorOriginal,2))+" ",1),e(C,null,{default:a(()=>[r("Valor")]),_:1})]),_:2},1024)]),_:2},1024),e(b,{side:"",top:""},{default:a(()=>[c("div",Z,[g("",!0),i.receberPagar===!0&&i.dataPagamento===null?(f(),_("div",ee,[e(L,{color:"tertiary",size:"md",icon:"mdi-barcode-scan",flat:"",dense:"",round:"",class:"buttons",onClick:D=>n.copiarCodigoBarras(i.LinhaDigitavel)},null,8,["onClick"]),e(L,{color:"tertiary",flat:"",icon:"print",onClick:D=>n.imprimirBoleto(i)},null,8,["onClick"])])):g("",!0),i.receberPagar===!0&&i.dataPagamento!==null?(f(),F(d,{key:2,class:"text-tertiary"},{default:a(()=>[e(m,null,{default:a(()=>[e(d,null,{default:a(()=>[e(k,{class:"q-mr-sm",escuro:"",cor:"positive"},{default:a(()=>[e(y,{class:"text-white",name:"today"}),r(" Pago em "+v(t.$filters.data(i.dataPagamento)),1)]),_:2},1024),e(C,null,{default:a(()=>[r("Data de Pagamento")]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024)):g("",!0),g("",!0)])]),_:2},1024)]),_:2},1024),(V=l.listaLayout[i.id])!=null&&V.detalhes?(f(),_("div",oe,[e(m,{class:"q-col-gutter-md text-tertiary"},{default:a(()=>[c("div",te,[e(d,null,{default:a(()=>[r("52x - Descri\xE7\xE3o do item ")]),_:1})])]),_:1}),e(m,{class:"q-col-gutter-md text-tertiary"},{default:a(()=>[c("div",ae,[e(d,{class:"text-tertiary"},{default:a(()=>[e(m,null,{default:a(()=>[e(y,{class:"text-tertiary",name:"today"}),e(d,null,{default:a(()=>[r("22/01/2021 ")]),_:1}),e(C,null,{default:a(()=>[r("Data de Emiss\xE3o")]),_:1})]),_:1})]),_:1})]),c("div",le,[e(d,{class:"text-tertiary"},{default:a(()=>[e(m,null,{default:a(()=>[e(y,{class:"text-tertiary",name:"today"}),e(d,null,{default:a(()=>[r("22/01/2021 ")]),_:1}),e(C,null,{default:a(()=>[r("Data de Vencimento")]),_:1})]),_:1})]),_:1})]),c("div",ie,[e(d,{class:"text-tertiary text-right"},{default:a(()=>[re,se,r(" R$100,00 "),e(C,null,{default:a(()=>[r("Valor")]),_:1})]),_:1})])]),_:1})])):g("",!0),(S=l.listaLayout[i.id])!=null&&S.detalhes?(f(),_("div",ne,[(f(!0),_(B,null,I(i.tags,x=>(f(),F(k,{class:"q-mr-sm",escuro:"",cor:"primary",key:x},{default:a(()=>[r(v(x),1)]),_:2},1024))),128))])):g("",!0),e(M)])}),128))]),_:1})]),_:1},8,["titulo","onCriar_click","onCheckBoxGeral_click","onFiltro_change","onLimparFiltros_click","onAbrirTodosPreview","onExportarXLSX_click","onRemoverTodos","onRestaurarTodos","tabSelecionada","tabs","lista","listaLayout","paginacao","filtros","buscaCampo","checkboxModel","bannerMsg"]),e(E,{ref:"modalFicha"},null,512),e($,{modelValue:l.modalCombinarContatos,"onUpdate:modelValue":o[10]||(o[10]=i=>l.modalCombinarContatos=i)},null,8,["modelValue"])])}var ke=T(X,[["render",de]]);export{ke as default};
