import{by as f,co as m,cp as _}from"./index.20d4d726.js";var D={executa(e,i,o){return this.geraTags(e,i,o)},geraTags(e,i,o){let r={},t=!1;for(let s in e)if(!s.startsWith("_")){if(s.startsWith("lista"))return this.geraLista(e[s],i,o);s==="visivel"?i!=null&&s in i?r[s]=i[s]:r[s]=e[s]._valorInic===!0:s==="valor_escolha"?i!=null&&s in i?r[s]=i[s]:(r[s]=this.primeiraEscolha(e),r[s]==="ICMS00"&&(r[s]="")):i!=null&&s in i?r[s]=this.geraTags(e[s],i[s],o):r[s]=this.geraTags(e[s],null,o),t=!0}return t||(i==null?r=e._valorInic:e._tipo==="data"&&i.length===10?r=i+"T00:00:00":r=i),r},geraLista(e,i,o){let r=[];for(let t in i)r.push(this.geraTags(e,i[t],o));return r},primeiraEscolha(e){if(e._opcional)return"N\xE3o se aplica";for(let i in e)if(!i.startsWith("_")){if(i==="valor_escolha")continue;return i}return""}},v={formataNumero(e,i){let o=e;if(typeof e=="string"&&(e=Number(e.replace(/\./g,"").replace(",","."))),typeof e=="number"){const r=e.toFixed(i),t=e.toString();o=r.length>t.length?r:t}return o},mensagemPorTipo(e,i,o,r,t,s,a,n){let l="";return o==="cEAN"||o==="cEANTrib"?l="Deve conter 8, 12, 13 ou 14 digitos ou o texto SEM GTIN":r==="TCnpj"?l="Deve conter 14 digitos":r==="TCnpjOpc"?l="Deve conter 14 digitos ou em branco":r==="TCpf"?l="Deve conter 11 digitos":r==="TIeDestNaoIsento"?l="Deve conter de 2 a 14 digitos":r==="TIeDest"||r==="TIe"?l="Deve conter de 2 a 14 digitos ou o texto ISENTO":r==="TSerie"?l="Deve conter de 1 a 3 digitos":r==="TDec_0302a04Max100"?l="Deve ser um n\xFAmero de 0 a 100 com at\xE9 4 decimais":r.startsWith("TDec_0302a04")?l="Deve ser um n\xFAmero de 0 a 999 com at\xE9 4 decimais":f.tiposNumero.includes(t)?!a&&Number(i)===0?l="Campo obrigat\xF3rio":a&&Number(i)===0?l="":s===0?l="N\xFAmero inv\xE1lido":l="Deve ser um valor com at\xE9 "+s+" casas decimais":l="Conte\xFAdo inv\xE1lido",l},consisteCampo(e,i,o){const r=typeof e=="string"?e.length:e?e.toString().length:0,t=i._minLength||0,s=i._maxLength||0,a=i._opcional||!1,n=i._pattern||null,l=i._type||"",g=i._tipo||"",h=parseInt(i._decimals||"0");let c="",p=!1,u=e;return n&&(f.tiposNumero.includes(g)&&(u=this.formataNumero(e,h)),g==="data"?u=f.formatarDataNFeSemHoras(e):g==="dataHora"&&(u=f.formatarDataNFe(e)),p=new RegExp("^("+n+")$").test(u)),a&&r===0?c="":!a&&r===0&&!p?c="Campo obrigat\xF3rio":r<t?c="Tamanho m\xEDnimo de "+t+" caracteres":s!==0&&r>s?c="Tamanho m\xE1ximo de "+s+" caracteres":n===null||n===""||p?c="":c=this.mensagemPorTipo(e,u,o,l,g,h,a,n),c||void 0}},b={erros:null,executa(e,i){const o=m("compactarValidarNFe");try{return this.erros=[],this.gerarTags(e,i,"infNFe")}catch(r){throw console.error(`Erro no compactarValidarNFe
`,r),r}finally{_(o)}},gerarTags(e,i,o){let r={};if(i=i||{},e.visivel)if(i.visivel)r.visivel=!0;else return r;for(let t in e){if(t.startsWith("_")||t==="visivel")continue;const s=i[t],a=e[t];if(t.startsWith("opcional")){let n=this.gerarTags(a,s,o+"."+t);n.visivel&&(r[t]=n)}else if(t.startsWith("escolhas")){const n=(s||{}).valor_escolha||"";if(n in a){const l=this.gerarCampo(a[n],s,n,o+"."+n);l!==null&&!(l.constructor===Object&&Object.keys(l).length===0)&&(r[t]={valor_escolha:n},r[t][n]=l)}}else{const n=this.gerarCampo(a,i,t,o+"."+t);n!==null&&(r[t]=n)}}return r},gerarCampo(e,i,o,r){let t=(i||{})[o],s=v.consisteCampo(t,e,o);if(s&&this.erros.push("Erro: "+s+". Campo: "+e._titulo+" ("+r+")"),f.tiposNumero.includes(e._tipo)){if(t)return t;if(!e._opcional)return 0}else if(e._tipo==="dataHora"){if(t)return f.formatarDataNFe(t);if(!e._opcional)return""}else if(e._tipo==="data"){if(t)return f.formatarDataNFeSemHoras(t);if(!e._opcional)return""}else if("lista"in e){if(t&&t.constructor===Array&&t.length>0)return this.gerarLista(e.lista,t,r+"."+o);if(!e._opcional)return[]}else if(t==null){if(!e._opcional)return null}else if(t.constructor===String){if(t)return t;if(!e._opcional)return""}else{let a=this.gerarTags(e,t,r);if(t!=null&&Object.keys(a).length>0&&t.visivel!==!1)return a;if(!e._opcional)return{}}return null},gerarLista(e,i,o){let r=[];for(let t in i)r.push(this.gerarTags(e,i[t],o+"["+t+"]"));return r}};export{b as a,D as c,v};
