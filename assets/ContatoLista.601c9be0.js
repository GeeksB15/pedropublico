import{_ as H,be as W,aE as O,an as j,p as L,a8 as J,o as d,i as b,w as s,f as t,s as K,B as Y,E as Z,e as C,t as h,C as S,D as y,L as M,x as m,z as ee,n as oe,bb as te,d as p,F as I,r as D,Q as F,az as E,N as P,P as q,R as _,l as v,U as B,y as ae,W as le,X as ie,Y as se,Z as re,j as V,a6 as ne,b1 as $,S as A,k as G,q as de,a4 as ue,bs as ce}from"./index.81269774.js";import{Q as X}from"./QBtnGroup.d8322823.js";import{l as me}from"./listaV2.e57fdb1b.js";import{m as fe}from"./ContatoModalFicha.46c45fcf.js";import{M as he}from"./ContatoCombinar.70f81a73.js";import{x as R}from"./xlsx.09c1adc2.js";import"./QBreadcrumbs.ea899c8f.js";import"./ContatoFicha.6c980e77.js";import"./Icone.a14cf3d7.js";import"./SeletorPais.83b68898.js";import"./open-url.a086c90d.js";const ve={components:{SeletorCampoTabela:W},data(){return{visivel:!1,descricao:"",tipo:"",opcoesTipo:[],isLoading:!1,continuarCadastrando:!1,proximoInput:0}},props:{modalConfig:{required:!0,type:Object}},methods:{fecharSeletor(e){},async criar(){try{this.isLoading=!0;const e=await this.modalConfig.criar();this.$q.notifyPositive(this.modalConfig.successMsg),this.continuarCadastrando?(this.continuarCadastrando=!1,this.resetNovoCadastro()):(this.close(),this.modalConfig.abrirItem&&this.modalConfig.abrirItem(e.id))}catch(e){$q.notifyError(`Ocorreu erro ao adicionar ${this.modalConfig.db}`,e)}finally{this.isLoading=!1}},async abrirItem(e){this.close(),this.modalConfig.abrirItem&&this.modalConfig.abrirItem(e)},async buscarItems(e,o){e.onchange&&e.onchange();var n=this;if(e.isLoading=!0,this.proximoCampo(o),!e.value&&e.value.length<3)return clearTimeout(n.actualTimeouot),e.searches=[],e.isLoading=!1,!1;await n.erpQuery(e.value,o)},onHide(){for(const e of this.modalConfig.campos)e.value=e.default||"",e.searches=[]},show(){this.visivel=!0,this.modalConfig.configRules&&this.modalConfig.configRules();for(const e of this.modalConfig.campos)e.value=e.default||"",e.searches=[];return new Promise((e,o)=>{this.resolve=e,e(!0)})},close(){return this.visivel=!1,new Promise((e,o)=>{this.resolve=e,e(!0)})},async erpQuery(e,o){const n=this.modalConfig.campos[o];let f=this.getReceived(this.modalConfig.db),l=[];this.modalConfig.func?l=(await O[this.modalConfig.db][this.modalConfig.func]({filtros:n.condition})).data:(await O[this.modalConfig.db].carregarMemoria(),l=O[this.modalConfig.db][f]),l=l.filter(g=>{if(!g[n.chave])return!1;if(!isNaN(parseInt(g[n.chave]))&&n.onlyNumber)return g[n.chave]===n.value&&g[this.getChaveDescricao(g)]!==void 0;if(n.condition){let w=Object.keys(n.condition);for(const N of w)if(g[N]!==n.condition[N])return!1}let k=!1;for(const w of n.value.split(" "))w.length<2||(k=g[n.chave].toLowerCase().indexOf(w.toLowerCase())!==-1);return k});let r=this.getCampoByIndex(o);r.searches=l,l.length>0&&(n.showing=j(!0)),n.isLoading=!1,await this.$forceUpdate()},getCampoBusca(){let e=this.modalConfig.campos.findIndex(o=>o.chave==="termoBusca");return this.modalConfig.campos[e]},getCampo(e){let o=this.modalConfig.campos.findIndex(n=>n.chave===e);return this.modalConfig.campos[o]},getCampoByIndex(e){return this.modalConfig.campos[e]},getReceived(e){return e==="item"?"itens":this.modalConfig.received},getChaveDescricao(e){return Object.keys(e).find(o=>o.toLowerCase().match(/(descricao|nome|apelido)/))},debug(e){console.log("[DEBUG]test => ",e,this.proximoInput)},resetNovoCadastro(){for(const e of this.modalConfig.campos)e.reset&&(e.value=e.default||"")},proximoCampo(e){this.proximoInput=e+1},proximoCampoT(e){this.proximoInput=e+1},focusNext(e){var o=this;const n=this.proximoInput;let f=this.modalConfig.campos[n];if(!f)return!1;let l=this.$refs[f.chave];if(!l)return!1;l=l.$el;let r=l.querySelector("input");if(r||(r=l.querySelector("select")),r||(r=l.querySelector(".q-anchor--skip")),!r)return!1;for(const g of this.modalConfig.campos)g.showing=j(!1);e.preventDefault(),e.stopPropagation(),setTimeout(function(){r.focus(),f.tipo!=="autocomplete"&&o.proximoCampo(n)},50)},setModel(e,o){console.log(e,o)}}},Q=e=>(le("data-v-050e32ac"),e=e(),ie(),e),pe={class:"layout-padding"},ge={key:0,class:"positionRelative"},be={key:0},Ce=Q(()=>m("button",{class:"btn-edit"},[m("i",{class:"notranslate material-icons q-icon","aria-hidden":"true",role:"img"},"edit")],-1)),_e={key:0},ye=Q(()=>m("button",{class:"btn-edit","no-focus":""},[m("i",{class:"notranslate material-icons q-icon","aria-hidden":"true",role:"img"},"edit")],-1)),ke={key:1,class:"positionRelative"},xe={key:2,class:"positionRelative"},we={key:3},Ve={key:4},Le={key:5},qe={key:0},Se=Q(()=>m("button",{class:"btn-edit"},[m("i",{class:"notranslate material-icons q-icon","aria-hidden":"true",role:"img"},"edit")],-1)),Ie={class:"q-mt-lg text-right"},De={class:"q-mt-lg text-right"};function Te(e,o,n,f,l,r){const g=L("SeletorCampoTabela"),k=L("campo"),w=L("row"),N=J("mask");return d(),b(ae,{modelValue:l.visivel,"onUpdate:modelValue":o[3]||(o[3]=i=>l.visivel=i),onHide:o[4]||(o[4]=i=>r.onHide())},{default:s(()=>[t(K,{class:"q-dialog-plugin"},{default:s(()=>[t(Y,{class:"bg-primary text-white"},{default:s(()=>[t(Z,null,{default:s(()=>[C(h(n.modalConfig.title),1)]),_:1}),S(t(y,{dense:"",flat:"",icon:"close",round:""},null,512),[[M]])]),_:1}),m("div",pe,[t(ee,{class:oe(["q-pa-md",{boxLoading:l.isLoading}]),onSubmit:r.criar,onClick:o[1]||(o[1]=i=>r.debug(n.modalConfig)),onKeydown:o[2]||(o[2]=te(i=>r.focusNext(i),["tab"]))},{default:s(()=>[t(w,{class:"items-center q-col-gutter-md"},{default:s(()=>[(d(!0),p(I,null,D(n.modalConfig.campos,(i,x)=>(d(),p("div",{class:"col-12",key:x},[i.tipo&&i.tipo==="autocomplete"?(d(),p("div",ge,[m("div",null,[i.onlyNumber?(d(),b(F,{key:0,filled:"",modelValue:i.value,"onUpdate:modelValue":[c=>i.value=c,c=>r.buscarItems(i,x)],label:i.nome,mask:"####################",loading:i.isLoading,debounce:500,autofocus:x==0,ref_for:!0,ref:i.chave,onFocus:c=>r.proximoCampo(x)},{default:s(()=>[i.showing?(d(),b(E,{key:0,modelValue:i.showing,"onUpdate:modelValue":c=>i.showing=c,"auto-close":"","no-focus":"",style:{"min-width":"360px"}},{default:s(()=>[t(P,{link:"","no-border":"",separator:""},{default:s(()=>[(d(!0),p(I,null,D(i.searches,(c,T)=>S((d(),b(q,{clickable:"",key:T,onClick:U=>r.abrirItem(c.id)},{default:s(()=>[t(_,null,{default:s(()=>[C(h(c[r.getChaveDescricao(c)])+" ",1),i.nome!=="Produto"?(d(),p("span",be,h(i.nome)+": "+h(c[i.chave]),1)):v("",!0),Ce]),_:2},1024)]),_:2},1032,["onClick"])),[[B]])),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):v("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","label","loading","autofocus","onFocus"])):v("",!0),i.onlyNumber?v("",!0):(d(),b(F,{key:1,filled:"",modelValue:i.value,"onUpdate:modelValue":[c=>i.value=c,c=>r.buscarItems(i,x)],label:i.nome,debounce:500,autofocus:x==0,ref_for:!0,ref:i.chave,loading:i.isLoading,onFocus:c=>r.proximoCampo(x)},{default:s(()=>[i.showing?(d(),b(E,{key:0,modelValue:i.showing,"onUpdate:modelValue":c=>i.showing=c,"auto-close":"","no-focus":"",style:{"min-width":"360px"}},{default:s(()=>[t(P,{link:"","no-border":"",separator:""},{default:s(()=>[(d(!0),p(I,null,D(i.searches,(c,T)=>S((d(),b(q,{clickable:"","no-focus":"",key:T,onClick:U=>r.abrirItem(c.id)},{default:s(()=>[t(_,null,{default:s(()=>[C(h(c[r.getChaveDescricao(c)])+" ",1),i.nome!=="Produto"?(d(),p("span",_e,h(i.nome)+": "+h(c[i.chave]),1)):v("",!0),ye]),_:2},1024)]),_:2},1032,["onClick"])),[[B]])),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):v("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","label","autofocus","loading","onFocus"]))])])):v("",!0),i.tipo&&i.tipo==="autocomplete2"?(d(),p("div",ke,[t(g,{modelValue:i.value,"onUpdate:modelValue":c=>i.value=c,ref_for:!0,ref:i.chave,tabela:n.modalConfig.db,enableAdd:!0,campo:i.chave,label:i.nome},null,8,["modelValue","onUpdate:modelValue","tabela","campo","label"])])):v("",!0),i.tipo&&i.tipo==="price"?(d(),p("div",xe,[t(k,{modelValue:i.value,"onUpdate:modelValue":c=>i.value=c,ref_for:!0,ref:i.chave,tipo:"decimal",decimals:"4",zerosDireita:"2",rotulo:i.nome,dense:""},null,8,["modelValue","onUpdate:modelValue","rotulo"])])):v("",!0),i.tipo&&i.tipo=="select"?(d(),p("div",we,[t(k,{modelValue:i.value,"onUpdate:modelValue":c=>i.value=c,ref_for:!0,ref:i.chave,opcoes:i.opcoes,class:"row",rotulo:i.nome,tipo:"seletor",dense:""},null,8,["modelValue","onUpdate:modelValue","opcoes","rotulo"])])):v("",!0),i.tipo&&i.tipo=="text"?(d(),p("div",Ve,[t(k,{modelValue:i.value,"onUpdate:modelValue":c=>i.value=c,ref_for:!0,ref:i.chave,class:"row",rotulo:i.nome,tipo:"texto"},null,8,["modelValue","onUpdate:modelValue","rotulo"])])):v("",!0),i.tipo&&i.tipo=="documentoNacional"?(d(),p("div",Le,[S((d(),b(F,{filled:"",modelValue:i.value,"onUpdate:modelValue":[c=>i.value=c,c=>r.buscarItems(i,x)],label:i.nome,debounce:500,autofocus:x==0,ref_for:!0,ref:i.chave,loading:i.isLoading,onFocus:c=>r.proximoCampo(x),rules:i.rule},{default:s(()=>[t(E,{modelValue:i.showing,"onUpdate:modelValue":c=>i.showing=c,"auto-close":"","no-focus":"",style:{"min-width":"360px"}},{default:s(()=>[t(P,{link:"","no-border":"",separator:""},{default:s(()=>[(d(!0),p(I,null,D(i.searches,(c,T)=>S((d(),b(q,{clickable:"",key:T,onClick:U=>r.abrirItem(c.id)},{default:s(()=>[t(_,null,{default:s(()=>[C(h(c[r.getChaveDescricao(c)])+" ",1),i.nome!=="Produto"?(d(),p("span",qe,h(i.nome)+": "+h(c[i.chave]),1)):v("",!0),Se]),_:2},1024)]),_:2},1032,["onClick"])),[[B]])),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","label","autofocus","loading","onFocus","rules"])),[[N,["###.###.###-##","##.###.###/####-##"]]])])):v("",!0)]))),128))]),_:1}),m("div",Ie,[S(t(y,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[M]]),t(y,{color:"primary",class:"text-white",unelevated:"",label:"Criar",type:"submit"})]),m("div",De,[t(y,{color:"primary",class:"text-white",unelevated:"",label:"Criar e continuar",onClick:o[0]||(o[0]=i=>l.continuarCadastrando=!0),type:"submit"})])]),_:1},8,["onSubmit","class"])])]),_:1})]),_:1},8,["modelValue"])}var Ne=H(ve,[["render",Te],["__scopeId","data-v-050e32ac"]]);const Ue={components:{lista:me,modalContatoFicha:fe,Avatar:se,Badge:re,ModalCombinarContato:he,modalCriarNovoGenerico:Ne},data(){return{actualEmail:"",lista:[],listaOriginal:[],listaLayout:{},modalConfig:{},usuario:JSON.parse(localStorage.getItem("usuario")),diretivaContatosAcessaTodosContatos:!1,vendedoresAssistentesOpcoes:[],entregueInicio:new Date(new Date($utils.dataAtual()).toDateString()),entregueFim:new Date(new Date($utils.dataAtual()).toDateString()),modalCombinarContatos:!1,campos:{nome:"",apelido:"",numeroDocumentoNacional:"",telefone:"",cep:"",numero:""},paginacao:{atual:1,maximo:1,total:1,limite:25},thisContato:null,filtros:{nome:null,apelido:null,numeroDocumentoNacional:null,telefone:null,cidade:null,uf:null,grupo:null,segmento:null,estoque:null,vendedor:null},buscaCampo:"",opcoesVendedores:[],opcoesSegmento:[],tabSelecionada:{valor:"Ativos"},tabs:[{rotulo:"Ativos",value:"Ativos"},{rotulo:"Exclu\xEDdos",value:"Excluidos"},{rotulo:"Todos",value:"Todos"}],showAllPreviewDetail:!1,checkboxModel:!1,enderecoTipos:[{label:"Principal",value:"Principal",icon:"star",color:"orange"},{label:"Cobran\xE7a",value:"Cobran\xE7a",icon:"attach_money"},{label:"Comercial",value:"Comercial",icon:"business"},{label:"Correspond\xEAncia",value:"Correspond\xEAncia",icon:"mail"},{label:"Entrega",value:"Entrega",icon:"local_shipping"},{label:"Instala\xE7\xE3o",value:"Instala\xE7\xE3o",icon:"build"},{label:"Residencial",value:"Residencial",icon:"store_mall_directory"},{label:"Outros",value:"Outros",icon:"location_city"}]}},methods:{async atualizar(){try{$q.loading.show();const e=this.paginacao.limite,o=this.paginacao.atual,n="nome",f=$utils.eliminarVazios(this.filtros);delete f.ativo,this.tabSelecionada.valor==="Ativos"&&(f.ativo=!0),this.tabSelecionada.valor==="Excluidos"&&(f.ativo=!1);let l=this.filtros.vendedor?this.filtros.vendedor.value:null;f.codigoContatoVendedor=l,this.diretivaContatosAcessaTodosContatos||(l=this.thisContato.codigoContato,f.codigoContatoVendedor=l);let r={};this.buscaCampo?r.data=(await $db.contato.ler({filtros:{termoBusca:this.buscaCampo,ativo:f.ativo,codigoContatoVendedor:l,nome:f.nome||null}})).data:r=await $db.contato.leRefatorado({filtros:f,limit:e,page:o,sort:n}),r.total||(r.total=r.total=r.data.length),r.totalPages||(r.totalPages=1),this.listaLayout={};for(let g of r.data){const k=await $db.contato.leCompletoV3(g.id);k.detalhes=!1,k.remover=!1,this.listaLayout[g.id]=k}this.listaOriginal=$utils.clonarV2(r.data),this.lista=r.data,this.paginacao.total=r.total,this.paginacao.maximo=r.totalPages}catch(e){$q.notifyError("Erro iniciar",e)}finally{$q.loading.hide()}},async removerContato(e,o=!1){$q.dialog({cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},title:"Remover contato",message:"Ao continuar voc\xEA ir\xE1 remover este contato.",ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{$q.loading.show();const n=$utils.clonar(e);e.ativo=!1,o>-1&&this.lista.splice(o,1),await $db.contato.gravar({atual:{contato:e},original:{contato:n}}),$q.notifyPositive("O Contato foi exclu\xEDdo com sucesso.")}catch(n){$q.notifyError("Ocorreu um erro ao remover contato",n)}finally{$q.loading.hide()}})},async abrirItem(e){this.$router.replace({params:{id:e}}).finally(()=>{this.$refs.modalFicha.show({id:e})})},async restaurarContato(e,o=!1){$q.dialog({title:"Restaurar contato",message:"Deseja restaurar este contato?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{$q.loading.show();let n=$utils.clonarV2(e);e.ativo=!0,o>-1&&this.lista.splice(o,1),await $db.contato.gravar({original:{contato:n},atual:{contato:e}}),$q.notifyPositive("O contato foi restaurado com sucesso.")}catch(n){$q.notifyError("Ocorreu um erro ao restaurar contato",n)}finally{$q.loading.hide()}})},async contatoCriarPorModal_click(){await this.$refs.modalCriarNovoGenerico.show()},limparFiltros_click(){this.filtros={tab:"Ativos",nome:null,apelido:null,numeroDocumentoNacional:null,telefone:null,cidade:null,uf:null,grupo:null,segmento:null,estoque:null,vendedor:null},this.atualizar()},copiarEmail(e){this.actualEmail=e;const o=this.$refs.inputEmail;o.type="text",o.value=e;try{o.select(),document.execCommand("copy"),this.$q.notify({message:"Copiado!",type:"info"})}catch{this.$q.notify("Erro ao copiar.")}o.type="hidden",window.getSelection().removeAllRanges()},async leOpcoesSegmento(){await $db.contato.carregarMemoria(),this.opcoesSegmento=$db.contato.contatos.filter(e=>e.segmento).map(e=>({rotulo:e.segmento,valor:e.segmento}))},checkBoxGeral_click(){for(let e of this.lista)this.listaLayout[e.id].remover=this.checkboxModel;this.checkboxModel=!this.checkboxModel},async removerTodos(){let e=this;$q.dialog({title:"Remover Contatos",message:"Deseja remover todos os contatos selecionados?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{for(let o of this.lista)if(this.listaLayout[o.id].remover){let n=$utils.clonarV2(o);o.ativo=!1;try{await $db.contato.gravar({original:{contato:n},atual:{contato:o}})}catch{$q.notify("Houve um erro ao remover os contatos. Tente novamente")}}this.checkboxModel=!1,setTimeout(async()=>{await e.atualizar()},500)})},async restaurarTodos(){let e=this;$q.dialog({title:"Restaurar itens",message:"Deseja restaurar todos os itens selecionados?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{for(let o of this.lista)if(this.listaLayout[o.id].remover){let n=$utils.clonarV2(o);o.ativo=!0;try{await $db.contato.gravar({original:{contato:n},atual:{contato:o}})}catch{$q.notify("Houve um erro ao restaurar os itens. Tente novamente")}}this.checkboxModel=!1,setTimeout(async()=>{await e.atualizar()},500)})},async abrirDetalhesItem(e,o){this.listaLayout[e.id].detalhes=o||!this.listaLayout[e.id].detalhes,this.listaLayout[e.id].detalhes&&await $db.contato.leCompleto(e.id)},abrirTodosPreview(){this.showAllPreviewDetail=!this.showAllPreviewDetail,this.lista.forEach(e=>{this.abrirDetalhesItem(e,this.showAllPreviewDetail)})},async adicionarItem(){if(this.campos.descricao.length<2){$q.notifyError("favor preencher a descri\xE7\xE3o do item");return}let e={};try{this.completarCodigoBarras(),e={...$db.item.vazio,id:$utils.uuid(),ativo:!0,tipo:this.campos.tipo,marca:this.campos.marca,descricao:this.campos.descricao,referencia:this.campos.referencia,valorVenda:this.campos.valorVenda,codigoBarras:this.campos.codigoBarras,valorCustoReposicao:this.campos.valorCustoReposicao},$q.loading.show(),await $db.item.grava({atual:e}),this.filtros.codIdRef=e.id,this.atualizar(),$q.notifyPositive("Os dados do contato foram salvos com sucesso."),this.campos={ativo:!0,codigoBarras:"",descricao:"",marca:"",referencia:"",tipo:"Contato",valorCustoReposicao:0,valorVenda:0}}catch(o){$q.notifyError("Ocorreu um erro ao salvar",o)}finally{$q.loading.hide()}},abrirEdicaoCompleta(e){$q.dialog({title:"Item Cadastrado!",message:"Deseja abrir a edi\xE7\xE3o completa?",persistent:"Sim",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(()=>{this.abrirItem(e)})},async exportarXLSX_click(){try{$q.loading.show();const e=$utils.eliminarVazios(this.filtros);delete e.ativo,this.tabSelecionada.valor==="Ativos"&&(e.ativo=!0),this.tabSelecionada.valaor==="Excluidos"&&(e.ativo=!1);const o=await $db.contato.leRefatorado({filtros:e,limit:999999,page:1,sort:"descricao"}),n=R.utils.book_new(),f=R.utils.json_to_sheet(o.data,{header:Object.keys(o.data[0])});R.utils.book_append_sheet(n,f,"contatos"),R.writeFile(n,"contatos.xlsx")}catch(e){$q.notifyError("Erro iniciar",e)}finally{$q.loading.hide()}},enderecoIcone(e){const o=this.enderecoTipos.find(n=>n.label===e)||{};return{color:o.color||"dark",name:o.icon||"store_mall_directory",size:e==="Principal"?"18px":"24px"}},limparStringTelefone(e){return e.replace(/[-\s()]/g,"")},debug(e){console.log("debug => ",e)}},async mounted(){let e=this;this.thisContato=this.usuario,await $db.permissao.objeto("Diretiva_Contatos_AcessaTodosContatos").then(async o=>{this.$route.params.id&&this.$route.params.id.length&&this.$refs.modalFicha.show({id:this.$route.params.id}),this.diretivaContatosAcessaTodosContatos=o,this.diretivaContatosAcessaTodosContatos&&(this.vendedoresAssistentesOpcoes=[],$db.crm.leOnlineVendedoresDigitadores({entregueInicio:this.entregueInicio,entregueFim:this.entregueFim}).then(n=>{n.forEach(f=>{f.codigo&&this.vendedoresAssistentesOpcoes.push({label:f.nome,value:f.codigo})})}))}),this.modalConfig={title:"Cadastrar Contato",db:"contato",func:"leRefatorado",received:"contatos",searchRules:[],successMsg:"Contato Criado com sucessso!",campos:{nome:{nome:"Nome",chave:"nome",tipo:"autocomplete",condition:{codigoContatoVendedor:e.thisContato.codigoContato},reset:!0,onchange:()=>{this.modalConfig.campos[1].value=this.modalConfig.campos[0].value.split(" ")[0]}},apelido:{nome:"Apelido",chave:"apelido",tipo:"autocomplete",condition:{codigoContatoVendedor:e.thisContato.codigoContato},reset:!0},numeroDocumentoNacional:{nome:"CPF/CNPJ",chave:"numeroDocumentoNacional",tipo:"documentoNacional",reset:!0,rule:[async()=>{const o=this.modalConfig.getCampo("numeroDocumentoNacional"),n=(o.value||"").replace(/\D/g,"");if(!n.trim())return!0;if(!$utils.validarDocumentoNacional(n))return"Documento inv\xE1lido";for(const f of $db.contato.contatos){if(f.id===o.id)continue;const l=(f.numeroDocumentoNacional||"").replace(/\D/g,"");if(!!l&&n===l)return"Documento j\xE1 existente"}return!0}]}},criar:async function(){const o={...$db[this.db].vazio};for(const n of this.campos)o[n.chaveCadastro||n.chave]=n.value;return o.id=$utils.uuid(),o.codigoContatoVendedor=e.thisContato.codigoContato,await $db[this.db].gravar({atual:{contato:o}}),o},abrirItem:function(o){e.abrirItem(o)},configRules:async()=>{await $db.contato.carregarMemoria()},getCampo(o){let n=this.campos.findIndex(f=>f.chave===o);return this.campos[n]}},this.atualizar()}},Ee=["onClick"],Pe=["onClick"],ze=["onClick"],Ae={class:"col-12"},Re={class:"text-tertiary q-col-gutter-xs"},Oe=["href"],Fe=["href"],Be=["href"],Me=["href"],Qe=["href"],je={key:1,class:"q-pa-md showPreviewDetail"},$e={key:0,class:"col-12 col-md-4"},Ge=m("small",null,"Local",-1),Xe={style:{"white-space":"pre-line"}},He={class:"col-12 col-md"},Je=m("small",null,"Anivers\xE1rio",-1),We=m("br",null,null,-1),Ke={class:"col-12 col-md"},Ye=m("small",null,"Segmento",-1),Ze=m("br",null,null,-1),eo={class:"col-12 col-md"},oo=m("small",null,"E-mail",-1),to=m("br",null,null,-1),ao={key:2,class:"row q-px-md q-pb-md showPreviewDetail"};function lo(e,o,n,f,l,r){const g=L("campo"),k=L("badge"),w=L("row"),N=L("avatar"),i=L("lista"),x=L("modalContatoFicha"),c=L("modalCombinarContato"),T=L("modalCriarNovoGenerico"),U=J("mask");return d(),p(I,null,[t(i,{titulo:"Contatos",icone:"person",onCriar_click:r.contatoCriarPorModal_click,onCheckBoxGeral_click:r.checkBoxGeral_click,onFiltro_change:r.atualizar,onLimparFiltros_click:r.limparFiltros_click,onAbrirTodosPreview:r.abrirTodosPreview,onExportarXLSX_click:r.exportarXLSX_click,onRemoverTodos:r.removerTodos,onRestaurarTodos:r.restaurarTodos,tabSelecionada:l.tabSelecionada,tabs:l.tabs,lista:l.lista,listaLayout:l.listaLayout,paginacao:l.paginacao,filtros:l.filtros,buscaCampo:l.buscaCampo,"onUpdate:buscaCampo":o[10]||(o[10]=a=>l.buscaCampo=a),checkboxModel:l.checkboxModel,"onUpdate:checkboxModel":o[11]||(o[11]=a=>l.checkboxModel=a)},{menuExtras:s(()=>[t(q,{clickable:"",onClick:o[0]||(o[0]=()=>{this.modalCombinarContatos=!0})},{default:s(()=>[t(_,{avatar:""},{default:s(()=>[t(V,{name:"compare_arrows",size:"sm"})]),_:1}),t(_,null,{default:s(()=>[C("Combinar Contato")]),_:1})]),_:1})]),filtroCampos:s(()=>[t(g,{modelValue:l.filtros.nome,"onUpdate:modelValue":o[1]||(o[1]=a=>l.filtros.nome=a),rotulo:"Nome/Raz\xE3o",dense:""},null,8,["modelValue"]),t(g,{modelValue:l.filtros.apelido,"onUpdate:modelValue":o[2]||(o[2]=a=>l.filtros.apelido=a),rotulo:"Apelido/Fantasia",dense:""},null,8,["modelValue"]),S(t(g,{modelValue:l.filtros.numeroDocumentoNacional,"onUpdate:modelValue":o[3]||(o[3]=a=>l.filtros.numeroDocumentoNacional=a),rotulo:"CPF/CNPJ",dense:""},null,8,["modelValue"]),[[U,["###.###.###-##","##.###.###/####-##"]]]),S(t(g,{modelValue:l.filtros.telefone,"onUpdate:modelValue":o[4]||(o[4]=a=>l.filtros.telefone=a),rotulo:"Telefone",dense:""},null,8,["modelValue"]),[[U,["(##) # ####-####"]]]),t(g,{modelValue:l.filtros.cidade,"onUpdate:modelValue":o[5]||(o[5]=a=>l.filtros.cidade=a),rotulo:"Cidade",dense:""},null,8,["modelValue"]),t(g,{modelValue:l.filtros.uf,"onUpdate:modelValue":o[6]||(o[6]=a=>l.filtros.uf=a),rotulo:"Estado",dense:""},null,8,["modelValue"]),l.diretivaContatosAcessaTodosContatos?(d(),b(ne,{key:0,modelValue:l.filtros.vendedor,"onUpdate:modelValue":[o[7]||(o[7]=a=>l.filtros.vendedor=a),e.refazFiltro],options:l.vendedoresAssistentesOpcoes,clearable:"",label:"Vendedor / Assistente"},null,8,["modelValue","options","onUpdate:modelValue"])):v("",!0),t(g,{modelValue:l.filtros.segmento,"onUpdate:modelValue":o[8]||(o[8]=a=>l.filtros.segmento=a),rotulo:"Segmento/Profiss\xE3o",clearable:"",tipo:"seletor",opcoes:l.opcoesSegmento,dense:"",onClick:r.leOpcoesSegmento},null,8,["modelValue","opcoes","onClick"]),t(g,{modelValue:l.paginacao.limite,"onUpdate:modelValue":o[9]||(o[9]=a=>l.paginacao.limite=a),min:"1",rotulo:"Quantidade por p\xE1gina",tipo:"quantidade",dense:""},null,8,["modelValue"])]),itemLista:s(()=>[t(P,{class:"rounded-borders"},{default:s(()=>[(d(!0),p(I,null,D(l.lista,(a,z)=>(d(),p("div",{key:a,class:"itemHover fullWidth",onClick:u=>r.debug(a)},[l.listaLayout[a.id]?(d(),b(q,{key:0,"manual-focus":"",clickable:"",class:"items-center d-flex q-pa-xs"},{default:s(()=>[t(_,{avatar:"",center:"",class:"mw120 hideonmobile"},{default:s(()=>[t(w,{class:"items-center"},{default:s(()=>[l.listaLayout[a.id]?(d(),b($,{key:0,modelValue:l.listaLayout[a.id].remover,"onUpdate:modelValue":u=>l.listaLayout[a.id].remover=u},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),t(k,{cor:a.ativo?"positive":"tertiary",escuro:"",class:"q-ml-xs large-for-mobile"},{default:s(()=>[C(" #"+h((a.codigoContato||0).toString().padStart(4,"0")),1)]),_:2},1032,["cor"])]),_:2},1024)]),_:2},1024),t(_,{clickable:"",onClick:u=>r.debug(a)},{default:s(()=>[t(w,{class:"items-center q-col-gutter-x-sm"},{default:s(()=>[t($,{modelValue:l.listaLayout[a.id].remover,"onUpdate:modelValue":u=>l.listaLayout[a.id].remover=u,class:"q-ma-none q-pa-none hideondesktop large-for-mobile"},null,8,["modelValue","onUpdate:modelValue"]),m("div",{class:"col-auto q-pl-none items-center",onClick:u=>r.abrirItem(a.id)},[t(N,{imagem:a.photo,tamanho:"40",rotulo:a.nome,style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])],8,Pe),m("div",{class:"col",onClick:u=>r.abrirItem(a.id)},[t(A,{class:"text-tertiary text-weight-bold"},{default:s(()=>[C(h(a.apelido),1)]),_:2},1024),t(A,{caption:"",class:"text-tertiary"},{default:s(()=>[C(h(a.nome),1)]),_:2},1024),t(w,{class:"hideondesktop items-center q-my-sm"},{default:s(()=>[m("div",Ae,[t(k,{class:"q-mr-sm",escuro:"",cor:a.ativo?"positive":"tertiary"},{default:s(()=>[C("#"+h((a.codigoContato||0).toString().padStart(4,"0")),1)]),_:2},1032,["cor"])])]),_:2},1024)],8,ze)]),_:2},1024)]),_:2},1032,["onClick"]),t(_,{class:"hideonmobile"},{default:s(()=>[t(A,{class:"text-tertiary"},{default:s(()=>[C(h(a.numeroDocumentoNacional)+" ",1),t(G,null,{default:s(()=>[C("CNPJ")]),_:1})]),_:2},1024),t(A,{caption:"",class:"text-tertiary"},{default:s(()=>[C(h(a.numeroDocumentoEstadual)+" ",1),t(G,null,{default:s(()=>[C("Inscri\xE7\xE3o Estadual")]),_:1})]),_:2},1024)]),_:2},1024),t(_,{side:"",top:""},{default:s(()=>[m("div",Re,[l.listaLayout[a.id]?(d(),b(y,{key:0,"text-color":"tertiary",size:"md",icon:l.listaLayout[a.id].detalhes?"keyboard_arrow_up":"keyboard_arrow_down",flat:"",dense:"",round:"",class:"buttons hideonmobile",onClick:u=>r.abrirDetalhesItem(a)},null,8,["icon","onClick"])):v("",!0),t(y,{icon:"phone",style:{"padding-right":"0px"},class:"hideonmobile",disabled:!(l.listaLayout[a.id]&&l.listaLayout[a.id].telefone.length),color:"none",flat:"","text-color":"tertiary",label:a.tel,"icon-right":"arrow_drop_down"},{default:s(()=>[t(E,null,{default:s(()=>[(d(!0),p(I,null,D(l.listaLayout[a.id].telefone,u=>(d(),p("div",{key:u,class:"row q-pa-none bordered"},[t(X,{flat:""},{default:s(()=>[t(y,{icon:"phone",color:"none","text-color":"tertiary",class:"btntel"},{default:s(()=>[m("a",{push:"",href:"tel:55"+r.limparStringTelefone(u.telefone),target:"_blank",class:"btntel text-tertiary"},h(u.telefone),9,Oe)]),_:2},1024),u.tipoTelefone==="Celular"||u.tipoTelefone==="WhatsApp"?(d(),b(y,{key:0,color:"none","text-color":"positive",class:"btntel"},{default:s(()=>[m("a",{push:"",href:"https://wa.me/"+r.limparStringTelefone("+55"+u.telefone),target:"_blank",class:"btntel text-tertiary"},[t(V,{name:"mdi-whatsapp"})],8,Fe)]),_:2},1024)):v("",!0)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1032,["disabled","label"]),t(y,{icon:"more_vert",style:{"padding-right":"0px"},class:"hideondesktop",color:"none",flat:"","text-color":"tertiary",label:a.tel},{default:s(()=>[t(E,null,{default:s(()=>[S((d(),b(P,{link:"","no-border":"",separator:""},{default:s(()=>[l.listaLayout[a.id]&&l.listaLayout[a.id].telefone.length?(d(),b(q,{key:0,clickable:""},{default:s(()=>[t(_,null,{default:s(()=>[(d(!0),p(I,null,D(l.listaLayout[a.id].telefone,u=>(d(),p("div",{key:u,class:"row q-pa-none bordered"},[t(X,{flat:""},{default:s(()=>[t(y,{icon:"phone",color:"none","text-color":"tertiary",class:"btntel"},{default:s(()=>[m("a",{push:"",href:"tel:55"+r.limparStringTelefone(u.telefone),target:"_blank",class:"btntel text-tertiary"},h(u.telefone),9,Be)]),_:2},1024),u.tipoTelefone==="Celular"||u.tipoTelefone==="WhatsApp"?(d(),b(y,{key:0,color:"none","text-color":"positive",class:"btntel"},{default:s(()=>[m("a",{push:"",href:"https://wa.me/"+r.limparStringTelefone(u.telefone),target:"_blank",class:"btntel text-tertiary"},[t(V,{name:"mdi-whatsapp"})],8,Me)]),_:2},1024)):v("",!0)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1024)):v("",!0),a.email&&a.email.length?(d(),b(q,{key:1,clickable:""},{default:s(()=>[t(_,null,{default:s(()=>[t(y,{"text-color":"tertiary",size:"md",flat:"",icon:"email",dense:"",round:"",label:"Enviar por E-mail"},{default:s(()=>[a.email&&a.email.length?(d(),p("a",{key:0,icon:"mail",push:"",href:"mailto:"+a.email,target:"_blank",class:"btntel text-tertiary"},null,8,Qe)):v("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)):v("",!0),t(q,{clickable:"",onClick:u=>r.abrirItem(a.id)},{default:s(()=>[t(_,{avatar:""},{default:s(()=>[t(V,{name:"edit",size:"sm"})]),_:1}),t(_,null,{default:s(()=>[C("Editar")]),_:1})]),_:2},1032,["onClick"]),t(q,{clickable:"",onClick:u=>r.abrirItem(a.id)},{default:s(()=>[t(_,{avatar:""},{default:s(()=>[t(V,{name:"delete",size:"sm"})]),_:1}),t(_,null,{default:s(()=>[C("Remover")]),_:1})]),_:2},1032,["onClick"]),a.ativo?(d(),b(q,{key:2,clickable:"",onClick:u=>r.removerContato(a,z)},{default:s(()=>[t(_,{avatar:""},{default:s(()=>[t(V,{name:"delete",size:"sm"})]),_:1}),t(_,null,{default:s(()=>[C("Remover")]),_:1})]),_:2},1032,["onClick"])):v("",!0),a.ativo?v("",!0):(d(),b(q,{key:3,clickable:"",onClick:u=>r.restaurarContato(a,z)},{default:s(()=>[t(_,{avatar:""},{default:s(()=>[t(V,{name:"restore_from_trash",size:"sm"})]),_:1}),t(_,null,{default:s(()=>[C("Restaurar")]),_:1})]),_:2},1032,["onClick"]))]),_:2},1024)),[[M]])]),_:2},1024)]),_:2},1032,["label"]),t(y,{"text-color":"tertiary",disabled:!(a.email&&a.email.length),size:"md",flat:"",dense:"",round:"",class:"buttons hideonmobile btntel text-tertiary",icon:"mail",onClick:u=>r.copiarEmail(a.email)},null,8,["disabled","onClick"]),t(y,{"text-color":"primary",size:"md",icon:"edit",flat:"",dense:"",round:"",class:"buttons hideonmobile",onClick:u=>r.abrirItem(a.id)},null,8,["onClick"]),a.ativo?(d(),b(y,{key:1,"text-color":"tertiary",size:"md",icon:"delete",flat:"",dense:"",round:"",class:"buttons hideonmobile",onClick:u=>r.removerContato(a,z)},null,8,["onClick"])):v("",!0),a.ativo?v("",!0):(d(),b(y,{key:2,"text-color":"tertiary",size:"md",icon:"restore_from_trash",flat:"",dense:"",round:"",class:"buttons hideonmobile",onClick:u=>r.restaurarContato(a,z)},null,8,["onClick"]))])]),_:2},1024)]),_:2},1024)):v("",!0),l.listaLayout[a.id]&&l.listaLayout[a.id].detalhes?(d(),p("div",je,[t(w,{class:"q-col-gutter-md text-tertiary"},{default:s(()=>[l.listaLayout[a.id].endereco.length?(d(),p("div",$e,[Ge,(d(!0),p(I,null,D(l.listaLayout[a.id].endereco.filter(u=>u.logradouro),u=>(d(),p("div",{key:u.id},[t(V,de(r.enderecoIcone(u.grupo),{"text-color":"tertiary",size:"xs",class:"q-mx-xs"}),null,16),m("span",Xe,h(u.logradouro)+" "+h(u.numero)+" "+h(u.complemento)+" "+h(u.bairro)+" "+h(u.cep)+" "+h(u.municipio)+" "+h(u.uf),1)]))),128))])):v("",!0),m("div",He,[Je,We,t(V,{name:"event",class:"q-mr-xs"}),C(h(e.$filters.data(a.dataAbertura)),1)]),m("div",Ke,[Ye,Ze,t(V,{name:"local_offer",class:"q-mr-xs"}),C(h(a.segmento),1)]),m("div",eo,[oo,to,t(V,{name:"email",class:"q-mr-xs"}),C(h(a.email),1)])]),_:2},1024)])):v("",!0),l.listaLayout[a.id]&&l.listaLayout[a.id].detalhes?(d(),p("div",ao,[(d(!0),p(I,null,D(a.tags,u=>(d(),b(k,{class:"q-mr-sm",escuro:"",cor:"primary",key:u},{default:s(()=>[C(h(u),1)]),_:2},1024))),128))])):v("",!0),t(ue)],8,Ee))),128))]),_:1})]),_:1},8,["onCriar_click","onCheckBoxGeral_click","onFiltro_change","onLimparFiltros_click","onAbrirTodosPreview","onExportarXLSX_click","onRemoverTodos","onRestaurarTodos","tabSelecionada","tabs","lista","listaLayout","paginacao","filtros","buscaCampo","checkboxModel"]),t(x,{ref:"modalFicha",atualizarLista:r.atualizar},null,8,["atualizarLista"]),t(c,{modelValue:l.modalCombinarContatos,"onUpdate:modelValue":o[12]||(o[12]=a=>l.modalCombinarContatos=a),atualizar:r.atualizar},null,8,["modelValue","atualizar"]),t(T,{ref:"modalCriarNovoGenerico",modalConfig:l.modalConfig},null,8,["modalConfig"]),S(m("input",{type:"hidden","onUpdate:modelValue":o[13]||(o[13]=a=>l.actualEmail=a),ref:"inputEmail"},null,512),[[ce,l.actualEmail]])],64)}var go=H(Ue,[["render",lo]]);export{go as default};
